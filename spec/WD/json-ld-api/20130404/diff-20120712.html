<?xml version='1.0' encoding='UTF-8'?>
<!DOCTYPE html PUBLIC '-//W3C//DTD XHTML+RDFa 1.1//EN' 'http://www.w3.org/MarkUp/DTD/xhtml-rdfa-2.dtd'>
<html dir="ltr" xmlns="http://www.w3.org/1999/xhtml" prefix='bibo: http://purl.org/ontology/bibo/' typeof="bibo:Document">
<head>
<title>JSON-LD 1.0 Processing Algorithms and API</title>
<meta http-equiv="content-type" content="text/html; charset=UTF-8" />



<style type="text/css">
  .diff {
    font-weight:bold; color:#0a3;
  }
  .error a {
    color:  #ff4500;
    border-bottom:  1px dotted #ff4500;
    text-decoration: none;
  }
</style>
<style>/*****************************************************************
 * ReSpec 3 CSS
 * Robin Berjon - http://berjon.com/
 *****************************************************************/

/* --- INLINES --- */
em.rfc2119 { 
    text-transform:     lowercase;
    font-variant:       small-caps;
    font-style:         normal;
    color:              #900;
}

h1 acronym, h2 acronym, h3 acronym, h4 acronym, h5 acronym, h6 acronym, a acronym,
h1 abbr, h2 abbr, h3 abbr, h4 abbr, h5 abbr, h6 abbr, a abbr {
    border: none;
}

dfn {
    font-weight:    bold;
}

a.internalDFN {
    color:  inherit;
    border-bottom:  1px solid #99c;
    text-decoration:    none;
}

a.externalDFN {
    color:  inherit;
    border-bottom:  1px dotted #ccc;
    text-decoration:    none;
}

a.bibref {
    text-decoration:    none;
}

cite .bibref {
    font-style: normal;
}

code {
    color:  #ff4500;
}


/* --- --- */
ol.algorithm { counter-reset:numsection; list-style-type: none; }
ol.algorithm li { margin: 0.5em 0; }
ol.algorithm li:before { font-weight: bold; counter-increment: numsection; content: counters(numsection, ".") ") "; }

/* --- TOC --- */
.toc a, .tof a {
    text-decoration:    none;
}

a .secno, a .figno {
    color:  #000;
}

ul.tof, ol.tof {
    list-style: none outside none;
}

.caption {
    margin-top: 0.5em;
    font-style:   italic;
}

/* --- TABLE --- */
table.simple {
    border-spacing: 0;
    border-collapse:    collapse;
    border-bottom:  3px solid #005a9c;
}

.simple th {
    background: #005a9c;
    color:  #fff;
    padding:    3px 5px;
    text-align: left;
}

.simple th[scope="row"] {
    background: inherit;
    color:  inherit;
    border-top: 1px solid #ddd;
}

.simple td {
    padding:    3px 10px;
    border-top: 1px solid #ddd;
}

.simple tr:nth-child(even) {
    background: #f0f6ff;
}

/* --- DL --- */
.section dd > p:first-child {
    margin-top: 0;
}

.section dd > p:last-child {
    margin-bottom: 0;
}

.section dd {
    margin-bottom:  1em;
}

.section dl.attrs dd, .section dl.eldef dd {
    margin-bottom:  0;
}
</style><style>/* --- EXAMPLES --- */
div.example-title {
    min-width: 7.5em;
    color: #b9ab2d;
}
div.example-title span {
    text-transform: uppercase;   
}
aside.example, div.example, div.illegal-example {
    padding: 0.5em;
    margin: 1em 0;
    position: relative;
    clear: both;
}
div.illegal-example { color: red }
div.illegal-example p { color: black }
aside.example, div.example {
    padding: .5em;
    border-left-width: .5em;
    border-left-style: solid;
    border-color: #e0cb52;
    background: #fcfaee;    
}

aside.example div.example {
    border-left-width: .1em;
    border-color: #999;
    background: #fff;
}
aside.example div.example div.example-title {
    color: #999;
}
</style><style>/* --- ISSUES/NOTES --- */
div.issue-title, div.note-title {
    padding-right:  1em;
    min-width: 7.5em;
    color: #b9ab2d;
}
div.issue-title { color: #e05252; }
div.note-title { color: #52e052; }
div.issue-title span, div.note-title span {
    text-transform: uppercase;
}
div.note, div.issue {
    margin-top: 1em;
    margin-bottom: 1em;
}
.note > p:first-child, .issue > p:first-child { margin-top: 0 }
.issue, .note {
    padding: .5em;
    border-left-width: .5em;
    border-left-style: solid;
}
div.issue, div.note {
    padding: 0.5em;
    margin: 1em 0;
    position: relative;
    clear: both;
}
span.note, span.issue { padding: .1em .5em .15em; }

.issue {
    border-color: #e05252;
    background: #fbe9e9;
}
.note {
    border-color: #52e052;
    background: #e9fbe9;
}


</style><style>/* --- WEB IDL --- */
pre.idl {
    border-top: 1px solid #90b8de;
    border-bottom: 1px solid #90b8de;
    padding:    1em;
    line-height:    120%;
}

pre.idl::before {
    content:    "WebIDL";
    display:    block;
    width:      150px;
    background: #90b8de;
    color:  #fff;
    font-family:    initial;
    padding:    3px;
    font-weight:    bold;
    margin: -1em 0 1em -1em;
}

.idlType {
    color:  #ff4500;
    font-weight:    bold;
    text-decoration:    none;
}

/*.idlModule*/
/*.idlModuleID*/
/*.idlInterface*/
.idlInterfaceID, .idlDictionaryID, .idlCallbackID, .idlEnumID {
    font-weight:    bold;
    color:  #005a9c;
}
a.idlEnumItem {
    color:  #000;
    border-bottom:  1px dotted #ccc;
    text-decoration: none;
}

.idlSuperclass {
    font-style: italic;
    color:  #005a9c;
}

/*.idlAttribute*/
.idlAttrType, .idlFieldType, .idlMemberType {
    color:  #005a9c;
}
.idlAttrName, .idlFieldName, .idlMemberName {
    color:  #ff4500;
}
.idlAttrName a, .idlFieldName a, .idlMemberName a {
    color:  #ff4500;
    border-bottom:  1px dotted #ff4500;
    text-decoration: none;
}

/*.idlMethod*/
.idlMethType, .idlCallbackType {
    color:  #005a9c;
}
.idlMethName {
    color:  #ff4500;
}
.idlMethName a {
    color:  #ff4500;
    border-bottom:  1px dotted #ff4500;
    text-decoration: none;
}

/*.idlParam*/
.idlParamType {
    color:  #005a9c;
}
.idlParamName, .idlDefaultValue {
    font-style: italic;
}

.extAttr {
    color:  #666;
}

/*.idlConst*/
.idlConstType {
    color:  #005a9c;
}
.idlConstName {
    color:  #ff4500;
}
.idlConstName a {
    color:  #ff4500;
    border-bottom:  1px dotted #ff4500;
    text-decoration: none;
}

/*.idlException*/
.idlExceptionID {
    font-weight:    bold;
    color:  #c00;
}

.idlTypedefID, .idlTypedefType {
    color:  #005a9c;
}

.idlRaises, .idlRaises a.idlType, .idlRaises a.idlType code, .excName a, .excName a code {
    color:  #c00;
    font-weight:    normal;
}

.excName a {
    font-family:    monospace;
}

.idlRaises a.idlType, .excName a.idlType {
    border-bottom:  1px dotted #c00;
}

.excGetSetTrue, .excGetSetFalse, .prmNullTrue, .prmNullFalse, .prmOptTrue, .prmOptFalse {
    width:  45px;
    text-align: center;
}
.excGetSetTrue, .prmNullTrue, .prmOptTrue { color:  #0c0; }
.excGetSetFalse, .prmNullFalse, .prmOptFalse { color:  #c00; }

.idlImplements a {
    font-weight:    bold;
}

dl.attributes, dl.methods, dl.constants, dl.fields, dl.dictionary-members {
    margin-left:    2em;
}

.attributes dt, .methods dt, .constants dt, .fields dt, .dictionary-members dt {
    font-weight:    normal;
}

.attributes dt code, .methods dt code, .constants dt code, .fields dt code, .dictionary-members dt code {
    font-weight:    bold;
    color:  #000;
    font-family:    monospace;
}

.attributes dt code, .fields dt code, .dictionary-members dt code {
    background:  #ffffd2;
}

.attributes dt .idlAttrType code, .fields dt .idlFieldType code, .dictionary-members dt .idlMemberType code {
    color:  #005a9c;
    background:  transparent;
    font-family:    inherit;
    font-weight:    normal;
    font-style: italic;
}

.methods dt code {
    background:  #d9e6f8;
}

.constants dt code {
    background:  #ddffd2;
}

.attributes dd, .methods dd, .constants dd, .fields dd, .dictionary-members dd {
    margin-bottom:  1em;
}

table.parameters, table.exceptions {
    border-spacing: 0;
    border-collapse:    collapse;
    margin: 0.5em 0;
    width:  100%;
}
table.parameters { border-bottom:  1px solid #90b8de; }
table.exceptions { border-bottom:  1px solid #deb890; }

.parameters th, .exceptions th {
    color:  #fff;
    padding:    3px 5px;
    text-align: left;
    font-family:    initial;
    font-weight:    normal;
    text-shadow:    #666 1px 1px 0;
}
.parameters th { background: #90b8de; }
.exceptions th { background: #deb890; }

.parameters td, .exceptions td {
    padding:    3px 10px;
    border-top: 1px solid #ddd;
    vertical-align: top;
}

.parameters tr:first-child td, .exceptions tr:first-child td {
    border-top: none;
}

.parameters td.prmName, .exceptions td.excName, .exceptions td.excCodeName {
    width:  100px;
}

.parameters td.prmType {
    width:  120px;
}

table.exceptions table {
    border-spacing: 0;
    border-collapse:    collapse;
    width:  100%;
}
</style><link rel="stylesheet" href="http://www.w3.org/StyleSheets/TR/W3C-WD" />
<!--[if lt IE 9]><script src='http://www.w3.org/2008/site/js/html5shiv.js'></script><![endif]-->
<style type='text/css'>
.diff-old-a {
  font-size: smaller;
  color: red;
}

.diff-new { background-color: yellow; }
.diff-chg { background-color: lime; }
.diff-new:before,
.diff-new:after
    { content: "\2191" }
.diff-chg:before, .diff-chg:after
    { content: "\2195" }
.diff-old { text-decoration: line-through; background-color: #FBB; }
.diff-old:before,
.diff-old:after
    { content: "\2193" }
:focus { border: thin red solid}
</style>
</head>


<body>
<div class="head">
<p>
<a href="http://www.w3.org/">
<img width="72" height="48" src="http://www.w3.org/Icons/w3c_home" alt="W3C" />
</a>
</p>
<h1 class="title" id="title">
JSON-LD
<del class="diff-old">API
</del>
1.0
<ins class="diff-new">Processing
Algorithms
and
API
</ins>
</h1>
<del class="diff-old">An
Application
Programming
Interface
for
the
JSON-LD
Syntax
</del>
<h2 id="w3c-working-draft-04-april-2013">
<abbr title="World Wide Web Consortium">
W3C
</abbr>
Working
Draft
<del class="diff-old">12
July
2012
</del>
<ins class="diff-chg">04
April
2013
</ins>
</h2>
<dl>
<dt>
This
version:
</dt>
<dd>
<del class="diff-old">http://www.w3.org/TR/2012/WD-json-ld-api-20120712/
</del>
<a href="http://www.w3.org/TR/2013/WD-json-ld-api-20130404/">
<ins class="diff-chg">http://www.w3.org/TR/2013/WD-json-ld-api-20130404/
</ins>
</a>
</dd>
<dt>
Latest
published
version:
</dt>
<dd>
<a href="http://www.w3.org/TR/json-ld-api/">
http://www.w3.org/TR/json-ld-api/
</a>
</dd>
<dt>
Latest
editor's
draft:
</dt>
<dd>
<del class="diff-old">http://dvcs.w3.org/hg/json-ld/raw-file/default/spec/latest/json-ld-api/index.html
</del>
<a href="http://dvcs.w3.org/hg/json-ld/raw-file/spec/latest/json-ld-api/index.html">
<ins class="diff-chg">http://dvcs.w3.org/hg/json-ld/raw-file/spec/latest/json-ld-api/index.html
</ins></a></dd><dt><ins class="diff-chg">
Test
suite:
</ins></dt><dd><a href="http://json-ld.org/test-suite/"><ins class="diff-chg">
http://json-ld.org/test-suite/
</ins></a></dd><dt><ins class="diff-chg">
Previous
version:
</ins></dt><dd><a href="http://www.w3.org/TR/2012/WD-json-ld-api-20120712/"><ins class="diff-chg">
http://www.w3.org/TR/2012/WD-json-ld-api-20120712/
</ins>
</a>
</dd>
<dt>
Editors:
</dt>
<dd rel="bibo:editor" inlist="">
<span typeof="foaf:Person">
<del class="diff-old">Manu
Sporny
</del>
<a rel="foaf:homepage" property="foaf:name" content="Markus Lanthaler" href="http://www.markus-lanthaler.com/">
<ins class="diff-chg">Markus
Lanthaler
</ins>
</a>,
<del class="diff-old">Digital
Bazaar
</del>
<a rel="foaf:workplaceHomepage" href="http://www.tugraz.at/">
<ins class="diff-chg">Graz
University
of
Technology
</ins>
</a>
</span>
</dd>
<dd rel="bibo:editor" inlist="">
<span typeof="foaf:Person">
<a rel="foaf:homepage" property="foaf:name" content="Gregg Kellogg" href="http://greggkellogg.net/">
Gregg
Kellogg
</a>,
<a rel="foaf:workplaceHomepage" href="http://kellogg-assoc.com/">
Kellogg
Associates
</a>
</span>
</dd>
<dd rel="bibo:editor" inlist="">
<span typeof="foaf:Person">
<del class="diff-old">Dave
Longley
</del>
<a rel="foaf:homepage" property="foaf:name" content="Manu Sporny" href="http://manu.sporny.org/">
<ins class="diff-chg">Manu
Sporny
</ins>
</a>,
<a rel="foaf:workplaceHomepage" href="http://digitalbazaar.com/">
Digital
Bazaar
</a>
</span>
</dd>
<del class="diff-old">Markus
Lanthaler
,
Graz
University
of
Technology
</del>
<dt>
Authors:
</dt>
<dd rel="dcterms:contributor">
<span typeof="foaf:Person">
<a rel="foaf:homepage" property="foaf:name" content="Dave Longley" href="http://digitalbazaar.com/">
Dave
Longley
</a>,
<a rel="foaf:workplaceHomepage" href="http://digitalbazaar.com/">
Digital
Bazaar
</a>
</span>
</dd>
<dd rel="dcterms:contributor">
<span typeof="foaf:Person">
<del class="diff-old">Manu
Sporny
,
Digital
Bazaar
</del>
<a rel="foaf:homepage" property="foaf:name" content="Gregg Kellogg" href="http://greggkellogg.net/">
Gregg
Kellogg
</a>,
<a rel="foaf:workplaceHomepage" href="http://kellogg-assoc.com/">
Kellogg
Associates
</a>
</span>
</dd>
<dd rel="dcterms:contributor">
<span typeof="foaf:Person">
<a rel="foaf:homepage" property="foaf:name" content="Markus Lanthaler" href="http://www.markus-lanthaler.com/">
Markus
Lanthaler
</a>,
<a rel="foaf:workplaceHomepage" href="http://www.tugraz.at/">
Graz
University
of
Technology
</a>
</span>
</dd>
<dd rel="dcterms:contributor">
<span typeof="foaf:Person">
<a rel="foaf:homepage" property="foaf:name" content="Manu Sporny" href="http://digitalbazaar.com/">
<ins class="diff-new">Manu
Sporny
</ins></a>,<a rel="foaf:workplaceHomepage" href="http://digitalbazaar.com/"><ins class="diff-new">
Digital
Bazaar
</ins></a></span></dd>
</dl>
<p>
This
document
is
also
available
in
this
non-normative
format:
<a rel="alternate" href="diff-20120712.html">
diff
to
previous
version
</a>
</p>
<p class="copyright">
<a href="http://www.w3.org/Consortium/Legal/ipr-notice#Copyright">
Copyright
</a>
©
<del class="diff-old">2010-2012
</del>
<ins class="diff-chg">2010-2013
</ins>
<a href="http://www.w3.org/">
<abbr title="World Wide Web Consortium">
W3C
</abbr>
</a>
<sup>
®
</sup>
(
<a href="http://www.csail.mit.edu/">
<abbr title="Massachusetts Institute of Technology">
MIT
</abbr>
</a>,
<a href="http://www.ercim.eu/">
<abbr title="European Research Consortium for Informatics and Mathematics">
ERCIM
</abbr>
</a>,
<a href="http://www.keio.ac.jp/">
Keio
</a>,
<a href="http://ev.buaa.edu.cn/">
<ins class="diff-new">Beihang
</ins>
</a>
),
All
Rights
Reserved.
<abbr title="World Wide Web Consortium">
W3C
</abbr>
<a href="http://www.w3.org/Consortium/Legal/ipr-notice#Legal_Disclaimer">
liability
</a>,
<a href="http://www.w3.org/Consortium/Legal/ipr-notice#W3C_Trademarks">
trademark
</a>
and
<a href="http://www.w3.org/Consortium/Legal/copyright-documents">
document
use
</a>
rules
apply.
</p>
<hr />
</div>
<section id="abstract" class="introductory" property="dcterms:abstract" datatype="" typeof="bibo:Chapter" resource="#abstract" rel="bibo:chapter">
<h2>
Abstract
</h2>
<p>
JSON
[
<cite>
<a class="bibref" href="#bib-RFC4627">
RFC4627
</a>
</cite>
]
has
proven
to
be
a
highly
useful
object
serialization
and
messaging
format.
JSON-LD
[
<cite>
<a class="bibref" href="#bib-JSON-LD">
JSON-LD
</a>
</cite>
]
harmonizes
the
representation
of
Linked
Data
in
JSON
by
outlining
a
common
JSON
representation
format
for
expressing
directed
<del class="diff-old">graphs;
</del>
<ins class="diff-chg">graphs,
</ins>
mixing
both
Linked
Data
and
non-Linked
Data
in
a
single
document.
This
document
outlines
an
Application
Programming
Interface
and
a
set
of
algorithms
for
programmatically
transforming
JSON-LD
documents
<del class="diff-old">in
order
</del>
to
make
them
easier
to
work
with
in
programming
environments
like
<ins class="diff-new">those
that
use
</ins>
JavaScript,
Python,
and
Ruby.
</p>
</section>
<section id="sotd" class="introductory" typeof="bibo:Chapter" resource="#sotd" rel="bibo:chapter">
<h2>
Status
of
This
Document
</h2>
<p>
<em>
This
section
describes
the
status
of
this
document
at
the
time
of
its
publication.
Other
documents
may
supersede
this
document.
A
list
of
current
<abbr title="World Wide Web Consortium">
W3C
</abbr>
publications
and
the
latest
revision
of
this
technical
report
can
be
found
in
the
<a href="http://www.w3.org/TR/">
<abbr title="World Wide Web Consortium">
W3C
</abbr>
technical
reports
index
</a>
at
http://www.w3.org/TR/.
</em>
</p>
<p>
This
document
has
been
under
development
for
over
<del class="diff-old">18
</del>
<ins class="diff-chg">25
</ins>
months
in
the
JSON
for
Linking
Data
Community
Group.
The
document
has
recently
been
transferred
to
the
RDF
Working
Group
for
review,
improvement,
and
publication
along
the
Recommendation
track.
<del class="diff-old">While
this
is
a
First
Public
Working
Draft
publication,
the
</del>
<ins class="diff-chg">The
</ins>
specification
has
undergone
significant
development,
review,
and
changes
during
the
course
of
the
last
<del class="diff-old">18
months
and
is
more
mature
than
the
First
Public
Working
Draft
status
implies.
</del>
<ins class="diff-chg">25
months.
</ins>
</p>
<p>
There
are
<del class="diff-old">currently
</del>
<ins class="diff-chg">several
independent
</ins>
<a href="http://json-ld.org/#impl">
<del class="diff-old">five
</del>
interoperable
implementations
</a>
of
this
specification.
There
is
a
<a href="https://github.com/json-ld/json-ld.org/tree/master/test-suite">
fairly
complete
test
suite
</a>
and
a
<a href="http://json-ld.org/playground/">
live
JSON-LD
editor
</a>
that
is
capable
of
demonstrating
the
features
described
in
this
document.
While
<ins class="diff-new">there
will
be
continuous
</ins>
development
on
implementations,
the
test
<del class="diff-old">suite
</del>
<ins class="diff-chg">suite,
</ins>
and
the
live
<del class="diff-old">editor
will
continue,
</del>
<ins class="diff-chg">editor,
</ins>
they
are
believed
to
be
mature
enough
to
be
integrated
into
a
non-production
system
at
this
point
in
<del class="diff-old">time
with
the
</del>
<ins class="diff-chg">time.
There
is
an
</ins>
expectation
that
they
could
be
used
in
a
production
system
within
the
<del class="diff-old">next
</del>
year.
</p>
<p>
<ins class="diff-chg">There
are
a
number
of
ways
that
one
may
participate
in
the
development
of
this
specification:
</ins></p><ul><li><ins class="diff-chg">
If
you
want
to
make
sure
that
your
feedback
is
formally
addressed
by
the
RDF
Working
Group,
you
should
send
it
to
public-rdf-comments:
</ins><a href="http://lists.w3.org/Archives/Public/public-rdf-comments/"><ins class="diff-chg">
public-rdf-comments@w3.org
</ins></a>
<del class="diff-old">Issue
1
</del>
</li>
<li>
<ins class="diff-chg">Ad-hoc
technical
discussion
primarily
occurs
on
the
public
community
mailing
list:
</ins><a href="http://lists.w3.org/Archives/Public/public-linked-json/"><ins class="diff-chg">
public-linked-json@w3.org
</ins></a>
</li>
<li>
<del class="diff-old">It
</del>
<a href="http://json-ld.org/minutes/">
<ins class="diff-chg">Public
JSON-LD
Community
Group
teleconferences
</ins></a><ins class="diff-chg">
are
held
on
Tuesdays
at
1500UTC
every
week.
Participation
</ins>
is
<del class="diff-old">important
for
readers
</del>
<ins class="diff-chg">open
</ins>
to
<del class="diff-old">understand
that
</del>
the
<del class="diff-old">scope
of
this
document
</del>
<ins class="diff-chg">public.
</ins></li><li><ins class="diff-chg">
RDF
Working
Group
teleconferences
are
held
on
Wednesdays
at
1500UTC
every
week.
Participation
</ins>
is
<del class="diff-old">currently
under
debate
</del>
<ins class="diff-chg">limited
to
RDF
Working
Group
members.
</ins></li><li><ins class="diff-chg">
Specification
bugs
</ins>
and
<del class="diff-old">new
features
may
</del>
<ins class="diff-chg">issues
should
</ins>
be
<del class="diff-old">added
</del>
<ins class="diff-chg">reported
in
the
</ins><a href="https://github.com/json-ld/json-ld.org/issues"><ins class="diff-chg">
issue
tracker
</ins></a><ins class="diff-chg">
if
you
do
not
want
to
send
an
email
</ins>
to
the
<del class="diff-old">specification.
Existing
features
may
be
modified
heavily
or
removed
entirely
from
</del>
<ins class="diff-chg">public-rdf-comments
mailing
list.
</ins></li><li><a href="https://github.com/json-ld/json-ld.org/tree/master/spec"><ins class="diff-chg">
Source
code
</ins></a><ins class="diff-chg">
for
</ins>
the
specification
<del class="diff-old">upon
further
review
and
feedback
from
the
broader
community.
This
</del>
<ins class="diff-chg">can
be
found
on
Github.
</ins></li><li><ins class="diff-chg">
The
</ins><a href="http://webchat.freenode.net/?channels=json-ld"><ins class="diff-chg">
#json-ld
</ins></a><ins class="diff-chg">
IRC
channel
</ins>
is
<del class="diff-old">a
work
in
progress
and
publication
as
a
First
Public
Working
Draft
does
not
require
that
all
Working
Group
members
agree
</del>
<ins class="diff-chg">available
for
real-time
discussion
</ins>
on
<del class="diff-old">the
content
of
the
document.
</del>
<ins class="diff-chg">irc.freenode.net.
</ins></li></ul>
<p>
This
document
was
published
by
the
<a href="http://www.w3.org/2011/rdf-wg/">
RDF
Working
Group
</a>
as
a
<del class="diff-old">First
Public
</del>
<ins class="diff-chg">Last
Call
</ins>
Working
Draft.
This
document
is
intended
to
become
a
<abbr title="World Wide Web Consortium">
W3C
</abbr>
Recommendation.
If
you
wish
to
make
comments
regarding
this
document,
please
send
them
to
<a href="mailto:public-rdf-comments@w3.org">
public-rdf-comments@w3.org
</a>
(
<a href="mailto:public-rdf-comments-request@w3.org?subject=subscribe">
subscribe
</a>,
<a href="http://lists.w3.org/Archives/Public/public-rdf-comments/">
archives
</a>
).
<ins class="diff-new">The
Last
Call
period
ends
04
May
2013.
</ins>
All
<del class="diff-old">feedback
is
</del>
<ins class="diff-chg">comments
are
</ins>
welcome.
</p>
<p>
Publication
as
a
Working
Draft
does
not
imply
endorsement
by
the
<abbr title="World Wide Web Consortium">
W3C
</abbr>
Membership.
This
is
a
draft
document
and
may
be
updated,
replaced
or
obsoleted
by
other
documents
at
any
time.
It
is
inappropriate
to
cite
this
document
as
other
than
work
in
progress.
</p>
<p>
This
<ins class="diff-new">is
a
Last
Call
Working
Draft
and
thus
the
Working
Group
has
determined
that
this
document
has
satisfied
the
relevant
technical
requirements
and
is
sufficiently
stable
to
advance
through
the
Technical
Recommendation
process.
</ins></p><p><ins class="diff-new">
This
</ins>
document
was
produced
by
a
group
operating
under
the
<a href="http://www.w3.org/Consortium/Patent-Policy-20040205/">
5
February
2004
<abbr title="World Wide Web Consortium">
W3C
</abbr>
Patent
Policy
</a>.
<abbr title="World Wide Web Consortium">
W3C
</abbr>
maintains
a
<a href="http://www.w3.org/2004/01/pp-impl/46168/status" rel="disclosure">
public
list
of
any
patent
disclosures
</a>
made
in
connection
with
the
deliverables
of
the
group;
that
page
also
includes
instructions
for
disclosing
a
patent.
An
individual
who
has
actual
knowledge
of
a
patent
which
the
individual
believes
contains
<a href="http://www.w3.org/Consortium/Patent-Policy-20040205/#def-essential">
Essential
Claim(s)
</a>
must
disclose
the
information
in
accordance
with
<a href="http://www.w3.org/Consortium/Patent-Policy-20040205/#sec-Disclosure">
section
6
of
the
<abbr title="World Wide Web Consortium">
W3C
</abbr>
Patent
Policy
</a>.
</p>
</section>
<section id="toc">
<h2 class="introductory">
Table
of
Contents
</h2>
<ul class="toc">
<li class="tocline">
<a href="#introduction" class="tocxref">
<span class="secno">
1.
</span>
<del class="diff-old">Preface
1.1
Contributing
</del>
<ins class="diff-chg">Introduction
</ins>
</a>
</li>
<li class="tocline">
<a href="#features" class="tocxref">
<span class="secno">
2.
</span>
<del class="diff-old">Introduction
</del>
<ins class="diff-chg">Features
</ins>
</a>
<ul class="toc">
<li class="tocline">
<a href="#expansion" class="tocxref">
<span class="secno">
2.1
</span>
Expansion
</a>
</li>
<li class="tocline">
<a href="#compaction" class="tocxref">
<span class="secno">
2.2
</span>
Compaction
</a>
</li>
<li class="tocline">
<a href="#flattening" class="tocxref">
<span class="secno">
2.3
</span>
<del class="diff-old">Conversion
to
and
from
RDF
</del>
<ins class="diff-chg">Flattening
</ins>
</a>
</li>
<li class="tocline">
<a href="#rdf-conversion" class="tocxref">
<span class="secno">
2.4
</span>
<del class="diff-old">Framing
and
Normalization
</del>
<ins class="diff-chg">RDF
Conversion
</ins>
</a>
</li>
</ul>
</li>
<li class="tocline">
<a href="#conformance" class="tocxref">
<span class="secno">
3.
</span>
<del class="diff-old">The
Application
Programming
Interface
</del>
<ins class="diff-chg">Conformance
</ins>
</a>
</li>
<li class="tocline">
<a href="#general-terminology" class="tocxref">
<span class="secno">
<del class="diff-old">3.1
</del>
<ins class="diff-chg">4.
</ins>
</span>
General
Terminology
</a>
</li>
<li class="tocline">
<del class="diff-old">3.2
JsonLdProcessor
3.2.1
Methods
3.3
Callbacks
3.3.1
JsonLdCallback
3.3.1.1
Methods
3.3.2
QuadCallback
3.3.2.1
Methods
3.4
Data
Structures
3.4.1
URL
</del>
<a href="#algorithm-terms" class="tocxref">
<span class="secno">
<del class="diff-old">3.4.2
</del>
<ins class="diff-chg">5.
</ins>
</span>
<del class="diff-old">JsonLdOptions
</del>
<ins class="diff-chg">Algorithm
Terms
</ins>
</a>
</li>
<li class="tocline">
<a href="#context-processing-algorithms" class="tocxref">
<span class="secno">
<del class="diff-old">3.4.3
</del>
<ins class="diff-chg">6.
</ins>
</span>
<del class="diff-old">Quad
</del>
<ins class="diff-chg">Context
Processing
Algorithms
</ins>
</a>
<ul class="toc">
<li class="tocline">
<a href="#context-processing-algorithm" class="tocxref">
<span class="secno">
<del class="diff-old">3.4.3.1
</del>
<ins class="diff-chg">6.1
</ins>
</span>
<del class="diff-old">Attributes
</del>
<ins class="diff-chg">Context
Processing
Algorithm
</ins>
</a>
</li>
<li class="tocline">
<a href="#create-term-definition" class="tocxref">
<span class="secno">
<del class="diff-old">3.4.4
</del>
<ins class="diff-chg">6.2
</ins>
</span>
<del class="diff-old">Node
</del>
<ins class="diff-chg">Create
Term
Definition
</ins>
</a>
</li>
<li class="tocline">
<a href="#iri-expansion" class="tocxref">
<span class="secno">
<del class="diff-old">3.4.5
</del>
<ins class="diff-chg">6.3
</ins>
</span>
<abbr title="Internationalized Resource Identifier">
IRI
</abbr>
<del class="diff-old">3.4.5.1
Attributes
</del>
<ins class="diff-chg">Expansion
</ins>
</a>
</li>
</ul>
</li>
<li class="tocline">
<a href="#expansion-algorithms" class="tocxref">
<span class="secno">
<del class="diff-old">3.4.6
Blank
Node
</del>
<ins class="diff-chg">7.
</ins>
</span>
<ins class="diff-chg">Expansion
Algorithms
</ins>
</a>
<ul class="toc">
<li class="tocline">
<a href="#expansion-algorithm" class="tocxref">
<span class="secno">
<del class="diff-old">3.4.6.1
</del>
<ins class="diff-chg">7.1
</ins>
</span>
<del class="diff-old">Attributes
</del>
<ins class="diff-chg">Expansion
Algorithm
</ins>
</a>
</li>
<li class="tocline">
<del class="diff-old">3.4.7
Literal
</del>
<a href="#value-expansion" class="tocxref">
<span class="secno">
<del class="diff-old">3.4.7.1
</del>
<ins class="diff-chg">7.2
</ins>
</span>
<del class="diff-old">Attributes
</del>
<ins class="diff-chg">Value
Expansion
</ins>
</a>
</li>
</ul>
</li>
<li class="tocline">
<a href="#compaction-algorithms" class="tocxref">
<span class="secno">
<del class="diff-old">4.
</del>
<ins class="diff-chg">8.
</ins>
</span>
<ins class="diff-new">Compaction
</ins>
Algorithms
</a>
<ul class="toc">
<li class="tocline">
<a href="#compaction-algorithm" class="tocxref">
<span class="secno">
<del class="diff-old">4.1
</del>
<ins class="diff-chg">8.1
</ins>
</span>
<ins class="diff-new">Compaction
</ins>
Algorithm
<del class="diff-old">Terms
</del>
</a>
</li>
<li class="tocline">
<a href="#inverse-context-creation" class="tocxref">
<span class="secno">
<del class="diff-old">4.2
</del>
<ins class="diff-chg">8.2
</ins>
</span>
<ins class="diff-new">Inverse
</ins>
Context
<del class="diff-old">Processing
4.3
IRI
Expansion
</del>
<ins class="diff-chg">Creation
</ins>
</a>
</li>
<li class="tocline">
<a href="#iri-compaction" class="tocxref">
<span class="secno">
<del class="diff-old">4.4
</del>
<ins class="diff-chg">8.3
</ins>
</span>
<abbr title="Internationalized Resource Identifier">
IRI
</abbr>
Compaction
</a>
</li>
<li class="tocline">
<a href="#term-selection" class="tocxref">
<span class="secno">
<del class="diff-old">4.4.1
</del>
<ins class="diff-chg">8.4
</ins>
</span>
<del class="diff-old">IRI
Compaction
Algorithm
</del>
<ins class="diff-chg">Term
Selection
</ins>
</a>
</li>
<li class="tocline">
<a href="#value-compaction" class="tocxref">
<span class="secno">
<del class="diff-old">4.4.2
</del>
<ins class="diff-chg">8.5
</ins>
</span>
<del class="diff-old">Term
Rank
Algorithm
</del>
<ins class="diff-chg">Value
Compaction
</ins>
</a>
</li>
</ul>
</li>
<li class="tocline">
<a href="#flattening-algorithms" class="tocxref">
<span class="secno">
<del class="diff-old">4.5
</del>
<ins class="diff-chg">9.
</ins>
</span>
<del class="diff-old">Value
Expansion
</del>
<ins class="diff-chg">Flattening
Algorithms
</ins>
</a>
<ul class="toc">
<li class="tocline">
<a href="#flattening-algorithm" class="tocxref">
<span class="secno">
<del class="diff-old">4.6
</del>
<ins class="diff-chg">9.1
</ins>
</span>
<del class="diff-old">Value
Compaction
</del>
<ins class="diff-chg">Flattening
Algorithm
</ins>
</a>
</li>
<li class="tocline">
<a href="#node-map-generation" class="tocxref">
<span class="secno">
<del class="diff-old">4.7
</del>
<ins class="diff-chg">9.2
</ins>
</span>
<del class="diff-old">Expansion
</del>
<ins class="diff-chg">Node
Map
Generation
</ins>
</a>
</li>
<li class="tocline">
<a href="#generate-blank-node-identifier" class="tocxref">
<span class="secno">
<del class="diff-old">4.7.1
</del>
<ins class="diff-chg">9.3
</ins>
</span>
<del class="diff-old">Expansion
Algorithm
</del>
<ins class="diff-chg">Generate
Blank
Node
Identifier
</ins>
</a>
</li>
</ul>
</li>
<li class="tocline">
<a href="#rdf-conversion-algorithms" class="tocxref">
<span class="secno">
<del class="diff-old">4.8
</del>
<ins class="diff-chg">10.
</ins>
</span>
<del class="diff-old">Compaction
</del>
<ins class="diff-chg">RDF
Conversion
Algorithms
</ins>
</a>
<ul class="toc">
<li class="tocline">
<a href="#convert-to-rdf-algorithm" class="tocxref">
<span class="secno">
<del class="diff-old">4.8.1
</del>
<ins class="diff-chg">10.1
</ins>
</span>
<del class="diff-old">Compaction
</del>
<ins class="diff-chg">Convert
to
RDF
</ins>
Algorithm
</a>
</li>
<li class="tocline">
<a href="#object-to-rdf-conversion" class="tocxref">
<span class="secno">
<del class="diff-old">4.9
</del>
<ins class="diff-chg">10.2
</ins>
</span>
<ins class="diff-new">Object
to
</ins>
RDF
Conversion
</a>
</li>
<li class="tocline">
<a href="#list-to-rdf-conversion" class="tocxref">
<span class="secno">
<del class="diff-old">4.9.1
</del>
<ins class="diff-chg">10.3
</ins>
</span>
<del class="diff-old">Overview
</del>
<ins class="diff-chg">List
to
RDF
Conversion
</ins>
</a>
</li>
<li class="tocline">
<a href="#convert-from-rdf-algorithm" class="tocxref">
<span class="secno">
<del class="diff-old">4.9.2
</del>
<ins class="diff-chg">10.4
</ins>
</span>
<del class="diff-old">Parsing
Examples
</del>
<ins class="diff-chg">Convert
from
RDF
Algorithm
</ins>
</a>
</li>
<li class="tocline">
<a href="#rdf-to-object-conversion" class="tocxref">
<span class="secno">
<del class="diff-old">4.9.3
</del>
<ins class="diff-chg">10.5
</ins>
</span>
<del class="diff-old">Convert
to
</del>
RDF
<del class="diff-old">Algorithm
</del>
<ins class="diff-chg">to
Object
Conversion
</ins>
</a>
</li>
<li class="tocline">
<a href="#data-round-tripping" class="tocxref">
<span class="secno">
<del class="diff-old">4.9.4
</del>
<ins class="diff-chg">10.6
</ins>
</span>
<del class="diff-old">List
Conversion
</del>
<ins class="diff-chg">Data
Round
Tripping
</ins>
</a>
</li>
</ul>
</li>
<li class="tocline">
<a href="#the-application-programming-interface" class="tocxref">
<span class="secno">
<del class="diff-old">4.9.5
</del>
<ins class="diff-chg">11.
</ins>
</span>
<del class="diff-old">Convert
from
RDF
Algorithm
</del>
<ins class="diff-chg">The
Application
Programming
Interface
</ins>
</a>
<ul class="toc">
<li class="tocline">
<a href="#jsonldprocessor" class="tocxref">
<span class="secno">
<ins class="diff-chg">11.1
</ins></span><ins class="diff-chg">
JsonLdProcessor
</ins></a>
</li>
<li class="tocline">
<a href="#callbacks" class="tocxref">
<span class="secno">
<del class="diff-old">5.
</del>
<ins class="diff-chg">11.2
</ins>
</span>
<del class="diff-old">Data
Round
Tripping
</del>
<ins class="diff-chg">Callbacks
</ins>
</a>
</li>
<li class="tocline">
<a href="#data-structures" class="tocxref">
<span class="secno">
<del class="diff-old">A.
</del>
<ins class="diff-chg">11.3
</ins>
</span>
<del class="diff-old">Initial
Context
</del>
<ins class="diff-chg">Data
Structures
</ins>
</a>
</li>
</ul>
</li>
<li class="tocline">
<a href="#acknowledgements" class="tocxref">
<span class="secno">
<del class="diff-old">B.
</del>
<ins class="diff-chg">A.
</ins>
</span>
Acknowledgements
</a>
</li>
<li class="tocline">
<a href="#references" class="tocxref">
<span class="secno">
<del class="diff-old">C.
</del>
<ins class="diff-chg">B.
</ins>
</span>
References
</a>
<ul class="toc">
<li class="tocline">
<a href="#normative-references" class="tocxref">
<span class="secno">
<del class="diff-old">C.1
</del>
<ins class="diff-chg">B.1
</ins>
</span>
Normative
references
</a>
</li>
<li class="tocline">
<a href="#informative-references" class="tocxref">
<span class="secno">
<del class="diff-old">C.2
</del>
<ins class="diff-chg">B.2
</ins>
</span>
Informative
references
</a>
</li>
</ul>
</li>
</ul>
</section>
<section class="informative" id="introduction">
<h2>
<span class="secno">
1.
</span>
<del class="diff-old">Preface
</del>
<ins class="diff-chg">Introduction
</ins>
</h2>
<p>
<em>
<ins class="diff-new">This
section
is
non-normative.
</ins></em></p>
<p>
This
document
is
a
detailed
specification
for
an
Application
Programming
Interface
for
the
JSON-LD
<del class="diff-old">Syntax.
</del>
<ins class="diff-chg">syntax.
</ins>
The
document
is
primarily
intended
for
the
following
audiences:
</p>
<ul>
<li>
<ins class="diff-new">Developers
that
want
an
overview
of
the
JSON-LD
API.
</ins></li><li>
Web
authors
and
developers
that
want
a
very
detailed
view
of
how
a
JSON-LD
<del class="diff-old">processor
and
the
</del>
<ins class="diff-chg">Implementation
or
a
JSON-LD
Processor's
</ins>
API
operates.
</li>
<li>
Software
developers
that
want
to
implement
<del class="diff-old">processors
and
APIs
for
JSON-LD.
</del>
<ins class="diff-chg">the
algorithms
to
transform
JSON-LD
documents.
</ins>
</li>
</ul>
<p>
To
understand
the
basics
in
this
specification
you
must
first
be
familiar
with
JSON,
which
is
detailed
in
[
<cite>
<a class="bibref" href="#bib-RFC4627">
RFC4627
</a>
</cite>
].
You
must
also
understand
the
JSON-LD
Syntax
[
<cite>
<a class="bibref" href="#bib-JSON-LD">
JSON-LD
</a>
</cite>
],
which
is
the
base
syntax
used
by
all
of
the
algorithms
in
this
document.
To
understand
the
API
and
how
it
is
intended
to
operate
in
a
programming
environment,
it
is
useful
to
have
working
knowledge
of
the
JavaScript
programming
language
[
<cite>
<a class="bibref" href="#bib-ECMA-262">
ECMA-262
</a>
</cite>
]
and
WebIDL
[
<cite>
<a class="bibref" href="#bib-WEBIDL">
WEBIDL
</a>
</cite>
].
To
understand
how
JSON-LD
maps
to
RDF,
it
is
helpful
to
be
familiar
with
the
basic
RDF
concepts
[
<cite>
<del class="diff-old">RDF-CONCEPTS
</del>
<a class="bibref" href="#bib-RDF11-CONCEPTS">
<ins class="diff-chg">RDF11-CONCEPTS
</ins>
</a>
</cite>
].
</p>
</section>
<section class="informative" id="features">
<h2>
<span class="secno">
<del class="diff-old">1.1
</del>
<ins class="diff-chg">2.
</ins>
</span>
<del class="diff-old">Contributing
There
are
a
number
of
ways
that
one
may
participate
in
the
development
of
this
specification:
If
you
want
to
make
sure
that
your
feedback
is
formally
addressed
by
the
RDF
Working
Group,
you
should
send
it
to
public-rdf-comments:
public-rdf-comments@w3.org
Ad-hoc
technical
discussion
primarily
occurs
on
the
public
community
mailing
list:
public-linked-json@w3.org
</del>
<ins class="diff-chg">Features
</ins></h2>
<del class="diff-old">Public
JSON-LD
Community
Group
teleconferences
are
held
on
Tuesdays
at
1500UTC
every
week.
RDF
Working
Group
teleconferences
are
held
on
Wednesdays
at
1500UTC
every
week.
Participation
is
limited
to
RDF
Working
Group
members.
Specification
bugs
and
issues
should
be
reported
in
the
issue
tracker
if
you
do
not
want
to
send
an
e-mail
to
the
public-rdf-comments
mailing
list.
</del>
<p>
<del class="diff-old">Source
code
for
the
specification
can
be
found
on
Github.
The
#json-ld
IRC
channel
</del>
<em>
<ins class="diff-chg">This
section
</ins>
is
<del class="diff-old">available
for
real-time
discussion
on
irc.freenode.net.
</del>
<ins class="diff-chg">non-normative.
</ins></em>
<del class="diff-old">2.
Introduction
</del>
</p>
<p>
The
JSON-LD
Syntax
specification
[
<cite>
<a class="bibref" href="#bib-JSON-LD">
JSON-LD
</a>
</cite>
]
outlines
a
<del class="diff-old">language
</del>
<ins class="diff-chg">syntax
</ins>
that
may
be
used
to
express
Linked
Data
in
JSON.
<del class="diff-old">Often,
</del>
<ins class="diff-chg">Because
there
is
more
than
one
way
to
express
Linked
Data
using
this
syntax,
</ins>
it
is
<ins class="diff-new">often
</ins>
useful
to
be
able
to
transform
JSON-LD
documents
so
that
they
may
be
<ins class="diff-new">more
</ins>
easily
<del class="diff-old">processed
</del>
<ins class="diff-chg">consumed
by
specific
applications.
</ins></p><p><ins class="diff-chg">
The
way
JSON-LD
allows
Linked
Data
to
be
expressed
</ins>
in
a
<del class="diff-old">programming
environment
like
JavaScript,
Python
</del>
<ins class="diff-chg">way
that
is
specifically
tailored
to
a
particular
person
</ins>
or
<del class="diff-old">Ruby.
</del>
<ins class="diff-chg">application
is
by
providing
</ins><a class="tref internalDFN" title="context" href="#dfn-context"><ins class="diff-chg">
context
</ins></a>.<ins class="diff-chg">
By
providing
</ins><a class="tref internalDFN" title="context" href="#dfn-context"><ins class="diff-chg">
context
</ins></a>,<ins class="diff-chg">
JSON
data
can
be
expressed
in
a
way
that
is
a
natural
fit
for
a
particular
person
or
application
whilst
also
indicating
how
the
data
should
be
understood
at
a
global
scale.
In
order
for
people
or
applications
to
share
data
that
was
created
using
a
</ins><a class="tref internalDFN" title="context" href="#dfn-context"><ins class="diff-chg">
context
</ins></a><ins class="diff-chg">
that
is
different
from
their
own,
a
JSON-LD
processor
must
be
able
to
transform
a
document
from
one
</ins><a class="tref internalDFN" title="context" href="#dfn-context"><ins class="diff-chg">
context
</ins></a><ins class="diff-chg">
to
another.
Instead
of
requiring
JSON-LD
processors
to
write
specific
code
for
every
imaginable
</ins><a class="tref internalDFN" title="context" href="#dfn-context"><ins class="diff-chg">
context
</ins></a><ins class="diff-chg">
switching
scenario,
it
is
much
easier
to
specify
a
single
algorithm
that
can
remove
any
</ins><a class="tref internalDFN" title="context" href="#dfn-context"><ins class="diff-chg">
context
</ins></a>.<ins class="diff-chg">
Similarly,
another
algorithm
can
be
specified
to
subsequently
apply
any
</ins><a class="tref internalDFN" title="context" href="#dfn-context"><ins class="diff-chg">
context
</ins></a>.<ins class="diff-chg">
These
two
algorithms
represent
the
most
basic
transformations
of
JSON-LD
documents.
They
are
referred
to
as
</ins><a class="tref internalDFN" title="expansion" href="#dfn-expansion"><ins class="diff-chg">
expansion
</ins></a><ins class="diff-chg">
and
</ins><a class="tref internalDFN" title="compaction" href="#dfn-compaction"><ins class="diff-chg">
compaction
</ins></a>,<ins class="diff-chg">
respectively.
</ins>
</p>
<p>
There
are
<del class="diff-old">three
</del>
<ins class="diff-chg">four
</ins>
major
types
of
transformation
that
are
discussed
in
this
<del class="diff-old">document;
compaction,
</del>
<ins class="diff-chg">document:
</ins>
expansion,
<ins class="diff-new">compaction,
flattening,
</ins>
and
RDF
conversion.
</p>
<section class="informative" id="expansion">
<h3>
<span class="secno">
2.1
</span>
Expansion
</h3>
<p>
<del class="diff-old">Software
algorithms
are
easiest
to
write
when
the
data
</del>
<em>
<ins class="diff-chg">This
section
is
non-normative.
</ins></em></p><p><ins class="diff-chg">
The
algorithm
</ins>
that
<del class="diff-old">they
are
processing
have
</del>
<ins class="diff-chg">removes
</ins><a class="tref internalDFN" title="context" href="#dfn-context"><ins class="diff-chg">
context
</ins></a><ins class="diff-chg">
is
called
</ins><dfn title="expansion" id="dfn-expansion"><ins class="diff-chg">
expansion
</ins></dfn>.<ins class="diff-chg">
Before
performing
any
other
transformations
on
</ins>
a
<del class="diff-old">regular
form.
Since
information
can
be
represented
by
</del>
JSON-LD
<del class="diff-old">in
a
variety
of
different
ways,
transforming
</del>
<ins class="diff-chg">document,
it
is
easiest
to
remove
any
</ins><a class="tref internalDFN" title="context" href="#dfn-context"><ins class="diff-chg">
context
</ins></a><ins class="diff-chg">
from
it,
localizing
</ins>
all
<ins class="diff-new">information,
and
to
make
data
structures
more
regular.
</ins></p><p><ins class="diff-new">
To
get
an
idea
</ins>
of
<del class="diff-old">these
methods
into
a
uniform
structure
allows
</del>
<ins class="diff-chg">how
context
and
data
structuring
affects
</ins>
the
<del class="diff-old">developer
to
simplify
their
processing
code.
For
example,
note
</del>
<ins class="diff-chg">same
data,
here
is
an
example
of
JSON-LD
</ins>
that
<del class="diff-old">the
following
input
</del>
uses
only
<a class="tref internalDFN" title="term" href="#dfn-term">
<del class="diff-old">term
</del>
<ins class="diff-chg">terms
</ins>
</a>
<del class="diff-old">s
</del>
and
is
fairly
compact:
</p>
<del class="diff-old">  var input1 = {
  &quot;@context&quot;: &quot;http://json-ld.org/contexts/person.jsonld&quot;
  &quot;name&quot;: &quot;Manu Sporny&quot;,
  &quot;homepage&quot;: &quot;http://manu.sporny.org/&quot;
</del>
    <div class="example"><div class="example-title"><span>Example 1</span>: Sample JSON-LD document</div><pre class="example">{
<ins class="diff-chg">  &quot;@context&quot;: {
    &quot;name&quot;: &quot;http://xmlns.com/foaf/0.1/name&quot;,
    &quot;homepage&quot;: {
      &quot;@id&quot;: &quot;http://xmlns.com/foaf/0.1/homepage&quot;,
      &quot;@type&quot;: &quot;@id&quot;
    }
  },
  &quot;@id&quot;: &quot;http://me.markus-lanthaler.com/&quot;,
  &quot;name&quot;: &quot;Markus Lanthaler&quot;,
  &quot;homepage&quot;: &quot;http://www.markus-lanthaler.com/&quot;
</ins>
}
</pre>
</div>
<p>
The
next
input
example
uses
one
<a class="tref internalDFN" title="iri" href="#dfn-iri">
<abbr title="Internationalized Resource Identifier">
IRI
</abbr>
</a>
to
express
a
<del class="diff-old">property,
</del>
<ins class="diff-chg">property
and
</ins><a class="tref internalDFN" title="array" href="#dfn-array"><ins class="diff-chg">
array
</ins></a><ins class="diff-chg">
to
encapsulate
another,
</ins>
but
leaves
the
rest
of
the
information
untouched.
</p>
<del class="diff-old">  var input2 = {
  &quot;@context&quot;: &quot;http://json-ld.org/contexts/person.jsonld&quot;
  &quot;&quot;: &quot;Manu Sporny&quot;,
  &quot;homepage&quot;: &quot;http://manu.sporny.org/&quot;
</del>
    <div class="example"><div class="example-title"><span>Example 2</span>: Sample JSON-LD document using a IRI instead of a term to express a property</div><pre class="example">{
<ins class="diff-chg">  &quot;@context&quot;: {
</ins>    <span class="diff">&quot;website&quot;: &quot;http://xmlns.com/foaf/0.1/homepage&quot;</span><ins class="diff-chg">
  },
  &quot;@id&quot;: &quot;http://me.markus-lanthaler.com/&quot;,
  &quot;<span class="diff">http://xmlns.com/foaf/0.1/name</span>&quot;: &quot;Markus Lanthaler&quot;,
</ins>  <span class="diff">&quot;website&quot;</span>: <span class="diff">{ &quot;@id&quot;:</span> &quot;http://www.markus-lanthaler.com/&quot; <span class="diff">}</span>
}
</pre>
</div>
<p>
<del class="diff-old">While
</del>
<ins class="diff-chg">Note
that
</ins>
both
inputs
are
valid
<del class="diff-old">JSON-LD,
writing
a
program
to
handle
every
permutation
of
possible
inputs
can
be
difficult,
especially
when
</del>
<ins class="diff-chg">JSON-LD
and
both
represent
</ins>
the
<del class="diff-old">incoming
</del>
<ins class="diff-chg">same
information.
The
difference
is
in
their
</ins><a class="tref internalDFN" title="context" href="#dfn-context">
context
<del class="diff-old">could
change
as
well.
To
</del>
</a>
<ins class="diff-chg">information
and
in
the
data
structures
used.
A
JSON-LD
processor
can
remove
</ins><a class="tref internalDFN" title="context" href="#dfn-context"><ins class="diff-chg">
context
</ins></a><ins class="diff-chg">
and
</ins>
ensure
that
the
data
<del class="diff-old">can
be
given
a
</del>
<ins class="diff-chg">is
</ins>
more
<del class="diff-old">uniform
structure,
JSON-LD
introduces
the
notion
of
expansion.
</del>
<ins class="diff-chg">regular
by
employing
</ins><a class="tref internalDFN" title="expansion" href="#dfn-expansion"><ins class="diff-chg">
expansion
</ins></a>.</p><p><a class="tref internalDFN" title="expansion" href="#dfn-expansion">
Expansion
<del class="diff-old">performs
</del>
</a>
<ins class="diff-chg">has
</ins>
two
important
<del class="diff-old">operations.
The
first
is
to
expand
</del>
<ins class="diff-chg">goals:
removing
any
contextual
information
from
the
document,
and
ensuring
</ins>
all
values
<del class="diff-old">that
</del>
are
<del class="diff-old">IRI
s
to
their
fully
expanded
</del>
<ins class="diff-chg">represented
in
a
regular
</ins>
form.
<del class="diff-old">The
second
is
</del>
<ins class="diff-chg">These
goals
are
accomplished
by
expanding
all
properties
</ins>
to
<del class="diff-old">express
</del>
<a class="tref internalDFN" title="absolute-iri" href="#dfn-absolute-iri">
<ins class="diff-chg">absolute
IRIs
</ins></a><ins class="diff-chg">
and
by
expressing
</ins>
all
values
in
<a class="tref internalDFN" title="array" href="#dfn-array">
<ins class="diff-chg">arrays
</ins></a><ins class="diff-chg">
in
</ins><a class="tref internalDFN" title="expanded-form" href="#dfn-expanded-form">
expanded
form
<del class="diff-old">.
To
transform
both
inputs
above
to
</del>
</a>.
<a class="tref internalDFN" title="expanded-form" href="#dfn-expanded-form">
<ins class="diff-chg">Expanded
form
</ins></a><ins class="diff-chg">
is
</ins>
the
<del class="diff-old">same
representation,
</del>
<ins class="diff-chg">most
verbose
and
regular
way
of
expressing
of
values
in
JSON-LD;
all
contextual
information
from
</ins>
the
<del class="diff-old">developer
could
do
</del>
<ins class="diff-chg">document
is
instead
stored
locally
with
each
value.
Running
</ins>
the
<del class="diff-old">following:
  function expansionCallback(output) {
   console.log(output);
}
</del>
<a href="#expansion-algorithm">
<ins class="diff-chg">Expansion
algorithm
</ins></a><ins class="diff-chg">
(
</ins><code class="idlMemberName">
<del class="diff-old">// the second parameter is 'null' because the developer does not wish to
// inject another context value
jsonld.expand(input1, null, expansionCallback);
jsonld.expand(input2,
null,
expansionCallback);
</del>
<a href="#widl-JsonLdProcessor-expand-void-object-object---DOMString-input-JsonLdCallback-callback-JsonLdOptions-options">
<ins class="diff-chg">expand
</ins></a>
<del class="diff-old">The
output
for
both
calls
</del>
</code>
<ins class="diff-chg">operation)
against
the
examples
provided
</ins>
above
<del class="diff-old">will
be:
</del>
<ins class="diff-chg">results
in
the
following
output:
</ins>
</p>
<del class="diff-old">  [{
  &quot;http://xmlns.com/foaf/0.1/name&quot;: [{
    &quot;@value&quot;: &quot;Manu Sporny&quot;
  }],
  &quot;http://xmlns.com/foaf/0.1/homepage&quot;: [{
    &quot;@id&quot;: &quot;http://manu.sporny.org/&quot;
  }]
}]
</del>
    <div class="example"><div class="example-title"><span>Example 3</span>: Expanded sample document</div><pre class="example">[
<ins class="diff-chg">  {
    &quot;@id&quot;: &quot;http://me.markus-lanthaler.com/&quot;,
    &quot;http://xmlns.com/foaf/0.1/name&quot;: [
      { &quot;@value&quot;: &quot;Markus Lanthaler&quot; }
    ],
    &quot;http://xmlns.com/foaf/0.1/homepage&quot;: [
      { &quot;@id&quot;: &quot;http://www.markus-lanthaler.com/&quot; }
    ]
  }
]
</ins>
</pre>
</div>
<p>
Note
that
in
the
<del class="diff-old">example
above;
</del>
<ins class="diff-chg">output
above
</ins>
all
<a class="tref internalDFN" title="context" href="#dfn-context">
context
</a>
definitions
have
been
removed,
all
<a class="tref internalDFN" title="term" href="#dfn-term">
<del class="diff-old">term
</del>
<ins class="diff-chg">terms
</ins>
</a>
and
<del class="diff-old">prefixes
</del>
<a class="tref internalDFN" title="compact-iri" href="#dfn-compact-iri">
<ins class="diff-chg">compact
IRIs
</ins></a>
have
been
expanded
to
<del class="diff-old">full
IRIs,
</del>
<ins class="diff-chg">absolute
</ins><a class="tref internalDFN" title="iri" href="#dfn-iri"><ins class="diff-chg">
IRIs
</ins></a>,
and
all
<del class="diff-old">literal
</del>
<a class="tref internalDFN" title="json-ld-value" href="#dfn-json-ld-value">
<ins class="diff-chg">JSON-LD
values
</ins>
</a>
<del class="diff-old">s
</del>
are
expressed
in
<a class="tref internalDFN" title="array" href="#dfn-array">
<ins class="diff-chg">arrays
</ins></a><ins class="diff-chg">
in
</ins><a class="tref internalDFN" title="expanded-form" href="#dfn-expanded-form">
expanded
form
</a>.
While
the
output
is
more
<ins class="diff-new">verbose
and
</ins>
difficult
for
a
human
to
read,
it
<del class="diff-old">is
easier
for
</del>
<ins class="diff-chg">establishes
</ins>
a
<del class="diff-old">software
program
to
process
</del>
<ins class="diff-chg">baseline
that
makes
JSON-LD
processing
easier
</ins>
because
of
its
very
regular
structure.
</p>
</section>
<section class="informative" id="compaction">
<h3>
<span class="secno">
2.2
</span>
Compaction
</h3>
<p>
<em>
<ins class="diff-new">This
section
is
non-normative.
</ins></em></p>
<p>
While
<a class="tref internalDFN" title="expansion" href="#dfn-expansion">
expansion
<del class="diff-old">expands
</del>
</a>
<ins class="diff-chg">removes
</ins><a class="tref internalDFN" title="context" href="#dfn-context"><ins class="diff-chg">
context
</ins></a><ins class="diff-chg">
from
</ins>
a
given
<del class="diff-old">input
as
much
as
possible,
compaction
performs
</del>
<ins class="diff-chg">input,
</ins><a class="tref internalDFN" title="compaction" href="#dfn-compaction"><ins class="diff-chg">
compaction's
</ins></a><ins class="diff-chg">
primary
function
is
to
perform
</ins>
the
opposite
<del class="diff-old">operation
-
expressing
</del>
<ins class="diff-chg">operation:
to
express
</ins>
a
given
input
<del class="diff-old">as
succinctly
as
possible.
While
expansion
is
meant
</del>
<ins class="diff-chg">according
</ins>
to
<del class="diff-old">produce
something
</del>
<ins class="diff-chg">a
particular
</ins><a class="tref internalDFN" title="context" href="#dfn-context"><ins class="diff-chg">
context
</ins></a>.<dfn title="compaction" id="dfn-compaction"><ins class="diff-chg">
Compaction
</ins></dfn><ins class="diff-chg">
applies
a
</ins><a class="tref internalDFN" title="context" href="#dfn-context"><ins class="diff-chg">
context
</ins></a>
that
<ins class="diff-new">specifically
tailors
the
way
information
</ins>
is
<del class="diff-old">easy
to
process
by
software
programs,
compaction
is
meant
to
produce
something
</del>
<ins class="diff-chg">expressed
for
a
particular
person
or
application.
This
simplifies
applications
</ins>
that
<del class="diff-old">is
easy
</del>
<ins class="diff-chg">consume
JSON
or
JSON-LD
by
expressing
the
data
in
application-specific
terms,
and
it
makes
the
data
easier
</ins>
to
<del class="diff-old">ready
</del>
<ins class="diff-chg">read
</ins>
by
<del class="diff-old">software
developers.
</del>
<ins class="diff-chg">humans.
</ins></p><p><a class="tref internalDFN" title="compaction" href="#dfn-compaction">
Compaction
</a>
uses
a
developer-supplied
<a class="tref internalDFN" title="context" href="#dfn-context">
context
</a>
to
<del class="diff-old">compresses
all
</del>
<ins class="diff-chg">shorten
</ins>
<a class="tref internalDFN" title="iri" href="#dfn-iri">
<del class="diff-old">IRI
</del>
<ins class="diff-chg">IRIs
</ins>
</a>
<del class="diff-old">s
</del>
to
<a class="tref internalDFN" title="term" href="#dfn-term">
<del class="diff-old">term
</del>
<ins class="diff-chg">terms
</ins>
</a>
<del class="diff-old">s
</del>
or
<del class="diff-old">prefix
</del>
<a class="tref internalDFN" title="compact-iri" href="#dfn-compact-iri">
<ins class="diff-chg">compact
IRIs
</ins>
</a>
<del class="diff-old">es,
</del>
and
<del class="diff-old">compacts
all
literal
</del>
<a class="tref internalDFN" title="json-ld-value" href="#dfn-json-ld-value">
<ins class="diff-chg">JSON-LD
values
</ins>
</a>
<del class="diff-old">s
</del>
expressed
in
<a class="tref internalDFN" title="expanded-form" href="#dfn-expanded-form">
expanded
form
</a>
<ins class="diff-new">to
simple
values
such
</ins>
as
<del class="diff-old">much
as
possible.
</del>
<a class="tref internalDFN" title="string" href="#dfn-string">
<ins class="diff-chg">strings
</ins></a><ins class="diff-chg">
or
</ins><a class="tref internalDFN" title="number" href="#dfn-number"><ins class="diff-chg">
numbers
</ins></a>.
</p>
<p>
<del class="diff-old">The
</del>
<ins class="diff-chg">For
example,
assume
the
</ins>
following
<del class="diff-old">example
expresses
</del>
<ins class="diff-chg">expanded
JSON-LD
</ins>
input
<del class="diff-old">that
has
already
been
fully
expanded:
</del>
<ins class="diff-chg">document:
</ins>
</p>
<del class="diff-old">  var expandedInput = [{
  &quot;http://xmlns.com/foaf/0.1/name&quot;: [{
    &quot;@value&quot;: &quot;Manu Sporny&quot;
  }],
  &quot;http://xmlns.com/foaf/0.1/homepage&quot;: [{
    &quot;@id&quot;: &quot;http://manu.sporny.org/&quot;
  }]
}]
</del>
    <div class="example"><div class="example-title"><span>Example 4</span>: Expanded sample document</div><pre class="example">[
<ins class="diff-chg">  {
    &quot;@id&quot;: &quot;http://me.markus-lanthaler.com/&quot;,
    &quot;http://xmlns.com/foaf/0.1/name&quot;: [
      { &quot;@value&quot;: &quot;Markus Lanthaler&quot; }
    ],
    &quot;http://xmlns.com/foaf/0.1/homepage&quot;: [
      { &quot;@id&quot;: &quot;http://www.markus-lanthaler.com/&quot; }
    ]
  }
]
</ins>
</pre>
</div>
<p>
<del class="diff-old">A
developer
that
wants
to
transform
the
data
above
into
a
more
human-readable
form,
could
do
</del>
<ins class="diff-chg">Additionally,
assume
</ins>
the
following
<del class="diff-old">using
the
</del>
<ins class="diff-chg">developer-supplied
</ins>
JSON-LD
<del class="diff-old">API:
</del>
<a class="tref internalDFN" title="context" href="#dfn-context">
<ins class="diff-chg">context
</ins></a>:
</p>
<del class="diff-old">  function compactionCallback(output) {
   console.log(output);
</del>
    <div class="example"><div class="example-title"><span>Example 5</span>: JSON-LD context</div><pre class="example">{
<ins class="diff-chg">  &quot;@context&quot;: {
    &quot;name&quot;: &quot;http://xmlns.com/foaf/0.1/name&quot;,
    &quot;homepage&quot;: {
      &quot;@id&quot;: &quot;http://xmlns.com/foaf/0.1/homepage&quot;,
      &quot;@type&quot;: &quot;@id&quot;
    }
  }
</ins>
}
<del class="diff-old">jsonld.compact(expandedInput,
&quot;http://json-ld.org/contexts/person.jsonld&quot;,
compactionCallback);
</del>
</pre>
</div>
<p>
<del class="diff-old">The
following
would
be
</del>
<ins class="diff-chg">Running
the
</ins><a href="#compaction-algorithm"><ins class="diff-chg">
Compaction
Algorithm
</ins></a><ins class="diff-chg">
(
</ins><code class="idlMemberName"><a href="#widl-JsonLdProcessor-compact-void-object-object---DOMString-input-object-DOMString-context-JsonLdCallback-callback-JsonLdOptions-options"><ins class="diff-chg">
compact
</ins></a></code><ins class="diff-chg">
operation)
given
</ins>
the
<ins class="diff-new">context
supplied
above
against
the
JSON-LD
input
document
provided
above
would
</ins>
result
<del class="diff-old">of
</del>
<ins class="diff-chg">in
</ins>
the
<del class="diff-old">call
above:
</del>
<ins class="diff-chg">following
output:
</ins>
</p>
<del class="diff-old">  {
  &quot;@context&quot;: &quot;http://json-ld.org/contexts/person.jsonld&quot;
  &quot;name&quot;: &quot;Manu Sporny&quot;,
  &quot;homepage&quot;: &quot;http://manu.sporny.org/&quot;
</del>
    <div class="example"><div class="example-title"><span>Example 6</span>: Compacted sample document</div><pre class="example">{
<ins class="diff-chg">  &quot;@context&quot;: {
    &quot;name&quot;: &quot;http://xmlns.com/foaf/0.1/name&quot;,
    &quot;homepage&quot;: {
      &quot;@id&quot;: &quot;http://xmlns.com/foaf/0.1/homepage&quot;,
      &quot;@type&quot;: &quot;@id&quot;
    }
  },
  &quot;@id&quot;: &quot;http://me.markus-lanthaler.com/&quot;,
  &quot;name&quot;: &quot;Markus Lanthaler&quot;,
  &quot;homepage&quot;: &quot;http://www.markus-lanthaler.com/&quot;
</ins>
}
</pre>
</div>
<p>
Note
that
all
<del class="diff-old">of
the
term
</del>
<a class="tref internalDFN" title="iri" href="#dfn-iri">
<ins class="diff-chg">IRIs
</ins>
</a>
<del class="diff-old">s
</del>
have
been
<del class="diff-old">compressed
and
</del>
<ins class="diff-chg">compacted
to
</ins><a class="tref internalDFN" title="term" href="#dfn-term"><ins class="diff-chg">
terms
</ins></a><ins class="diff-chg">
as
specified
in
</ins>
the
<a class="tref internalDFN" title="context" href="#dfn-context">
context
</a>,
<ins class="diff-chg">which
</ins>
has
been
injected
into
the
output.
While
compacted
output
is
<del class="diff-old">most
</del>
useful
to
humans,
it
<del class="diff-old">can
</del>
<ins class="diff-chg">is
</ins>
also
<del class="diff-old">be
carefully
</del>
used
to
generate
structures
that
are
easy
to
<del class="diff-old">use
for
</del>
<ins class="diff-chg">program
against.
Compaction
enables
</ins>
developers
to
<del class="diff-old">program
against
as
well.
</del>
<ins class="diff-chg">map
any
expanded
document
into
an
application-specific
compacted
document.
While
the
context
provided
above
mapped
</ins><code><ins class="diff-chg">
http://xmlns.com/foaf/0.1/nam
</ins></code><ins class="diff-chg">
to
</ins><code><ins class="diff-chg">
name
</ins></code>,<ins class="diff-chg">
it
could
also
have
been
mapped
to
any
other
term
provided
by
the
developer.
</ins>
</p>
</section>
<section class="informative" id="flattening">
<h3>
<span class="secno">
2.3
</span>
<del class="diff-old">Conversion
</del>
<ins class="diff-chg">Flattening
</ins></h3><p><em><ins class="diff-chg">
This
section
is
non-normative.
</ins></em></p><p><ins class="diff-chg">
While
expansion
ensures
that
a
document
is
in
a
uniform
structure,
flattening
goes
a
step
further
to
ensure
that
the
shape
of
the
data
is
deterministic.
In
expanded
documents,
the
properties
of
a
single
</ins><a class="tref internalDFN" title="node" href="#dfn-node"><ins class="diff-chg">
node
</ins></a><ins class="diff-chg">
may
be
spread
across
a
number
of
different
</ins><a class="tref internalDFN" title="json-object" href="#dfn-json-object"><ins class="diff-chg">
JSON
objects
</ins></a>.<ins class="diff-chg">
By
flattening
a
document,
all
properties
of
a
</ins><a class="tref internalDFN" title="node" href="#dfn-node"><ins class="diff-chg">
node
</ins></a><ins class="diff-chg">
are
collected
in
a
single
</ins><a class="tref internalDFN" title="json-object" href="#dfn-json-object"><ins class="diff-chg">
JSON
object
</ins></a><ins class="diff-chg">
and
all
</ins><a class="tref internalDFN" title="blank-node" href="#dfn-blank-node"><ins class="diff-chg">
blank
nodes
</ins></a><ins class="diff-chg">
are
labeled
with
a
</ins><a class="tref internalDFN" title="blank-node-identifier" href="#dfn-blank-node-identifier"><ins class="diff-chg">
blank
node
identifier
</ins></a>.<ins class="diff-chg">
This
may
drastically
simplify
the
code
required
</ins>
to
<ins class="diff-new">process
JSON-LD
data
in
certain
applications.
</ins></p><p><ins class="diff-new">
For
example,
assume
the
following
JSON-LD
input
document:
</ins></p>    <div class="example"><div class="example-title"><span>Example 7</span>: Sample JSON-LD document</div><pre class="example">{<ins class="diff-new">
  &quot;@context&quot;: {
    &quot;name&quot;: &quot;http://xmlns.com/foaf/0.1/name&quot;,
    &quot;knows&quot;: &quot;http://xmlns.com/foaf/0.1/knows&quot;
  },
  &quot;@id&quot;: &quot;http://me.markus-lanthaler.com/&quot;,
  &quot;name&quot;: &quot;Markus Lanthaler&quot;,
  &quot;knows&quot;: [
    {
      &quot;name&quot;: &quot;Dave Longley&quot;
    }
  ]
}
</ins></pre></div><p><ins class="diff-new">
Running
the
</ins><a href="#flattening-algorithm"><ins class="diff-new">
Flattening
algorithm
</ins></a><ins class="diff-new">
(
</ins><code class="idlMemberName"><a href="#widl-JsonLdProcessor-flatten-void-object-object---DOMString-input-object-DOMString-context-JsonLdCallback-callback-JsonLdOptions-options"><ins class="diff-new">
flatten
</ins></a></code><ins class="diff-new">
operation)
with
a
context
set
to
</ins><a class="tref internalDFN" title="null" href="#dfn-null"><ins class="diff-new">
null
</ins></a><ins class="diff-new">
to
prevent
compaction
returns
the
following
document:
</ins></p>    <div class="example"><div class="example-title"><span>Example 8</span>: Flattened sample document in expanded form</div><pre class="example">[<ins class="diff-new">
  {
    &quot;@id&quot;: &quot;_:t0&quot;,
    &quot;http://xmlns.com/foaf/0.1/name&quot;: [
      { &quot;@value&quot;: &quot;Dave Longley&quot; }
    ]
  },
  {
    &quot;@id&quot;: &quot;http://me.markus-lanthaler.com/&quot;,
    &quot;http://xmlns.com/foaf/0.1/name&quot;: [
      { &quot;@value&quot;: &quot;Markus Lanthaler&quot; }
    ],
    &quot;http://xmlns.com/foaf/0.1/knows&quot;: [
      { &quot;@id&quot;: &quot;_:t0&quot; }
    ]
  }
]
</ins></pre></div><p><ins class="diff-new">
Note
how
in
the
output
above
all
properties
of
a
</ins><a class="tref internalDFN" title="node" href="#dfn-node"><ins class="diff-new">
node
</ins></a><ins class="diff-new">
are
collected
in
a
single
</ins><a class="tref internalDFN" title="json-object" href="#dfn-json-object"><ins class="diff-new">
JSON
object
</ins></a>
and
<del class="diff-old">from
</del>
<ins class="diff-chg">how
the
</ins><a class="tref internalDFN" title="blank-node" href="#dfn-blank-node"><ins class="diff-chg">
blank
node
</ins></a><ins class="diff-chg">
representing
&quot;Dave
Longley&quot;
has
been
assigned
the
</ins><a class="tref internalDFN" title="blank-node-identifier" href="#dfn-blank-node-identifier"><ins class="diff-chg">
blank
node
identifier
</ins></a><code><ins class="diff-chg">
_:t0
</ins></code>.</p><p><ins class="diff-chg">
To
make
it
easier
for
humans
to
read
or
for
certain
applications
to
process
it,
a
flattened
document
can
be
compacted
by
passing
a
context.
Using
the
same
context
as
the
input
document,
the
flattened
and
compacted
document
looks
as
follows:
</ins></p>    <div class="example"><div class="example-title"><span>Example 9</span>: Flattened and compacted sample document</div><pre class="example">{<ins class="diff-chg">
  &quot;@context&quot;: {
    &quot;name&quot;: &quot;http://xmlns.com/foaf/0.1/name&quot;,
    &quot;knows&quot;: &quot;http://xmlns.com/foaf/0.1/knows&quot;
  },
  &quot;@graph&quot;: [
    {
      &quot;@id&quot;: &quot;_:t0&quot;,
      &quot;name&quot;: &quot;Dave Longley&quot;
    },
    {
      &quot;@id&quot;: &quot;http://me.markus-lanthaler.com/&quot;,
      &quot;name&quot;: &quot;Markus Lanthaler&quot;,
      &quot;knows&quot;: { &quot;@id&quot;: &quot;_:t0&quot; }
    }
  ]
}
</ins></pre></div><p><ins class="diff-chg">
Please
note
that
the
flattened
and
compacted
result
always
explicitly
designates
the
default
graph
by
the
</ins><code><ins class="diff-chg">
@graph
</ins></code><ins class="diff-chg">
member
in
the
top-level
</ins><a class="tref internalDFN" title="json-object" href="#dfn-json-object"><ins class="diff-chg">
JSON
object
</ins></a>.</p></section><section class="informative" id="rdf-conversion"><h3><span class="secno"><ins class="diff-chg">
2.4
</ins></span>
RDF
<ins class="diff-new">Conversion
</ins>
</h3>
<p>
<em>
<ins class="diff-new">This
section
is
non-normative.
</ins></em></p>
<p>
JSON-LD
can
be
used
to
<del class="diff-old">losslessly
express
the
RDF
</del>
<ins class="diff-chg">serialize
</ins>
data
<del class="diff-old">model
</del>
<ins class="diff-chg">expressed
in
RDF
</ins>
as
described
in
<del class="diff-old">the
RDF
Concepts
document
</del>
[
<cite>
<del class="diff-old">RDF-CONCEPTS
</del>
<a class="bibref" href="#bib-RDF11-CONCEPTS">
<ins class="diff-chg">RDF11-CONCEPTS
</ins>
</a>
</cite>
].
This
ensures
that
data
can
be
round-tripped
<ins class="diff-new">to
and
</ins>
from
any
RDF
<del class="diff-old">syntax,
like
N-Triples
or
TURTLE,
</del>
<ins class="diff-chg">syntax
</ins>
without
any
loss
in
<del class="diff-old">the
fidelity
of
the
data.
Assume
</del>
<ins class="diff-chg">fidelity.
</ins></p><p><ins class="diff-chg">
For
example,
assume
</ins>
the
following
RDF
input
<ins class="diff-new">serialized
</ins>
in
<del class="diff-old">N-Triples
format:
</del>
<ins class="diff-chg">Turtle
[
</ins><cite><a class="bibref" href="#bib-TURTLE"><ins class="diff-chg">
TURTLE
</ins></a></cite><ins class="diff-chg">
]:
</ins>
</p>
<del class="diff-old">  var data = &quot;
&lt;http://manu.sporny.org/about/#manu&gt; &lt;http://xmlns.com/foaf/0.1/name&gt; \&quot;Manu Sporny\&quot; .\n
&lt;http://manu.sporny.org/about/#manu&gt;
</del>
    <div class="example"><div class="example-title"><span>Example 10</span>: Sample Turtle document</div><pre class="example">&lt;http://me.markus-lanthaler.com/&gt; &lt;http://xmlns.com/foaf/0.1/name&gt; &quot;Markus Lanthaler&quot; .
<ins class="diff-chg">&lt;http://me.markus-lanthaler.com/&gt;
</ins>
&lt;http://xmlns.com/foaf/0.1/homepage&gt;
<del class="diff-old">&lt;http://manu.sporny.org/&gt;
.&quot;;
</del>
<ins class="diff-chg">&lt;http://www.markus-lanthaler.com/&gt;
.
</ins>
</pre>
</div>
<p>
<del class="diff-old">A
developer
can
use
</del>
<ins class="diff-chg">Using
</ins>
the
<del class="diff-old">JSON-LD
API
to
</del>
<a href="#convert-from-rdf-algorithm">
<ins class="diff-chg">Convert
from
RDF
algorithm
</ins></a><ins class="diff-chg">
a
developer
could
</ins>
transform
<del class="diff-old">the
markup
above
</del>
<ins class="diff-chg">this
document
</ins>
into
<del class="diff-old">a
JSON-LD
document:
  function conversionCallback(result)
{
  console.log(&quot;JSON-LD Document: &quot;, result);
};
jsonld.fromRDF(data,
conversionCallback,
{&quot;format&quot;:
&quot;ntriples&quot;});
The
following
</del>
expanded
<del class="diff-old">output
would
be
the
result
of
the
call
above:
</del>
<ins class="diff-chg">JSON-LD:
</ins>
</p>
<del class="diff-old">  [{
  &quot;@id&quot;: &quot;http://manu.sporny.org/about/#manu&quot;,
  &quot;http://xmlns.com/foaf/0.1/name&quot;: [{
    &quot;@value&quot;: &quot;Manu Sporny&quot;
  }],
  &quot;http://xmlns.com/foaf/0.1/homepage&quot;: [{
    &quot;@id&quot;: &quot;http://manu.sporny.org/&quot;
  }]
}]
</del>
    <div class="example"><div class="example-title"><span>Example 11</span>: Sample Turtle document converted to JSON-LD</div><pre class="example">[
<ins class="diff-chg">  {
    &quot;@id&quot;: &quot;http://me.markus-lanthaler.com/&quot;,
    &quot;http://xmlns.com/foaf/0.1/name&quot;: [
      { &quot;@value&quot;: &quot;Markus Lanthaler&quot; }
    ],
    &quot;http://xmlns.com/foaf/0.1/homepage&quot;: [
      { &quot;@id&quot;: &quot;http://www.markus-lanthaler.com/&quot; }
    ]
  }
]
</ins>
</pre>
</div>
<p>
Note
that
the
output
<del class="diff-old">above,
</del>
<ins class="diff-chg">above
</ins>
could
easily
be
compacted
<del class="diff-old">to
produce
the
following
</del>
using
the
technique
outlined
in
the
previous
<del class="diff-old">section:
  {
  &quot;@context&quot;: &quot;http://json-ld.org/contexts/person.jsonld&quot;,
  &quot;@id&quot;: &quot;http://manu.sporny.org/about/#manu&quot;,
  &quot;name&quot;: &quot;Manu Sporny&quot;,
  &quot;homepage&quot;: &quot;http://manu.sporny.org/&quot;
}
Transforming
</del>
<ins class="diff-chg">section.
It
is
also
possible
to
transform
</ins>
the
<del class="diff-old">object
above
</del>
<ins class="diff-chg">JSON-LD
document
</ins>
back
to
RDF
<del class="diff-old">is
as
simple
as
calling
</del>
<ins class="diff-chg">using
</ins>
the
<del class="diff-old">toRDF()
method:
</del>
<a href="#convert-to-rdf-algorithm">
<ins class="diff-chg">Convert
to
RDF
algorithm
</ins></a>.
</p>
<del class="diff-old">  var jsonldDocument = ...; // assign the JSON-LD document here
function rdfCallback(quads)
{
  console.log(&quot;RDF Data: &quot;, quads);
};
jsonld.toRDF(jsonldDocument,
rdfCallback);
</del>
</section>
</section>
<section id="conformance">
<h2>
<span class="secno">
<del class="diff-old">2.4
</del>
<ins class="diff-chg">3.
</ins>
</span>
<del class="diff-old">Framing
</del>
<ins class="diff-chg">Conformance
</ins></h2><p><ins class="diff-chg">
All
examples
</ins>
and
<del class="diff-old">Normalization
Issue
2
</del>
<ins class="diff-chg">notes
as
well
as
sections
marked
as
non-normative
in
this
specification
are
non-normative.
Everything
else
in
this
specification
is
normative.
</ins></p><p><ins class="diff-chg">
The
keywords
</ins><em class="rfc2119" title="MUST"><ins class="diff-chg">
MUST
</ins></em>,<em class="rfc2119" title="MUST NOT"><ins class="diff-chg">
MUST
NOT
</ins></em>,<em class="rfc2119" title="REQUIRED"><ins class="diff-chg">
REQUIRED
</ins></em>,<em class="rfc2119" title="SHOULD"><ins class="diff-chg">
SHOULD
</ins></em>,<em class="rfc2119" title="SHOULD NOT"><ins class="diff-chg">
SHOULD
NOT
</ins></em>,<em class="rfc2119" title="RECOMMENDED"><ins class="diff-chg">
RECOMMENDED
</ins></em>,<em class="rfc2119" title="MAY"><ins class="diff-chg">
MAY
</ins></em>,<ins class="diff-chg">
and
</ins><em class="rfc2119" title="OPTIONAL"><ins class="diff-chg">
OPTIONAL
</ins></em><ins class="diff-chg">
in
this
specification
are
to
be
interpreted
as
described
in
[
</ins><cite>
<a class="bibref" href="#bib-RFC2119">
<ins class="diff-chg">RFC2119
</ins></a>
</cite>
<ins class="diff-chg">].
</ins></p><p>
There
are
<del class="diff-old">currently
</del>
two
<del class="diff-old">other
API
methods
</del>
<ins class="diff-chg">classes
of
products
</ins>
that
<del class="diff-old">are
in
active
development
and
were
not
ready
for
publication
at
the
time
this
document
was
published.
Framing
allows
a
developer
</del>
<ins class="diff-chg">can
claim
conformance
</ins>
to
<del class="diff-old">force
a
different
layout
for
the
data
</del>
<ins class="diff-chg">this
specification:
</ins><a class="tref internalDFN" title="json-ld-implementation" href="#dfn-json-ld-implementation"><ins class="diff-chg">
JSON-LD
Implementations
</ins></a>
and
<del class="diff-old">effectively
perform
query-by-example
on
</del>
<a class="tref internalDFN" title="json-ld-processor" href="#dfn-json-ld-processor">
JSON-LD
<del class="diff-old">documents
-
this
</del>
<ins class="diff-chg">Processors
</ins></a>.</p><p><ins class="diff-chg">
A
conforming
</ins><dfn title="json-ld-implementation" id="dfn-json-ld-implementation"><ins class="diff-chg">
JSON-LD
Implementation
</ins></dfn>
is
<del class="diff-old">most
useful
when
</del>
a
<del class="diff-old">JSON-LD-based
REST
API
does
not
know
the
exact
form
</del>
<ins class="diff-chg">system
capable
</ins>
of
<ins class="diff-new">transforming
JSON-LD
documents
according
</ins>
the
<del class="diff-old">data
it
is
getting
in,
but
still
wants
to
operate
upon
it
if
some
bare
essentials
are
found
</del>
<ins class="diff-chg">algorithms
defined
</ins>
in
<del class="diff-old">the
data.
</del>
<ins class="diff-chg">this
specification.
</ins></p><p><ins class="diff-chg">
A
conforming
</ins><dfn title="json-ld-processor" id="dfn-json-ld-processor">
JSON-LD
<del class="diff-old">normalization
allows
</del>
<ins class="diff-chg">Processor
</ins></dfn><ins class="diff-chg">
is
a
conforming
</ins><a class="tref internalDFN" title="json-ld-implementation" href="#dfn-json-ld-implementation">
JSON-LD
<del class="diff-old">documents
to
be
deterministically
serialized
such
</del>
<ins class="diff-chg">Implementation
</ins></a>
that
<del class="diff-old">they
can
be
digitally
signed
or
be
used
to
find
</del>
<ins class="diff-chg">exposes
</ins>
the
<del class="diff-old">differences
between
two
linked
data
graph
s.
</del>
<ins class="diff-chg">Application
Programming
Interface
(API)
defined
in
this
specification.
</ins>
It
<del class="diff-old">is
expected
that
framing
will
be
a
part
</del>
<em class="rfc2119" title="MUST">
<ins class="diff-chg">MUST
</ins></em><ins class="diff-chg">
implement
the
</ins><code><ins class="diff-chg">
json-ld-1.0
</ins></code><ins class="diff-chg">
processing
mode
(for
further
details,
see
the
</ins><code class="idlMemberName"><a href="#widl-JsonLdOptions-processingMode"><ins class="diff-chg">
processingMode
</ins></a></code><ins class="diff-chg">
option
</ins>
of
<a href="#idl-def-JsonLdOptions" class="idlType">
<code>
<ins class="diff-new">JsonLdOptions
</ins></code></a><ins class="diff-new">
).
</ins></p><p><ins class="diff-new">
The
algorithms
in
this
specification
are
generally
written
with
more
concern
for
clarity
than
efficiency.
Thus,
JSON-LD
Implementations
and
Processors
may
implement
</ins>
the
<del class="diff-old">final
API.
It
</del>
<ins class="diff-chg">algorithms
given
in
this
specification
in
any
way
desired,
so
long
as
the
end
result
</ins>
is
<del class="diff-old">expected
</del>
<ins class="diff-chg">indistinguishable
from
the
result
</ins>
that
<del class="diff-old">normalization
will
</del>
<ins class="diff-chg">would
</ins>
be
<del class="diff-old">an
optional
feature
that
JSON-LD
processors
may
implement.
</del>
<ins class="diff-chg">obtained
by
the
specification's
algorithms.
</ins>
</p>
<del class="diff-old">3.
The
Application
Programming
Interface
</del>
<p>
This
<del class="diff-old">API
provides
a
clean
mechanism
that
enables
developers
to
convert
</del>
<ins class="diff-chg">specification
does
not
define
how
</ins>
JSON-LD
<del class="diff-old">data
into
a
a
variety
of
output
formats
</del>
<ins class="diff-chg">Implementations
or
Processors
handle
non-conforming
input
documents.
This
implies
</ins>
that
<del class="diff-old">are
easier
to
work
with
in
various
programming
languages.
If
a
</del>
JSON-LD
<del class="diff-old">API
is
provided
in
a
programming
environment,
the
entirety
of
the
following
API
must
</del>
<ins class="diff-chg">Implementations
or
Processors
</ins><em class="rfc2119" title="MUST NOT"><ins class="diff-chg">
MUST
NOT
</ins>
</em>
<del class="diff-old">be
implemented.
</del>
<ins class="diff-chg">attempt
to
correct
malformed
</ins><a class="tref internalDFN" title="iri" href="#dfn-iri"><ins class="diff-chg">
IRIs
</ins></a><ins class="diff-chg">
or
language
tags;
however,
they
</ins><em class="rfc2119" title="MAY"><ins class="diff-chg">
MAY
</ins></em><ins class="diff-chg">
issue
validation
warnings.
IRIs
are
not
modified
other
than
converted
between
</ins><a class="tref internalDFN" title="relative-iri" href="#dfn-relative-iri"><ins class="diff-chg">
relative
</ins></a><ins class="diff-chg">
and
</ins><a class="tref internalDFN" title="absolute-iri" href="#dfn-absolute-iri"><ins class="diff-chg">
absolute
IRIs
</ins></a>.
</p>
<del class="diff-old">3.1
General
Terminology
</del>
<div class="note">
<div class="note-title">
<span>
<del class="diff-old">Issue
3
</del>
<ins class="diff-chg">Note
</ins>
</span>
</div>
<p class="">
<del class="diff-old">The
intent
of
the
Working
Group
and
the
Editors
</del>
<ins class="diff-chg">Implementers
can
partially
check
their
level
</ins>
of
<del class="diff-old">this
specification
is
</del>
<ins class="diff-chg">conformance
</ins>
to
<del class="diff-old">eventually
align
terminology
used
in
</del>
this
<del class="diff-old">document
with
</del>
<ins class="diff-chg">specification
by
successfully
passing
</ins>
the
<del class="diff-old">terminology
used
in
</del>
<ins class="diff-chg">test
cases
of
</ins>
the
<del class="diff-old">RDF
Concepts
document
to
</del>
<ins class="diff-chg">JSON-LD
test
suite
[
</ins><cite><a class="bibref" href="#bib-JSON-LD-TESTS"><ins class="diff-chg">
JSON-LD-TESTS
</ins></a></cite><ins class="diff-chg">
].
Note,
however,
that
passing
all
</ins>
the
<del class="diff-old">extent
to
which
it
makes
sense
to
do
so.
In
general,
if
there
is
an
analogue
to
terminology
used
in
this
document
</del>
<ins class="diff-chg">tests
</ins>
in
the
<del class="diff-old">RDF
Concepts
document,
the
preference
is
</del>
<ins class="diff-chg">test
suite
does
not
imply
complete
conformance
</ins>
to
<del class="diff-old">use
</del>
<ins class="diff-chg">this
specification.
It
only
implies
that
</ins>
the
<del class="diff-old">terminology
in
</del>
<ins class="diff-chg">implementation
conforms
to
aspects
tested
by
</ins>
the
<del class="diff-old">RDF
Concepts
document.
</del>
<ins class="diff-chg">test
suite.
</ins>
</p>
</div>
</section>
<section id="general-terminology">
<h2>
<span class="secno">
<ins class="diff-new">4.
</ins></span><ins class="diff-new">
General
Terminology
</ins></h2>
<p>
<del class="diff-old">The
</del>
<ins class="diff-chg">This
document
uses
the
</ins>
following
<del class="diff-old">is
an
explanation
of
</del>
<ins class="diff-chg">terms
as
defined
in
JSON
[
</ins><cite><a class="bibref" href="#bib-RFC4627"><ins class="diff-chg">
RFC4627
</ins></a></cite><ins class="diff-chg">
].
Refer
to
</ins>
the
<del class="diff-old">general
terminology
used
</del>
<em>
<ins class="diff-chg">JSON
Grammar
</ins></em><ins class="diff-chg">
section
</ins>
in
<del class="diff-old">this
document:
</del>
<ins class="diff-chg">[
</ins><cite><a class="bibref" href="#bib-RFC4627"><ins class="diff-chg">
RFC4627
</ins></a></cite><ins class="diff-chg">
]
for
formal
definitions.
</ins>
</p>
<dl>
<dt>
<dfn title="json-object" id="dfn-json-object">
JSON
object
</dfn>
</dt>
<dd>
An
object
structure
is
represented
as
a
pair
of
curly
brackets
surrounding
zero
or
more
<del class="diff-old">name-value
</del>
<ins class="diff-chg">key-value
</ins>
pairs.
A
<del class="diff-old">name
</del>
<ins class="diff-chg">key
</ins>
is
a
<a class="tref internalDFN" title="string" href="#dfn-string">
string
</a>.
A
single
colon
comes
after
each
<del class="diff-old">name,
</del>
<ins class="diff-chg">key,
</ins>
separating
the
<del class="diff-old">name
</del>
<ins class="diff-chg">key
</ins>
from
the
value.
A
single
comma
separates
a
value
from
a
following
<del class="diff-old">name.
The
names
within
</del>
<ins class="diff-chg">key.
In
contrast
to
JSON,
in
JSON-LD
the
keys
in
</ins>
an
object
<del class="diff-old">should
</del>
<ins class="diff-chg">must
</ins>
be
unique.
</dd>
<dt>
<dfn title="array" id="dfn-array">
array
</dfn>
</dt>
<dd>
An
array
<ins class="diff-new">structure
</ins>
is
represented
as
square
brackets
surrounding
zero
or
more
values
<del class="diff-old">that
</del>
<ins class="diff-chg">(or
elements).
Elements
</ins>
are
separated
by
commas.
<ins class="diff-new">In
JSON,
an
array
is
an
</ins><em><ins class="diff-new">
ordered
</ins></em><ins class="diff-new">
sequence
of
zero
or
more
values.
While
JSON-LD
uses
the
same
array
representation
as
JSON,
the
collection
is
</ins><em><ins class="diff-new">
unordered
</ins></em><ins class="diff-new">
by
default.
While
order
is
preserved
in
regular
JSON
arrays,
it
is
not
in
regular
JSON-LD
arrays
unless
specific
markup
is
provided
(see
</ins><a href="#sets-and-lists"></a><ins class="diff-new">
).
</ins>
</dd>
<dt>
<dfn title="string" id="dfn-string">
string
</dfn>
</dt>
<dd>
A
string
is
a
sequence
of
zero
or
more
Unicode
<del class="diff-old">(UTF-8)
</del>
characters,
wrapped
in
double
quotes,
using
backslash
escapes
(if
necessary).
A
character
is
represented
as
a
single
character
string.
</dd>
<dt>
<dfn title="number" id="dfn-number">
number
</dfn>
</dt>
<dd>
A
number
is
similar
to
that
used
in
most
programming
languages,
except
that
the
octal
and
hexadecimal
formats
are
not
used
and
that
leading
zeros
are
not
allowed.
</dd>
<dt>
<dfn title="true" id="dfn-true">
true
</dfn>
and
<dfn title="false" id="dfn-false">
false
</dfn>
</dt>
<dd>
Values
that
are
used
to
express
one
of
two
possible
boolean
states.
</dd>
<dt>
<dfn title="null" id="dfn-null">
null
</dfn>
</dt>
<dd>
<del class="diff-old">Unless
otherwise
specified,
a
JSON-LD
processor
must
act
as
if
</del>
<ins class="diff-chg">The
</ins><a class="tref internalDFN" title="null" href="#dfn-null"><ins class="diff-chg">
null
</ins></a><ins class="diff-chg">
value.
A
key-value
pair
in
the
</ins><code><ins class="diff-chg">
@context
</ins></code><ins class="diff-chg">
where
the
value,
or
the
</ins><code><ins class="diff-chg">
@id
</ins></code><ins class="diff-chg">
of
the
value,
is
</ins><a class="tref internalDFN" title="null" href="#dfn-null"><ins class="diff-chg">
null
</ins></a><ins class="diff-chg">
explicitly
decouples
</ins>
a
<ins class="diff-new">term's
association
with
an
</ins><abbr title="Internationalized Resource Identifier"><ins class="diff-new">
IRI
</ins></abbr>.<ins class="diff-new">
A
</ins>
key-value
pair
in
the
body
of
a
JSON-LD
document
<del class="diff-old">was
never
declared
when
the
</del>
<ins class="diff-chg">whose
</ins>
value
<del class="diff-old">equals
</del>
<ins class="diff-chg">is
</ins><a class="tref internalDFN" title="null" href="#dfn-null">
null
<del class="diff-old">.
</del>
</a>
<ins class="diff-chg">has
the
same
meaning
as
if
the
key-value
pair
was
not
defined.
</ins>
If
<code>
@value
</code>,
<code>
@list
</code>,
or
<code>
@set
</code>
is
set
to
<a class="tref internalDFN" title="null" href="#dfn-null">
null
</a>
in
expanded
form,
then
the
entire
<a class="tref internalDFN" title="json-object" href="#dfn-json-object">
JSON
object
</a>
is
ignored.
<del class="diff-old">If
@context
is
set
to
null
,
</del>
</dd>
</dl>
<p>
<ins class="diff-chg">Furthermore,
</ins>
the
<del class="diff-old">active
context
</del>
<ins class="diff-chg">following
terminology
</ins>
is
<del class="diff-old">reset
and
when
</del>
used
<del class="diff-old">within
a
context
,
it
removes
any
definition
associated
with
the
key,
unless
otherwise
specified.
</del>
<ins class="diff-chg">throughout
this
document:
</ins></p><dl>
<dt>
<del class="diff-old">subject
definition
</del>
<dfn title="keyword" id="dfn-keyword">
<ins class="diff-chg">keyword
</ins>
</dfn>
</dt>
<dd>
A
JSON
<del class="diff-old">object
used
to
represent
a
subject
and
one
or
more
properties
of
</del>
<ins class="diff-chg">key
</ins>
that
<del class="diff-old">subject.
A
JSON
object
</del>
is
<del class="diff-old">a
subject
definition
if
it
does
not
contain
they
keys
@value
,
@list
or
@set
and
it
has
one
or
more
keys
other
than
@id
.
</del>
<ins class="diff-chg">specific
to
JSON-LD,
specified
in
the
JSON-LD
Syntax
specification
[
</ins><cite>
<del class="diff-old">subject
reference
</del>
<a class="bibref" href="#bib-JSON-LD">
<ins class="diff-chg">JSON-LD
</ins></a>
</cite>
<ins class="diff-chg">]
in
the
section
titled
</ins><cite>
<del class="diff-old">A
JSON
object
</del>
<a href="../json-ld-syntax/#syntax-tokens-and-keywords">
<ins class="diff-chg">Syntax
Tokens
and
Keywords
</ins>
</a>
<del class="diff-old">used
to
reference
a
subject
having
only
the
@id
key.
</del>
</cite>.
</dd>
<dt>
<del class="diff-old">Linked
Data
</del>
<dfn title="context" id="dfn-context">
<ins class="diff-chg">context
</ins>
</dfn>
</dt>
<dd>
A
<del class="diff-old">set
of
documents,
each
containing
</del>
a
<del class="diff-old">representation
</del>
<ins class="diff-chg">set
</ins>
of
<ins class="diff-new">rules
for
interpreting
</ins>
a
<del class="diff-old">linked
data
graph
.
linked
data
graph
or
dataset
</del>
<ins class="diff-chg">JSON-LD
document
as
specified
in
</ins><cite>
<del class="diff-old">An
unordered
labeled
directed
graph,
where
node
s
are
subject
</del>
<a href="../json-ld-syntax/#the-context">
<ins class="diff-chg">The
Context
</ins>
</a>
<del class="diff-old">s
or
object
</del>
</cite>
<ins class="diff-chg">of
the
[
</ins><cite><a class="bibref" href="#bib-JSON-LD"><ins class="diff-chg">
JSON-LD
</ins>
</a>
<del class="diff-old">s,
and
edges
are
properties.
</del>
</cite>
<ins class="diff-chg">]
specification.
</ins>
</dd>
<dt>
<del class="diff-old">node
</del>
<dfn title="json-ld-document" id="dfn-json-ld-document">
<ins class="diff-chg">JSON-LD
document
</ins>
</dfn>
</dt>
<dd>
A
<del class="diff-old">piece
of
information
that
</del>
<a class="tref internalDFN" title="json-ld-document" href="#dfn-json-ld-document">
<ins class="diff-chg">JSON-LD
document
</ins></a>
is
<del class="diff-old">represented
in
</del>
a
<del class="diff-old">linked
data
</del>
<ins class="diff-chg">serialization
of
a
collection
of
</ins><a class="tref internalDFN" title="json-ld-graph" href="#dfn-json-ld-graph"><ins class="diff-chg">
JSON-LD
graphs
</ins></a><ins class="diff-chg">
and
comprises
exactly
one
</ins><a class="tref internalDFN" title="default-graph" href="#dfn-default-graph"><ins class="diff-chg">
default
</ins>
graph
</a>
<ins class="diff-new">and
zero
or
more
</ins><a class="tref internalDFN" title="named-graph" href="#dfn-named-graph"><ins class="diff-new">
named
graphs
</ins>
</a>.
</dd>
<dt>
<dfn title="named-graph" id="dfn-named-graph">
named
graph
</dfn>
</dt>
<dd>
A
<del class="diff-old">linked
data
</del>
<ins class="diff-chg">named
</ins>
graph
<del class="diff-old">that
has
one
or
more
</del>
<ins class="diff-chg">is
a
pair
consisting
of
an
</ins>
<a class="tref internalDFN" title="iri" href="#dfn-iri">
<abbr title="Internationalized Resource Identifier">
IRI
</abbr>
</a>
<del class="diff-old">that
are
used
to
refer
to
it.
</del>
<ins class="diff-chg">or
</ins><a class="tref internalDFN" title="blank-node" href="#dfn-blank-node"><ins class="diff-chg">
blank
node
</ins></a><ins class="diff-chg">
(the
</ins><dfn title="graph-name" id="dfn-graph-name">
graph
name
</dfn>
<del class="diff-old">An
IRI
that
is
a
reference
to
</del>
<ins class="diff-chg">)
and
</ins>
a
<del class="diff-old">named
</del>
<a class="tref internalDFN" title="json-ld-graph" href="#dfn-json-ld-graph">
<ins class="diff-chg">JSON-LD
</ins>
graph
</a>.
</dd>
<dt>
<dfn title="default-graph" id="dfn-default-graph">
default
graph
</dfn>
</dt>
<dd>
<del class="diff-old">When
executing
an
algorithm,
</del>
<ins class="diff-chg">The
default
graph
is
</ins>
the
<ins class="diff-new">only
</ins>
graph
<del class="diff-old">where
data
should
be
placed
if
</del>
<ins class="diff-chg">in
</ins>
a
<del class="diff-old">named
</del>
<ins class="diff-chg">JSON-LD
document
which
has
no
</ins><a class="tref internalDFN" title="graph-name" href="#dfn-graph-name">
graph
<del class="diff-old">is
not
specified.
</del>
<ins class="diff-chg">name
</ins></a>.
</dd>
<dt>
<del class="diff-old">subject
</del>
<dfn title="json-ld-graph" id="dfn-json-ld-graph">
<ins class="diff-chg">JSON-LD
graph
</ins>
</dfn>
</dt>
<dd>
<del class="diff-old">Any
node
in
</del>
<ins class="diff-chg">A
labeled
directed
graph,
i.e.,
</ins>
a
<del class="diff-old">linked
data
graph
</del>
<ins class="diff-chg">set
of
</ins><a class="tref internalDFN" title="node" href="#dfn-node"><ins class="diff-chg">
nodes
</ins>
</a>
<del class="diff-old">with
at
least
one
outgoing
edge.
IRI
An
Internationalized
Resource
Identifier
</del>
<ins class="diff-chg">connected
by
</ins><a class="tref internalDFN" title="edge" href="#dfn-edge"><ins class="diff-chg">
edges
</ins></a>,
as
<del class="diff-old">described
</del>
<ins class="diff-chg">specified
</ins>
in
<del class="diff-old">[
</del>
<ins class="diff-chg">the
</ins>
<cite>
<del class="diff-old">RFC3987
</del>
<a href="../json-ld-syntax/#data-model">
<ins class="diff-chg">Data
Model
</ins>
</a>
</cite>
<del class="diff-old">]).
object
A
node
in
a
linked
data
graph
with
at
least
one
incoming
edge.
property
An
edge
of
the
linked
data
graph
.
literal
An
object
with
a
label
that
is
not
an
IRI
.
quad
A
piece
</del>
<ins class="diff-chg">section
</ins>
of
<del class="diff-old">information
that
contains
four
items;
a
subject
,
a
property
,
a
object
,
and
a
graph
name
.
context
A
JSON
object
that
contains
rules
for
interpreting
a
JSON-LD
document.
keyword
A
JSON
key
that
is
specific
to
JSON-LD,
specified
in
</del>
the
JSON-LD
<del class="diff-old">Syntax
</del>
<ins class="diff-chg">syntax
</ins>
specification
[
<cite>
<a class="bibref" href="#bib-JSON-LD">
JSON-LD
</a>
</cite>
<del class="diff-old">]
in
the
section
titled
Syntax
Tokens
and
Keywords
.
</del>
<ins class="diff-chg">].
</ins>
</dd>
<del class="diff-old">3.2
JsonLdProcessor
The
JSON-LD
Processor
interface
is
the
high-level
programming
structure
that
developers
use
to
access
the
JSON-LD
transformation
methods.
    ]
interface  {
};
3.2.1
Methods
</del>
<dt>
<del class="diff-old">compact
</del>
<dfn title="edge" id="dfn-edge">
<ins class="diff-chg">edge
</ins></dfn>
</dt>
<dd>
<del class="diff-old">Compacts
</del>
<ins class="diff-chg">Every
</ins><a class="tref internalDFN" title="edge" href="#dfn-edge"><ins class="diff-chg">
edge
</ins>
</a>
<del class="diff-old">the
given
input
using
the
context
according
to
the
steps
in
the
Compaction
Algorithm
.
The
input
must
be
copied,
compacted
</del>
<ins class="diff-chg">has
a
direction
associated
with
it
</ins>
and
<del class="diff-old">returned
if
there
are
no
errors.
If
the
compaction
fails,
an
appropriate
exception
must
be
thrown.
Parameter
Type
Nullable
Optional
Description
input
object
or
object[]
or
URL
✘
✘
The
JSON-LD
object
or
array
of
JSON-LD
objects
to
perform
the
compaction
upon
or
</del>
<ins class="diff-chg">is
labeled
with
</ins>
an
<a class="tref internalDFN" title="iri" href="#dfn-iri">
<abbr title="Internationalized Resource Identifier">
IRI
</abbr>
</a>
<del class="diff-old">referencing
the
JSON-LD
document
to
compact.
context
object
or
URL
✘
✘
The
context
to
use
when
compacting
the
input
;
either
in
the
form
of
an
JSON
object
</del>
or
<del class="diff-old">as
IRI
.
callback
JsonLdCallback
✘
✘
A
callback
that
is
called
when
processing
is
complete
on
the
given
input
.
options
JsonLdOptions
✘
✔
A
set
of
options
that
may
affect
the
expansion
algorithm
such
as,
e.g.,
the
input
document's
base
IRI
</del>
<ins class="diff-chg">a
</ins><a class="tref internalDFN" title="blank-node-identifier" href="#dfn-blank-node-identifier"><ins class="diff-chg">
blank
node
identifier
</ins>
</a>.
<del class="diff-old">This
also
includes
optimize
,
which
if
set
will
cause
processor-specific
optimization.
Return
type:
void
expand
Expands
the
given
input
according
to
the
steps
in
</del>
<ins class="diff-chg">Within
</ins>
the
<del class="diff-old">Expansion
Algorithm
.
The
input
must
be
copied,
expanded
and
returned
if
there
</del>
<ins class="diff-chg">JSON-LD
syntax
these
edge
labels
</ins>
are
<del class="diff-old">no
errors.
If
the
expansion
fails,
</del>
<ins class="diff-chg">called
</ins><dfn title="property" id="dfn-property"><ins class="diff-chg">
properties
</ins></dfn>.<ins class="diff-chg">
Whenever
possible,
</ins>
an
<del class="diff-old">appropriate
exception
must
be
thrown.
Parameter
Type
Nullable
Optional
Description
input
object
or
object[]
or
URL
</del>
<a class="tref internalDFN" title="edge" href="#dfn-edge">
<ins class="diff-chg">edge
</ins>
</a>
<del class="diff-old">✘
✘
The
JSON-LD
object
or
array
of
JSON-LD
objects
to
perform
the
expansion
upon
or
</del>
<ins class="diff-chg">should
be
labeled
with
</ins>
an
<a class="tref internalDFN" title="iri" href="#dfn-iri">
<abbr title="Internationalized Resource Identifier">
IRI
</abbr>
<del class="diff-old">referencing
the
JSON-LD
document
to
expand.
context
object
or
URL
✔
✘
An
optional
external
context
to
use
additionally
to
the
context
embedded
in
input
when
expanding
the
input
.
callback
JsonLdCallback
✘
✘
A
callback
that
is
called
when
processing
is
complete
on
the
given
input
.
options
JsonLdOptions
✘
✔
A
set
of
options
that
may
affect
the
expansion
algorithm
such
as,
e.g.,
the
input
document's
base
IRI
</del>
</a>.
<del class="diff-old">Return
type:
void
</del>
</dd>
<dt>
<del class="diff-old">fromRDF
Creates
a
JSON-LD
document
given
an
set
of
Quads
.
Parameter
Type
Nullable
Optional
Description
input
Quad
[]
✘
✘
A
dataset
represented
as
an
array
of
Quads
.
callback
JsonLdCallback
✘
✘
A
callback
that
is
called
when
processing
is
complete
on
the
given
input
.
options
JsonLdOptions
✘
✔
A
set
of
options
that
will
affect
the
algorithm.
This
includes
notType
,
which
if
set
to
true
causes
the
resulting
document
to
use
rdf:type
as
a
property,
instead
of
@type
.
Return
type:
void
toRDF
</del>
<dfn title="node" id="dfn-node">
<ins class="diff-chg">node
</ins></dfn>
</dt>
<dd>
<del class="diff-old">Processes
the
input
according
to
the
Convert
to
RDF
Algorithm
,
calling
the
provided
callback
for
each
Quad
generated.
Parameter
Type
Nullable
Optional
Description
input
object
or
object[]
or
URL
✘
✘
The
JSON-LD
object
or
array
of
JSON-LD
objects
to
convert
to
RDF
or
a
URL
referencing
the
JSON-LD
document
to
convert
to
RDF.
callback
QuadCallback
✘
✘
A
callback
that
is
called
when
a
Quad
</del>
<ins class="diff-chg">Every
</ins><a class="tref internalDFN" title="node" href="#dfn-node"><ins class="diff-chg">
node
</ins>
</a>
is
<del class="diff-old">created
from
processing
the
given
input
.
options
JsonLdOptions
✘
✔
A
set
of
options
that
may
affect
the
conversion
to
RDF
such
as,
e.g.,
the
input
document's
base
</del>
<ins class="diff-chg">an
</ins>
<a class="tref internalDFN" title="iri" href="#dfn-iri">
<abbr title="Internationalized Resource Identifier">
IRI
</abbr>
<del class="diff-old">.
Return
type:
void
3.3
Callbacks
3.3.1
JsonLdCallback
The
JsonLdCallback
is
used
to
return
</del>
</a>,
a
<del class="diff-old">processed
</del>
<a class="tref internalDFN" title="blank-node" href="#dfn-blank-node">
<ins class="diff-chg">blank
node
</ins></a>,<ins class="diff-chg">
a
</ins><a class="tref internalDFN" title="json-ld-value" href="#dfn-json-ld-value">
JSON-LD
<del class="diff-old">representation
as
the
result
of
processing
an
API
method.
    ]
interface  {
};
3.3.1.1
Methods
jsonLd
This
callback
is
invoked
when
processing
is
complete.
Parameter
Type
Nullable
Optional
Description
jsonld
object
</del>
<ins class="diff-chg">value
</ins></a>,
or
<del class="diff-old">object
[]
✘
✘
The
processed
JSON-LD
document.
Return
type:
void
3.3.2
QuadCallback
The
QuadCallback
is
called
whenever
the
processor
generates
a
quad
during
the
quad()
call.
    ]
interface  {
};
3.3.2.1
Methods
quad
This
callback
is
invoked
whenever
</del>
a
<del class="diff-old">quad
is
generated
by
the
processor.
Parameter
Type
Nullable
Optional
Description
quad
Quad
✘
✘
The
quad.
Return
type:
void
</del>
<a class="tref internalDFN" title="list" href="#dfn-list">
<ins class="diff-chg">list
</ins></a>.
</dd>
<dt>
<del class="diff-old">3.4
Data
Structures
This
section
describes
datatype
definitions
used
within
the
JSON-LD
API.
3.4.1
URL
The
URL
datatype
is
a
string
representation
of
an
</del>
<dfn title="iri" id="dfn-iri">
<abbr title="Internationalized Resource Identifier">
IRI
</abbr>
<del class="diff-old">.
typedef
DOMString
URL
;
</del>
</dfn>
<del class="diff-old">This
datatype
indicates
that
the
</del>
</dt>
<dd>
<ins class="diff-chg">An
</ins>
<a class="tref internalDFN" title="iri" href="#dfn-iri">
<abbr title="Internationalized Resource Identifier">
IRI
</abbr>
</a>
<del class="diff-old">is
interpreted
as
a
Universal
</del>
<ins class="diff-chg">(Internationalized
</ins>
Resource
<del class="diff-old">Locator
identifying
a
document,
which
when
parsed
as
JSON
yields
either
a
JSON
object
or
array
.
3.4.2
JsonLdOptions
The
JsonLdOptions
type
</del>
<ins class="diff-chg">Identifier)
</ins>
is
<del class="diff-old">used
to
convert
</del>
a
<del class="diff-old">set
of
options
</del>
<ins class="diff-chg">string
that
conforms
</ins>
to
<del class="diff-old">an
interface
method.
typedef
</del>
<ins class="diff-chg">the
syntax
defined
in
[
</ins><cite>
<del class="diff-old">object
</del>
<a class="bibref" href="#bib-RFC3987">
<ins class="diff-chg">RFC3987
</ins>
</a>
<del class="diff-old">JsonLdOptions
;
</del>
</cite>
<ins class="diff-chg">].
</ins></dd>
<dt>
<del class="diff-old">URL
base
The
Base
</del>
<dfn title="absolute-iri" id="dfn-absolute-iri">
<ins class="diff-chg">absolute
</ins>
<abbr title="Internationalized Resource Identifier">
IRI
</abbr>
<del class="diff-old">to
use
when
expanding
the
document.
This
overrides
the
value
of
input
if
it
is
a
</del>
<del class="diff-old">URL
</del>
</dfn>
<del class="diff-old">or
if
it
is
a
object
or
object[]
.
boolean
optimize
</del>
</dt>
<dd>
<del class="diff-old">If
set
to
true
,
the
JSON-LD
processor
is
allowed
to
optimize
the
output
of
the
Compaction
Algorithm
to
produce
even
compacter
representations.
The
algorithm
for
compaction
optimization
is
beyond
the
scope
of
this
specification
and
thus
not
defined.
Consequently,
different
implementations
may
implement
different
optimization
algorithms.
boolean
noType
If
set
to
true
,
the
JSON-LD
processor
will
not
use
the
@type
property
when
generating
the
output,
and
will
use
the
expanded
rdf:type
</del>
<ins class="diff-chg">An
absolute
</ins>
<abbr title="Internationalized Resource Identifier">
IRI
</abbr>
<del class="diff-old">as
the
property
instead
of
@type
.
The
following
data
structures
are
used
for
representing
data
about
RDF
quads.
They
are
used
for
normalization,
fromRDF
,
and
from
toRDF
interfaces.
3.4.3
Quad
The
Quad
interface
represents
an
RDF
Quad.
See
</del>
<ins class="diff-chg">is
defined
in
</ins>
[
<cite>
<del class="diff-old">RDF-CONCEPTS
</del>
<a class="bibref" href="#bib-RFC3987">
<ins class="diff-chg">RFC3987
</ins>
</a>
</cite>
]
<del class="diff-old">definition
for
RDF
triple
,
which
most
closely
aligns
to
Quad
.
    ]
interface  {
};
3.4.3.1
Attributes
graphName
of
type
Node
,
readonly,
nullable
If
present,
the
name
associated
with
the
Quad
identifying
it
as
a
member
of
</del>
<ins class="diff-chg">containing
</ins>
a
<del class="diff-old">named
graph
.
If
it
is
missing,
the
quad
is
</del>
<em>
<ins class="diff-chg">scheme
</ins></em><ins class="diff-chg">
along
with
</ins>
a
<del class="diff-old">member
of
the
default
graph
.
Issue
4
This
element
is
at
risk,
</del>
<em>
<ins class="diff-chg">path
</ins></em>
and
<del class="diff-old">may
be
removed.
object
of
type
Node
,
readonly
The
object
associated
with
the
Quad
.
</del>
<ins class="diff-chg">optional
</ins><em><ins class="diff-chg">
query
</ins></em><ins class="diff-chg">
and
fragment
segments.
</ins>
</dd>
<dt>
<del class="diff-old">predicate
of
type
Node
,
readonly
The
predicate
associated
with
the
Quad
</del>
<dfn title="relative-iri" id="dfn-relative-iri">
<ins class="diff-chg">relative
</ins><abbr title="Internationalized Resource Identifier"><ins class="diff-chg">
IRI
</ins></abbr>
<del class="diff-old">.
Within
JSON-LD,
an
RDF
predicate
</del>
</dfn>
<del class="diff-old">is
refered
to
as
a
property
</del>
<del class="diff-old">subject
of
type
Node
,
readonly
</del>
</dt>
<dd>
<del class="diff-old">The
subject
associated
with
the
Quad
.
3.4.4
Node
Node
is
the
base
class
of
</del>
<ins class="diff-chg">A
relative
</ins>
<abbr title="Internationalized Resource Identifier">
IRI
</abbr>
<del class="diff-old">,
BlankNode
,
and
Literal
.
It
</del>
is
<del class="diff-old">the
IDL
representation
of
a
linked
data
graph
node
.
    ]
interface  {
};
3.4.5
</del>
<ins class="diff-chg">an
</ins>
<abbr title="Internationalized Resource Identifier">
IRI
</abbr>
<del class="diff-old">A
node
</del>
that
is
<del class="diff-old">an
</del>
<ins class="diff-chg">relative
some
other
</ins><a class="tref internalDFN" title="absolute-iri" href="#dfn-absolute-iri"><ins class="diff-chg">
absolute
</ins>
<abbr title="Internationalized Resource Identifier">
IRI
</abbr>
<del class="diff-old">.
    ]
interface  {
};
3.4.5.1
Attributes
value
of
type
DOMString
</del>
</a>
<del class="diff-old">,
readonly
The
IRI
identifier
</del>
<ins class="diff-chg">;
in
the
case
</ins>
of
<ins class="diff-new">JSON-LD
this
is
</ins>
the
<del class="diff-old">node
as
a
[
UNICODE
]
string.
</del>
<ins class="diff-chg">base
location
of
the
document.
</ins>
</dd>
<dt>
<del class="diff-old">3.4.6
Blank
Node
</del>
<dfn title="blank-node" id="dfn-blank-node">
<ins class="diff-chg">blank
node
</ins>
</dfn>
</dt>
<dd>
A
<a class="tref internalDFN" title="node" href="#dfn-node">
node
</a>
in
<del class="diff-old">the
linked
data
</del>
<ins class="diff-chg">a
</ins><a class="tref internalDFN" title="json-ld-graph" href="#dfn-json-ld-graph"><ins class="diff-chg">
JSON-LD
</ins>
graph
</a>
that
does
not
contain
a
<del class="diff-old">de-reference-able
</del>
<ins class="diff-chg">de-referenceable
</ins>
identifier
because
it
is
either
ephemeral
in
nature
or
does
not
contain
information
that
needs
to
be
linked
to
from
outside
of
the
<del class="diff-old">linked
data
graph
.
A
</del>
<ins class="diff-chg">JSON-LD
graph.
</ins></dd><dt><dfn title="blank-node-identifier" id="dfn-blank-node-identifier">
blank
node
<del class="diff-old">is
assigned
an
identifier
starting
with
the
prefix
_:
and
an
implementation
dependent,
auto-generated
suffix
that
is
unique
to
all
information
associated
with
the
particular
blank
node.
    ]
interface  {
};
3.4.6.1
Attributes
</del>
identifier
<del class="diff-old">of
type
DOMString
</del>
</dfn>
<del class="diff-old">,
readonly
</del>
</dt>
<dd>
<del class="diff-old">The
temporary
identifier
of
the
</del>
<ins class="diff-chg">A
</ins>
blank
node
<del class="diff-old">.
The
</del>
identifier
<del class="diff-old">must
not
be
relied
upon
in
any
way
between
two
separate
processing
runs
of
the
same
document
or
with
</del>
<ins class="diff-chg">is
</ins>
a
<del class="diff-old">different
document.
Note
Developers
and
authors
must
not
assume
</del>
<ins class="diff-chg">string
</ins>
that
<del class="diff-old">the
value
of
</del>
<ins class="diff-chg">can
be
used
as
an
identifier
for
</ins>
a
<a class="tref internalDFN" title="blank-node" href="#dfn-blank-node">
blank
node
</a>
<del class="diff-old">will
remain
the
same
between
two
processing
runs.
BlankNode
values
are
only
valid
for
the
most
recent
processing
run
on
</del>
<ins class="diff-chg">within
</ins>
the
<ins class="diff-new">scope
of
a
JSON-LD
</ins>
document.
<ins class="diff-chg">Blank
node
identifiers
begin
with
</ins>
<code>
<del class="diff-old">BlankNode
values
will
often
be
generated
differently
by
different
processors.
Note
Implementers
must
ensure
that
</del>
<ins class="diff-chg">_:
</ins></code>.</dd><dt>
<del class="diff-old">BlankNode
</del>
<dfn title="json-ld-value" id="dfn-json-ld-value">
<ins class="diff-chg">JSON-LD
value
</ins></dfn>
</dt>
<dd>
<ins class="diff-new">A
</ins><a class="tref internalDFN" title="json-ld-value" href="#dfn-json-ld-value"><ins class="diff-new">
JSON-LD
value
</ins>
</a>
<del class="diff-old">values
are
unique
within
the
current
environment,
two
BlankNodes
</del>
<ins class="diff-chg">is
a
</ins><a class="tref internalDFN" title="string" href="#dfn-string"><ins class="diff-chg">
string
</ins></a>,<ins class="diff-chg">
a
</ins><a class="tref internalDFN" title="number" href="#dfn-number"><ins class="diff-chg">
number
</ins></a>,<a class="tref internalDFN" title="true" href="#dfn-true"><ins class="diff-chg">
true
</ins>
</a>
<del class="diff-old">are
considered
equal
if,
and
only
if,
their
values
are
strictly
equal.
</del>
<ins class="diff-chg">or
</ins><a class="tref internalDFN" title="false" href="#dfn-false"><ins class="diff-chg">
false
</ins></a>,<ins class="diff-chg">
a
</ins><a class="tref internalDFN" title="typed-value" href="#dfn-typed-value"><ins class="diff-chg">
typed
value
</ins></a>,<ins class="diff-chg">
or
a
</ins><a class="tref internalDFN" title="language-tagged-string" href="#dfn-language-tagged-string"><ins class="diff-chg">
language-tagged
string
</ins></a>.</dd><dt>
<dfn title="typed-value" id="dfn-typed-value">
<ins class="diff-chg">typed
value
</ins></dfn>
<del class="diff-old">3.4.7
Literal
Literals
represent
values
such
as
numbers,
dates
and
strings
in
RDF
data.
</del>
</dt>
<dd>
A
<del class="diff-old">Literal
</del>
<a class="tref internalDFN" title="typed-value" href="#dfn-typed-value">
<ins class="diff-chg">typed
value
</ins>
</a>
<del class="diff-old">is
comprised
</del>
<ins class="diff-chg">consists
</ins>
of
<del class="diff-old">three
attributes:
</del>
a
<del class="diff-old">lexical
form
of
the
value
an
optional
language
tag
</del>
<ins class="diff-chg">value,
which
is
</ins>
a
<del class="diff-old">datatype
specified
by
</del>
<ins class="diff-chg">string,
and
a
type,
which
is
</ins>
an
<a class="tref internalDFN" title="iri" href="#dfn-iri">
<abbr title="Internationalized Resource Identifier">
IRI
</abbr>
</a>.
</dd>
<dt>
<dfn title="language-tagged-string" id="dfn-language-tagged-string">
<ins class="diff-chg">language-tagged
string
</ins></dfn>
<del class="diff-old">Literals
representing
plain
text
in
</del>
</dt>
<dd>
<ins class="diff-chg">A
</ins><a class="tref internalDFN" title="language-tagged-string" href="#dfn-language-tagged-string"><ins class="diff-chg">
language-tagged
string
</ins></a><ins class="diff-chg">
consists
of
</ins>
a
<del class="diff-old">natural
language
may
have
</del>
<ins class="diff-chg">string
and
</ins>
a
<ins class="diff-chg">non-empty
</ins>
language
tag
<del class="diff-old">specified
by
a
string
token,
</del>
as
<del class="diff-old">specified
in
</del>
<ins class="diff-chg">defined
by
</ins>
[
<cite>
<a class="bibref" href="#bib-BCP47">
BCP47
</a>
</cite>
<del class="diff-old">],
normalized
to
lowercase
(e.g.,
'en'
,
'fr'
,
'en-gb'
).
They
also
have
a
datatype
attribute
such
as
xsd:string
.
If
unspecified,
the
datatype
defaults
</del>
<ins class="diff-chg">].
The
language
tag
must
be
well-formed
according
</ins>
to
<del class="diff-old">xsd:string
.
Literals
representing
values
with
a
specific
datatype,
such
as
the
integer
72,
may
have
a
datatype
attribute
specified
in
the
form
of
a
IRI
(e.g.,
xsd:integer
).
See[
RDF-CONCEPTS
]
definition
for
literal
</del>
<a href="http://tools.ietf.org/html/bcp47#section-2.2.9">
<ins class="diff-chg">section
2.2.9
</ins>
</a>
<del class="diff-old">.
      ]
interface  {
};
3.4.7.1
Attributes
datatype
</del>
of
<del class="diff-old">type
IRI
,
readonly,
nullable
An
optional
datatype
identified
by
a
IRI
.
language
of
type
DOMString
,
readonly,
nullable
An
optional
language
tag
as
defined
in
</del>
[
<cite>
<a class="bibref" href="#bib-BCP47">
BCP47
</a>
</cite>
],
<ins class="diff-new">and
is
</ins>
normalized
to
lowercase.
</dd>
<dt>
<del class="diff-old">value
of
type
DOMString
</del>
<dfn title="list" id="dfn-list">
<ins class="diff-chg">list
</ins></dfn>
<del class="diff-old">,
readonly
</del>
</dt>
<dd>
<del class="diff-old">The
lexical
form
</del>
<ins class="diff-chg">A
</ins><a class="tref internalDFN" title="list" href="#dfn-list"><ins class="diff-chg">
list
</ins></a><ins class="diff-chg">
is
an
ordered
sequence
</ins>
of
<del class="diff-old">the
Literal's
value.
</del>
<a class="tref internalDFN" title="iri" href="#dfn-iri">
<ins class="diff-chg">IRIs
</ins></a>,<a class="tref internalDFN" title="blank-node" href="#dfn-blank-node"><ins class="diff-chg">
blank
nodes
</ins></a>,<ins class="diff-chg">
and
</ins><a class="tref internalDFN" title="json-ld-value" href="#dfn-json-ld-value"><ins class="diff-chg">
JSON-LD
values
</ins></a>.
</dd>
</dl>
</section>
<section id="algorithm-terms">
<h2>
<span class="secno">
<del class="diff-old">4.
Algorithms
All
algorithms
described
in
this
section
are
intended
to
operate
on
language-native
data
structures.
That
is,
the
serialization
to
a
text-based
JSON
document
isn't
required
as
input
or
output
to
any
of
these
algorithms
and
language-native
data
structures
must
be
used
where
applicable.
4.1
</del>
<ins class="diff-chg">5.
</ins>
</span>
Algorithm
Terms
</h2>
<dl>
<dt>
<del class="diff-old">initial
context
</del>
<dfn title="active-graph" id="dfn-active-graph">
<ins class="diff-chg">active
graph
</ins>
</dfn>
</dt>
<dd>
<del class="diff-old">a
context
that
is
specified
to
the
algorithm
before
processing
begins.
</del>
The
<del class="diff-old">contents
</del>
<ins class="diff-chg">name
</ins>
of
the
<del class="diff-old">initial
context
is
defined
in
Appendix
A
.
active
subject
the
</del>
currently
active
<del class="diff-old">subject
</del>
<ins class="diff-chg">graph
</ins>
that
the
processor
should
use
when
processing.
</dd>
<dt>
<dfn title="active-subject" id="dfn-active-subject">
active
<del class="diff-old">property
</del>
<ins class="diff-chg">subject
</ins>
</dfn>
</dt>
<dd>
<del class="diff-old">the
</del>
<ins class="diff-chg">The
</ins>
currently
active
<del class="diff-old">property
</del>
<ins class="diff-chg">subject
</ins>
that
the
processor
should
use
when
processing.
<del class="diff-old">The
active
property
is
represented
in
the
original
lexical
form,
which
is
used
for
finding
coercion
mappings
in
the
active
context
.
</del>
</dd>
<dt>
<dfn title="active-property" id="dfn-active-property">
active
<del class="diff-old">object
</del>
<ins class="diff-chg">property
</ins>
</dfn>
</dt>
<dd>
<del class="diff-old">the
</del>
<ins class="diff-chg">The
</ins>
currently
active
<del class="diff-old">object
</del>
<a class="tref internalDFN" title="property" href="#dfn-property">
<ins class="diff-chg">property
</ins></a><ins class="diff-chg">
or
</ins><a class="tref internalDFN" title="keyword" href="#dfn-keyword"><ins class="diff-chg">
keyword
</ins></a>
that
the
processor
should
use
when
processing.
</dd>
<dt>
<dfn title="active-context" id="dfn-active-context">
active
context
</dfn>
</dt>
<dd>
<del class="diff-old">a
</del>
<ins class="diff-chg">A
</ins>
context
that
is
used
to
resolve
<a class="tref internalDFN" title="term" href="#dfn-term">
<del class="diff-old">term
</del>
<ins class="diff-chg">terms
</ins>
</a>
<del class="diff-old">s
</del>
while
the
processing
algorithm
is
running.
<del class="diff-old">The
active
</del>
</dd>
<dt>
<dfn title="local-context" id="dfn-local-context">
<ins class="diff-chg">local
</ins>
context
<del class="diff-old">is
the
</del>
</dfn>
</dt>
<dd>
<ins class="diff-chg">A
</ins>
context
<del class="diff-old">contained
</del>
<ins class="diff-chg">that
is
specified
</ins>
within
<ins class="diff-new">a
</ins><a class="tref internalDFN" title="json-object" href="#dfn-json-object"><ins class="diff-new">
JSON
object
</ins></a>,<ins class="diff-new">
specified
via
</ins>
the
<del class="diff-old">processor
state
</del>
<code>
<ins class="diff-chg">@context
</ins></code><a class="tref internalDFN" title="keyword" href="#dfn-keyword"><ins class="diff-chg">
keyword
</ins>
</a>.
</dd>
<dt>
<dfn title="json-ld-input" id="dfn-json-ld-input">
<ins class="diff-chg">JSON-LD
input
</ins></dfn></dt><dd><ins class="diff-chg">
The
JSON-LD
data
structure
that
is
provided
as
input
to
the
algorithm.
</ins></dd><dt><dfn title="term" id="dfn-term"><ins class="diff-chg">
term
</ins></dfn></dt><dd><ins class="diff-chg">
A
</ins><a class="tref internalDFN" title="term" href="#dfn-term"><ins class="diff-chg">
term
</ins></a><ins class="diff-chg">
is
a
short
word
defined
in
a
context
that
may
be
expanded
to
an
</ins><a class="tref internalDFN" title="iri" href="#dfn-iri"><abbr title="Internationalized Resource Identifier"><ins class="diff-chg">
IRI
</ins></abbr></a></dd><dt><dfn title="compact-iri" id="dfn-compact-iri">
compact
<abbr title="Internationalized Resource Identifier">
IRI
</abbr>
</dfn>
</dt>
<dd>
<del class="diff-old">a
</del>
<ins class="diff-chg">A
</ins>
compact
<abbr title="Internationalized Resource Identifier">
IRI
</abbr>
is
has
the
form
of
<dfn title="prefix" id="dfn-prefix">
prefix
<del class="diff-old">and
</del>
</dfn>:
<em>
suffix
</em>
and
is
used
as
a
way
of
expressing
an
<abbr title="Internationalized Resource Identifier">
IRI
</abbr>
without
needing
to
define
separate
<a class="tref internalDFN" title="term" href="#dfn-term">
term
</a>
definitions
for
each
<abbr title="Internationalized Resource Identifier">
IRI
</abbr>
contained
within
a
common
vocabulary
identified
by
<a class="tref internalDFN" title="prefix" href="#dfn-prefix">
prefix
</a>.
</dd>
<dt>
<del class="diff-old">local
context
</del>
<dfn title="node-object" id="dfn-node-object">
<ins class="diff-chg">node
object
</ins>
</dfn>
</dt>
<dd>
<ins class="diff-new">A
</ins><a class="tref internalDFN" title="node-object" href="#dfn-node-object"><ins class="diff-new">
node
object
</ins></a><ins class="diff-new">
represents
zero
or
more
properties
of
</ins>
a
<del class="diff-old">context
that
</del>
<a class="tref internalDFN" title="node" href="#dfn-node">
<ins class="diff-chg">node
</ins></a><ins class="diff-chg">
in
the
</ins><a class="tref internalDFN" title="json-ld-graph" href="#dfn-json-ld-graph"><ins class="diff-chg">
JSON-LD
graph
</ins></a><ins class="diff-chg">
serialized
by
the
JSON-LD
document.
A
</ins><a class="tref internalDFN" title="json-object" href="#dfn-json-object"><ins class="diff-chg">
JSON
object
</ins></a>
is
<del class="diff-old">specified
within
</del>
a
<a class="tref internalDFN" title="node-object" href="#dfn-node-object">
<ins class="diff-chg">node
object
</ins></a><ins class="diff-chg">
if
it
exists
outside
of
the
JSON-LD
</ins><a class="tref internalDFN" title="context" href="#dfn-context"><ins class="diff-chg">
context
</ins></a><ins class="diff-chg">
and:
</ins><ul><li><ins class="diff-chg">
it
does
not
contain
the
</ins><code><ins class="diff-chg">
@value
</ins></code>,<code><ins class="diff-chg">
@list
</ins></code>,<ins class="diff-chg">
or
</ins><code><ins class="diff-chg">
@set
</ins></code><ins class="diff-chg">
keywords,
or
</ins></li><li><ins class="diff-chg">
it
is
not
the
top-most
</ins><a class="tref internalDFN" title="json-object" href="#dfn-json-object">
JSON
object
<del class="diff-old">,
specified
via
</del>
</a>
<ins class="diff-chg">in
</ins>
the
<ins class="diff-new">JSON-LD
document
consisting
of
no
other
members
than
</ins>
<code>
<del class="diff-old">@context
</del>
<ins class="diff-chg">@graph
</ins>
</code>
<del class="diff-old">keyword
.
</del>
<ins class="diff-chg">and
</ins><code><ins class="diff-chg">
@context
</ins></code>.</li></ul>
</dd>
<dt>
<del class="diff-old">processor
state
</del>
<dfn title="value-object" id="dfn-value-object">
<ins class="diff-chg">value
object
</ins>
</dfn>
</dt>
<dd>
<del class="diff-old">the
processor
state
,
which
includes
the
active
context
,
active
subject
,
and
active
property
.
The
processor
state
</del>
<ins class="diff-chg">A
</ins><a class="tref internalDFN" title="value-object" href="#dfn-value-object"><ins class="diff-chg">
value
object
</ins>
</a>
is
<del class="diff-old">managed
as
</del>
a
<del class="diff-old">stack
with
elements
from
the
previous
processor
state
copied
into
a
new
processor
state
when
entering
a
new
</del>
<a class="tref internalDFN" title="json-object" href="#dfn-json-object">
JSON
object
<del class="diff-old">.
</del>
</a>
<ins class="diff-chg">that
has
an
</ins><code><ins class="diff-chg">
@value
</ins></code><ins class="diff-chg">
member.
</ins>
</dd>
<dt>
<del class="diff-old">JSON-LD
input
</del>
<dfn title="list-object" id="dfn-list-object">
<ins class="diff-chg">list
object
</ins>
</dfn>
</dt>
<dd>
<del class="diff-old">The
JSON-LD
data
structure
that
</del>
<ins class="diff-chg">A
</ins><a class="tref internalDFN" title="list-object" href="#dfn-list-object"><ins class="diff-chg">
list
object
</ins></a>
is
<del class="diff-old">provided
as
input
to
the
algorithm.
</del>
<ins class="diff-chg">a
</ins><a class="tref internalDFN" title="json-object" href="#dfn-json-object"><ins class="diff-chg">
JSON
object
</ins></a><ins class="diff-chg">
that
has
an
</ins><code><ins class="diff-chg">
@list
</ins></code><ins class="diff-chg">
member.
</ins>
</dd>
<dt>
<del class="diff-old">JSON-LD
output
</del>
<dfn title="set-object" id="dfn-set-object">
<ins class="diff-chg">set
object
</ins>
</dfn>
</dt>
<dd>
<del class="diff-old">The
JSON-LD
data
structure
that
</del>
<ins class="diff-chg">A
</ins><a class="tref internalDFN" title="set-object" href="#dfn-set-object"><ins class="diff-chg">
set
object
</ins></a>
is
<del class="diff-old">produced
as
output
by
the
algorithm.
</del>
<ins class="diff-chg">a
</ins><a class="tref internalDFN" title="json-object" href="#dfn-json-object"><ins class="diff-chg">
JSON
object
</ins></a><ins class="diff-chg">
that
has
an
</ins><code><ins class="diff-chg">
@set
</ins></code><ins class="diff-chg">
member.
</ins>
</dd>
<dt>
<del class="diff-old">term
</del>
<dfn title="scalar" id="dfn-scalar">
<ins class="diff-chg">scalar
</ins>
</dfn>
</dt>
<dd>
A
<del class="diff-old">term
</del>
<ins class="diff-chg">scalar
</ins>
is
<ins class="diff-new">either
</ins>
a
<del class="diff-old">short
word
defined
in
a
context
that
may
be
expanded
to
an
IRI
</del>
<ins class="diff-chg">JSON
</ins><a class="tref internalDFN" title="string" href="#dfn-string"><ins class="diff-chg">
string
</ins></a>,<a class="tref internalDFN" title="number" href="#dfn-number"><ins class="diff-chg">
number
</ins></a>,<a class="tref internalDFN" title="true" href="#dfn-true"><ins class="diff-chg">
true
</ins></a>,<ins class="diff-chg">
or
</ins><a class="tref internalDFN" title="false" href="#dfn-false"><ins class="diff-chg">
false
</ins></a>.
</dd>
<dt>
<del class="diff-old">prefix
</del>
<dfn title="rdf-subject" id="dfn-rdf-subject">
<ins class="diff-chg">RDF
subject
</ins>
</dfn>
</dt>
<dd>
A
<del class="diff-old">prefix
is
a
term
</del>
<a class="tref externalDFN" title="subject" href="http://www.w3.org/TR/rdf11-concepts/#dfn-subject">
<ins class="diff-chg">subject
</ins>
</a>
<del class="diff-old">that
expands
to
a
vocabulary
base
IRI
.
It
is
typically
used
along
with
a
suffix
to
form
a
compact
IRI
</del>
<ins class="diff-chg">as
specified
by
[
</ins><cite>
<a class="bibref" href="#bib-RDF11-CONCEPTS">
<ins class="diff-new">RDF11-CONCEPTS
</ins>
</a>
<del class="diff-old">to
create
an
IRI
within
a
vocabulary.
</del>
</cite>
<ins class="diff-chg">].
</ins>
</dd>
<dt>
<del class="diff-old">language-tagged
literal
</del>
<dfn title="rdf-predicate" id="dfn-rdf-predicate">
<ins class="diff-chg">RDF
predicate
</ins>
</dfn>
</dt>
<dd>
A
<del class="diff-old">language-tagged
literal
is
a
literal
</del>
<a class="tref externalDFN" title="predicate" href="http://www.w3.org/TR/rdf11-concepts/#dfn-predicate">
<ins class="diff-chg">predicate
</ins>
</a>
<del class="diff-old">without
a
datatype,
including
a
language.
See
</del>
<ins class="diff-chg">as
specified
by
[
</ins>
<cite>
<del class="diff-old">literal
</del>
<a class="bibref" href="#bib-RDF11-CONCEPTS">
<ins class="diff-chg">RDF11-CONCEPTS
</ins>
</a>
</cite>
<del class="diff-old">in
</del>
<ins class="diff-chg">].
</ins></dd><dt><dfn title="rdf-object" id="dfn-rdf-object"><ins class="diff-chg">
RDF
object
</ins></dfn></dt><dd><ins class="diff-chg">
An
</ins><a class="tref externalDFN" title="object" href="http://www.w3.org/TR/rdf11-concepts/#dfn-object"><ins class="diff-chg">
object
</ins></a><ins class="diff-chg">
as
specified
by
</ins>
[
<cite>
<del class="diff-old">RDF-CONCEPTS
</del>
<a class="bibref" href="#bib-RDF11-CONCEPTS">
<ins class="diff-chg">RDF11-CONCEPTS
</ins>
</a>
</cite>
].
</dd>
<dt>
<del class="diff-old">typed
literal
</del>
<dfn title="rdf-triple" id="dfn-rdf-triple">
<ins class="diff-chg">RDF
triple
</ins>
</dfn>
</dt>
<dd>
A
<del class="diff-old">typed
literal
is
a
literal
with
an
associated
IRI
</del>
<a class="tref externalDFN" title="triple" href="http://www.w3.org/TR/rdf11-concepts/#dfn-rdf-triple">
<ins class="diff-chg">triple
</ins>
</a>
<del class="diff-old">which
indicates
the
literal's
datatype.
See
</del>
<ins class="diff-chg">as
specified
by
[
</ins>
<cite>
<del class="diff-old">language-tagged
string
</del>
<a class="bibref" href="#bib-RDF11-CONCEPTS">
<ins class="diff-chg">RDF11-CONCEPTS
</ins>
</a>
</cite>
<del class="diff-old">in
</del>
<ins class="diff-chg">].
</ins></dd><dt><dfn title="rdf-dataset" id="dfn-rdf-dataset"><ins class="diff-chg">
RDF
dataset
</ins></dfn></dt><dd><ins class="diff-chg">
A
</ins><a class="tref externalDFN" title="dataset" href="http://www.w3.org/TR/rdf11-concepts/#dfn-rdf-dataset"><ins class="diff-chg">
dataset
</ins></a><ins class="diff-chg">
as
specified
by
</ins>
[
<cite>
<del class="diff-old">RDF-CONCEPTS
</del>
<a class="bibref" href="#bib-RDF11-CONCEPTS">
<ins class="diff-chg">RDF11-CONCEPTS
</ins>
</a>
</cite>
<del class="diff-old">].
</del>
<ins class="diff-chg">]
representing
a
collection
of
</ins><a class="tref externalDFN" title="rdf-graphs" href="http://www.w3.org/TR/rdf11-concepts/#dfn-rdf-graph"><ins class="diff-chg">
RDF
graphs
</ins></a>.
</dd>
</dl>
</section>
<section id="context-processing-algorithms">
<h2>
<span class="secno">
<del class="diff-old">4.2
</del>
<ins class="diff-chg">6.
</ins>
</span>
Context
Processing
<ins class="diff-new">Algorithms
</ins></h2><section id="context-processing-algorithm"><h3><span class="secno"><ins class="diff-new">
6.1
</ins></span><ins class="diff-new">
Context
Processing
Algorithm
</ins>
</h3>
<p>
<del class="diff-old">Processing
of
</del>
<ins class="diff-chg">When
processing
a
</ins>
JSON-LD
data
<del class="diff-old">structure
is
managed
recursively.
During
processing,
</del>
<ins class="diff-chg">structure,
</ins>
each
<ins class="diff-new">processing
</ins>
rule
is
applied
using
information
provided
by
the
<a class="tref internalDFN" title="active-context" href="#dfn-active-context">
active
context
</a>.
<del class="diff-old">Processing
begins
by
pushing
a
new
processor
state
</del>
<ins class="diff-chg">This
section
describes
how
to
produce
an
</ins><a class="tref internalDFN" title="active-context" href="#dfn-active-context"><ins class="diff-chg">
active
context
</ins></a>.</p><p><ins class="diff-chg">
The
</ins><a class="tref internalDFN" title="active-context" href="#dfn-active-context"><ins class="diff-chg">
active
context
</ins>
</a>
<del class="diff-old">onto
</del>
<ins class="diff-chg">contains
</ins>
the
<del class="diff-old">processor
state
</del>
<ins class="diff-chg">active
</ins><dfn title="term-definition" id="dfn-term-definition"><ins class="diff-chg">
term
definitions
</ins></dfn><ins class="diff-chg">
which
specify
how
properties
and
values
have
to
be
interpreted
as
well
as
the
current
</ins><dfn title="base-iri" id="dfn-base-iri"><ins class="diff-chg">
base
</ins><abbr title="Internationalized Resource Identifier"><ins class="diff-chg">
IRI
</ins></abbr></dfn>,<ins class="diff-chg">
the
</ins><dfn title="vocabulary-mapping" id="dfn-vocabulary-mapping"><ins class="diff-chg">
vocabulary
mapping
</ins></dfn><ins class="diff-chg">
and
the
</ins><dfn title="default-language" id="dfn-default-language"><ins class="diff-chg">
default
language
</ins></dfn>.<ins class="diff-chg">
Each
</ins><a class="tref internalDFN" title="term-definition" href="#dfn-term-definition"><ins class="diff-chg">
term
definition
</ins>
</a>
<del class="diff-old">stack
</del>
<ins class="diff-chg">consists
of
an
</ins><dfn title="iri-mapping" id="dfn-iri-mapping"><abbr title="Internationalized Resource Identifier"><ins class="diff-chg">
IRI
</ins></abbr><ins class="diff-chg">
mapping
</ins></dfn>,<ins class="diff-chg">
a
boolean
flag
</ins><dfn title="reverse-property" id="dfn-reverse-property"><ins class="diff-chg">
reverse
property
</ins></dfn>,<ins class="diff-chg">
an
optional
</ins><dfn title="type-mapping" id="dfn-type-mapping"><ins class="diff-chg">
type
mapping
</ins></dfn><ins class="diff-chg">
or
</ins><dfn title="language-mapping" id="dfn-language-mapping"><ins class="diff-chg">
language
mapping
</ins></dfn>,
and
<del class="diff-old">initializing
</del>
<ins class="diff-chg">an
optional
</ins><dfn title="container-mapping" id="dfn-container-mapping"><ins class="diff-chg">
container
mapping
</ins></dfn>.<ins class="diff-chg">
A
</ins><a class="tref internalDFN" title="term-definition" href="#dfn-term-definition"><ins class="diff-chg">
term
definition
</ins></a><ins class="diff-chg">
can
not
only
be
used
to
map
a
</ins><a class="tref internalDFN" title="term" href="#dfn-term"><ins class="diff-chg">
term
</ins></a><ins class="diff-chg">
to
an
</ins><abbr title="Internationalized Resource Identifier"><ins class="diff-chg">
IRI
</ins></abbr>,<ins class="diff-chg">
but
also
to
map
a
</ins><a class="tref internalDFN" title="term" href="#dfn-term"><ins class="diff-chg">
term
</ins></a><ins class="diff-chg">
to
a
</ins><a class="tref internalDFN" title="keyword" href="#dfn-keyword"><ins class="diff-chg">
keyword
</ins></a>,<ins class="diff-chg">
in
which
case
it
is
referred
to
as
a
</ins><dfn title="keyword-alias" id="dfn-keyword-alias"><ins class="diff-chg">
keyword
alias
</ins></dfn>.</p><p><ins class="diff-chg">
When
processing,
</ins>
the
<a class="tref internalDFN" title="active-context" href="#dfn-active-context">
active
context
</a>
<del class="diff-old">with
the
initial
context
</del>
<ins class="diff-chg">is
initialized
without
any
</ins><a class="tref internalDFN" title="term-definition" href="#dfn-term-definition"><ins class="diff-chg">
term
definitions
</ins></a>,<a class="tref internalDFN" title="vocabulary-mapping" href="#dfn-vocabulary-mapping"><ins class="diff-chg">
vocabulary
mapping
</ins></a>,<ins class="diff-chg">
or
</ins><a class="tref internalDFN" title="default-language" href="#dfn-default-language"><ins class="diff-chg">
default
language
</ins>
</a>.
If
a
<a class="tref internalDFN" title="local-context" href="#dfn-local-context">
local
context
</a>
is
<del class="diff-old">encountered,
</del>
<ins class="diff-chg">encountered
during
processing,
a
new
</ins><a class="tref internalDFN" title="active-context" href="#dfn-active-context"><ins class="diff-chg">
active
context
</ins></a><ins class="diff-chg">
is
created
by
cloning
the
existing
</ins><a class="tref internalDFN" title="active-context" href="#dfn-active-context"><ins class="diff-chg">
active
context
</ins></a>.<ins class="diff-chg">
Then
the
</ins>
information
from
the
<a class="tref internalDFN" title="local-context" href="#dfn-local-context">
local
context
</a>
is
merged
into
the
<ins class="diff-chg">new
</ins><a class="tref internalDFN" title="active-context" href="#dfn-active-context">
active
context
</a>.
<ins class="diff-new">Given
that
</ins><a class="tref internalDFN" title="local-context" href="#dfn-local-context"><ins class="diff-new">
local
contexts
</ins></a><ins class="diff-new">
may
contain
references
to
remote
contexts,
this
includes
their
retrieval.
</ins>
</p>
<section class="informative">
<h4 id="general-solution">
<ins class="diff-new">General
Solution
</ins></h4>
<p>
<del class="diff-old">The
</del>
<em>
<ins class="diff-chg">This
section
is
non-normative.
</ins></em></p><p><ins class="diff-chg">
First
we
prepare
a
new
</ins><a class="tref internalDFN" title="active-context" href="#dfn-active-context">
active
context
</a>
<del class="diff-old">is
used
for
expanding
properties
and
values
</del>
<i>
<ins class="diff-chg">result
</ins></i><ins class="diff-chg">
by
cloning
the
current
</ins><a class="tref internalDFN" title="active-context" href="#dfn-active-context"><ins class="diff-chg">
active
context
</ins></a>.<ins class="diff-chg">
Then
we
normalize
the
form
the
passed
</ins><a class="tref internalDFN" title="local-context" href="#dfn-local-context"><ins class="diff-chg">
local
context
</ins></a><ins class="diff-chg">
to
an
</ins><a class="tref internalDFN" title="array" href="#dfn-array"><ins class="diff-chg">
array
</ins></a>.<a class="tref internalDFN" title="local-context" href="#dfn-local-context"><ins class="diff-chg">
Local
contexts
</ins></a><ins class="diff-chg">
may
be
in
the
form
</ins>
of
a
<a class="tref internalDFN" title="json-object" href="#dfn-json-object">
JSON
object
<del class="diff-old">(or
elements
of
</del>
</a>,
<ins class="diff-chg">a
</ins><a class="tref internalDFN" title="string" href="#dfn-string"><ins class="diff-chg">
string
</ins></a>,<ins class="diff-chg">
or
</ins>
an
<del class="diff-old">array)
using
</del>
<a class="tref internalDFN" title="array" href="#dfn-array">
<ins class="diff-chg">array
</ins></a><ins class="diff-chg">
containing
</ins>
a
<del class="diff-old">term
mapping
.
It
</del>
<ins class="diff-chg">combination
of
the
two.
Finally
we
process
each
</ins><a class="tref internalDFN" title="context" href="#dfn-context"><ins class="diff-chg">
context
</ins></a><ins class="diff-chg">
contained
in
the
</ins><a class="tref internalDFN" title="local-context" href="#dfn-local-context"><ins class="diff-chg">
local
context
</ins></a><a class="tref internalDFN" title="array" href="#dfn-array"><ins class="diff-chg">
array
</ins></a><ins class="diff-chg">
as
follows.
</ins></p><p><ins class="diff-chg">
If
</ins><a class="tref internalDFN" title="context" href="#dfn-context"><ins class="diff-chg">
context
</ins></a>
is
<del class="diff-old">also
used
to
maintain
coercion
mapping
s
from
terms
to
datatypes,
language
mapping
s
from
terms
</del>
<ins class="diff-chg">a
</ins><a class="tref internalDFN" title="string" href="#dfn-string"><ins class="diff-chg">
string
</ins></a>,<ins class="diff-chg">
it
represents
a
reference
</ins>
to
<del class="diff-old">language
codes,
and
list
mapping
s
</del>
<ins class="diff-chg">a
remote
context.
We
dereference
the
remote
context
</ins>
and
<del class="diff-old">set
mapping
s
for
terms.
Processors
must
use
</del>
<ins class="diff-chg">replace
</ins><a class="tref internalDFN" title="context" href="#dfn-context"><ins class="diff-chg">
context
</ins></a><ins class="diff-chg">
with
</ins>
the
<del class="diff-old">lexical
form
</del>
<ins class="diff-chg">value
</ins>
of
the
<del class="diff-old">property
when
creating
a
mapping,
as
lookup
</del>
<code>
<ins class="diff-chg">@context
</ins></code><ins class="diff-chg">
key
of
the
top-level
object
in
the
retrieved
JSON-LD
document.
If
there's
no
such
key,
an
invalid
remote
context
has
been
detected.
Otherwise,
we
process
</ins><a class="tref internalDFN" title="context" href="#dfn-context"><ins class="diff-chg">
context
</ins></a><ins class="diff-chg">
by
recursively
using
this
algorithm
ensuring
that
there
</ins>
is
<del class="diff-old">performed
on
lexical
forms,
not
expanded
IRI
representations.
</del>
<ins class="diff-chg">no
cyclical
reference.
</ins>
</p>
<p>
<del class="diff-old">A
local
</del>
<ins class="diff-chg">If
</ins><a class="tref internalDFN" title="context" href="#dfn-context">
context
</a>
is
<del class="diff-old">identified
within
</del>
a
<a class="tref internalDFN" title="json-object" href="#dfn-json-object">
JSON
object
</a>,
<ins class="diff-new">we
first
update
the
</ins><a class="tref internalDFN" title="base-iri" href="#dfn-base-iri"><ins class="diff-new">
base
</ins><abbr title="Internationalized Resource Identifier"><ins class="diff-new">
IRI
</ins></abbr></a>,<ins class="diff-new">
the
</ins><a class="tref internalDFN" title="vocabulary-mapping" href="#dfn-vocabulary-mapping"><ins class="diff-new">
vocabulary
mapping
</ins></a>,<ins class="diff-new">
and
the
</ins><a class="tref internalDFN" title="default-language" href="#dfn-default-language"><ins class="diff-new">
default
language
</ins>
</a>
<del class="diff-old">having
a
</del>
<ins class="diff-chg">by
processing
three
specific
keywords:
</ins>
<code>
<del class="diff-old">@context
property
with
a
string
</del>
<ins class="diff-chg">@base
</ins></code>,<code><ins class="diff-chg">
@vocab
</ins></code>,<ins class="diff-chg">
and
</ins><code><ins class="diff-chg">
@language
</ins></code>.<ins class="diff-chg">
These
are
handled
before
any
other
keys
in
the
</ins><a class="tref internalDFN" title="local-context" href="#dfn-local-context"><ins class="diff-chg">
local
context
</ins></a><ins class="diff-chg">
because
they
affect
how
the
other
keys
are
processed.
</ins></p><p><ins class="diff-chg">
Then,
for
every
other
key
in
</ins><a class="tref internalDFN" title="local-context" href="#dfn-local-context"><ins class="diff-chg">
local
context
</ins>
</a>,
<del class="diff-old">array
</del>
<ins class="diff-chg">we
update
the
</ins><a class="tref internalDFN" title="term-definition" href="#dfn-term-definition"><ins class="diff-chg">
term
definition
</ins>
</a>
<del class="diff-old">or
a
JSON
object
</del>
<ins class="diff-chg">in
</ins><i><ins class="diff-chg">
result
</ins></i>.<ins class="diff-chg">
Since
</ins><a class="tref internalDFN" title="term-definition" href="#dfn-term-definition"><ins class="diff-chg">
term
definitions
</ins>
</a>
<del class="diff-old">value.
When
processing
</del>
<ins class="diff-chg">in
</ins>
a
<a class="tref internalDFN" title="local-context" href="#dfn-local-context">
local
context
</a>
<ins class="diff-new">may
themselves
contain
</ins><a class="tref internalDFN" title="term" href="#dfn-term"><ins class="diff-new">
terms
</ins></a><ins class="diff-new">
or
</ins><a class="tref internalDFN" title="compact-iri" href="#dfn-compact-iri"><ins class="diff-new">
compact
IRIs
</ins>
</a>,
<del class="diff-old">special
processing
rules
apply:
</del>
<ins class="diff-chg">we
may
need
to
recurse.
When
doing
so,
we
must
ensure
that
there
is
no
cyclical
dependency,
which
is
an
error.
After
we
have
processed
any
</ins><a class="tref internalDFN" title="term-definition" href="#dfn-term-definition"><ins class="diff-chg">
term
definition
</ins></a><ins class="diff-chg">
dependencies,
we
update
the
current
</ins><a class="tref internalDFN" title="term-definition" href="#dfn-term-definition"><ins class="diff-chg">
term
definition
</ins></a>,<ins class="diff-chg">
which
may
be
a
</ins><a class="tref internalDFN" title="keyword-alias" href="#dfn-keyword-alias"><ins class="diff-chg">
keyword
alias
</ins></a>.
</p>
<del class="diff-old">Create
</del>
<p>
<ins class="diff-chg">Finally,
we
return
</ins><i><ins class="diff-chg">
result
</ins></i><ins class="diff-chg">
as
the
new
</ins><a class="tref internalDFN" title="active-context" href="#dfn-active-context"><ins class="diff-chg">
active
context
</ins></a>.</p></section><section><h4 id="algorithm"><ins class="diff-chg">
Algorithm
</ins></h4><p><ins class="diff-chg">
This
algorithm
specifies
how
</ins>
a
<del class="diff-old">new,
empty
</del>
<ins class="diff-chg">new
</ins><a class="tref internalDFN" title="active-context" href="#dfn-active-context"><ins class="diff-chg">
active
context
</ins></a><ins class="diff-chg">
is
updated
with
a
</ins><a class="tref internalDFN" title="local-context" href="#dfn-local-context">
local
context
</a>.
<del class="diff-old">Let
context
be
the
value
of
@context
If
</del>
<ins class="diff-chg">The
algorithm
takes
three
input
variables:
an
</ins><a class="tref internalDFN" title="active-context" href="#dfn-active-context"><ins class="diff-chg">
active
</ins>
context
<del class="diff-old">equals
null
</del>
</a>,
<del class="diff-old">reset
the
active
</del>
<ins class="diff-chg">a
</ins><a class="tref internalDFN" title="local-context" href="#dfn-local-context"><ins class="diff-chg">
local
</ins>
context
</a>,
<ins class="diff-new">and
an
</ins><a class="tref internalDFN" title="array" href="#dfn-array"><ins class="diff-new">
array
</ins>
</a>
<i>
<ins class="diff-new">remote
contexts
</ins></i><ins class="diff-new">
which
is
used
to
detect
cyclical
context
inclusions.
If
</ins><i><ins class="diff-new">
remote
contexts
</ins></i><ins class="diff-new">
is
not
passed,
it
is
initialized
to
an
empty
</ins><a class="tref internalDFN" title="array" href="#dfn-array"><ins class="diff-new">
array
</ins></a>.</p><ol class="algorithm"><li><ins class="diff-new">
Initialize
</ins><i><ins class="diff-new">
result
</ins></i>
to
the
<del class="diff-old">initial
</del>
<ins class="diff-chg">result
of
cloning
</ins><a class="tref internalDFN" title="active-context" href="#dfn-active-context"><ins class="diff-chg">
active
</ins>
context
</a>.
</li>
<li>
If
<a class="tref internalDFN" title="local-context" href="#dfn-local-context">
<ins class="diff-chg">local
</ins>
context
</a>
is
<ins class="diff-new">not
</ins>
an
<a class="tref internalDFN" title="array" href="#dfn-array">
array
</a>,
<del class="diff-old">process
</del>
<ins class="diff-chg">set
it
to
an
</ins><a class="tref internalDFN" title="array" href="#dfn-array"><ins class="diff-chg">
array
</ins></a><ins class="diff-chg">
containing
only
</ins><a class="tref internalDFN" title="local-context" href="#dfn-local-context"><ins class="diff-chg">
local
context
</ins></a>.</li><li><ins class="diff-chg">
For
</ins>
each
<del class="diff-old">element
as
</del>
<ins class="diff-chg">item
</ins><i>
context
</i>
in
<del class="diff-old">order
by
starting
at
Step
2.1
.
</del>
<a class="tref internalDFN" title="local-context" href="#dfn-local-context">
<ins class="diff-chg">local
context
</ins></a>:<ol class="algorithm"><li><ins class="diff-chg">
If
</ins><i><ins class="diff-chg">
context
</ins></i><ins class="diff-chg">
is
</ins><a class="tref internalDFN" title="null" href="#dfn-null"><ins class="diff-chg">
null
</ins></a>,<ins class="diff-chg">
set
</ins><i><ins class="diff-chg">
result
</ins></i><ins class="diff-chg">
to
a
newly-initialized
</ins><a class="tref internalDFN" title="active-context" href="#dfn-active-context"><ins class="diff-chg">
active
context
</ins></a><ins class="diff-chg">
and
continue
with
the
next
</ins><i><ins class="diff-chg">
context
</ins></i>.
</li>
<li>
If
<i>
context
</i>
is
a
<a class="tref internalDFN" title="string" href="#dfn-string">
string
</a>,
<del class="diff-old">it
must
have
</del>
<ol class="algorithm">
<li>
<ins class="diff-chg">Set
</ins><i><ins class="diff-chg">
context
</ins></i><ins class="diff-chg">
to
the
result
of
resolving
</ins><i><ins class="diff-chg">
value
</ins></i><ins class="diff-chg">
against
the
base
</ins><abbr title="Internationalized Resource Identifier"><ins class="diff-chg">
IRI
</ins></abbr><ins class="diff-chg">
which
is
established
as
specified
in
</ins><cite><a href="http://tools.ietf.org/html/rfc3986#section-5.1"><ins class="diff-chg">
section
5.1
Establishing
</ins>
a
<del class="diff-old">lexical
form
</del>
<ins class="diff-chg">Base
URI
</ins></a></cite>
of
<del class="diff-old">absolute
</del>
<ins class="diff-chg">[
</ins><cite><a class="bibref" href="#bib-RFC3986"><ins class="diff-chg">
RFC3986
</ins></a></cite><ins class="diff-chg">
].
Only
the
basic
algorithm
in
</ins><cite><a href="http://tools.ietf.org/html/rfc3986#section-5.2"><ins class="diff-chg">
section
5.2
</ins></a></cite><ins class="diff-chg">
of
[
</ins><cite><a class="bibref" href="#bib-RFC3986"><ins class="diff-chg">
RFC3986
</ins></a></cite><ins class="diff-chg">
]
is
used;
neither
</ins><cite><a href="http://tools.ietf.org/html/rfc3986#section-6.2.2"><ins class="diff-chg">
Syntax-Based
Normalization
</ins></a></cite><ins class="diff-chg">
nor
</ins><cite><a href="http://tools.ietf.org/html/rfc3986#section-6.2.3"><ins class="diff-chg">
Scheme-Based
Normalization
</ins></a></cite><ins class="diff-chg">
are
performed.
Characters
additionally
allowed
in
</ins>
<abbr title="Internationalized Resource Identifier">
IRI
</abbr>
<ins class="diff-new">references
are
treated
in
the
same
way
that
unreserved
characters
are
treated
in
URI
references,
per
</ins><cite><a href="http://tools.ietf.org/html/rfc3987#section-6.5"><ins class="diff-new">
section
6.5
</ins></a></cite><ins class="diff-new">
of
[
</ins><cite><a class="bibref" href="#bib-RFC3987"><ins class="diff-new">
RFC3987
</ins></a></cite><ins class="diff-new">
].
</ins></li><li><ins class="diff-new">
If
</ins><i><ins class="diff-new">
context
</ins></i><ins class="diff-new">
is
in
the
</ins><i><ins class="diff-new">
remote
contexts
</ins></i><ins class="diff-new">
array,
a
</ins><code class="error">
<a href="#idl-def-JsonLdErrorCode.recursive-context-inclusion">
<ins class="diff-new">recursive
context
inclusion
</ins></a></code><ins class="diff-new">
error
has
been
detected
and
processing
is
aborted;
otherwise,
add
</ins><i><ins class="diff-new">
context
</ins></i><ins class="diff-new">
to
</ins><i><ins class="diff-new">
remote
contexts
</ins></i>.</li><li><ins class="diff-new">
Initialize
</ins><i><ins class="diff-new">
context
no
base
</ins></i><ins class="diff-new">
to
the
result
of
cloning
the
</ins><a class="tref internalDFN" title="active-context" href="#dfn-active-context"><ins class="diff-new">
active
context
</ins>
</a>.
</li>
<li>
<del class="diff-old">Dereference
</del>
<ins class="diff-chg">Remove
the
</ins><a class="tref internalDFN" title="base-iri" href="#dfn-base-iri"><ins class="diff-chg">
base
</ins><abbr title="Internationalized Resource Identifier"><ins class="diff-chg">
IRI
</ins></abbr></a><ins class="diff-chg">
of
</ins><i>
context
<del class="diff-old">.
</del>
<ins class="diff-chg">no
base
</ins></i>.
</li>
<li>
<ins class="diff-new">Dereference
</ins><i><ins class="diff-new">
context
</ins></i>.
If
the
<del class="diff-old">resulting
</del>
<ins class="diff-chg">dereferenced
</ins>
document
<del class="diff-old">is
a
JSON
document,
extract
the
</del>
<ins class="diff-chg">has
no
</ins>
top-level
<a class="tref internalDFN" title="json-object" href="#dfn-json-object">
<ins class="diff-new">JSON
object
</ins></a><ins class="diff-new">
with
an
</ins>
<code>
@context
</code>
<del class="diff-old">element
using
the
JSON
Pointer
&quot;/@context&quot;
as
described
in
[
</del>
<ins class="diff-chg">member,
an
</ins><code class="error">
<del class="diff-old">JSON-POINTER
</del>
<a href="#idl-def-JsonLdErrorCode.invalid-remote-context">
<ins class="diff-chg">invalid
remote
context
</ins>
</a>
<del class="diff-old">].
</del>
</code>
<ins class="diff-chg">has
been
detected
and
processing
is
aborted;
otherwise,
set
</ins><i><ins class="diff-chg">
context
</ins></i><ins class="diff-chg">
to
the
value
of
that
member.
</ins></li><li>
Set
<i>
context
</i>
to
the
<del class="diff-old">extracted
content
</del>
<ins class="diff-chg">result
of
recursively
calling
this
algorithm,
passing
</ins><i><ins class="diff-chg">
context
no
base
</ins></i><ins class="diff-chg">
for
</ins><a class="tref internalDFN" title="active-context" href="#dfn-active-context"><ins class="diff-chg">
active
context
</ins></a>,<i><ins class="diff-chg">
context
</ins></i><ins class="diff-chg">
for
</ins><a class="tref internalDFN" title="local-context" href="#dfn-local-context"><ins class="diff-chg">
local
context
</ins></a>,
and
<del class="diff-old">process
it
by
starting
at
Step
2.1
.
</del>
<i>
<ins class="diff-chg">remote
contexts
</ins></i>.</li><li><ins class="diff-chg">
If
</ins><i><ins class="diff-chg">
context
</ins></i><ins class="diff-chg">
has
no
</ins><a class="tref internalDFN" title="base-iri" href="#dfn-base-iri"><ins class="diff-chg">
base
</ins><abbr title="Internationalized Resource Identifier"><ins class="diff-chg">
IRI
</ins></abbr></a><ins class="diff-chg">
but
</ins><i><ins class="diff-chg">
result
</ins></i><ins class="diff-chg">
does,
set
the
</ins><a class="tref internalDFN" title="base-iri" href="#dfn-base-iri"><ins class="diff-chg">
base
</ins><abbr title="Internationalized Resource Identifier"><ins class="diff-chg">
IRI
</ins></abbr></a><ins class="diff-chg">
of
</ins><i><ins class="diff-chg">
context
</ins></i><ins class="diff-chg">
to
the
one
of
</ins><i><ins class="diff-chg">
result
</ins></i>.</li><li><ins class="diff-chg">
Overwrite
</ins><i><ins class="diff-chg">
result
</ins></i><ins class="diff-chg">
with
</ins><i><ins class="diff-chg">
context
</ins></i><ins class="diff-chg">
and
continue
with
the
next
</ins><i><ins class="diff-chg">
context
</ins></i>.
</li>
</ol>
</li>
<li>
If
<i>
context
</i>
is
<ins class="diff-new">not
</ins>
a
<a class="tref internalDFN" title="json-object" href="#dfn-json-object">
JSON
object
</a>,
<del class="diff-old">perform
the
following
steps:
</del>
<ins class="diff-chg">an
</ins><code class="error"><a href="#idl-def-JsonLdErrorCode.invalid-local-context"><ins class="diff-chg">
invalid
local
context
</ins></a></code><ins class="diff-chg">
error
has
been
detected
and
processing
is
aborted.
</ins></li>
<li>
If
<i>
context
</i>
has
<del class="diff-old">a
</del>
<ins class="diff-chg">an
</ins>
<code>
<del class="diff-old">@language
</del>
<ins class="diff-chg">@base
</ins>
</code>
<del class="diff-old">property,
it
must
have
</del>
<ins class="diff-chg">key:
</ins><div class="issue"><div class="issue-title"><a href="https://github.com/json-ld/json-ld.org/issues/223"><span><ins class="diff-chg">
Issue
223
</ins></span></a>:<ins class="diff-chg">
Feature
at
risk
</ins></div><p class="atrisk"><ins class="diff-chg">
This
feature
is
at
risk
as
the
fact
that
</ins>
a
<del class="diff-old">value
</del>
<ins class="diff-chg">document
may
have
multiple
base
IRIs
is
potentially
confusing
for
developers.
It
is
also
being
discussed
whether
relative
IRIs
are
allowed
as
values
</ins>
of
<del class="diff-old">a
simple
string
</del>
<code>
<ins class="diff-chg">@base
</ins></code>
or
<del class="diff-old">null
.
Add
</del>
<ins class="diff-chg">whether
</ins>
the
<del class="diff-old">language
</del>
<ins class="diff-chg">empty
string
should
be
used
to
explicitly
specify
that
there
isn't
a
base
</ins><abbr title="Internationalized Resource Identifier"><ins class="diff-chg">
IRI
</ins></abbr>,<ins class="diff-chg">
which
could
be
used
to
ensure
that
relative
IRIs
remain
relative
when
expanding.
</ins></p></div><ol class="algorithm"><li><ins class="diff-chg">
Initialize
</ins><i><ins class="diff-chg">
value
</ins></i>
to
the
<del class="diff-old">local
context
.
Otherwise,
for
each
property
in
context
perform
</del>
<ins class="diff-chg">value
associated
with
</ins>
the
<del class="diff-old">following
steps:
</del>
<code>
<ins class="diff-chg">@base
</ins></code><ins class="diff-chg">
key.
</ins></li>
<li>
If
<i>
<ins class="diff-new">value
</ins></i><ins class="diff-new">
is
</ins><a class="tref internalDFN" title="null" href="#dfn-null"><ins class="diff-new">
null
</ins></a>,<ins class="diff-new">
remove
</ins>
the
<del class="diff-old">property's
</del>
<a class="tref internalDFN" title="base-iri" href="#dfn-base-iri">
<ins class="diff-chg">base
</ins><abbr title="Internationalized Resource Identifier"><ins class="diff-chg">
IRI
</ins></abbr></a><ins class="diff-chg">
of
</ins><i><ins class="diff-chg">
result
</ins></i>.</li><li><ins class="diff-chg">
Otherwise,
if
</ins><i>
value
</i>
is
<del class="diff-old">a
simple
string
</del>
<ins class="diff-chg">an
</ins><a class="tref internalDFN" title="absolute-iri" href="#dfn-absolute-iri"><ins class="diff-chg">
absolute
</ins><abbr title="Internationalized Resource Identifier"><ins class="diff-chg">
IRI
</ins></abbr>
</a>,
<del class="diff-old">determine
</del>
the
<a class="tref internalDFN" title="base-iri" href="#dfn-base-iri">
<ins class="diff-new">base
</ins>
<abbr title="Internationalized Resource Identifier">
IRI
</abbr>
<del class="diff-old">mapping
</del>
</a>
<ins class="diff-chg">of
</ins><i><ins class="diff-chg">
result
</ins></i><ins class="diff-chg">
is
set
to
</ins><i>
value
<del class="diff-old">by
performing
</del>
</i>.
<ins class="diff-chg">If
it
is
not
an
</ins><a class="tref internalDFN" title="absolute-iri" href="#dfn-absolute-iri"><ins class="diff-chg">
absolute
</ins><abbr title="Internationalized Resource Identifier"><ins class="diff-chg">
IRI
</ins></abbr>
</a>,
<ins class="diff-new">an
</ins><code class="error"><a href="#idl-def-JsonLdErrorCode.invalid-base-IRI"><ins class="diff-new">
invalid
base
</ins>
<abbr title="Internationalized Resource Identifier">
IRI
</abbr>
<del class="diff-old">Expansion
</del>
</a>
<del class="diff-old">on
</del>
</code>
<ins class="diff-chg">error
has
been
detected
and
processing
is
aborted.
</ins></li></ol></li><li><ins class="diff-chg">
If
</ins><i><ins class="diff-chg">
context
</ins></i><ins class="diff-chg">
has
an
</ins><code><ins class="diff-chg">
@vocab
</ins></code><ins class="diff-chg">
key:
</ins><ol class="algorithm"><li><ins class="diff-chg">
Initialize
</ins><i><ins class="diff-chg">
value
</ins></i><ins class="diff-chg">
to
</ins>
the
<ins class="diff-new">value
</ins>
associated
<del class="diff-old">value.
If
</del>
<ins class="diff-chg">with
</ins>
the
<code>
<ins class="diff-new">@vocab
</ins></code><ins class="diff-new">
key.
</ins></li><li><ins class="diff-new">
If
</ins><i><ins class="diff-new">
value
</ins></i><ins class="diff-new">
is
</ins><a class="tref internalDFN" title="null" href="#dfn-null"><ins class="diff-new">
null
</ins></a>,<ins class="diff-new">
remove
any
</ins><a class="tref internalDFN" title="vocabulary-mapping" href="#dfn-vocabulary-mapping"><ins class="diff-new">
vocabulary
mapping
</ins></a><ins class="diff-new">
from
</ins><i>
result
<del class="diff-old">of
the
</del>
</i>.
</li>
<li>
<ins class="diff-chg">Otherwise,
if
</ins><i><ins class="diff-chg">
value
</ins></i><ins class="diff-chg">
is
an
</ins><a class="tref internalDFN" title="absolute-iri" href="#dfn-absolute-iri"><ins class="diff-chg">
absolute
</ins>
<abbr title="Internationalized Resource Identifier">
IRI
</abbr>
</a>,
<ins class="diff-new">the
</ins><a class="tref internalDFN" title="vocabulary-mapping" href="#dfn-vocabulary-mapping"><ins class="diff-new">
vocabulary
</ins>
mapping
</a>
<ins class="diff-new">of
</ins><i><ins class="diff-new">
result
</ins></i><ins class="diff-new">
is
set
to
</ins><i><ins class="diff-new">
value
</ins></i>.<ins class="diff-new">
If
it
</ins>
is
<ins class="diff-new">not
</ins>
an
<a class="tref internalDFN" title="absolute-iri" href="#dfn-absolute-iri">
absolute
<abbr title="Internationalized Resource Identifier">
IRI
</abbr>
</a>,
<del class="diff-old">merge
the
property
into
the
local
context
term
</del>
<ins class="diff-chg">an
</ins><code class="error"><a href="#idl-def-JsonLdErrorCode.invalid-vocab-mapping"><ins class="diff-chg">
invalid
vocab
</ins>
mapping
<del class="diff-old">,
unless
the
property
</del>
</a>
</code>
<ins class="diff-chg">error
has
been
detected
and
processing
</ins>
is
<del class="diff-old">a
JSON-LD
keyword
,
in
which
case
throw
an
exception.
</del>
<ins class="diff-chg">aborted.
</ins></li></ol>
</li>
<li>
<del class="diff-old">Otherwise,
if
</del>
<ins class="diff-chg">If
</ins><i><ins class="diff-chg">
context
</ins></i><ins class="diff-chg">
has
an
</ins><code><ins class="diff-chg">
@language
</ins></code><ins class="diff-chg">
key:
</ins><ol class="algorithm"><li><ins class="diff-chg">
Initialize
</ins><i><ins class="diff-chg">
value
</ins></i><ins class="diff-chg">
to
</ins>
the
<del class="diff-old">property's
</del>
value
<ins class="diff-new">associated
with
the
</ins><code><ins class="diff-new">
@language
</ins></code><ins class="diff-new">
key.
</ins></li><li><ins class="diff-new">
If
</ins><i><ins class="diff-new">
value
</ins></i>
is
<a class="tref internalDFN" title="null" href="#dfn-null">
null
</a>,
remove
<del class="diff-old">mapping,
coercion,
container
and
</del>
<ins class="diff-chg">any
</ins><a class="tref internalDFN" title="default-language" href="#dfn-default-language"><ins class="diff-chg">
default
</ins>
language
<del class="diff-old">information
associated
with
property
</del>
</a>
from
<del class="diff-old">the
local
context
.
</del>
<i>
<ins class="diff-chg">result
</ins></i>.
</li>
<li>
Otherwise,
<ins class="diff-new">if
</ins><i><ins class="diff-new">
value
</ins></i><ins class="diff-new">
is
</ins><a class="tref internalDFN" title="string" href="#dfn-string"><ins class="diff-new">
string
</ins></a>,
the
<del class="diff-old">property
's
</del>
<a class="tref internalDFN" title="default-language" href="#dfn-default-language">
<ins class="diff-chg">default
language
</ins></a><ins class="diff-chg">
of
</ins><i><ins class="diff-chg">
result
</ins></i><ins class="diff-chg">
is
set
to
lowercased
</ins><i>
value
<del class="diff-old">must
be
a
JSON
object
.
</del>
</i>.
If
<del class="diff-old">the
property
</del>
<ins class="diff-chg">it
</ins>
is
<ins class="diff-new">not
</ins>
a
<del class="diff-old">JSON-LD
keyword
</del>
<a class="tref internalDFN" title="string" href="#dfn-string">
<ins class="diff-chg">string
</ins></a>,<ins class="diff-chg">
an
</ins><code class="error"><a href="#idl-def-JsonLdErrorCode.invalid-default-language"><ins class="diff-chg">
invalid
default
language
</ins>
</a>
</code>
<ins class="diff-new">error
has
been
detected
</ins>
and
<del class="diff-old">the
value
</del>
<ins class="diff-chg">processing
is
aborted.
</ins></li></ol></li><li><ins class="diff-chg">
Create
a
</ins><a class="tref internalDFN" title="json-object" href="#dfn-json-object"><ins class="diff-chg">
JSON
object
</ins></a><i><ins class="diff-chg">
defined
</ins></i><ins class="diff-chg">
to
use
to
keep
track
of
whether
or
not
a
</ins><a class="tref internalDFN" title="term" href="#dfn-term"><ins class="diff-chg">
term
</ins></a>
has
<ins class="diff-new">already
been
defined
or
currently
being
defined
during
recursion.
</ins></li><li><ins class="diff-new">
For
each
</ins><i><ins class="diff-new">
key
</ins></i><ins class="diff-new">
-
</ins><i><ins class="diff-new">
value
</ins></i><ins class="diff-new">
pair
in
</ins><i><ins class="diff-new">
context
</ins></i><ins class="diff-new">
where
</ins><i><ins class="diff-new">
key
</ins></i><ins class="diff-new">
is
not
</ins>
<code>
<del class="diff-old">@id
</del>
<ins class="diff-chg">@base
</ins>
</code>,
<code>
<del class="diff-old">@language
</del>
<ins class="diff-chg">@vocab
</ins></code>,
or
<code>
<del class="diff-old">@type
properties,
throw
an
exception.
</del>
<ins class="diff-chg">@language
</ins></code>,<ins class="diff-chg">
invoke
the
</ins><a href="#create-term-definition"><ins class="diff-chg">
Create
Term
Definition
algorithm
</ins></a>,<ins class="diff-chg">
passing
</ins><i><ins class="diff-chg">
result
</ins></i><ins class="diff-chg">
for
</ins><a class="tref internalDFN" title="active-context" href="#dfn-active-context"><ins class="diff-chg">
active
context
</ins></a>,<i><ins class="diff-chg">
context
</ins></i><ins class="diff-chg">
for
</ins><a class="tref internalDFN" title="local-context" href="#dfn-local-context"><ins class="diff-chg">
local
context
</ins></a>,<i><ins class="diff-chg">
key
</ins></i>,<ins class="diff-chg">
and
</ins><i><ins class="diff-chg">
defined
</ins></i>.</li></ol></li><li><ins class="diff-chg">
Return
</ins><i><ins class="diff-chg">
result
</ins></i>.</li></ol></section></section><section id="create-term-definition"><h3>
<del class="diff-old">Issue
5
</del>
<span class="secno">
<ins class="diff-chg">6.2
</ins>
</span>
<del class="diff-old">Undecided
if
@type
or
@graph
can
take
</del>
<ins class="diff-chg">Create
Term
Definition
</ins></h3><p><ins class="diff-chg">
This
algorithm
is
called
from
the
</ins><a href="#context-processing-algorithm"><ins class="diff-chg">
Context
Processing
algorithm
</ins></a><ins class="diff-chg">
to
create
</ins>
a
<del class="diff-old">@container
with
@set
.
If
</del>
<a class="tref internalDFN" title="term-definition" href="#dfn-term-definition">
<ins class="diff-chg">term
definition
</ins></a><ins class="diff-chg">
in
</ins>
the
<a class="tref internalDFN" title="active-context" href="#dfn-active-context">
<ins class="diff-new">active
context
</ins></a><ins class="diff-new">
for
a
</ins><a class="tref internalDFN" title="term" href="#dfn-term"><ins class="diff-new">
term
</ins></a><ins class="diff-new">
being
processed
in
a
</ins><a class="tref internalDFN" title="local-context" href="#dfn-local-context"><ins class="diff-new">
local
context
</ins></a>.</p><section class="informative"><h4 id="general-solution-1"><ins class="diff-new">
General
Solution
</ins></h4><p>
<em>
<del class="diff-old">property
</del>
<ins class="diff-chg">This
section
is
non-normative.
</ins>
</em>
<del class="diff-old">has
</del>
</p>
<p>
<a class="tref internalDFN" title="term-definition" href="#dfn-term-definition">
<ins class="diff-chg">Term
definitions
</ins></a><ins class="diff-chg">
are
created
by
parsing
</ins>
the
<del class="diff-old">form
of
</del>
<ins class="diff-chg">information
in
the
given
</ins><a class="tref internalDFN" title="local-context" href="#dfn-local-context"><ins class="diff-chg">
local
context
</ins></a><ins class="diff-chg">
for
the
given
</ins>
<a class="tref internalDFN" title="term" href="#dfn-term">
term
<del class="diff-old">,
its
value
must
have
an
@id
property
with
a
string
value
which
must
have
</del>
</a>.
<ins class="diff-chg">If
</ins>
the
<del class="diff-old">form
of
a
</del>
<ins class="diff-chg">given
</ins>
<a class="tref internalDFN" title="term" href="#dfn-term">
term
<del class="diff-old">,
</del>
</a>
<ins class="diff-chg">is
a
</ins><a class="tref internalDFN" title="compact-iri" href="#dfn-compact-iri">
compact
<abbr title="Internationalized Resource Identifier">
IRI
</abbr>
</a>,
<del class="diff-old">or
absolute
IRI
</del>
<ins class="diff-chg">it
may
omit
an
</ins><a class="tref internalDFN" title="iri-mapping" href="#dfn-iri-mapping">
<del class="diff-old">.
Determine
the
</del>
<abbr title="Internationalized Resource Identifier">
IRI
</abbr>
mapping
</a>
by
<del class="diff-old">performing
IRI
Expansion
</del>
<ins class="diff-chg">depending
on
its
</ins><a class="tref internalDFN" title="prefix" href="#dfn-prefix"><ins class="diff-chg">
prefix
</ins></a><ins class="diff-chg">
having
its
own
</ins><a class="tref internalDFN" title="term-definition" href="#dfn-term-definition"><ins class="diff-chg">
term
definition
</ins></a>.<ins class="diff-chg">
If
the
</ins><a class="tref internalDFN" title="prefix" href="#dfn-prefix"><ins class="diff-chg">
prefix
</ins></a><ins class="diff-chg">
is
a
key
in
the
</ins><a class="tref internalDFN" title="local-context" href="#dfn-local-context"><ins class="diff-chg">
local
context
</ins></a>,<ins class="diff-chg">
then
its
</ins><a class="tref internalDFN" title="term-definition" href="#dfn-term-definition"><ins class="diff-chg">
term
definition
</ins></a><ins class="diff-chg">
must
first
be
created,
through
recursion,
before
continuing.
Because
a
</ins><a class="tref internalDFN" title="term-definition" href="#dfn-term-definition"><ins class="diff-chg">
term
definition
</ins>
</a>
<ins class="diff-new">can
depend
</ins>
on
<ins class="diff-new">other
</ins><a class="tref internalDFN" title="term-definition" href="#dfn-term-definition"><ins class="diff-new">
term
definitions
</ins></a>,<ins class="diff-new">
a
mechanism
must
be
used
to
detect
cyclical
dependencies.
The
solution
employed
here
uses
a
map,
</ins><i><ins class="diff-new">
defined
</ins></i>,<ins class="diff-new">
that
keeps
track
of
whether
or
not
a
</ins><a class="tref internalDFN" title="term" href="#dfn-term"><ins class="diff-new">
term
</ins></a><ins class="diff-new">
has
been
defined
or
is
currently
in
</ins>
the
<del class="diff-old">associated
value.
If
</del>
<ins class="diff-chg">process
of
being
defined.
This
map
is
checked
before
any
recursion
is
attempted.
</ins></p><p><ins class="diff-chg">
After
all
dependencies
for
a
</ins><a class="tref internalDFN" title="term" href="#dfn-term"><ins class="diff-chg">
term
</ins></a><ins class="diff-chg">
have
been
defined,
</ins>
the
<del class="diff-old">result
</del>
<ins class="diff-chg">rest
</ins>
of
the
<del class="diff-old">IRI
mapping
</del>
<ins class="diff-chg">information
in
the
</ins><a class="tref internalDFN" title="local-context" href="#dfn-local-context"><ins class="diff-chg">
local
context
</ins></a><ins class="diff-chg">
for
the
given
</ins><a class="tref internalDFN" title="term" href="#dfn-term"><ins class="diff-chg">
term
</ins></a>
is
<del class="diff-old">an
absolute
</del>
<ins class="diff-chg">taken
into
account,
creating
the
appropriate
</ins><a class="tref internalDFN" title="iri-mapping" href="#dfn-iri-mapping">
<abbr title="Internationalized Resource Identifier">
IRI
</abbr>
<ins class="diff-chg">mapping
</ins>
</a>,
<del class="diff-old">merge
the
property
into
</del>
<a class="tref internalDFN" title="container-mapping" href="#dfn-container-mapping">
<ins class="diff-chg">container
mapping
</ins></a>,<ins class="diff-chg">
and
</ins><a class="tref internalDFN" title="type-mapping" href="#dfn-type-mapping"><ins class="diff-chg">
type
mapping
</ins></a><ins class="diff-chg">
or
</ins><a class="tref internalDFN" title="language-mapping" href="#dfn-language-mapping"><ins class="diff-chg">
language
mapping
</ins></a><ins class="diff-chg">
for
</ins>
the
<a class="tref internalDFN" title="term" href="#dfn-term">
<ins class="diff-chg">term
</ins></a>.</p></section><section><h4 id="algorithm-1"><ins class="diff-chg">
Algorithm
</ins></h4><p><ins class="diff-chg">
The
algorithm
has
four
required
inputs
which
are:
an
</ins><a class="tref internalDFN" title="active-context" href="#dfn-active-context"><ins class="diff-chg">
active
context
</ins></a>,<ins class="diff-chg">
a
</ins><a class="tref internalDFN" title="local-context" href="#dfn-local-context">
local
context
</a>,
<ins class="diff-chg">a
</ins><i>
term
<del class="diff-old">mapping
.
</del>
</i>,
<ins class="diff-chg">and
a
map
</ins><i><ins class="diff-chg">
defined
</ins></i>.</p><ol class="algorithm">
<li>
If
<i>
<ins class="diff-new">defined
</ins></i><ins class="diff-new">
contains
</ins>
the
<del class="diff-old">property
</del>
<ins class="diff-chg">key
</ins><i><ins class="diff-chg">
term
</ins></i><ins class="diff-chg">
and
the
associated
value
is
</ins><a class="tref internalDFN" title="true" href="#dfn-true"><ins class="diff-chg">
true
</ins></a><ins class="diff-chg">
(indicating
that
the
</ins><a class="tref internalDFN" title="term-definition" href="#dfn-term-definition"><ins class="diff-chg">
term
definition
</ins></a>
has
<ins class="diff-new">already
been
created),
return.
Otherwise,
if
</ins>
the
<del class="diff-old">form
of
of
</del>
<ins class="diff-chg">value
is
</ins><a class="tref internalDFN" title="false" href="#dfn-false"><ins class="diff-chg">
false
</ins></a>,
a
<del class="diff-old">compact
</del>
<code class="error">
<a href="#idl-def-JsonLdErrorCode.cyclic-IRI-mapping">
<ins class="diff-chg">cyclic
</ins>
<abbr title="Internationalized Resource Identifier">
IRI
</abbr>
<ins class="diff-new">mapping
</ins></a></code><ins class="diff-new">
error
has
been
detected
and
processing
is
aborted.
</ins></li><li><ins class="diff-new">
Set
the
value
associated
with
</ins><i><ins class="diff-new">
defined
</ins></i><ins class="diff-new">
's
</ins><i><ins class="diff-new">
term
</ins></i><ins class="diff-new">
key
to
</ins><a class="tref internalDFN" title="false" href="#dfn-false"><ins class="diff-new">
false
</ins></a>.<ins class="diff-new">
This
indicates
that
the
</ins><a class="tref internalDFN" title="term-definition" href="#dfn-term-definition"><ins class="diff-new">
term
definition
</ins></a><ins class="diff-new">
is
now
being
created
but
is
not
yet
complete.
</ins></li><li><ins class="diff-new">
Since
</ins><a class="tref internalDFN" title="keyword" href="#dfn-keyword"><ins class="diff-new">
keywords
</ins></a><ins class="diff-new">
cannot
be
overridden,
</ins><i><ins class="diff-new">
term
</ins></i><ins class="diff-new">
must
not
be
a
</ins><a class="tref internalDFN" title="keyword" href="#dfn-keyword"><ins class="diff-new">
keyword
</ins></a>.<ins class="diff-new">
Otherwise,
a
</ins><code class="error">
<a href="#idl-def-JsonLdErrorCode.keyword-redefinition">
<ins class="diff-new">keyword
redefinition
</ins>
</a>
<del class="diff-old">or
absolute
IRI
</del>
<del class="diff-old">,
</del>
</code>
<ins class="diff-chg">error
has
been
detected
and
processing
is
aborted.
</ins></li><li><ins class="diff-chg">
Remove
any
existing
</ins><a class="tref internalDFN" title="term-definition" href="#dfn-term-definition"><ins class="diff-chg">
term
definition
</ins></a><ins class="diff-chg">
for
</ins><i><ins class="diff-chg">
term
</ins></i><ins class="diff-chg">
in
</ins><a class="tref internalDFN" title="active-context" href="#dfn-active-context"><ins class="diff-chg">
active
context
</ins></a>.</li><li><ins class="diff-chg">
Initialize
</ins><i><ins class="diff-chg">
value
</ins></i><ins class="diff-chg">
to
</ins>
the
value
<del class="diff-old">may
have
</del>
<ins class="diff-chg">associated
with
the
key
</ins><i><ins class="diff-chg">
term
</ins></i><ins class="diff-chg">
in
</ins><a class="tref internalDFN" title="local-context" href="#dfn-local-context"><ins class="diff-chg">
local
context
</ins></a>.</li><li><ins class="diff-chg">
If
</ins><i><ins class="diff-chg">
value
</ins></i><ins class="diff-chg">
is
</ins><a class="tref internalDFN" title="null" href="#dfn-null"><ins class="diff-chg">
null
</ins></a><ins class="diff-chg">
or
</ins><i><ins class="diff-chg">
value
</ins></i><ins class="diff-chg">
is
</ins>
a
<a class="tref internalDFN" title="json-object" href="#dfn-json-object">
<ins class="diff-new">JSON
object
</ins></a><ins class="diff-new">
containing
the
key-value
pair
</ins>
<code>
@id
</code>
<del class="diff-old">property
</del>
<ins class="diff-chg">-
</ins><a class="tref internalDFN" title="null" href="#dfn-null"><ins class="diff-chg">
null
</ins></a>,<ins class="diff-chg">
set
the
</ins><a class="tref internalDFN" title="term-definition" href="#dfn-term-definition"><ins class="diff-chg">
term
definition
</ins></a><ins class="diff-chg">
in
</ins><a class="tref internalDFN" title="active-context" href="#dfn-active-context"><ins class="diff-chg">
active
context
</ins></a><ins class="diff-chg">
to
</ins><a class="tref internalDFN" title="null" href="#dfn-null"><ins class="diff-chg">
null
</ins></a>,<ins class="diff-chg">
set
the
value
associated
</ins>
with
<i>
<ins class="diff-new">defined
</ins></i><ins class="diff-new">
's
key
</ins><i><ins class="diff-new">
term
</ins></i><ins class="diff-new">
to
</ins><a class="tref internalDFN" title="true" href="#dfn-true"><ins class="diff-new">
true
</ins></a>,<ins class="diff-new">
and
return.
</ins></li><li><ins class="diff-new">
Otherwise,
if
</ins><i><ins class="diff-new">
value
</ins></i><ins class="diff-new">
is
</ins>
a
<a class="tref internalDFN" title="string" href="#dfn-string">
string
</a>:
<ol class="algorithm">
<li>
<ins class="diff-new">Expand
</ins><i>
value
<del class="diff-old">which
must
have
</del>
</i>
<ins class="diff-chg">by
setting
it
to
</ins>
the
<del class="diff-old">form
</del>
<ins class="diff-chg">result
</ins>
of
<del class="diff-old">a
term
,
compact
IRI
,
or
absolute
IRI
.
Determine
</del>
<ins class="diff-chg">using
</ins>
the
<del class="diff-old">IRI
mapping
by
performing
</del>
<a href="#iri-expansion">
<abbr title="Internationalized Resource Identifier">
IRI
</abbr>
Expansion
<ins class="diff-new">algorithm
</ins></a>,<ins class="diff-new">
passing
</ins><a class="tref internalDFN" title="active-context" href="#dfn-active-context"><ins class="diff-new">
active
context
</ins></a>,<i><ins class="diff-new">
value
</ins></i>,<a class="tref internalDFN" title="true" href="#dfn-true"><ins class="diff-new">
true
</ins>
</a>
<del class="diff-old">on
the
associated
value.
</del>
<ins class="diff-chg">for
</ins><i><ins class="diff-chg">
vocabRelative
</ins></i>,<a class="tref internalDFN" title="true" href="#dfn-true"><ins class="diff-chg">
true
</ins></a><ins class="diff-chg">
for
</ins><i><ins class="diff-chg">
documentRelative
</ins></i>,<a class="tref internalDFN" title="local-context" href="#dfn-local-context"><ins class="diff-chg">
local
context
</ins></a>,<ins class="diff-chg">
and
</ins><i><ins class="diff-chg">
defined
</ins></i>.</li><li>
If
<del class="diff-old">the
result
of
the
IRI
mapping
</del>
<i>
<ins class="diff-chg">value
</ins></i>
is
<code>
<ins class="diff-new">@context
</ins></code>,
an
<del class="diff-old">absolute
</del>
<code class="error">
<a href="#idl-def-JsonLdErrorCode.invalid-keyword-alias">
<ins class="diff-chg">invalid
keyword
alias
</ins></a></code><ins class="diff-chg">
error
has
been
detected
and
processing
is
aborted.
</ins></li><li><ins class="diff-chg">
Set
the
</ins><a class="tref internalDFN" title="iri-mapping" href="#dfn-iri-mapping">
<abbr title="Internationalized Resource Identifier">
IRI
</abbr>
<del class="diff-old">,
merge
the
property
into
</del>
<ins class="diff-chg">mapping
</ins></a><ins class="diff-chg">
for
</ins>
the
<del class="diff-old">local
</del>
<a class="tref internalDFN" title="term-definition" href="#dfn-term-definition">
<ins class="diff-chg">term
definition
</ins></a><ins class="diff-chg">
for
</ins><i><ins class="diff-chg">
term
</ins></i><ins class="diff-chg">
in
</ins><a class="tref internalDFN" title="active-context" href="#dfn-active-context"><ins class="diff-chg">
active
</ins>
context
</a>
<ins class="diff-chg">to
</ins><i><ins class="diff-chg">
value
</ins></i>,<ins class="diff-chg">
set
the
value
associated
with
</ins><i><ins class="diff-chg">
defined
</ins></i><ins class="diff-chg">
's
key
</ins><i>
term
<del class="diff-old">mapping
.
</del>
</i>
<ins class="diff-chg">to
</ins><a class="tref internalDFN" title="true" href="#dfn-true"><ins class="diff-chg">
true
</ins></a>,<ins class="diff-chg">
and
return.
</ins></li></ol>
</li>
<li>
<del class="diff-old">If
the
</del>
<ins class="diff-chg">Otherwise,
</ins><i>
value
</i>
<ins class="diff-chg">must
be
a
</ins><a class="tref internalDFN" title="json-object" href="#dfn-json-object"><ins class="diff-chg">
JSON
object
</ins></a>,<ins class="diff-chg">
if
not,
an
</ins><code class="error"><a href="#idl-def-JsonLdErrorCode.invalid-term-definition"><ins class="diff-chg">
invalid
term
definition
</ins></a></code><ins class="diff-chg">
error
</ins>
has
<ins class="diff-new">been
detected
and
processing
is
aborted.
</ins></li><li><ins class="diff-new">
Create
</ins>
a
<ins class="diff-new">new
</ins><a class="tref internalDFN" title="term-definition" href="#dfn-term-definition"><ins class="diff-new">
term
definition
</ins></a>,<i><ins class="diff-new">
definition
</ins></i>.</li><li><ins class="diff-new">
If
</ins><i><ins class="diff-new">
value
</ins></i><ins class="diff-new">
contains
the
key
</ins><code><ins class="diff-new">
@reverse
</ins></code>:<ol class="algorithm"><li><ins class="diff-new">
If
</ins><i><ins class="diff-new">
value
</ins></i><ins class="diff-new">
contains
an
</ins><code><ins class="diff-new">
@id
</ins></code>,<ins class="diff-new">
an
</ins>
<code>
@type
</code>,
<ins class="diff-new">or
an
</ins><code><ins class="diff-new">
@language
</ins></code>,<ins class="diff-new">
member,
an
</ins><code class="error"><a href="#idl-def-JsonLdErrorCode.invalid-reverse-property"><ins class="diff-new">
invalid
reverse
property
</ins></a>
</code>
<del class="diff-old">property,
its
</del>
<ins class="diff-chg">error
has
been
detected
and
processing
is
aborted.
</ins></li><li><ins class="diff-chg">
If
the
</ins>
value
<del class="diff-old">must
have
</del>
<ins class="diff-chg">associated
with
</ins>
the
<del class="diff-old">form
of
</del>
<code>
<ins class="diff-chg">@reverse
</ins></code><ins class="diff-chg">
key
is
not
</ins>
a
<del class="diff-old">term
</del>
<a class="tref internalDFN" title="string" href="#dfn-string">
<ins class="diff-chg">string
</ins>
</a>,
<del class="diff-old">compact
IRI
</del>
<ins class="diff-chg">an
</ins><code class="error">
<del class="diff-old">,
absolute
</del>
<a href="#idl-def-JsonLdErrorCode.invalid-IRI-mapping">
<ins class="diff-chg">invalid
</ins>
<abbr title="Internationalized Resource Identifier">
IRI
</abbr>
<del class="diff-old">,
or
the
keyword
</del>
<ins class="diff-chg">mapping
</ins>
</a>
<del class="diff-old">@id
.
Determine
</del>
</code>
<ins class="diff-chg">error
has
been
detected
and
processing
is
aborted.
</ins></li><li><ins class="diff-chg">
Otherwise,
set
</ins>
the
<a class="tref internalDFN" title="iri-mapping" href="#dfn-iri-mapping">
<abbr title="Internationalized Resource Identifier">
IRI
</abbr>
<del class="diff-old">by
performing
</del>
<ins class="diff-chg">mapping
</ins></a><ins class="diff-chg">
of
</ins><i><ins class="diff-chg">
definition
</ins></i><ins class="diff-chg">
to
the
result
of
using
the
</ins>
<a href="#iri-expansion">
<abbr title="Internationalized Resource Identifier">
IRI
</abbr>
Expansion
<del class="diff-old">on
</del>
<ins class="diff-chg">algorithm
</ins></a>,<ins class="diff-chg">
passing
</ins><a class="tref internalDFN" title="active-context" href="#dfn-active-context"><ins class="diff-chg">
active
context
</ins></a>,
the
<ins class="diff-new">value
</ins>
associated
<del class="diff-old">value.
</del>
<ins class="diff-chg">with
the
</ins><code><ins class="diff-chg">
@reverse
</ins></code><ins class="diff-chg">
key
for
</ins><i><ins class="diff-chg">
value
</ins></i>,<a class="tref internalDFN" title="true" href="#dfn-true"><ins class="diff-chg">
true
</ins></a><ins class="diff-chg">
for
</ins><i><ins class="diff-chg">
vocabRelative
</ins></i>,<a class="tref internalDFN" title="true" href="#dfn-true"><ins class="diff-chg">
true
</ins></a><ins class="diff-chg">
for
</ins><i><ins class="diff-chg">
documentRelative
</ins></i>,<a class="tref internalDFN" title="local-context" href="#dfn-local-context"><ins class="diff-chg">
local
context
</ins></a>,<ins class="diff-chg">
and
</ins><i><ins class="diff-chg">
defined
</ins></i>.
If
the
result
<del class="diff-old">of
the
IRI
mapping
</del>
is
<ins class="diff-new">not
</ins>
an
<a class="tref internalDFN" title="absolute-iri" href="#dfn-absolute-iri">
absolute
<abbr title="Internationalized Resource Identifier">
IRI
</abbr>
</a>,
<ins class="diff-new">i.e.,
it
contains
no
colon
(
</ins><code>:</code><ins class="diff-new">
),
an
</ins><code class="error"><a href="#idl-def-JsonLdErrorCode.invalid-IRI-mapping"><ins class="diff-new">
invalid
</ins><abbr title="Internationalized Resource Identifier"><ins class="diff-new">
IRI
</ins></abbr><ins class="diff-new">
mapping
</ins>
</a>
<del class="diff-old">or
@id
,
merge
into
</del>
</code>
<ins class="diff-chg">error
has
been
detected
and
processing
is
aborted.
</ins></li><li><ins class="diff-chg">
Set
</ins>
the
<del class="diff-old">local
context
coercion
</del>
<a class="tref internalDFN" title="type-mapping" href="#dfn-type-mapping">
<ins class="diff-chg">type
</ins>
mapping
</a>
<del class="diff-old">using
the
lexical
value
</del>
of
<del class="diff-old">the
property
.
</del>
<i>
<ins class="diff-chg">definition
</ins></i><ins class="diff-chg">
to
</ins><code><ins class="diff-chg">
@id
</ins></code>.
</li>
<li>
If
<del class="diff-old">the
</del>
<i>
value
<del class="diff-old">has
a
</del>
</i>
<ins class="diff-chg">contains
an
</ins>
<code>
@container
</code>
<del class="diff-old">property,
its
value
must
be
</del>
<ins class="diff-chg">member,
set
the
</ins><a class="tref internalDFN" title="container-mapping" href="#dfn-container-mapping"><ins class="diff-chg">
container
mapping
</ins></a><ins class="diff-chg">
of
</ins><i><ins class="diff-chg">
definition
</ins></i><ins class="diff-chg">
to
</ins>
<code>
<del class="diff-old">@list
</del>
<ins class="diff-chg">@index
</ins>
</code>
<del class="diff-old">or
@set
.
Merge
</del>
<ins class="diff-chg">if
that
is
</ins>
the
<del class="diff-old">list
mapping
</del>
<ins class="diff-chg">value
of
the
</ins><code><ins class="diff-chg">
@container
</ins></code><ins class="diff-chg">
member;
otherwise
an
</ins><code class="error"><a href="#idl-def-JsonLdErrorCode.invalid-reverse-property"><ins class="diff-chg">
invalid
reverse
property
</ins>
</a>
<del class="diff-old">or
set
mapping
</del>
</code>
<ins class="diff-chg">error
has
been
detected
(reverse
properties
only
support
index-containers)
and
processing
is
aborted.
</ins></li><li><ins class="diff-chg">
Set
the
</ins><a class="tref internalDFN" title="reverse-property" href="#dfn-reverse-property"><ins class="diff-chg">
reverse
property
</ins>
</a>
<del class="diff-old">into
</del>
<ins class="diff-chg">flag
of
</ins><i><ins class="diff-chg">
definition
</ins></i><ins class="diff-chg">
to
</ins><a class="tref internalDFN" title="true" href="#dfn-true"><ins class="diff-chg">
true
</ins></a>.</li><li><ins class="diff-chg">
Set
</ins>
the
<del class="diff-old">local
</del>
<a class="tref internalDFN" title="term-definition" href="#dfn-term-definition">
<ins class="diff-chg">term
definition
</ins></a><ins class="diff-chg">
of
</ins><i><ins class="diff-chg">
term
</ins></i><ins class="diff-chg">
in
</ins><a class="tref internalDFN" title="active-context" href="#dfn-active-context"><ins class="diff-chg">
active
</ins>
context
</a>
<del class="diff-old">using
</del>
<ins class="diff-chg">to
</ins><i><ins class="diff-chg">
definition
</ins></i><ins class="diff-chg">
and
</ins>
the
<del class="diff-old">lexical
</del>
value
<del class="diff-old">of
</del>
<ins class="diff-chg">associated
with
</ins><i><ins class="diff-chg">
defined
</ins></i><ins class="diff-chg">
's
key
</ins><i><ins class="diff-chg">
term
</ins></i><ins class="diff-chg">
to
</ins><a class="tref internalDFN" title="true" href="#dfn-true"><ins class="diff-chg">
true
</ins></a><ins class="diff-chg">
and
return.
</ins></li></ol></li><li><ins class="diff-chg">
Set
</ins>
the
<a class="tref internalDFN" title="reverse-property" href="#dfn-reverse-property">
<ins class="diff-chg">reverse
</ins>
property
<del class="diff-old">.
</del>
</a>
<ins class="diff-chg">flag
of
</ins><i><ins class="diff-chg">
definition
</ins></i><ins class="diff-chg">
to
</ins><a class="tref internalDFN" title="false" href="#dfn-false"><ins class="diff-chg">
false
</ins></a>.
</li>
<li>
If
<del class="diff-old">the
</del>
<i>
value
<del class="diff-old">has
a
@language
property
but
no
</del>
</i>
<ins class="diff-chg">contains
the
key
</ins>
<code>
<del class="diff-old">@type
property,
</del>
<ins class="diff-chg">@id
</ins></code>:<ol class="algorithm"><li><ins class="diff-chg">
If
</ins>
the
value
<del class="diff-old">of
</del>
<ins class="diff-chg">associated
with
</ins>
the
<code>
<del class="diff-old">@language
</del>
<ins class="diff-chg">@id
</ins>
</code>
<del class="diff-old">property
must
be
</del>
<ins class="diff-chg">key
is
not
</ins>
a
<a class="tref internalDFN" title="string" href="#dfn-string">
string
</a>,
<ins class="diff-new">an
</ins><code class="error"><a href="#idl-def-JsonLdErrorCode.invalid-IRI-mapping"><ins class="diff-new">
invalid
</ins><abbr title="Internationalized Resource Identifier"><ins class="diff-new">
IRI
</ins></abbr><ins class="diff-new">
mapping
</ins>
</a>
<del class="diff-old">or
null
.
Merge
</del>
</code>
<ins class="diff-chg">error
has
been
detected
and
processing
is
aborted.
</ins></li><li><ins class="diff-chg">
Otherwise,
set
</ins>
the
<del class="diff-old">language
</del>
<a class="tref internalDFN" title="iri-mapping" href="#dfn-iri-mapping">
<abbr title="Internationalized Resource Identifier">
<ins class="diff-chg">IRI
</ins></abbr>
mapping
</a>
<del class="diff-old">into
</del>
<ins class="diff-chg">of
</ins><i><ins class="diff-chg">
definition
</ins></i><ins class="diff-chg">
to
</ins>
the
<del class="diff-old">local
context
</del>
<ins class="diff-chg">result
of
</ins>
using
the
<del class="diff-old">lexical
</del>
<a href="#iri-expansion">
<abbr title="Internationalized Resource Identifier">
<ins class="diff-chg">IRI
</ins></abbr><ins class="diff-chg">
Expansion
algorithm
</ins></a>,<ins class="diff-chg">
passing
</ins><a class="tref internalDFN" title="active-context" href="#dfn-active-context"><ins class="diff-chg">
active
context
</ins></a>,<ins class="diff-chg">
the
</ins>
value
<del class="diff-old">of
</del>
<ins class="diff-chg">associated
with
</ins>
the
<del class="diff-old">property
.
</del>
<code>
<ins class="diff-chg">@id
</ins></code><ins class="diff-chg">
key
for
</ins><i><ins class="diff-chg">
value
</ins></i>,<a class="tref internalDFN" title="true" href="#dfn-true"><ins class="diff-chg">
true
</ins></a><ins class="diff-chg">
for
</ins><i><ins class="diff-chg">
vocabRelative
</ins></i>,<a class="tref internalDFN" title="true" href="#dfn-true"><ins class="diff-chg">
true
</ins></a><ins class="diff-chg">
for
</ins><i><ins class="diff-chg">
documentRelative
</ins></i>,<a class="tref internalDFN" title="local-context" href="#dfn-local-context"><ins class="diff-chg">
local
context
</ins></a>,<ins class="diff-chg">
and
</ins><i><ins class="diff-chg">
defined
</ins></i>.
</li>
</ol>
</li>
<li>
<del class="diff-old">Merge
</del>
<ins class="diff-chg">Otherwise
if
</ins>
the
<i>
<ins class="diff-chg">term
</ins></i><ins class="diff-chg">
contains
a
colon
(
</ins><code>:</code><ins class="diff-chg">
):
</ins><ol class="algorithm"><li><ins class="diff-chg">
If
</ins><i><ins class="diff-chg">
term
</ins></i><ins class="diff-chg">
is
a
</ins><a class="tref internalDFN" title="compact-iri" href="#dfn-compact-iri"><ins class="diff-chg">
compact
</ins><abbr title="Internationalized Resource Identifier"><ins class="diff-chg">
IRI
</ins></abbr></a><ins class="diff-chg">
with
a
</ins><a class="tref internalDFN" title="prefix" href="#dfn-prefix"><ins class="diff-chg">
prefix
</ins></a><ins class="diff-chg">
that
is
a
key
in
</ins><a class="tref internalDFN" title="local-context" href="#dfn-local-context">
local
context
</a>
<del class="diff-old">into
the
</del>
<ins class="diff-chg">a
dependency
has
been
found.
Use
this
algorithm
recursively
passing
</ins><a class="tref internalDFN" title="active-context" href="#dfn-active-context">
active
context
<del class="diff-old">.
</del>
</a>,
<a class="tref internalDFN" title="local-context" href="#dfn-local-context">
<ins class="diff-chg">local
context
</ins></a>,<ins class="diff-chg">
the
</ins><a class="tref internalDFN" title="prefix" href="#dfn-prefix"><ins class="diff-chg">
prefix
</ins></a><ins class="diff-chg">
as
</ins><i><ins class="diff-chg">
term
</ins></i>,<ins class="diff-chg">
and
</ins><i><ins class="diff-chg">
defined
</ins></i>.
</li>
<li>
<del class="diff-old">Repeat
Step
2.4.2
</del>
<ins class="diff-chg">If
</ins><i><ins class="diff-chg">
term
</ins></i><ins class="diff-chg">
's
</ins><a class="tref internalDFN" title="prefix" href="#dfn-prefix"><ins class="diff-chg">
prefix
</ins>
</a>
<del class="diff-old">until
no
entries
are
added
to
the
local
</del>
<ins class="diff-chg">has
a
</ins><a class="tref internalDFN" title="term-definition" href="#dfn-term-definition"><ins class="diff-chg">
term
definition
</ins></a><ins class="diff-chg">
in
</ins><a class="tref internalDFN" title="active-context" href="#dfn-active-context"><ins class="diff-chg">
active
</ins>
context
<del class="diff-old">.
Note
</del>
</a>,
<ins class="diff-chg">set
the
</ins><a class="tref internalDFN" title="iri-mapping" href="#dfn-iri-mapping">
<del class="diff-old">It
can
be
difficult
to
distinguish
between
a
compact
</del>
<abbr title="Internationalized Resource Identifier">
IRI
</abbr>
<ins class="diff-new">mapping
</ins></a><ins class="diff-new">
of
</ins><i><ins class="diff-new">
definition
</ins></i><ins class="diff-new">
to
the
result
of
concatenating
the
value
associated
with
the
</ins><a class="tref internalDFN" title="prefix" href="#dfn-prefix"><ins class="diff-new">
prefix
</ins></a><ins class="diff-new">
's
</ins><a class="tref internalDFN" title="iri-mapping" href="#dfn-iri-mapping">
<abbr title="Internationalized Resource Identifier">
<ins class="diff-new">IRI
</ins></abbr><ins class="diff-new">
mapping
</ins>
</a>
and
<ins class="diff-new">the
</ins><i><ins class="diff-new">
term
</ins></i><ins class="diff-new">
's
</ins><i><ins class="diff-new">
suffix
</ins></i>.</li><li><ins class="diff-new">
Otherwise,
</ins><i><ins class="diff-new">
term
</ins></i><ins class="diff-new">
is
</ins>
an
<a class="tref internalDFN" title="absolute-iri" href="#dfn-absolute-iri">
absolute
<abbr title="Internationalized Resource Identifier">
IRI
</abbr>
<del class="diff-old">,
as
a
compact
</del>
</a>.
<ins class="diff-chg">Set
the
</ins><a class="tref internalDFN" title="iri-mapping" href="#dfn-iri-mapping">
<abbr title="Internationalized Resource Identifier">
IRI
</abbr>
<ins class="diff-chg">mapping
</ins>
</a>
<del class="diff-old">may
seem
</del>
<ins class="diff-chg">of
</ins><i><ins class="diff-chg">
definition
</ins></i>
to
<del class="diff-old">be
</del>
<i>
<ins class="diff-chg">term
</ins></i>.</li></ol></li><li><ins class="diff-chg">
Otherwise,
if
</ins><a class="tref internalDFN" title="active-context" href="#dfn-active-context"><ins class="diff-chg">
active
context
</ins></a><ins class="diff-chg">
has
</ins>
a
<del class="diff-old">valid
IRI
scheme
.
When
performing
repeated
</del>
<a class="tref internalDFN" title="vocabulary-mapping" href="#dfn-vocabulary-mapping">
<ins class="diff-chg">vocabulary
mapping
</ins></a>,<ins class="diff-chg">
the
</ins><a class="tref internalDFN" title="iri-mapping" href="#dfn-iri-mapping">
<abbr title="Internationalized Resource Identifier">
IRI
</abbr>
<del class="diff-old">expansion,
a
</del>
<ins class="diff-chg">mapping
</ins></a><ins class="diff-chg">
of
</ins><i><ins class="diff-chg">
definition
</ins></i><ins class="diff-chg">
is
set
to
the
result
of
concatenating
the
value
associated
with
the
</ins><a class="tref internalDFN" title="vocabulary-mapping" href="#dfn-vocabulary-mapping"><ins class="diff-chg">
vocabulary
mapping
</ins></a><ins class="diff-chg">
and
</ins><i>
term
<del class="diff-old">used
as
a
prefix
may
</del>
</i>.
<ins class="diff-chg">If
it
does
</ins>
not
have
a
<del class="diff-old">valid
</del>
<a class="tref internalDFN" title="vocabulary-mapping" href="#dfn-vocabulary-mapping">
<ins class="diff-chg">vocabulary
</ins>
mapping
<del class="diff-old">due
</del>
</a>,
<ins class="diff-chg">an
</ins><code class="error"><a href="#idl-def-JsonLdErrorCode.invalid-IRI-mapping"><ins class="diff-chg">
invalid
</ins><abbr title="Internationalized Resource Identifier"><ins class="diff-chg">
IRI
</ins></abbr><ins class="diff-chg">
mapping
</ins></a></code><ins class="diff-chg">
error
been
detected
and
processing
is
aborted.
</ins></li><li><ins class="diff-chg">
If
</ins><i><ins class="diff-chg">
value
</ins></i><ins class="diff-chg">
contains
the
key
</ins><code><ins class="diff-chg">
@type
</ins></code>:<ol class="algorithm"><li><ins class="diff-chg">
Initialize
</ins><i><ins class="diff-chg">
type
</ins></i>
to
<del class="diff-old">dependencies
in
resolving
term
definitions.
By
continuing
Step
2.3.2
</del>
<ins class="diff-chg">the
value
associated
with
the
</ins><code><ins class="diff-chg">
@type
</ins></code><ins class="diff-chg">
key,
which
must
be
a
</ins><a class="tref internalDFN" title="string" href="#dfn-string"><ins class="diff-chg">
string
</ins></a>.<ins class="diff-chg">
Otherwise,
an
</ins><code class="error"><a href="#idl-def-JsonLdErrorCode.invalid-type-mapping"><ins class="diff-chg">
invalid
type
mapping
</ins>
</a>
<del class="diff-old">until
no
changes
are
made,
mappings
</del>
</code>
<ins class="diff-chg">error
has
been
detected
and
processing
is
aborted.
</ins></li><li><ins class="diff-chg">
Set
</ins><i><ins class="diff-chg">
type
</ins></i>
to
<del class="diff-old">IRIs
created
</del>
<ins class="diff-chg">the
result
of
</ins>
using
<ins class="diff-new">the
</ins><a href="#iri-expansion"><abbr title="Internationalized Resource Identifier"><ins class="diff-new">
IRI
</ins></abbr><ins class="diff-new">
Expansion
algorithm
</ins></a>,<ins class="diff-new">
passing
</ins><a class="tref internalDFN" title="active-context" href="#dfn-active-context"><ins class="diff-new">
active
context
</ins></a>,<i><ins class="diff-new">
type
</ins></i><ins class="diff-new">
for
</ins><i><ins class="diff-new">
value
</ins></i>,<a class="tref internalDFN" title="true" href="#dfn-true"><ins class="diff-new">
true
</ins></a><ins class="diff-new">
for
</ins><i><ins class="diff-new">
vocabRelative
</ins></i>,<a class="tref internalDFN" title="true" href="#dfn-true"><ins class="diff-new">
true
</ins></a><ins class="diff-new">
for
</ins><i><ins class="diff-new">
documentRelative
</ins></i>,<a class="tref internalDFN" title="local-context" href="#dfn-local-context"><ins class="diff-new">
local
context
</ins></a>,<ins class="diff-new">
and
</ins><i><ins class="diff-new">
defined
</ins></i>.<ins class="diff-new">
If
the
expanded
</ins><i><ins class="diff-new">
type
</ins></i><ins class="diff-new">
is
neither
</ins><code><ins class="diff-new">
@id
</ins></code>,<ins class="diff-new">
nor
</ins><code><ins class="diff-new">
@vocab
</ins></code>,<ins class="diff-new">
nor
</ins>
an
<del class="diff-old">undefined
term
prefix
will
eventually
resolve
to
</del>
<a class="tref internalDFN" title="absolute-iri" href="#dfn-absolute-iri">
absolute
<abbr title="Internationalized Resource Identifier">
IRI
</abbr>
<del class="diff-old">s.
</del>
</a>,
<ins class="diff-chg">an
</ins><code class="error">
<a href="#idl-def-JsonLdErrorCode.invalid-type-mapping">
<ins class="diff-chg">invalid
type
mapping
</ins></a>
</code>
<ins class="diff-chg">error
has
been
detected
and
processing
is
aborted.
</ins></li><li><ins class="diff-chg">
Set
the
</ins><a class="tref internalDFN" title="type-mapping" href="#dfn-type-mapping"><ins class="diff-chg">
type
mapping
</ins></a><ins class="diff-chg">
for
</ins><i><ins class="diff-chg">
definition
</ins></i><ins class="diff-chg">
to
</ins><i><ins class="diff-chg">
type
</ins></i>.</li></ol></li><li><ins class="diff-chg">
If
</ins><i><ins class="diff-chg">
value
</ins></i><ins class="diff-chg">
contains
the
key
</ins><code><ins class="diff-chg">
@container
</ins></code>:<ol class="algorithm"><li><ins class="diff-chg">
Initialize
</ins><i><ins class="diff-chg">
container
</ins></i><ins class="diff-chg">
to
the
value
associated
with
the
</ins><code><ins class="diff-chg">
@container
</ins></code><ins class="diff-chg">
key,
which
must
be
either
</ins><code><ins class="diff-chg">
@list
</ins></code>,<code><ins class="diff-chg">
@set
</ins></code>,<code><ins class="diff-chg">
@index
</ins></code>,<ins class="diff-chg">
or
</ins><code><ins class="diff-chg">
@language
</ins></code>.<ins class="diff-chg">
Otherwise,
an
</ins><code class="error">
<del class="diff-old">Issue
6
</del>
<a href="#idl-def-JsonLdErrorCode.invalid-container-mapping">
<ins class="diff-chg">invalid
container
mapping
</ins></a>
</code>
<ins class="diff-chg">error
has
been
detected
and
processing
is
aborted.
</ins></li><li><ins class="diff-chg">
Set
the
</ins><a class="tref internalDFN" title="container-mapping" href="#dfn-container-mapping"><ins class="diff-chg">
container
mapping
</ins></a><ins class="diff-chg">
of
</ins><i><ins class="diff-chg">
definition
</ins></i><ins class="diff-chg">
to
</ins><i><ins class="diff-chg">
container
</ins></i>.</li></ol></li><li><ins class="diff-chg">
If
</ins><i><ins class="diff-chg">
value
</ins></i><ins class="diff-chg">
contains
the
key
</ins><code><ins class="diff-chg">
@language
</ins></code><ins class="diff-chg">
and
does
not
contain
the
key
</ins><code><ins class="diff-chg">
@type
</ins></code>:<ol class="algorithm"><li><ins class="diff-chg">
Initialize
</ins><i><ins class="diff-chg">
language
</ins></i><ins class="diff-chg">
to
the
value
associated
with
the
</ins><code><ins class="diff-chg">
@language
</ins></code><ins class="diff-chg">
key,
which
must
be
either
</ins><a class="tref internalDFN" title="null" href="#dfn-null"><ins class="diff-chg">
null
</ins></a><ins class="diff-chg">
or
a
</ins><a class="tref internalDFN" title="string" href="#dfn-string"><ins class="diff-chg">
string
</ins></a>.<ins class="diff-chg">
Otherwise,
an
</ins><code class="error">
<a href="#idl-def-JsonLdErrorCode.invalid-language-mapping">
<ins class="diff-chg">invalid
language
mapping
</ins></a>
<del class="diff-old">Issue
43
</del>
</code>
<ins class="diff-chg">error
has
been
detected
and
processing
is
aborted.
</ins></li><li><ins class="diff-chg">
If
</ins><i><ins class="diff-chg">
language
</ins></i><ins class="diff-chg">
is
a
</ins><a class="tref internalDFN" title="string" href="#dfn-string"><ins class="diff-chg">
string
</ins>
</a>
<del class="diff-old">concerns
performing
IRI
expansion
in
</del>
<ins class="diff-chg">set
it
to
lowercased
</ins><i><ins class="diff-chg">
language
</ins></i>.<ins class="diff-chg">
Set
</ins>
the
<del class="diff-old">key
position
</del>
<a class="tref internalDFN" title="language-mapping" href="#dfn-language-mapping">
<ins class="diff-chg">language
mapping
</ins></a>
of
<del class="diff-old">a
</del>
<i>
<ins class="diff-chg">definition
</ins></i><ins class="diff-chg">
to
</ins><i><ins class="diff-chg">
language
</ins></i>.</li></ol></li><li><ins class="diff-chg">
Set
the
</ins><a class="tref internalDFN" title="term-definition" href="#dfn-term-definition"><ins class="diff-chg">
term
definition
</ins></a><ins class="diff-chg">
of
</ins><i><ins class="diff-chg">
term
</ins></i><ins class="diff-chg">
in
</ins><a class="tref internalDFN" title="active-context" href="#dfn-active-context"><ins class="diff-chg">
active
</ins>
context
<del class="diff-old">definition.
</del>
</a>
<ins class="diff-chg">to
</ins><i><ins class="diff-chg">
definition
</ins></i><ins class="diff-chg">
and
set
the
value
associated
with
</ins><i><ins class="diff-chg">
defined
</ins></i><ins class="diff-chg">
's
key
</ins><i><ins class="diff-chg">
term
</ins></i><ins class="diff-chg">
to
</ins><a class="tref internalDFN" title="true" href="#dfn-true"><ins class="diff-chg">
true
</ins></a>.</li></ol></section></section><section id="iri-expansion">
<h3>
<span class="secno">
<del class="diff-old">4.3
</del>
<ins class="diff-chg">6.3
</ins>
</span>
<abbr title="Internationalized Resource Identifier">
IRI
</abbr>
Expansion
</h3>
<p>
<del class="diff-old">Keys
and
</del>
<ins class="diff-chg">In
JSON-LD
documents,
</ins>
some
<ins class="diff-new">keys
and
</ins>
values
<del class="diff-old">are
evaluated
to
produce
an
</del>
<ins class="diff-chg">may
represent
</ins>
<a class="tref internalDFN" title="iri" href="#dfn-iri">
<del class="diff-old">IRI
</del>
<ins class="diff-chg">IRIs
</ins>
</a>.
This
section
defines
an
algorithm
for
transforming
a
<del class="diff-old">value
representing
</del>
<a class="tref internalDFN" title="string" href="#dfn-string">
<ins class="diff-chg">string
</ins></a><ins class="diff-chg">
that
represents
</ins>
an
<a class="tref internalDFN" title="iri" href="#dfn-iri">
<abbr title="Internationalized Resource Identifier">
IRI
</abbr>
</a>
into
an
<del class="diff-old">actual
</del>
<a class="tref internalDFN" title="absolute-iri" href="#dfn-absolute-iri">
<ins class="diff-chg">absolute
</ins>
<abbr title="Internationalized Resource Identifier">
IRI
<del class="diff-old">.
</del>
</abbr>
</a>
<ins class="diff-chg">or
</ins><a class="tref internalDFN" title="blank-node-identifier" href="#dfn-blank-node-identifier"><ins class="diff-chg">
blank
node
identifier
</ins></a>.<ins class="diff-chg">
It
also
covers
transforming
</ins><a class="tref internalDFN" title="keyword-alias" href="#dfn-keyword-alias"><ins class="diff-chg">
keyword
aliases
</ins></a><ins class="diff-chg">
into
</ins><a class="tref internalDFN" title="keyword" href="#dfn-keyword"><ins class="diff-chg">
keywords
</ins></a>.
</p>
<p>
<a class="tref internalDFN" title="iri" href="#dfn-iri">
<abbr title="Internationalized Resource Identifier">
IRI
</abbr>
</a>
<del class="diff-old">s
</del>
<ins class="diff-chg">expansion
</ins>
may
<ins class="diff-new">occur
during
context
processing
or
during
any
of
the
other
JSON-LD
algorithms.
If
</ins><abbr title="Internationalized Resource Identifier"><ins class="diff-new">
IRI
</ins></abbr><ins class="diff-new">
expansion
occurs
during
context
processing,
then
the
</ins><a class="tref internalDFN" title="local-context" href="#dfn-local-context"><ins class="diff-new">
local
context
</ins></a><ins class="diff-new">
and
its
related
</ins><i><ins class="diff-new">
defined
</ins></i><ins class="diff-new">
map
from
the
</ins><a href="#context-processing-algorithm"><ins class="diff-new">
Context
Processing
algorithm
</ins></a><ins class="diff-new">
are
passed
to
this
algorithm.
This
allows
for
</ins><a class="tref internalDFN" title="term-definition" href="#dfn-term-definition"><ins class="diff-new">
term
definition
</ins></a><ins class="diff-new">
dependencies
to
</ins>
be
<del class="diff-old">represented
as
</del>
<ins class="diff-chg">processed
via
the
</ins><a href="#create-term-definition"><ins class="diff-chg">
Create
Term
Definition
algorithm
</ins></a>.</p><section class="informative"><h4 id="general-solution-2"><ins class="diff-chg">
General
Solution
</ins></h4><p><em><ins class="diff-chg">
This
section
is
non-normative.
</ins></em></p><p><ins class="diff-chg">
In
order
to
expand
</ins><i><ins class="diff-chg">
value
</ins></i><ins class="diff-chg">
to
</ins>
an
<a class="tref internalDFN" title="absolute-iri" href="#dfn-absolute-iri">
absolute
<abbr title="Internationalized Resource Identifier">
IRI
</abbr>
</a>,
<ins class="diff-new">we
must
first
determine
if
it
is
</ins><a class="tref internalDFN" title="null" href="#dfn-null"><ins class="diff-new">
null
</ins></a>,
a
<a class="tref internalDFN" title="term" href="#dfn-term">
term
<del class="diff-old">or
</del>
</a>,
a
<del class="diff-old">compact
</del>
<a class="tref internalDFN" title="keyword-alias" href="#dfn-keyword-alias">
<ins class="diff-chg">keyword
alias
</ins></a>,<ins class="diff-chg">
or
some
form
of
</ins><a class="tref internalDFN" title="iri" href="#dfn-iri">
<abbr title="Internationalized Resource Identifier">
IRI
</abbr>
</a>.
<del class="diff-old">An
</del>
<ins class="diff-chg">Based
on
what
we
find,
we
handle
the
specific
kind
of
expansion;
for
example,
we
expand
a
</ins><a class="tref internalDFN" title="keyword-alias" href="#dfn-keyword-alias"><ins class="diff-chg">
keyword
alias
</ins></a><ins class="diff-chg">
to
a
</ins><a class="tref internalDFN" title="keyword" href="#dfn-keyword"><ins class="diff-chg">
keyword
</ins></a><ins class="diff-chg">
and
a
</ins><a class="tref internalDFN" title="term" href="#dfn-term"><ins class="diff-chg">
term
</ins></a><ins class="diff-chg">
to
an
</ins><a class="tref internalDFN" title="absolute-iri" href="#dfn-absolute-iri">
absolute
<abbr title="Internationalized Resource Identifier">
IRI
</abbr>
</a>
<ins class="diff-chg">according
to
its
</ins><a class="tref internalDFN" title="iri-mapping" href="#dfn-iri-mapping"><abbr title="Internationalized Resource Identifier"><ins class="diff-chg">
IRI
</ins></abbr><ins class="diff-chg">
mapping
</ins></a><ins class="diff-chg">
in
the
</ins><a class="tref internalDFN" title="active-context" href="#dfn-active-context"><ins class="diff-chg">
active
context
</ins></a>.<ins class="diff-chg">
While
inspecting
</ins><i><ins class="diff-chg">
value
</ins></i><ins class="diff-chg">
we
may
also
find
that
we
need
to
create
</ins><a class="tref internalDFN" title="term-definition" href="#dfn-term-definition"><ins class="diff-chg">
term
definition
</ins></a><ins class="diff-chg">
dependencies
because
we're
running
this
algorithm
during
context
processing.
We
can
tell
whether
or
not
we're
running
during
context
processing
by
checking
</ins><a class="tref internalDFN" title="local-context" href="#dfn-local-context"><ins class="diff-chg">
local
context
</ins></a><ins class="diff-chg">
against
</ins><a class="tref internalDFN" title="null" href="#dfn-null"><ins class="diff-chg">
null
</ins></a>.<ins class="diff-chg">
We
know
we
need
to
create
a
</ins><a class="tref internalDFN" title="term-definition" href="#dfn-term-definition"><ins class="diff-chg">
term
definition
</ins></a><ins class="diff-chg">
in
the
</ins><a class="tref internalDFN" title="active-context" href="#dfn-active-context"><ins class="diff-chg">
active
context
</ins></a><ins class="diff-chg">
when
</ins><i><ins class="diff-chg">
value
</ins></i>
is
<del class="diff-old">defined
</del>
<ins class="diff-chg">a
key
</ins>
in
<del class="diff-old">[
RFC3987
</del>
<ins class="diff-chg">the
</ins><a class="tref internalDFN" title="local-context" href="#dfn-local-context"><ins class="diff-chg">
local
context
</ins>
</a>
<del class="diff-old">]
containing
</del>
<ins class="diff-chg">and
the
</ins><i><ins class="diff-chg">
defined
</ins></i><ins class="diff-chg">
map
does
not
have
</ins>
a
<del class="diff-old">scheme
along
</del>
<ins class="diff-chg">key
for
</ins><i><ins class="diff-chg">
value
</ins></i>
with
<del class="diff-old">path
</del>
<ins class="diff-chg">an
associated
value
of
</ins><a class="tref internalDFN" title="true" href="#dfn-true"><ins class="diff-chg">
true
</ins></a>.<ins class="diff-chg">
The
</ins><i><ins class="diff-chg">
defined
</ins></i><ins class="diff-chg">
map
is
used
during
</ins><a href="#context-processing-algorithm"><ins class="diff-chg">
Context
Processing
</ins></a><ins class="diff-chg">
to
keep
track
of
which
</ins><a class="tref internalDFN" title="term" href="#dfn-term"><ins class="diff-chg">
terms
</ins></a><ins class="diff-chg">
have
already
been
defined
or
are
in
the
process
of
being
defined.
We
create
a
</ins><a class="tref internalDFN" title="term-definition" href="#dfn-term-definition"><ins class="diff-chg">
term
definition
</ins></a><ins class="diff-chg">
by
using
the
</ins><a href="#create-term-definition"><ins class="diff-chg">
Create
Term
Definition
algorithm
</ins></a>.</p></section><section><h4 id="algorithm-2"><ins class="diff-chg">
Algorithm
</ins></h4><p><ins class="diff-chg">
The
algorithm
takes
two
required
</ins>
and
<ins class="diff-new">four
</ins>
optional
<del class="diff-old">query
</del>
<ins class="diff-chg">input
variables.
The
required
inputs
are
an
</ins><a class="tref internalDFN" title="active-context" href="#dfn-active-context"><ins class="diff-chg">
active
context
</ins></a>
and
<del class="diff-old">fragment
segments.
A
</del>
<ins class="diff-chg">a
</ins><i><ins class="diff-chg">
value
</ins></i><ins class="diff-chg">
to
be
expanded.
The
optional
inputs
are
two
flags,
</ins><i><ins class="diff-chg">
documentRelative
</ins></i><ins class="diff-chg">
and
</ins><i><ins class="diff-chg">
vocabRelative
</ins></i>,<ins class="diff-chg">
that
specifying
whether
</ins><i><ins class="diff-chg">
value
</ins></i><ins class="diff-chg">
can
be
interpreted
as
a
</ins><a class="tref internalDFN" title="relative-iri" href="#dfn-relative-iri">
relative
<abbr title="Internationalized Resource Identifier">
IRI
</abbr>
<del class="diff-old">is
an
IRI
that
is
relative
some
other
absolute
</del>
</a>
<ins class="diff-chg">against
the
document's
base
</ins><a class="tref internalDFN" title="iri" href="#dfn-iri">
<abbr title="Internationalized Resource Identifier">
IRI
</abbr>
</a>
<del class="diff-old">;
in
</del>
<ins class="diff-chg">or
</ins>
the
<del class="diff-old">case
of
JSON-LD
</del>
<a class="tref internalDFN" title="active-context" href="#dfn-active-context">
<ins class="diff-chg">active
context's
</ins></a><a class="tref internalDFN" title="vocabulary-mapping" href="#dfn-vocabulary-mapping"><ins class="diff-chg">
vocabulary
mapping
</ins></a>,<ins class="diff-chg">
respectively,
and
a
</ins><a class="tref internalDFN" title="local-context" href="#dfn-local-context"><ins class="diff-chg">
local
context
</ins></a><ins class="diff-chg">
and
a
map
</ins><i><ins class="diff-chg">
defined
</ins></i><ins class="diff-chg">
to
be
used
when
</ins>
this
<ins class="diff-new">algorithm
</ins>
is
<ins class="diff-new">used
during
</ins><a href="#context-processing-algorithm"><ins class="diff-new">
Context
Processing
</ins></a>.<ins class="diff-new">
If
not
passed,
</ins>
the
<del class="diff-old">base
location
of
the
document.
</del>
<ins class="diff-chg">two
flags
are
set
to
</ins><code><ins class="diff-chg">
false
</ins></code><ins class="diff-chg">
and
</ins><a class="tref internalDFN" title="local-context" href="#dfn-local-context"><ins class="diff-chg">
local
context
</ins></a><ins class="diff-chg">
and
</ins><i><ins class="diff-chg">
defined
</ins></i><ins class="diff-chg">
are
initialized
to
</ins><a class="tref internalDFN" title="null" href="#dfn-null"><ins class="diff-chg">
null
</ins></a>.
</p>
<del class="diff-old">The
</del>
<ol class="algorithm">
<li>
<ins class="diff-chg">If
</ins><i><ins class="diff-chg">
value
</ins></i><ins class="diff-chg">
is
a
</ins><a class="tref internalDFN" title="keyword" href="#dfn-keyword"><ins class="diff-chg">
keyword
</ins></a><ins class="diff-chg">
or
</ins><a class="tref internalDFN" title="null" href="#dfn-null"><ins class="diff-chg">
null
</ins></a>,<ins class="diff-chg">
return
</ins><i><ins class="diff-chg">
value
</ins></i><ins class="diff-chg">
as
is.
</ins></li><li><ins class="diff-chg">
If
</ins><a class="tref internalDFN" title="local-context" href="#dfn-local-context"><ins class="diff-chg">
local
context
</ins></a><ins class="diff-chg">
is
not
</ins><a class="tref internalDFN" title="null" href="#dfn-null"><ins class="diff-chg">
null
</ins></a>,<ins class="diff-chg">
it
contains
a
key
that
equals
</ins><i><ins class="diff-chg">
value
</ins></i>,<ins class="diff-chg">
and
the
value
associated
with
the
key
that
equals
</ins><i><ins class="diff-chg">
value
</ins></i><ins class="diff-chg">
in
</ins><i><ins class="diff-chg">
defined
</ins></i><ins class="diff-chg">
is
not
</ins><a class="tref internalDFN" title="true" href="#dfn-true"><ins class="diff-chg">
true
</ins></a>,<ins class="diff-chg">
invoke
the
</ins><a href="#create-term-definition"><ins class="diff-chg">
Create
Term
Definition
</ins>
algorithm
</a>,
<ins class="diff-new">passing
</ins><a class="tref internalDFN" title="active-context" href="#dfn-active-context"><ins class="diff-new">
active
context
</ins></a>,<a class="tref internalDFN" title="local-context" href="#dfn-local-context"><ins class="diff-new">
local
context
</ins></a>,<i><ins class="diff-new">
value
</ins></i><ins class="diff-new">
as
</ins><i><ins class="diff-new">
term
</ins></i>,<ins class="diff-new">
and
</ins><i><ins class="diff-new">
defined
</ins></i>.<ins class="diff-new">
This
will
ensure
that
a
</ins><a class="tref internalDFN" title="term-definition" href="#dfn-term-definition"><ins class="diff-new">
term
definition
</ins></a><ins class="diff-new">
is
created
</ins>
for
<del class="diff-old">generating
an
IRI
is:
</del>
<i>
<ins class="diff-chg">value
</ins></i><ins class="diff-chg">
in
</ins><a class="tref internalDFN" title="active-context" href="#dfn-active-context"><ins class="diff-chg">
active
context
</ins></a><ins class="diff-chg">
during
</ins><a href="#context-processing-algorithm"><ins class="diff-chg">
Context
Processing
</ins></a>.</li>
<li>
If
<i>
<ins class="diff-new">vocabRelative
</ins></i><ins class="diff-new">
is
</ins><a class="tref internalDFN" title="true" href="#dfn-true"><ins class="diff-new">
true
</ins></a><ins class="diff-new">
and
</ins>
the
<a class="tref internalDFN" title="active-context" href="#dfn-active-context">
active
context
</a>
<del class="diff-old">contains
</del>
<ins class="diff-chg">has
</ins>
a
<a class="tref internalDFN" title="term-definition" href="#dfn-term-definition">
term
<ins class="diff-new">definition
</ins>
</a>
<del class="diff-old">mapping
</del>
for
<del class="diff-old">the
</del>
<i>
value
<del class="diff-old">using
a
case-sensitive
comparison,
use
</del>
</i>,
<ins class="diff-chg">return
</ins>
the
<del class="diff-old">mapped
value
as
an
</del>
<ins class="diff-chg">associated
</ins><a class="tref internalDFN" title="iri-mapping" href="#dfn-iri-mapping">
<abbr title="Internationalized Resource Identifier">
IRI
<del class="diff-old">.
</del>
</abbr>
<ins class="diff-chg">mapping
</ins></a>.
</li>
<li>
Otherwise,
<del class="diff-old">split
the
</del>
<ins class="diff-chg">if
</ins><i>
value
</i>
<ins class="diff-new">contains
a
colon
(
</ins><code>:</code><ins class="diff-new">
),
it
is
either
an
</ins><a class="tref internalDFN" title="absolute-iri" href="#dfn-absolute-iri"><ins class="diff-new">
absolute
</ins><abbr title="Internationalized Resource Identifier"><ins class="diff-new">
IRI
</ins></abbr></a><ins class="diff-new">
or
a
</ins><a class="tref internalDFN" title="compact-iri" href="#dfn-compact-iri"><ins class="diff-new">
compact
</ins><abbr title="Internationalized Resource Identifier"><ins class="diff-new">
IRI
</ins></abbr></a>:<ol class="algorithm"><li><ins class="diff-new">
Split
</ins><i><ins class="diff-new">
value
</ins></i>
into
a
<a class="tref internalDFN" title="prefix" href="#dfn-prefix">
prefix
</a>
and
<i>
suffix
<del class="diff-old">from
</del>
</i>
<ins class="diff-chg">at
</ins>
the
first
occurrence
of
<del class="diff-old">':'.
</del>
<ins class="diff-chg">a
colon
(
</ins><code>:</code><ins class="diff-chg">
).
</ins>
</li>
<li>
If
<del class="diff-old">the
</del>
<a class="tref internalDFN" title="prefix" href="#dfn-prefix">
prefix
</a>
<ins class="diff-new">is
not
underscore
(
</ins><code><ins class="diff-new">
_
</ins></code><ins class="diff-new">
)
and
</ins><i><ins class="diff-new">
suffix
</ins></i><ins class="diff-new">
does
not
begin
with
double-forward-slash
(
</ins><code><ins class="diff-new">
//
</ins></code><ins class="diff-new">
),
it
may
be
a
</ins><a class="tref internalDFN" title="compact-iri" href="#dfn-compact-iri"><ins class="diff-new">
compact
</ins><abbr title="Internationalized Resource Identifier"><ins class="diff-new">
IRI
</ins></abbr></a>:<ol class="algorithm"><li><ins class="diff-new">
If
</ins><a class="tref internalDFN" title="local-context" href="#dfn-local-context"><ins class="diff-new">
local
context
</ins></a>
is
<ins class="diff-new">not
</ins><a class="tref internalDFN" title="null" href="#dfn-null"><ins class="diff-new">
null
</ins></a>,<ins class="diff-new">
it
contains
</ins>
a
<del class="diff-old">'_'
(underscore),
</del>
<ins class="diff-chg">key
that
equals
</ins><a class="tref internalDFN" title="prefix" href="#dfn-prefix"><ins class="diff-chg">
prefix
</ins></a>,<ins class="diff-chg">
and
</ins>
the
value
<del class="diff-old">represents
</del>
<ins class="diff-chg">associated
with
the
key
that
equals
</ins><i><ins class="diff-chg">
prefix
</ins></i><ins class="diff-chg">
in
</ins><i><ins class="diff-chg">
defined
</ins></i><ins class="diff-chg">
is
not
</ins><a class="tref internalDFN" title="true" href="#dfn-true"><ins class="diff-chg">
true
</ins></a>,<ins class="diff-chg">
invoke
the
</ins><a href="#create-term-definition"><ins class="diff-chg">
Create
Term
Definition
algorithm
</ins></a>,<ins class="diff-chg">
passing
</ins><a class="tref internalDFN" title="active-context" href="#dfn-active-context"><ins class="diff-chg">
active
context
</ins></a>,<a class="tref internalDFN" title="local-context" href="#dfn-local-context"><ins class="diff-chg">
local
context
</ins></a>,<i><ins class="diff-chg">
prefix
</ins></i><ins class="diff-chg">
as
</ins><i><ins class="diff-chg">
term
</ins></i>,<ins class="diff-chg">
and
</ins><i><ins class="diff-chg">
defined
</ins></i>.<ins class="diff-chg">
This
will
ensure
that
</ins>
a
<del class="diff-old">named
blank
node
</del>
<a class="tref internalDFN" title="term-definition" href="#dfn-term-definition">
<ins class="diff-chg">term
definition
</ins></a><ins class="diff-chg">
is
created
for
</ins><a class="tref internalDFN" title="prefix" href="#dfn-prefix"><ins class="diff-chg">
prefix
</ins></a><ins class="diff-chg">
in
</ins><a class="tref internalDFN" title="active-context" href="#dfn-active-context"><ins class="diff-chg">
active
context
</ins></a><ins class="diff-chg">
during
</ins><a href="#context-processing-algorithm"><ins class="diff-chg">
Context
Processing
</ins>
</a>.
</li>
<li>
If
<del class="diff-old">the
</del>
<a class="tref internalDFN" title="active-context" href="#dfn-active-context">
active
context
</a>
contains
a
<a class="tref internalDFN" title="term-definition" href="#dfn-term-definition">
term
<ins class="diff-new">definition
</ins>
</a>
<del class="diff-old">mapping
</del>
for
<a class="tref internalDFN" title="prefix" href="#dfn-prefix">
prefix
<del class="diff-old">using
a
case-sensitive
comparison,
</del>
</a>,
<ins class="diff-chg">return
the
result
of
concatenating
the
</ins><a class="tref internalDFN" title="iri-mapping" href="#dfn-iri-mapping"><abbr title="Internationalized Resource Identifier"><ins class="diff-chg">
IRI
</ins></abbr><ins class="diff-chg">
mapping
</ins></a><ins class="diff-chg">
associated
with
</ins><a class="tref internalDFN" title="prefix" href="#dfn-prefix"><ins class="diff-chg">
prefix
</ins></a>
and
<i>
suffix
<del class="diff-old">does
not
does
not
begin
with
'//'
(i.e.,
it
</del>
</i>.
</li>
</ol>
</li>
</ol>
</li>
<li>
<ins class="diff-chg">Otherwise,
if
</ins><i><ins class="diff-chg">
value
</ins></i>
does
not
<del class="diff-old">match
</del>
<ins class="diff-chg">contain
</ins>
a
<del class="diff-old">hier-part
including
authority
(as
defined
</del>
<ins class="diff-chg">colon
(
</ins><code>:</code><ins class="diff-chg">
):
</ins><ol class="algorithm"><li><ins class="diff-chg">
If
</ins><i><ins class="diff-chg">
vocabRelative
</ins></i><ins class="diff-chg">
is
</ins><a class="tref internalDFN" title="true" href="#dfn-true"><ins class="diff-chg">
true
</ins></a>,<ins class="diff-chg">
and
</ins><a class="tref internalDFN" title="active-context" href="#dfn-active-context"><ins class="diff-chg">
active
context
</ins></a><ins class="diff-chg">
has
a
</ins><a class="tref internalDFN" title="vocabulary-mapping" href="#dfn-vocabulary-mapping"><ins class="diff-chg">
vocabulary
mapping
</ins></a>,<ins class="diff-chg">
return
the
result
of
concatenating
the
</ins><a class="tref internalDFN" title="vocabulary-mapping" href="#dfn-vocabulary-mapping"><ins class="diff-chg">
vocabulary
mapping
</ins></a><ins class="diff-chg">
with
</ins><i><ins class="diff-chg">
value
</ins></i>.</li><li><ins class="diff-chg">
Otherwise,
if
</ins><i><ins class="diff-chg">
documentRelative
</ins></i><ins class="diff-chg">
is
</ins><a class="tref internalDFN" title="true" href="#dfn-true"><ins class="diff-chg">
true
</ins></a>,<ins class="diff-chg">
return
the
result
of
resolving
</ins><i><ins class="diff-chg">
value
</ins></i><ins class="diff-chg">
against
the
</ins><a class="tref internalDFN" title="base-iri" href="#dfn-base-iri"><ins class="diff-chg">
base
</ins><abbr title="Internationalized Resource Identifier"><ins class="diff-chg">
IRI
</ins></abbr></a>.<ins class="diff-chg">
Only
the
basic
algorithm
</ins>
in
<cite>
<a href="http://tools.ietf.org/html/rfc3986#section-5.2">
<ins class="diff-new">section
5.2
</ins></a></cite><ins class="diff-new">
of
</ins>
[
<cite>
<a class="bibref" href="#bib-RFC3986">
RFC3986
</a>
</cite>
<del class="diff-old">]),
generate
an
</del>
<ins class="diff-chg">]
is
used;
neither
</ins><cite>
<a href="http://tools.ietf.org/html/rfc3986#section-6.2.2">
<ins class="diff-new">Syntax-Based
Normalization
</ins></a></cite><ins class="diff-new">
nor
</ins><cite><a href="http://tools.ietf.org/html/rfc3986#section-6.2.3"><ins class="diff-new">
Scheme-Based
Normalization
</ins></a></cite><ins class="diff-new">
are
performed.
Characters
additionally
allowed
in
</ins>
<abbr title="Internationalized Resource Identifier">
IRI
</abbr>
<del class="diff-old">by
prepending
the
mapped
prefix
to
</del>
<ins class="diff-chg">references
are
treated
in
</ins>
the
<del class="diff-old">(possibly
empty)
suffix
using
textual
concatenation.
Note
</del>
<ins class="diff-chg">same
way
</ins>
that
<del class="diff-old">an
empty
suffix
and
no
suffix
(meaning
the
value
contains
no
':'
string
at
all)
</del>
<ins class="diff-chg">unreserved
characters
</ins>
are
treated
<del class="diff-old">equivalently.
</del>
<ins class="diff-chg">in
URI
references,
per
</ins><cite><a href="http://tools.ietf.org/html/rfc3987#section-6.5"><ins class="diff-chg">
section
6.5
</ins></a></cite><ins class="diff-chg">
of
[
</ins><cite><a class="bibref" href="#bib-RFC3987"><ins class="diff-chg">
RFC3987
</ins></a></cite><ins class="diff-chg">
].
</ins></li></ol>
</li>
<li>
<del class="diff-old">Otherwise,
use
the
</del>
<ins class="diff-chg">If
</ins><a class="tref internalDFN" title="local-context" href="#dfn-local-context"><ins class="diff-chg">
local
context
</ins></a><ins class="diff-chg">
is
not
</ins><a class="tref internalDFN" title="null" href="#dfn-null"><ins class="diff-chg">
null
</ins></a><ins class="diff-chg">
and
</ins><i>
value
<del class="diff-old">directly
as
</del>
</i>
<ins class="diff-chg">is
not
</ins>
an
<a class="tref internalDFN" title="absolute-iri" href="#dfn-absolute-iri">
<ins class="diff-new">absolute
</ins>
<abbr title="Internationalized Resource Identifier">
IRI
<del class="diff-old">.
Note
</del>
</abbr>
</a>,
<ins class="diff-chg">an
</ins><code class="error">
<del class="diff-old">Previous
versions
of
this
specification
used
@base
and
@vocab
to
define
</del>
<a href="#idl-def-JsonLdErrorCode.invalid-IRI-mapping">
<ins class="diff-chg">invalid
</ins>
<abbr title="Internationalized Resource Identifier">
IRI
</abbr>
<del class="diff-old">prefixes
used
to
resolve
relative
IRIs
.
It
was
determined
that
this
added
too
much
complexity,
but
the
issue
can
be
re-examined
in
the
future
based
on
community
input.
</del>
<ins class="diff-chg">mapping
</ins></a>
</code>
<ins class="diff-chg">error
has
been
detected
and
processing
is
aborted.
</ins></li><li><ins class="diff-chg">
Otherwise,
return
</ins><i><ins class="diff-chg">
value
</ins></i><ins class="diff-chg">
as
is.
</ins></li></ol></section></section></section><section id="expansion-algorithms"><h2>
<span class="secno">
<del class="diff-old">4.4
</del>
<ins class="diff-chg">7.
</ins>
</span>
<ins class="diff-new">Expansion
Algorithms
</ins></h2><section id="expansion-algorithm"><h3>
<del class="diff-old">IRI
Compaction
</del>
<span class="secno">
<ins class="diff-chg">7.1
</ins></span><ins class="diff-chg">
Expansion
Algorithm
</ins>
</h3>
<p>
<del class="diff-old">Some
keys
</del>
<ins class="diff-chg">This
algorithm
expands
a
JSON-LD
document,
such
that
all
</ins><a class="tref internalDFN" title="context" href="#dfn-context"><ins class="diff-chg">
context
</ins></a><ins class="diff-chg">
definitions
are
removed,
all
</ins><a class="tref internalDFN" title="term" href="#dfn-term"><ins class="diff-chg">
terms
</ins></a><ins class="diff-chg">
and
</ins><a class="tref internalDFN" title="compact-iri" href="#dfn-compact-iri"><ins class="diff-chg">
compact
IRIs
</ins></a><ins class="diff-chg">
are
expanded
to
</ins><a class="tref internalDFN" title="absolute-iri" href="#dfn-absolute-iri"><ins class="diff-chg">
absolute
IRIs
</ins></a>,<a class="tref internalDFN" title="blank-node-identifier" href="#dfn-blank-node-identifier"><ins class="diff-chg">
blank
node
identifiers
</ins></a>,<ins class="diff-chg">
or
</ins><a class="tref internalDFN" title="keyword" href="#dfn-keyword"><ins class="diff-chg">
keywords
</ins></a>
and
<ins class="diff-new">all
</ins><a class="tref internalDFN" title="json-ld-value" href="#dfn-json-ld-value"><ins class="diff-new">
JSON-LD
</ins>
values
</a>
are
expressed
<del class="diff-old">using
</del>
<ins class="diff-chg">in
</ins><a class="tref internalDFN" title="array" href="#dfn-array"><ins class="diff-chg">
arrays
</ins></a><ins class="diff-chg">
in
</ins><a class="tref internalDFN" title="expanded-form" href="#dfn-expanded-form"><ins class="diff-chg">
expanded
form
</ins></a>.</p><section class="informative"><h4 id="general-solution-3"><ins class="diff-chg">
General
Solution
</ins></h4>
<del class="diff-old">IRI
</del>
<p>
<del class="diff-old">s.
</del>
<em>
This
section
<del class="diff-old">defines
</del>
<ins class="diff-chg">is
non-normative.
</ins></em></p><p><ins class="diff-chg">
Starting
with
its
root
</ins><i><ins class="diff-chg">
element
</ins></i>,<ins class="diff-chg">
we
can
process
the
JSON-LD
document
recursively,
until
we
have
a
fully
</ins><a class="tref internalDFN" title="expansion" href="#dfn-expansion"><ins class="diff-chg">
expanded
</ins></a><i><ins class="diff-chg">
result
</ins></i>.<ins class="diff-chg">
When
</ins><a class="tref internalDFN" title="expansion" href="#dfn-expansion"><ins class="diff-chg">
expanding
</ins></a>
an
<i>
<ins class="diff-new">element
</ins></i>,<ins class="diff-new">
we
can
treat
each
one
differently
according
to
its
type,
in
order
to
break
down
the
problem:
</ins></p><ol><li><ins class="diff-new">
If
the
</ins><i><ins class="diff-new">
element
</ins></i><ins class="diff-new">
is
</ins><a class="tref internalDFN" title="null" href="#dfn-null"><ins class="diff-new">
null
</ins></a>,<ins class="diff-new">
there
is
nothing
to
expand.
</ins></li><li><ins class="diff-new">
Otherwise,
if
</ins><i><ins class="diff-new">
element
</ins></i><ins class="diff-new">
is
a
</ins><a class="tref internalDFN" title="scalar" href="#dfn-scalar"><ins class="diff-new">
scalar
</ins></a>,<ins class="diff-new">
we
expand
it
according
to
the
</ins><a href="#value-expansion"><ins class="diff-new">
Value
Expansion
</ins>
algorithm
<del class="diff-old">for
transforming
</del>
</a>.
</li>
<li>
<ins class="diff-chg">Otherwise,
if
the
</ins><i><ins class="diff-chg">
element
</ins></i><ins class="diff-chg">
is
</ins>
an
<del class="diff-old">IRI
(
iri
)
to
</del>
<a class="tref internalDFN" title="array" href="#dfn-array">
<ins class="diff-chg">array
</ins></a>,<ins class="diff-chg">
then
we
expand
each
of
its
items
recursively
and
return
them
in
a
new
</ins><a class="tref internalDFN" title="array" href="#dfn-array"><ins class="diff-chg">
array
</ins></a>.</li><li><ins class="diff-chg">
Otherwise,
</ins><i><ins class="diff-chg">
element
</ins></i><ins class="diff-chg">
is
</ins>
a
<a class="tref internalDFN" title="json-object" href="#dfn-json-object">
<ins class="diff-new">JSON
object
</ins></a>.<ins class="diff-new">
We
expand
each
of
its
keys,
adding
them
to
our
</ins><i><ins class="diff-new">
result
</ins></i>,<ins class="diff-new">
and
then
we
expand
each
value
for
each
key
recursively.
Some
of
the
keys
will
be
</ins>
<a class="tref internalDFN" title="term" href="#dfn-term">
<del class="diff-old">term
</del>
<ins class="diff-chg">terms
</ins>
</a>
or
<a class="tref internalDFN" title="compact-iri" href="#dfn-compact-iri">
compact
<del class="diff-old">IRI
</del>
<ins class="diff-chg">IRIs
</ins>
</a>
<del class="diff-old">using
the
term
</del>
<ins class="diff-chg">and
others
will
be
</ins><a class="tref internalDFN" title="keyword" href="#dfn-keyword"><ins class="diff-chg">
keywords
</ins>
</a>
<del class="diff-old">s
specified
</del>
<ins class="diff-chg">or
simply
ignored
because
they
do
not
have
definitions
</ins>
in
the
<del class="diff-old">active
</del>
<a class="tref internalDFN" title="context" href="#dfn-context">
context
</a>.
<ins class="diff-new">Any
</ins><a class="tref internalDFN" title="iri" href="#dfn-iri"><ins class="diff-new">
IRIs
</ins>
</a>
<ins class="diff-new">will
be
expanded
</ins>
using
<del class="diff-old">an
optional
value
.
4.4.1
</del>
<ins class="diff-chg">the
</ins><a href="#iri-expansion">
<abbr title="Internationalized Resource Identifier">
IRI
</abbr>
<del class="diff-old">Compaction
</del>
<ins class="diff-chg">Expansion
algorithm
</ins></a>.</li></ol><p><ins class="diff-chg">
Finally,
after
ensuring
</ins><i><ins class="diff-chg">
result
</ins></i><ins class="diff-chg">
is
in
an
</ins><a class="tref internalDFN" title="array" href="#dfn-array"><ins class="diff-chg">
array
</ins></a>,<ins class="diff-chg">
we
return
</ins><i><ins class="diff-chg">
result
</ins></i>.</p></section><section><h4 id="algorithm-3">
Algorithm
</h4>
<p>
The
algorithm
<del class="diff-old">for
generating
a
compact
IRI
</del>
<ins class="diff-chg">takes
three
input
variables:
an
</ins><a class="tref internalDFN" title="active-context" href="#dfn-active-context"><ins class="diff-chg">
active
context
</ins></a>,<ins class="diff-chg">
an
</ins><a class="tref internalDFN" title="active-property" href="#dfn-active-property"><ins class="diff-chg">
active
property
</ins></a>,<ins class="diff-chg">
and
an
</ins><i><ins class="diff-chg">
element
</ins></i><ins class="diff-chg">
to
be
expanded.
To
begin,
the
</ins><a class="tref internalDFN" title="active-context" href="#dfn-active-context"><ins class="diff-chg">
active
context
</ins></a><ins class="diff-chg">
is
set
to
the
result
of
performing,
</ins><a href="#context-processing-algorithm"><ins class="diff-chg">
Context
Processing
</ins></a><ins class="diff-chg">
on
the
passed
</ins><code class="idlMemberName">
<a href="#widl-JsonLdOptions-expandContext">
<ins class="diff-new">expandContext
</ins>
</a>
<del class="diff-old">is:
</del>
</code>,
<ins class="diff-new">or
empty
if
</ins><code class="idlMemberName"><a href="#widl-JsonLdOptions-expandContext"><ins class="diff-new">
expandContext
</ins></a></code><ins class="diff-new">
is
</ins><a class="tref internalDFN" title="null" href="#dfn-null"><ins class="diff-new">
null
</ins></a>,<a class="tref internalDFN" title="active-property" href="#dfn-active-property"><ins class="diff-new">
active
property
</ins></a><ins class="diff-new">
is
set
to
</ins><a class="tref internalDFN" title="null" href="#dfn-null"><ins class="diff-new">
null
</ins></a>,<ins class="diff-new">
and
</ins><i><ins class="diff-new">
element
</ins></i><ins class="diff-new">
is
set
to
the
</ins><a class="tref internalDFN" title="json-ld-input" href="#dfn-json-ld-input"><ins class="diff-new">
JSON-LD
input
</ins></a>.</p>
<ol class="algorithm">
<li>
<del class="diff-old">Create
</del>
<ins class="diff-chg">If
</ins><i><ins class="diff-chg">
element
</ins></i><ins class="diff-chg">
is
</ins><a class="tref internalDFN" title="null" href="#dfn-null"><ins class="diff-chg">
null
</ins></a>,<ins class="diff-chg">
return
</ins><a class="tref internalDFN" title="null" href="#dfn-null"><ins class="diff-chg">
null
</ins></a>.</li><li><ins class="diff-chg">
If
</ins><i><ins class="diff-chg">
element
</ins></i><ins class="diff-chg">
is
a
</ins><a class="tref internalDFN" title="scalar" href="#dfn-scalar"><ins class="diff-chg">
scalar
</ins></a>,<ol class="algorithm"><li><ins class="diff-chg">
If
</ins><a class="tref internalDFN" title="active-property" href="#dfn-active-property"><ins class="diff-chg">
active
property
</ins></a><ins class="diff-chg">
is
</ins><a class="tref internalDFN" title="null" href="#dfn-null"><ins class="diff-chg">
null
</ins></a><ins class="diff-chg">
or
</ins><code><ins class="diff-chg">
@graph
</ins></code>,<ins class="diff-chg">
drop
the
free-floating
</ins><a class="tref internalDFN" title="scalar" href="#dfn-scalar"><ins class="diff-chg">
scalar
</ins></a><ins class="diff-chg">
by
returning
</ins><a class="tref internalDFN" title="null" href="#dfn-null"><ins class="diff-chg">
null
</ins></a>.</li><li><ins class="diff-chg">
Return
the
result
of
the
</ins><a href="#value-expansion"><ins class="diff-chg">
Value
Expansion
algorithm
</ins></a>,<ins class="diff-chg">
passing
the
</ins><a class="tref internalDFN" title="active-context" href="#dfn-active-context"><ins class="diff-chg">
active
context
</ins></a>,<a class="tref internalDFN" title="active-property" href="#dfn-active-property"><ins class="diff-chg">
active
property
</ins></a>,<ins class="diff-chg">
and
</ins><i><ins class="diff-chg">
element
</ins></i><ins class="diff-chg">
as
</ins><i><ins class="diff-chg">
value
</ins></i>.</li></ol></li><li><ins class="diff-chg">
If
</ins><i><ins class="diff-chg">
element
</ins></i><ins class="diff-chg">
is
an
</ins><a class="tref internalDFN" title="array" href="#dfn-array"><ins class="diff-chg">
array
</ins></a>,<ol class="algorithm"><li><ins class="diff-chg">
Initialize
</ins>
an
empty
<del class="diff-old">list
</del>
<ins class="diff-chg">array,
</ins><i><ins class="diff-chg">
result
</ins></i>.</li><li><ins class="diff-chg">
For
each
</ins><i><ins class="diff-chg">
item
</ins></i><ins class="diff-chg">
in
</ins><i><ins class="diff-chg">
element
</ins></i>:<ol class="algorithm"><li><ins class="diff-chg">
Initialize
</ins><i><ins class="diff-chg">
expanded
item
</ins></i><ins class="diff-chg">
to
the
result
</ins>
of
<del class="diff-old">terms
terms
that
will
</del>
<ins class="diff-chg">using
this
algorithm
recursively,
passing
</ins><a class="tref internalDFN" title="active-context" href="#dfn-active-context"><ins class="diff-chg">
active
context
</ins></a>,<a class="tref internalDFN" title="active-property" href="#dfn-active-property"><ins class="diff-chg">
active
property
</ins></a>,<ins class="diff-chg">
and
</ins><i><ins class="diff-chg">
item
</ins></i><ins class="diff-chg">
as
</ins><i><ins class="diff-chg">
element
</ins></i>.</li><li><ins class="diff-chg">
If
the
</ins><a class="tref internalDFN" title="active-property" href="#dfn-active-property"><ins class="diff-chg">
active
property
</ins></a><ins class="diff-chg">
is
</ins><code><ins class="diff-chg">
@list
</ins></code><ins class="diff-chg">
or
its
</ins><a class="tref internalDFN" title="container-mapping" href="#dfn-container-mapping"><ins class="diff-chg">
container
mapping
</ins></a><ins class="diff-chg">
is
set
to
</ins><code><ins class="diff-chg">
@list
</ins></code>,<ins class="diff-chg">
the
</ins><i><ins class="diff-chg">
expanded
item
</ins></i><ins class="diff-chg">
must
not
</ins>
be
<del class="diff-old">populated
with
term
</del>
<ins class="diff-chg">an
</ins><a class="tref internalDFN" title="array" href="#dfn-array"><ins class="diff-chg">
array
</ins>
</a>
<del class="diff-old">s
that
are
ranked
according
</del>
<ins class="diff-chg">or
a
</ins><a class="tref internalDFN" title="list-object" href="#dfn-list-object"><ins class="diff-chg">
list
object
</ins></a>,<ins class="diff-chg">
otherwise
a
</ins><code class="error"><a href="#idl-def-JsonLdErrorCode.list-of-lists"><ins class="diff-chg">
list
of
lists
</ins></a></code><ins class="diff-chg">
error
has
been
detected
and
processing
is
aborted.
</ins></li><li><ins class="diff-chg">
If
</ins><i><ins class="diff-chg">
expanded
item
</ins></i><ins class="diff-chg">
is
an
</ins><a class="tref internalDFN" title="array" href="#dfn-array"><ins class="diff-chg">
array
</ins></a>,<ins class="diff-chg">
append
each
of
its
items
</ins>
to
<del class="diff-old">how
closely
they
match
value
.
Initialize
highest
rank
</del>
<i>
<ins class="diff-chg">result
</ins></i>.<ins class="diff-chg">
Otherwise,
if
</ins><i><ins class="diff-chg">
expanded
item
</ins></i><ins class="diff-chg">
is
not
null,
append
it
</ins>
to
<i>
<ins class="diff-new">result
</ins></i>.</li></ol></li><li><ins class="diff-new">
Return
</ins><i><ins class="diff-new">
result
</ins></i>.</li></ol></li><li><ins class="diff-new">
Otherwise
</ins><i><ins class="diff-new">
element
</ins></i><ins class="diff-new">
is
a
</ins><a class="tref internalDFN" title="json-object" href="#dfn-json-object"><ins class="diff-new">
JSON
object
</ins></a>.</li><li><ins class="diff-new">
If
</ins><i><ins class="diff-new">
element
</ins></i><ins class="diff-new">
contains
the
key
</ins>
<code>
<del class="diff-old">0
</del>
<ins class="diff-chg">@context
</ins>
</code>,
<del class="diff-old">and
</del>
set
<del class="diff-old">a
flag
list
container
</del>
<a class="tref internalDFN" title="active-context" href="#dfn-active-context">
<ins class="diff-chg">active
context
</ins></a>
to
<ins class="diff-new">the
result
of
the
</ins><a href="#context-processing-algorithm"><ins class="diff-new">
Context
Processing
algorithm
</ins></a>,<ins class="diff-new">
passing
</ins><a class="tref internalDFN" title="active-context" href="#dfn-active-context"><ins class="diff-new">
active
context
</ins></a><ins class="diff-new">
and
the
value
of
the
</ins>
<code>
<del class="diff-old">false
.
</del>
<ins class="diff-chg">@context
</ins></code><ins class="diff-chg">
key
as
</ins><a class="tref internalDFN" title="local-context" href="#dfn-local-context"><ins class="diff-chg">
local
context
</ins></a>.</li><li><ins class="diff-chg">
Initialize
an
empty
</ins><a class="tref internalDFN" title="json-object" href="#dfn-json-object"><ins class="diff-chg">
JSON
object
</ins></a>,<i><ins class="diff-chg">
result
</ins></i>.
</li>
<li>
For
each
<del class="diff-old">term
</del>
<i>
<ins class="diff-chg">key
</ins></i><ins class="diff-chg">
and
</ins><i><ins class="diff-chg">
value
</ins></i>
in
<del class="diff-old">the
active
context
:
</del>
<i>
<ins class="diff-chg">element
</ins></i>,<ins class="diff-chg">
ordered
lexicographically
by
</ins><i><ins class="diff-chg">
key
</ins></i>:
<ol class="algorithm">
<li>
If
<i>
<ins class="diff-new">key
</ins></i><ins class="diff-new">
is
</ins><code><ins class="diff-new">
@context
</ins></code>,<ins class="diff-new">
continue
to
</ins>
the
<del class="diff-old">term
's
</del>
<ins class="diff-chg">next
</ins><i><ins class="diff-chg">
key
</ins></i>.</li><li><ins class="diff-chg">
Set
</ins><i><ins class="diff-chg">
expanded
property
</ins></i><ins class="diff-chg">
to
the
result
of
using
the
</ins><a href="#iri-expansion">
<abbr title="Internationalized Resource Identifier">
IRI
</abbr>
<ins class="diff-chg">Expansion
algorithm
</ins></a>,<ins class="diff-chg">
passing
</ins><a class="tref internalDFN" title="active-context" href="#dfn-active-context"><ins class="diff-chg">
active
context
</ins></a>,<i><ins class="diff-chg">
key
</ins></i><ins class="diff-chg">
for
</ins><i><ins class="diff-chg">
value
</ins></i>,<ins class="diff-chg">
and
</ins><a class="tref internalDFN" title="true" href="#dfn-true"><ins class="diff-chg">
true
</ins>
</a>
<ins class="diff-new">for
</ins><i><ins class="diff-new">
vocabRelative
</ins></i>.</li><li><ins class="diff-new">
If
</ins><i><ins class="diff-new">
expanded
property
</ins></i>
is
<del class="diff-old">not
</del>
<a class="tref internalDFN" title="null" href="#dfn-null">
<ins class="diff-chg">null
</ins></a><ins class="diff-chg">
or
it
neither
contains
</ins>
a
<del class="diff-old">complete
match
against
iri
,
continue
</del>
<ins class="diff-chg">colon
(
</ins><code>:</code><ins class="diff-chg">
)
nor
it
is
a
</ins><a class="tref internalDFN" title="keyword" href="#dfn-keyword"><ins class="diff-chg">
keyword
</ins></a>,<ins class="diff-chg">
drop
</ins><i><ins class="diff-chg">
key
</ins></i><ins class="diff-chg">
by
continuing
</ins>
to
the
next
<del class="diff-old">term
.
</del>
<i>
<ins class="diff-chg">key
</ins></i>.
</li>
<li>
If
<del class="diff-old">value
</del>
<i>
<ins class="diff-chg">expanded
property
</ins></i>
is
a
<del class="diff-old">JSON
object
containing
only
the
</del>
<a class="tref internalDFN" title="keyword" href="#dfn-keyword">
<ins class="diff-chg">keyword
</ins></a>:<ol class="algorithm"><li><ins class="diff-chg">
If
</ins><a class="tref internalDFN" title="active-property" href="#dfn-active-property"><ins class="diff-chg">
active
</ins>
property
</a>
<ins class="diff-new">equals
</ins>
<code>
<del class="diff-old">@list
:
</del>
<ins class="diff-chg">@reverse
</ins></code>,<ins class="diff-chg">
an
</ins><code class="error"><a href="#idl-def-JsonLdErrorCode.invalid-reverse-property-map"><ins class="diff-chg">
invalid
reverse
property
map
</ins></a></code><ins class="diff-chg">
error
has
been
detected
and
processing
is
aborted.
</ins></li>
<li>
If
<del class="diff-old">term
</del>
<i>
<ins class="diff-chg">result
</ins></i>
has
<ins class="diff-new">already
an
</ins><i><ins class="diff-new">
expanded
property
</ins></i><ins class="diff-new">
member,
an
</ins><code class="error"><a href="#idl-def-JsonLdErrorCode.colliding-keywords"><ins class="diff-new">
colliding
keywords
</ins></a></code><ins class="diff-new">
error
has
been
detected
and
processing
is
aborted.
</ins></li><li><ins class="diff-new">
If
</ins><i><ins class="diff-new">
expanded
property
</ins></i><ins class="diff-new">
is
</ins><code><ins class="diff-new">
@id
</ins></code><ins class="diff-new">
and
</ins><i><ins class="diff-new">
value
</ins></i><ins class="diff-new">
is
not
</ins>
a
<a class="tref internalDFN" title="string" href="#dfn-string">
<ins class="diff-new">string
</ins></a>,<ins class="diff-new">
an
</ins><code class="error"><a href="#idl-def-JsonLdErrorCode.invalid--id-value"><ins class="diff-new">
invalid
@id
value
</ins></a></code><ins class="diff-new">
error
has
been
detected
and
processing
is
aborted.
Otherwise,
set
</ins><i><ins class="diff-new">
expanded
value
</ins></i><ins class="diff-new">
to
the
result
of
using
the
</ins><a href="#iri-expansion"><abbr title="Internationalized Resource Identifier"><ins class="diff-new">
IRI
</ins></abbr><ins class="diff-new">
Expansion
algorithm
</ins></a>,<ins class="diff-new">
passing
</ins><a class="tref internalDFN" title="active-context" href="#dfn-active-context"><ins class="diff-new">
active
context
</ins></a>,<i><ins class="diff-new">
value
</ins></i>,<ins class="diff-new">
and
</ins><a class="tref internalDFN" title="true" href="#dfn-true"><ins class="diff-new">
true
</ins></a><ins class="diff-new">
for
</ins><i><ins class="diff-new">
documentRelative
</ins></i>.</li><li><ins class="diff-new">
If
</ins><i><ins class="diff-new">
expanded
property
</ins></i><ins class="diff-new">
is
</ins>
<code>
<del class="diff-old">@container
</del>
<ins class="diff-chg">@type
</ins></code><ins class="diff-chg">
and
</ins><i><ins class="diff-chg">
value
</ins></i><ins class="diff-chg">
is
neither
a
</ins><a class="tref internalDFN" title="string" href="#dfn-string"><ins class="diff-chg">
string
</ins></a><ins class="diff-chg">
nor
an
</ins><a class="tref internalDFN" title="array" href="#dfn-array"><ins class="diff-chg">
array
</ins></a><ins class="diff-chg">
of
</ins><a class="tref internalDFN" title="string" href="#dfn-string"><ins class="diff-chg">
strings
</ins></a>,<ins class="diff-chg">
an
</ins><code class="error"><a href="#idl-def-JsonLdErrorCode.invalid-type-value"><ins class="diff-chg">
invalid
type
value
</ins></a>
</code>
<ins class="diff-new">error
has
been
detected
and
processing
is
aborted.
Otherwise,
</ins>
set
<i>
<ins class="diff-new">expanded
value
</ins></i><ins class="diff-new">
to
the
result
of
using
the
</ins><a href="#iri-expansion"><abbr title="Internationalized Resource Identifier"><ins class="diff-new">
IRI
</ins></abbr><ins class="diff-new">
Expansion
algorithm
</ins></a>,<ins class="diff-new">
passing
</ins><a class="tref internalDFN" title="active-context" href="#dfn-active-context"><ins class="diff-new">
active
context
</ins></a>,<a class="tref internalDFN" title="true" href="#dfn-true"><ins class="diff-new">
true
</ins></a><ins class="diff-new">
for
</ins><i><ins class="diff-new">
vocabRelative
</ins></i>,<ins class="diff-new">
and
</ins><a class="tref internalDFN" title="true" href="#dfn-true"><ins class="diff-new">
true
</ins></a><ins class="diff-new">
for
</ins><i><ins class="diff-new">
documentRelative
</ins></i>
to
<ins class="diff-new">expand
the
</ins><i><ins class="diff-new">
value
</ins></i><ins class="diff-new">
or
each
of
its
items.
</ins></li><li><ins class="diff-new">
If
</ins><i><ins class="diff-new">
expanded
property
</ins></i><ins class="diff-new">
is
</ins>
<code>
<del class="diff-old">@set
</del>
<ins class="diff-chg">@graph
</ins>
</code>,
<del class="diff-old">continue
</del>
<ins class="diff-chg">set
</ins><i><ins class="diff-chg">
expanded
value
</ins></i>
to
the
<del class="diff-old">next
term
.
</del>
<ins class="diff-chg">result
of
using
this
algorithm
recursively
passing
</ins><a class="tref internalDFN" title="active-context" href="#dfn-active-context"><ins class="diff-chg">
active
context
</ins></a>,<code><ins class="diff-chg">
@graph
</ins></code><ins class="diff-chg">
for
</ins><a class="tref internalDFN" title="active-property" href="#dfn-active-property"><ins class="diff-chg">
active
property
</ins></a>,<ins class="diff-chg">
and
</ins><i><ins class="diff-chg">
value
</ins></i><ins class="diff-chg">
for
</ins><i><ins class="diff-chg">
element
</ins></i>.
</li>
<li>
If
<del class="diff-old">list
container
</del>
<i>
<ins class="diff-chg">expanded
property
</ins></i>
is
<code>
<del class="diff-old">true
</del>
<ins class="diff-chg">@value
</ins>
</code>
and
<del class="diff-old">term
does
</del>
<i>
<ins class="diff-chg">value
</ins></i><ins class="diff-chg">
is
</ins>
not
<del class="diff-old">have
</del>
a
<del class="diff-old">container
</del>
<a class="tref internalDFN" title="scalar" href="#dfn-scalar">
<ins class="diff-chg">scalar
</ins></a><ins class="diff-chg">
or
</ins><a class="tref internalDFN" title="null" href="#dfn-null"><ins class="diff-chg">
null
</ins></a>,<ins class="diff-chg">
an
</ins><code class="error"><a href="#idl-def-JsonLdErrorCode.invalid-value-object-value"><ins class="diff-chg">
invalid
value
object
value
</ins></a>
</code>
<ins class="diff-new">error
has
been
detected
and
processing
is
aborted.
Otherwise,
</ins>
set
<i>
<ins class="diff-new">expanded
value
</ins></i>
to
<i>
<ins class="diff-new">value
</ins></i>.<ins class="diff-new">
If
</ins><i><ins class="diff-new">
expanded
value
</ins></i><ins class="diff-new">
is
</ins><a class="tref internalDFN" title="null" href="#dfn-null"><ins class="diff-new">
null
</ins></a>,<ins class="diff-new">
set
the
</ins>
<code>
<del class="diff-old">@list
,
continue
</del>
<ins class="diff-chg">@value
</ins></code><ins class="diff-chg">
member
of
</ins><i><ins class="diff-chg">
result
</ins></i>
to
<a class="tref internalDFN" title="null" href="#dfn-null">
<ins class="diff-new">null
</ins></a><ins class="diff-new">
and
continue
with
</ins>
the
next
<del class="diff-old">term
.
</del>
<i>
<ins class="diff-chg">key
</ins></i><ins class="diff-chg">
from
</ins><i><ins class="diff-chg">
element
</ins></i>.<ins class="diff-chg">
Null
values
need
to
be
preserved
in
this
case
as
the
meaning
of
an
</ins><code><ins class="diff-chg">
@type
</ins></code><ins class="diff-chg">
member
depends
on
the
existence
of
an
</ins><code><ins class="diff-chg">
@value
</ins></code><ins class="diff-chg">
member.
</ins>
</li>
<li>
<del class="diff-old">Otherwise,
if
term
has
</del>
<ins class="diff-chg">If
</ins><i><ins class="diff-chg">
expanded
property
</ins></i><ins class="diff-chg">
is
</ins><code><ins class="diff-chg">
@language
</ins></code><ins class="diff-chg">
and
</ins><i><ins class="diff-chg">
value
</ins></i><ins class="diff-chg">
is
not
</ins>
a
<a class="tref internalDFN" title="string" href="#dfn-string">
<ins class="diff-new">string
</ins></a>,<ins class="diff-new">
an
</ins><code class="error"><a href="#idl-def-JsonLdErrorCode.invalid-language-tagged-string"><ins class="diff-new">
invalid
language-tagged
string
</ins></a></code><ins class="diff-new">
error
has
been
detected
and
processing
is
aborted.
Otherwise,
set
</ins><i><ins class="diff-new">
expanded
value
</ins></i><ins class="diff-new">
to
lowercased
</ins><i><ins class="diff-new">
value
</ins></i>.</li><li><ins class="diff-new">
If
</ins><i><ins class="diff-new">
expanded
property
</ins></i><ins class="diff-new">
is
</ins>
<code>
<del class="diff-old">container
</del>
<ins class="diff-chg">@index
</ins>
</code>
<ins class="diff-new">and
</ins><i><ins class="diff-new">
value
</ins></i><ins class="diff-new">
is
not
a
</ins><a class="tref internalDFN" title="string" href="#dfn-string"><ins class="diff-new">
string
</ins></a>,<ins class="diff-new">
an
</ins><code class="error"><a href="#idl-def-JsonLdErrorCode.invalid--index-value"><ins class="diff-new">
invalid
@index
value
</ins></a></code><ins class="diff-new">
error
has
been
detected
and
processing
is
aborted.
Otherwise,
</ins>
set
<i>
<ins class="diff-new">expanded
value
</ins></i>
to
<i>
<ins class="diff-new">value
</ins></i>.</li><li><ins class="diff-new">
If
</ins><i><ins class="diff-new">
expanded
property
</ins></i><ins class="diff-new">
is
</ins>
<code>
@list
</code>:
<ol class="algorithm">
<li>
<ins class="diff-new">If
</ins><a class="tref internalDFN" title="active-property" href="#dfn-active-property"><ins class="diff-new">
active
property
</ins></a><ins class="diff-new">
is
</ins><a class="tref internalDFN" title="null" href="#dfn-null"><ins class="diff-new">
null
</ins></a><ins class="diff-new">
or
</ins><code><ins class="diff-new">
@graph
</ins>
</code>,
continue
<del class="diff-old">to
</del>
<ins class="diff-chg">with
</ins>
the
next
<del class="diff-old">term
.
</del>
<i>
<ins class="diff-chg">key
</ins></i><ins class="diff-chg">
from
</ins><i><ins class="diff-chg">
element
</ins></i><ins class="diff-chg">
to
remove
the
free-floating
list..
</ins>
</li>
<li>
<del class="diff-old">Set
rank
</del>
<ins class="diff-chg">Otherwise,
initialize
</ins><i><ins class="diff-chg">
expanded
value
</ins></i>
to
the
<del class="diff-old">term
rank
</del>
<ins class="diff-chg">result
</ins>
of
<del class="diff-old">value
by
passing
</del>
<ins class="diff-chg">using
this
algorithm
recursively
</ins>
passing
<del class="diff-old">term
,
value
,
and
</del>
<a class="tref internalDFN" title="active-context" href="#dfn-active-context">
active
context
<del class="diff-old">to
the
Term
Rank
Algorithm
.
</del>
</a>,
<a class="tref internalDFN" title="active-property" href="#dfn-active-property">
<ins class="diff-chg">active
property
</ins></a>,<ins class="diff-chg">
and
</ins><i><ins class="diff-chg">
value
</ins></i><ins class="diff-chg">
for
</ins><i><ins class="diff-chg">
element
</ins></i>.
</li>
<li>
If
<del class="diff-old">rank
</del>
<i>
<ins class="diff-chg">expanded
value
</ins></i>
is
<del class="diff-old">greater
than
0
:
If
term
has
</del>
a
<del class="diff-old">container
</del>
<a class="tref internalDFN" title="list-object" href="#dfn-list-object">
<ins class="diff-chg">list
object
</ins></a>,<ins class="diff-chg">
a
</ins><code class="error"><a href="#idl-def-JsonLdErrorCode.list-of-lists"><ins class="diff-chg">
list
of
lists
</ins></a>
</code>
<del class="diff-old">set
to
</del>
<ins class="diff-chg">error
has
been
detected
and
processing
is
aborted.
</ins></li></ol></li><li><ins class="diff-chg">
If
</ins><i><ins class="diff-chg">
expanded
property
</ins></i><ins class="diff-chg">
is
</ins>
<code>
@set
</code>,
<del class="diff-old">then
add
1
</del>
<ins class="diff-chg">set
</ins><i><ins class="diff-chg">
expanded
value
</ins></i>
to
<del class="diff-old">rank
.
</del>
<ins class="diff-chg">the
result
of
using
this
algorithm
recursively,
passing
</ins><a class="tref internalDFN" title="active-context" href="#dfn-active-context"><ins class="diff-chg">
active
context
</ins></a>,<a class="tref internalDFN" title="active-property" href="#dfn-active-property"><ins class="diff-chg">
active
property
</ins></a>,<ins class="diff-chg">
and
</ins><i><ins class="diff-chg">
value
</ins></i><ins class="diff-chg">
for
</ins><i><ins class="diff-chg">
element
</ins></i>.
</li>
<li>
If
<i>
<ins class="diff-chg">expanded
property
</ins></i><ins class="diff-chg">
is
</ins><code><ins class="diff-chg">
@reverse
</ins></code><ins class="diff-chg">
and
</ins><i>
value
</i>
is
<ins class="diff-new">not
</ins>
a
<a class="tref internalDFN" title="json-object" href="#dfn-json-object">
JSON
object
</a>,
<ins class="diff-new">an
</ins><code class="error"><a href="#idl-def-JsonLdErrorCode.invalid--reverse-value"><ins class="diff-new">
invalid
@reverse
value
</ins>
</a>
<del class="diff-old">containing
only
the
property
@list
</del>
</code>
<ins class="diff-new">error
has
been
detected
</ins>
and
<del class="diff-old">list
container
</del>
<ins class="diff-chg">processing
</ins>
is
<ins class="diff-new">aborted.
Otherwise
</ins><ol class="algorithm"><li><ins class="diff-new">
Initialize
</ins><i><ins class="diff-new">
expanded
value
</ins></i><ins class="diff-new">
to
the
result
of
using
this
algorithm
recursively,
passing
</ins><a class="tref internalDFN" title="active-context" href="#dfn-active-context"><ins class="diff-new">
active
context
</ins></a>,
<code>
<del class="diff-old">false
</del>
<ins class="diff-chg">@reverse
</ins>
</code>
<ins class="diff-new">as
</ins><a class="tref internalDFN" title="active-property" href="#dfn-active-property"><ins class="diff-new">
active
property
</ins></a>,
and
<del class="diff-old">term
has
a
</del>
<i>
<ins class="diff-chg">value
</ins></i><ins class="diff-chg">
as
</ins><i><ins class="diff-chg">
element
</ins></i>.</li><li><ins class="diff-chg">
If
</ins><i><ins class="diff-chg">
expanded
value
</ins></i><ins class="diff-chg">
contains
an
</ins>
<code>
<del class="diff-old">container
</del>
<ins class="diff-chg">@reverse
</ins>
</code>
<ins class="diff-new">member,
i.e.,
properties
that
are
reversed
twice,
execute
for
each
of
its
</ins><i><ins class="diff-new">
property
</ins></i><ins class="diff-new">
and
</ins><i><ins class="diff-new">
item
</ins></i><ins class="diff-new">
the
following
steps:
</ins><ol class="algorithm"><li><ins class="diff-new">
If
</ins><i><ins class="diff-new">
result
</ins></i><ins class="diff-new">
does
not
have
a
</ins><i><ins class="diff-new">
property
</ins></i><ins class="diff-new">
member,
create
one
and
</ins>
set
<ins class="diff-new">its
value
</ins>
to
<del class="diff-old">@list
,
then
set
list
container
</del>
<ins class="diff-chg">an
empty
</ins><a class="tref internalDFN" title="array" href="#dfn-array"><ins class="diff-chg">
array
</ins></a>.</li><li><ins class="diff-chg">
Append
</ins><i><ins class="diff-chg">
item
</ins></i>
to
<ins class="diff-new">the
value
of
the
</ins><i><ins class="diff-new">
property
</ins></i><ins class="diff-new">
member
of
</ins><i><ins class="diff-new">
result
</ins></i>.</li></ol></li><li><ins class="diff-new">
If
</ins><i><ins class="diff-new">
expanded
value
</ins></i><ins class="diff-new">
contains
members
other
than
</ins>
<code>
<del class="diff-old">true
,
clear
terms
,
set
highest
rank
to
rank
,
</del>
<ins class="diff-chg">@reverse
</ins></code>:<ol class="algorithm"><li><ins class="diff-chg">
If
</ins><i><ins class="diff-chg">
result
</ins></i><ins class="diff-chg">
does
not
have
an
</ins><code><ins class="diff-chg">
@reverse
</ins></code><ins class="diff-chg">
member,
create
one
</ins>
and
<del class="diff-old">add
term
</del>
<ins class="diff-chg">set
its
value
</ins>
to
<del class="diff-old">terms
.
</del>
<ins class="diff-chg">an
empty
</ins><a class="tref internalDFN" title="json-object" href="#dfn-json-object"><ins class="diff-chg">
JSON
object
</ins></a>.
</li>
<li>
<del class="diff-old">Otherwise,
if
rank
is
greater
</del>
<ins class="diff-chg">Reference
the
value
of
the
</ins><code><ins class="diff-chg">
@reverse
</ins></code><ins class="diff-chg">
member
in
</ins><i><ins class="diff-chg">
result
</ins></i><ins class="diff-chg">
using
the
variable
</ins><i><ins class="diff-chg">
reverse
map
</ins></i>.</li><li><ins class="diff-chg">
For
each
</ins><i><ins class="diff-chg">
property
</ins></i><ins class="diff-chg">
and
</ins><i><ins class="diff-chg">
items
</ins></i><ins class="diff-chg">
in
</ins><i><ins class="diff-chg">
expanded
value
</ins></i><ins class="diff-chg">
other
</ins>
than
<del class="diff-old">or
equal
to
highest
rank
:
</del>
<code>
<ins class="diff-chg">@reverse
</ins></code>:<ol class="algorithm"><li><ins class="diff-chg">
For
each
</ins><i><ins class="diff-chg">
item
</ins></i><ins class="diff-chg">
in
</ins><i><ins class="diff-chg">
items
</ins></i>:
<ol class="algorithm">
<li>
If
<del class="diff-old">rank
</del>
<i>
<ins class="diff-chg">item
</ins></i>
is
<del class="diff-old">greater
than
highest
rank
,
clear
terms
</del>
<ins class="diff-chg">a
</ins><a class="tref internalDFN" title="value-object" href="#dfn-value-object"><ins class="diff-chg">
value
object
</ins></a><ins class="diff-chg">
or
</ins><a class="tref internalDFN" title="list-object" href="#dfn-list-object"><ins class="diff-chg">
list
object
</ins></a>,<ins class="diff-chg">
an
</ins><code class="error"><a href="#idl-def-JsonLdErrorCode.invalid--reverse-value"><ins class="diff-chg">
invalid
reverse
property
value
</ins></a></code><ins class="diff-chg">
has
been
detected
</ins>
and
<del class="diff-old">set
highest
rank
</del>
<ins class="diff-chg">processing
is
aborted.
</ins></li><li><ins class="diff-chg">
If
</ins><i><ins class="diff-chg">
reverse
map
</ins></i><ins class="diff-chg">
has
no
</ins><i><ins class="diff-chg">
property
</ins></i><ins class="diff-chg">
member,
create
one
and
initialize
its
value
</ins>
to
<del class="diff-old">rank
.
</del>
<ins class="diff-chg">an
empty
</ins><a class="tref internalDFN" title="array" href="#dfn-array"><ins class="diff-chg">
array
</ins></a>.
</li>
<li>
<del class="diff-old">Add
term
</del>
<ins class="diff-chg">Append
</ins><i><ins class="diff-chg">
item
</ins></i>
to
<del class="diff-old">terms
.
</del>
<ins class="diff-chg">the
value
of
the
</ins><i><ins class="diff-chg">
property
</ins></i><ins class="diff-chg">
member
in
</ins><i><ins class="diff-chg">
reverse
map
</ins></i>.
</li>
</ol>
</li>
</ol>
</li>
</ol>
</li>
<li>
<del class="diff-old">If
terms
</del>
<ins class="diff-chg">Continue
with
the
next
</ins><i><ins class="diff-chg">
key
</ins></i><ins class="diff-chg">
from
</ins><i><ins class="diff-chg">
element
</ins></i>.</li></ol></li><li><ins class="diff-chg">
Unless
</ins><i><ins class="diff-chg">
expanded
value
</ins></i>
is
<del class="diff-old">empty,
add
a
compact
IRI
representation
</del>
<a class="tref internalDFN" title="null" href="#dfn-null">
<ins class="diff-chg">null
</ins></a>,<ins class="diff-chg">
set
the
</ins><i><ins class="diff-chg">
expanded
property
</ins></i><ins class="diff-chg">
member
</ins>
of
<del class="diff-old">iri
for
each
term
</del>
<i>
<ins class="diff-chg">result
</ins></i><ins class="diff-chg">
to
</ins><i><ins class="diff-chg">
expanded
value
</ins></i>.</li><li><ins class="diff-chg">
Continue
with
the
next
</ins><i><ins class="diff-chg">
key
</ins></i><ins class="diff-chg">
from
</ins><i><ins class="diff-chg">
element.
</ins></i>.</li></ol></li><li><ins class="diff-chg">
Otherwise,
if
</ins><i><ins class="diff-chg">
key
</ins></i><ins class="diff-chg">
's
</ins><a class="tref internalDFN" title="container-mapping" href="#dfn-container-mapping"><ins class="diff-chg">
container
mapping
</ins>
</a>
in
<del class="diff-old">the
</del>
<a class="tref internalDFN" title="active-context" href="#dfn-active-context">
active
context
</a>
<del class="diff-old">which
maps
to
an
IRI
</del>
<ins class="diff-chg">is
</ins><code><ins class="diff-chg">
@language
</ins></code><ins class="diff-chg">
and
</ins><i><ins class="diff-chg">
value
</ins></i><ins class="diff-chg">
is
a
</ins><a class="tref internalDFN" title="json-object" href="#dfn-json-object"><ins class="diff-chg">
JSON
object
</ins>
</a>
<del class="diff-old">which
</del>
<ins class="diff-chg">then
</ins><i><ins class="diff-chg">
value
</ins></i>
is
<ins class="diff-new">expanded
from
</ins>
a
<del class="diff-old">prefix
for
iri
where
the
resulting
compact
IRI
</del>
<a class="tref externalDFN" title="language-map" href="../json-ld-syntax/#dfn-language-map">
<ins class="diff-chg">language
map
</ins>
</a>
<ins class="diff-new">as
follows:
</ins><ol class="algorithm"><li><ins class="diff-new">
Initialize
</ins><i><ins class="diff-new">
expanded
value
</ins></i><ins class="diff-new">
to
an
empty
</ins><a class="tref internalDFN" title="array" href="#dfn-array"><ins class="diff-new">
array
</ins></a>.</li><li><ins class="diff-new">
For
each
key-value
pair
</ins><i><ins class="diff-new">
language
</ins></i><ins class="diff-new">
-
</ins><i><ins class="diff-new">
language
value
</ins></i><ins class="diff-new">
in
</ins><i><ins class="diff-new">
value
</ins></i>,<ins class="diff-new">
ordered
lexicographically
by
</ins><i><ins class="diff-new">
language
</ins></i>:<ol class="algorithm"><li><ins class="diff-new">
If
</ins><i><ins class="diff-new">
language
value
</ins></i>
is
not
<del class="diff-old">a
term
</del>
<ins class="diff-chg">an
</ins><a class="tref internalDFN" title="array" href="#dfn-array"><ins class="diff-chg">
array
</ins></a><ins class="diff-chg">
set
it
to
an
</ins><a class="tref internalDFN" title="array" href="#dfn-array"><ins class="diff-chg">
array
</ins>
</a>
<ins class="diff-new">containing
only
</ins><i><ins class="diff-new">
language
value
</ins></i>.</li><li><ins class="diff-new">
For
each
</ins><i><ins class="diff-new">
item
</ins></i>
in
<del class="diff-old">the
active
context
.
The
resulting
compact
IRI
</del>
<i>
<ins class="diff-chg">language
value
</ins></i>:<ol class="algorithm"><li>
<i>
<ins class="diff-new">item
</ins></i><ins class="diff-new">
must
be
a
</ins><a class="tref internalDFN" title="string" href="#dfn-string"><ins class="diff-new">
string
</ins></a>,<ins class="diff-new">
otherwise
an
</ins><code class="error"><a href="#idl-def-JsonLdErrorCode.invalid-language-map-value"><ins class="diff-new">
invalid
language
map
value
</ins>
</a>
</code>
<ins class="diff-new">error
has
been
detected
and
processing
</ins>
is
<del class="diff-old">the
term
</del>
<ins class="diff-chg">aborted.
</ins></li><li><ins class="diff-chg">
Append
a
</ins><a class="tref internalDFN" title="json-object" href="#dfn-json-object"><ins class="diff-chg">
JSON
object
</ins></a><ins class="diff-chg">
to
</ins><i><ins class="diff-chg">
expanded
value
</ins></i><ins class="diff-chg">
that
consists
of
two
key-value
pairs:
(
</ins><code><ins class="diff-chg">
@value
</ins></code><ins class="diff-chg">
-
</ins><i><ins class="diff-chg">
item
</ins></i><ins class="diff-chg">
)
and
(
</ins><code><ins class="diff-chg">
@language
</ins></code><ins class="diff-chg">
-lowercased
</ins><i><ins class="diff-chg">
language
</ins></i><ins class="diff-chg">
).
</ins></li></ol></li></ol></li></ol></li><li><ins class="diff-chg">
Otherwise,
if
</ins><i><ins class="diff-chg">
key
</ins></i><ins class="diff-chg">
's
</ins><a class="tref internalDFN" title="container-mapping" href="#dfn-container-mapping"><ins class="diff-chg">
container
mapping
</ins>
</a>
<del class="diff-old">associated
with
the
partially
matched
IRI
</del>
in
<del class="diff-old">the
</del>
<a class="tref internalDFN" title="active-context" href="#dfn-active-context">
active
context
</a>
<del class="diff-old">concatenated
with
a
colon
(:)
character
</del>
<ins class="diff-chg">is
</ins><code><ins class="diff-chg">
@index
</ins></code>
and
<del class="diff-old">the
unmatched
part
of
iri
.
</del>
<i>
<ins class="diff-chg">value
</ins></i><ins class="diff-chg">
is
a
</ins><a class="tref internalDFN" title="json-object" href="#dfn-json-object"><ins class="diff-chg">
JSON
object
</ins></a><ins class="diff-chg">
then
</ins><i><ins class="diff-chg">
value
</ins></i><ins class="diff-chg">
is
expanded
from
an
index
map
as
follows:
</ins><ol class="algorithm"><li><ins class="diff-chg">
Initialize
</ins><i><ins class="diff-chg">
expanded
value
</ins></i><ins class="diff-chg">
to
an
empty
</ins><a class="tref internalDFN" title="array" href="#dfn-array"><ins class="diff-chg">
array
</ins></a>.
</li>
<li>
<ins class="diff-new">For
each
key-value
pair
</ins><i><ins class="diff-new">
index
</ins></i><ins class="diff-new">
-
</ins><i><ins class="diff-new">
index
value
</ins></i><ins class="diff-new">
in
</ins><i><ins class="diff-new">
value
</ins></i>,<ins class="diff-new">
ordered
lexicographically
by
</ins><i><ins class="diff-new">
index
</ins></i>:<ol class="algorithm"><li>
If
<del class="diff-old">terms
</del>
<i>
<ins class="diff-chg">index
value
</ins></i>
is
<del class="diff-old">empty,
return
iri
.
</del>
<ins class="diff-chg">not
an
</ins><a class="tref internalDFN" title="array" href="#dfn-array"><ins class="diff-chg">
array
</ins></a><ins class="diff-chg">
set
it
to
an
</ins><a class="tref internalDFN" title="array" href="#dfn-array"><ins class="diff-chg">
array
</ins></a><ins class="diff-chg">
containing
only
</ins><i><ins class="diff-chg">
index
value
</ins></i>.
</li>
<li>
<del class="diff-old">Otherwise,
return
</del>
<ins class="diff-chg">Initialize
</ins><i><ins class="diff-chg">
index
value
</ins></i><ins class="diff-chg">
to
</ins>
the
<del class="diff-old">shortest
</del>
<ins class="diff-chg">result
of
using
this
algorithm
recursively,
passing
</ins><a class="tref internalDFN" title="active-context" href="#dfn-active-context"><ins class="diff-chg">
active
context
</ins></a>,<i><ins class="diff-chg">
key
</ins></i><ins class="diff-chg">
as
</ins><a class="tref internalDFN" title="active-property" href="#dfn-active-property"><ins class="diff-chg">
active
property
</ins></a>,
and
<del class="diff-old">lexicographically
least
</del>
<i>
<ins class="diff-chg">index
</ins>
value
<del class="diff-old">in
terms
.
</del>
</i>
<ins class="diff-chg">as
</ins><i><ins class="diff-chg">
element
</ins></i>.
</li>
<del class="diff-old">4.4.2
Term
Rank
Algorithm
When
selecting
among
multiple
possible
terms
for
a
given
property,
it
may
be
that
multiple
terms
are
defined
with
the
same
IRI
,
but
differ
</del>
<li>
<ins class="diff-chg">For
each
</ins><i><ins class="diff-chg">
item
</ins></i>
in
<i>
<ins class="diff-new">index
value
</ins></i>:<ol class="algorithm"><li><ins class="diff-new">
If
</ins><i><ins class="diff-new">
item
</ins></i><ins class="diff-new">
does
not
have
the
key
</ins>
<code>
<del class="diff-old">@type
</del>
<ins class="diff-chg">@index
</ins>
</code>,
<ins class="diff-new">add
the
key-value
pair
(
</ins>
<code>
<del class="diff-old">@container
</del>
<ins class="diff-chg">@index
</ins>
</code>
<del class="diff-old">or
@language
.
The
purpose
</del>
<ins class="diff-chg">-
</ins><i><ins class="diff-chg">
index
</ins></i><ins class="diff-chg">
)
to
</ins><i><ins class="diff-chg">
item
</ins></i>.</li><li><ins class="diff-chg">
Append
</ins><i><ins class="diff-chg">
item
</ins></i><ins class="diff-chg">
to
</ins><i><ins class="diff-chg">
expanded
value
</ins></i>.</li></ol></li></ol></li></ol></li><li><ins class="diff-chg">
Otherwise,
initialize
</ins><i><ins class="diff-chg">
expanded
value
</ins></i><ins class="diff-chg">
to
the
result
</ins>
of
<ins class="diff-new">using
</ins>
this
algorithm
<ins class="diff-new">recursively,
passing
</ins><a class="tref internalDFN" title="active-context" href="#dfn-active-context"><ins class="diff-new">
active
context
</ins></a>,<i><ins class="diff-new">
key
</ins></i><ins class="diff-new">
for
</ins><a class="tref internalDFN" title="active-property" href="#dfn-active-property"><ins class="diff-new">
active
property
</ins></a>,<ins class="diff-new">
and
</ins><i><ins class="diff-new">
value
</ins></i><ins class="diff-new">
for
</ins><i><ins class="diff-new">
element
</ins></i>.</li><li><ins class="diff-new">
If
</ins><i><ins class="diff-new">
expanded
value
</ins></i>
is
<a class="tref internalDFN" title="null" href="#dfn-null">
<ins class="diff-new">null
</ins></a>,<ins class="diff-new">
ignore
</ins><i><ins class="diff-new">
key
</ins></i><ins class="diff-new">
by
continuing
</ins>
to
<del class="diff-old">take
a
term
</del>
<ins class="diff-chg">the
next
</ins><i><ins class="diff-chg">
key
</ins></i><ins class="diff-chg">
from
</ins><i><ins class="diff-chg">
element
</ins></i>.</li><li><ins class="diff-chg">
If
the
</ins><a class="tref internalDFN" title="container-mapping" href="#dfn-container-mapping"><ins class="diff-chg">
container
mapping
</ins>
</a>
<ins class="diff-new">associated
to
</ins><i><ins class="diff-new">
key
</ins></i><ins class="diff-new">
in
</ins><a class="tref internalDFN" title="active-context" href="#dfn-active-context"><ins class="diff-new">
active
context
</ins></a><ins class="diff-new">
is
</ins><code><ins class="diff-new">
@list
</ins></code>
and
<i>
<ins class="diff-new">expanded
value
</ins></i><ins class="diff-new">
is
not
already
a
</ins><a class="tref internalDFN" title="list-object" href="#dfn-list-object"><ins class="diff-new">
list
object
</ins></a>,<ins class="diff-new">
convert
</ins><i><ins class="diff-new">
expanded
value
</ins></i><ins class="diff-new">
to
</ins>
a
<a class="tref internalDFN" title="list-object" href="#dfn-list-object">
<ins class="diff-new">list
object
</ins></a><ins class="diff-new">
by
first
setting
it
to
an
</ins><a class="tref internalDFN" title="array" href="#dfn-array"><ins class="diff-new">
array
</ins></a><ins class="diff-new">
containing
only
</ins><i><ins class="diff-new">
expanded
</ins>
value
</i>
<ins class="diff-new">if
it
is
not
already
an
</ins><a class="tref internalDFN" title="array" href="#dfn-array"><ins class="diff-new">
array
</ins></a>,
and
<del class="diff-old">give
</del>
<ins class="diff-chg">then
by
setting
</ins>
it
<ins class="diff-new">to
</ins>
a
<del class="diff-old">term
rank
.
The
selection
can
then
be
based,
partly,
on
</del>
<a class="tref internalDFN" title="json-object" href="#dfn-json-object">
<ins class="diff-chg">JSON
object
</ins></a><ins class="diff-chg">
containing
</ins>
the
<del class="diff-old">term
having
</del>
<ins class="diff-chg">key-value
pair
</ins><code><ins class="diff-chg">
@list
</ins></code><ins class="diff-chg">
-
</ins><i><ins class="diff-chg">
expanded
value
</ins></i>.</li><li><ins class="diff-chg">
Otherwise,
if
</ins>
the
<del class="diff-old">highest
</del>
<a class="tref internalDFN" title="term-definition" href="#dfn-term-definition">
term
<del class="diff-old">rank
.
Given
</del>
<ins class="diff-chg">definition
</ins></a><ins class="diff-chg">
associated
to
</ins><i><ins class="diff-chg">
key
</ins></i><ins class="diff-chg">
indicates
that
it
is
</ins>
a
<del class="diff-old">term
</del>
<a class="tref internalDFN" title="reverse-property" href="#dfn-reverse-property">
<ins class="diff-chg">reverse
property
</ins>
</a>
<del class="diff-old">term
,
value
,
</del>
<ol class="algorithm">
<li>
<ins class="diff-chg">If
</ins><i><ins class="diff-chg">
result
</ins></i><ins class="diff-chg">
has
no
</ins><code><ins class="diff-chg">
@reverse
</ins></code><ins class="diff-chg">
member,
create
one
</ins>
and
<del class="diff-old">active
context
determine
</del>
<ins class="diff-chg">initialize
its
value
to
an
empty
</ins><a class="tref internalDFN" title="json-object" href="#dfn-json-object"><ins class="diff-chg">
JSON
object
</ins></a>.</li><li><ins class="diff-chg">
Reference
</ins>
the
<del class="diff-old">term
rank
</del>
<ins class="diff-chg">value
of
the
</ins><code><ins class="diff-chg">
@reverse
</ins></code><ins class="diff-chg">
member
in
</ins><i><ins class="diff-chg">
result
</ins></i>
using
the
<del class="diff-old">following
steps:
</del>
<ins class="diff-chg">variable
</ins><i><ins class="diff-chg">
reverse
map
</ins></i>.</li>
<li>
If
<i>
<ins class="diff-chg">expanded
</ins>
value
</i>
is
<del class="diff-old">null
</del>
<ins class="diff-chg">not
an
</ins><a class="tref internalDFN" title="array" href="#dfn-array"><ins class="diff-chg">
array
</ins>
</a>,
<del class="diff-old">term
rank
</del>
<ins class="diff-chg">set
it
to
an
</ins><a class="tref internalDFN" title="array" href="#dfn-array"><ins class="diff-chg">
array
</ins>
</a>
<del class="diff-old">is
3
.
</del>
<ins class="diff-chg">containing
</ins><i><ins class="diff-chg">
expanded
value
</ins></i>.
</li>
<li>
<del class="diff-old">Otherwise,
if
</del>
<ins class="diff-chg">For
each
</ins><i><ins class="diff-chg">
item
</ins></i><ins class="diff-chg">
in
</ins><i><ins class="diff-chg">
expanded
</ins>
value
</i>
<ol class="algorithm">
<li>
<ins class="diff-chg">If
</ins><i><ins class="diff-chg">
item
</ins></i>
is
a
<del class="diff-old">JSON
</del>
<a class="tref internalDFN" title="value-object" href="#dfn-value-object">
<ins class="diff-chg">value
</ins>
object
</a>
<del class="diff-old">containing
only
the
</del>
<ins class="diff-chg">or
</ins><a class="tref internalDFN" title="list-object" href="#dfn-list-object"><ins class="diff-chg">
list
object
</ins></a>,<ins class="diff-chg">
an
</ins><code class="error"><a href="#idl-def-JsonLdErrorCode.invalid--reverse-value"><ins class="diff-chg">
invalid
reverse
</ins>
property
<del class="diff-old">@list
:
</del>
<ins class="diff-chg">value
</ins></a></code><ins class="diff-chg">
has
been
detected
and
processing
is
aborted.
</ins></li>
<li>
If
<del class="diff-old">the
@list
</del>
<i>
<ins class="diff-chg">reverse
map
</ins></i><ins class="diff-chg">
has
no
</ins><i><ins class="diff-chg">
expanded
</ins>
property
<del class="diff-old">is
</del>
</i>
<ins class="diff-chg">member,
create
one
and
initialize
its
value
to
</ins>
an
empty
<del class="diff-old">array,
if
term
has
@container
set
to
@list
,
term
rank
is
1
,
otherwise
0
.
</del>
<a class="tref internalDFN" title="array" href="#dfn-array">
<ins class="diff-chg">array
</ins></a>.
</li>
<li>
<del class="diff-old">Otherwise,
return
</del>
<ins class="diff-chg">Append
</ins><i><ins class="diff-chg">
item
</ins></i><ins class="diff-chg">
to
</ins>
the
<del class="diff-old">sum
</del>
<ins class="diff-chg">value
</ins>
of
the
<del class="diff-old">term
rank
s
for
every
entry
in
the
list.
</del>
<i>
<ins class="diff-chg">expanded
property
</ins></i><ins class="diff-chg">
member
of
</ins><i><ins class="diff-chg">
reverse
map
</ins></i>.</li></ol>
</li>
</ol>
</li>
<li>
Otherwise,
<del class="diff-old">value
must
be
a
subject
definition
,
subject
reference
,
or
a
JSON
object
having
</del>
<ins class="diff-chg">if
</ins><i><ins class="diff-chg">
key
</ins></i><ins class="diff-chg">
is
not
</ins>
a
<del class="diff-old">@value
.
</del>
<a class="tref internalDFN" title="reverse-property" href="#dfn-reverse-property">
<ins class="diff-chg">reverse
property
</ins></a>:
<ol class="algorithm">
<li>
If
<i>
<ins class="diff-chg">result
</ins></i><ins class="diff-chg">
does
not
have
an
</ins><i><ins class="diff-chg">
expanded
property
</ins></i><ins class="diff-chg">
member,
create
one
and
initialize
its
</ins>
value
<del class="diff-old">has
a
@value
property:
</del>
<ins class="diff-chg">to
an
empty
</ins><a class="tref internalDFN" title="array" href="#dfn-array"><ins class="diff-chg">
array
</ins></a>.</li>
<li>
<del class="diff-old">If
</del>
<ins class="diff-chg">Append
</ins><i><ins class="diff-chg">
expanded
</ins>
value
<del class="diff-old">has
a
@type
</del>
</i>
<ins class="diff-chg">to
value
of
the
</ins><i><ins class="diff-chg">
expanded
</ins>
property
<del class="diff-old">matching
a
</del>
</i>
<ins class="diff-chg">member
of
</ins><i><ins class="diff-chg">
result
</ins></i>.</li></ol></li></ol></li><li><ins class="diff-chg">
If
</ins><i><ins class="diff-chg">
result
</ins></i><ins class="diff-chg">
contains
the
key
</ins>
<code>
<del class="diff-old">@type
coercion
for
term
,
term
rank
is
</del>
<ins class="diff-chg">@value
</ins></code>:<ol class="algorithm"><li><ins class="diff-chg">
The
</ins><i><ins class="diff-chg">
result
</ins></i><ins class="diff-chg">
must
not
contain
any
keys
other
than
</ins>
<code>
<del class="diff-old">3
</del>
<ins class="diff-chg">@value
</ins>
</code>,
<del class="diff-old">otherwise
if
term
has
no
@type
coercion
and
no
</del>
<code>
@language
</code>,
<del class="diff-old">term
rank
is
</del>
<code>
<del class="diff-old">1
</del>
<ins class="diff-chg">@type
</ins>
</code>,
<del class="diff-old">otherwise
</del>
<ins class="diff-chg">and
</ins>
<code>
<del class="diff-old">0
</del>
<ins class="diff-chg">@index
</ins>
</code>.
<del class="diff-old">Otherwise,
if
</del>
<ins class="diff-chg">It
must
not
contain
both
the
</ins>
<code>
<del class="diff-old">@value
</del>
<ins class="diff-chg">@language
</ins>
</code>
<del class="diff-old">is
not
a
string
,
if
term
has
no
</del>
<ins class="diff-chg">key
and
the
</ins>
<code>
@type
</code>
<del class="diff-old">or
@language
</del>
<ins class="diff-chg">key.
Otherwise,
an
</ins><code class="error"><a href="#idl-def-JsonLdErrorCode.invalid-value-object"><ins class="diff-chg">
invalid
value
object
</ins></a>
</code>
<del class="diff-old">it
</del>
<ins class="diff-chg">error
has
been
detected
and
processing
</ins>
is
<del class="diff-old">2
,
otherwise
1
.
</del>
<ins class="diff-chg">aborted.
</ins>
</li>
<li>
<del class="diff-old">Otherwise,
if
</del>
<ins class="diff-chg">If
the
</ins>
value
<del class="diff-old">has
no
@language
property,
if
term
has
</del>
<ins class="diff-chg">of
</ins><i><ins class="diff-chg">
result
</ins></i><ins class="diff-chg">
's
</ins>
<code>
<del class="diff-old">@language
</del>
<ins class="diff-chg">@value
</ins>
</code>
<ins class="diff-new">key
is
</ins>
<a class="tref internalDFN" title="null" href="#dfn-null">
null
</a>,
<del class="diff-old">or
term
has
no
@type
or
</del>
<ins class="diff-chg">then
set
</ins><i><ins class="diff-chg">
result
</ins></i><ins class="diff-chg">
to
</ins><a class="tref internalDFN" title="null" href="#dfn-null"><ins class="diff-chg">
null
</ins></a>.</li><li><ins class="diff-chg">
Otherwise,
if
the
value
of
</ins><i><ins class="diff-chg">
result
</ins></i><ins class="diff-chg">
's
</ins>
<code>
<del class="diff-old">@language
</del>
<ins class="diff-chg">@value
</ins>
</code>
<ins class="diff-new">member
is
not
a
</ins><a class="tref internalDFN" title="string" href="#dfn-string"><ins class="diff-new">
string
</ins></a>
and
<i>
<ins class="diff-new">result
</ins></i><ins class="diff-new">
contains
</ins>
the
<del class="diff-old">active
context
has
no
</del>
<ins class="diff-chg">key
</ins>
<code>
@language
</code>,
<del class="diff-old">term
rank
</del>
<ins class="diff-chg">an
</ins><code class="error"><a href="#idl-def-JsonLdErrorCode.invalid-language-tagged-value"><ins class="diff-chg">
invalid
language-tagged
value
</ins>
</a>
</code>
<ins class="diff-new">error
has
been
detected
(only
</ins><a class="tref internalDFN" title="string" href="#dfn-string"><ins class="diff-new">
strings
</ins></a><ins class="diff-new">
can
be
language-tagged)
and
processing
</ins>
is
<del class="diff-old">3
,
otherwise
0
.
</del>
<ins class="diff-chg">aborted.
</ins>
</li>
<li>
Otherwise,
if
<del class="diff-old">value
</del>
<ins class="diff-chg">the
</ins><i><ins class="diff-chg">
result
</ins></i>
has
a
<code>
<del class="diff-old">@language
</del>
<ins class="diff-chg">@type
</ins>
</code>
<del class="diff-old">property
matching
</del>
<ins class="diff-chg">member
and
its
value
is
not
</ins>
a
<del class="diff-old">@language
</del>
<a class="tref internalDFN" title="string" href="#dfn-string">
<ins class="diff-chg">string
</ins></a>,<ins class="diff-chg">
an
</ins><code class="error"><a href="#idl-def-JsonLdErrorCode.invalid-typed-value"><ins class="diff-chg">
invalid
typed
value
</ins></a>
</code>
<del class="diff-old">definition
for
term
(or
term
</del>
<ins class="diff-chg">error
</ins>
has
<del class="diff-old">no
</del>
<ins class="diff-chg">been
detected
and
processing
is
aborted.
</ins></li></ol></li><li><ins class="diff-chg">
Otherwise,
if
</ins><i><ins class="diff-chg">
result
</ins></i><ins class="diff-chg">
contains
the
key
</ins>
<code>
@type
</code>
<del class="diff-old">or
@language
definition
</del>
and
<del class="diff-old">@language
in
the
active
context
matches
the
</del>
<ins class="diff-chg">its
associated
</ins>
value
<del class="diff-old">@language
),
term
rank
</del>
is
<del class="diff-old">3
,
otherwise
</del>
<ins class="diff-chg">not
an
</ins><a class="tref internalDFN" title="array" href="#dfn-array"><ins class="diff-chg">
array
</ins></a>,<ins class="diff-chg">
set
it
to
an
</ins><a class="tref internalDFN" title="array" href="#dfn-array"><ins class="diff-chg">
array
</ins></a><ins class="diff-chg">
containing
only
the
associated
value.
</ins></li><li><ins class="diff-chg">
Otherwise,
</ins>
if
<del class="diff-old">term
has
no
</del>
<i>
<ins class="diff-chg">result
</ins></i><ins class="diff-chg">
contains
the
key
</ins>
<code>
<del class="diff-old">@type
</del>
<ins class="diff-chg">@set
</ins>
</code>
<del class="diff-old">coercion
</del>
<ins class="diff-chg">or
</ins><code><ins class="diff-chg">
@list
</ins></code>:<ol class="algorithm"><li><ins class="diff-chg">
The
</ins><i><ins class="diff-chg">
result
</ins></i><ins class="diff-chg">
must
contain
at
most
one
other
key
</ins>
and
<del class="diff-old">no
</del>
<ins class="diff-chg">that
key
must
be
</ins>
<code>
<del class="diff-old">@language
,
term
rank
</del>
<ins class="diff-chg">@index
</ins></code>.<ins class="diff-chg">
Otherwise,
an
</ins><code class="error"><a href="#idl-def-JsonLdErrorCode.invalid-set-or-list-object"><ins class="diff-chg">
invalid
set
or
list
object
</ins>
</a>
</code>
<ins class="diff-new">error
has
been
detected
and
processing
</ins>
is
<ins class="diff-new">aborted.
</ins></li><li><ins class="diff-new">
If
</ins><i><ins class="diff-new">
result
</ins></i><ins class="diff-new">
contains
the
key
</ins>
<code>
<del class="diff-old">1
</del>
<ins class="diff-chg">@set
</ins>
</code>,
<del class="diff-old">otherwise
0
.
</del>
<ins class="diff-chg">then
set
</ins><i><ins class="diff-chg">
result
</ins></i><ins class="diff-chg">
to
the
key's
associated
value.
</ins>
</li>
</ol>
</li>
<li>
<del class="diff-old">Otherwise,
if
term
has
@type
coerced
to
</del>
<ins class="diff-chg">If
</ins><i><ins class="diff-chg">
result
</ins></i><ins class="diff-chg">
contains
only
the
key
</ins>
<code>
<del class="diff-old">@id
</del>
<ins class="diff-chg">@language
</ins>
</code>,
<del class="diff-old">term
rank
</del>
<ins class="diff-chg">set
</ins><i><ins class="diff-chg">
result
</ins></i><ins class="diff-chg">
to
</ins><a class="tref internalDFN" title="null" href="#dfn-null"><ins class="diff-chg">
null
</ins></a>.</li><li><ins class="diff-chg">
If
</ins><a class="tref internalDFN" title="active-property" href="#dfn-active-property"><ins class="diff-chg">
active
property
</ins>
</a>
is
<a class="tref internalDFN" title="null" href="#dfn-null">
<ins class="diff-new">null
</ins></a><ins class="diff-new">
or
</ins>
<code>
<del class="diff-old">3
</del>
<ins class="diff-chg">@graph
</ins>
</code>,
<del class="diff-old">otherwise
if
term
has
no
</del>
<ins class="diff-chg">drop
free-floating
values
as
follows:
</ins><ol class="algorithm"><li><ins class="diff-chg">
If
</ins><i><ins class="diff-chg">
result
</ins></i><ins class="diff-chg">
is
an
empty
</ins><a class="tref internalDFN" title="json-object" href="#dfn-json-object"><ins class="diff-chg">
JSON
object
</ins></a><ins class="diff-chg">
or
contains
the
keys
</ins>
<code>
<del class="diff-old">@type
</del>
<ins class="diff-chg">@value
</ins>
</code>
<del class="diff-old">coercion
and
no
</del>
<ins class="diff-chg">or
</ins>
<code>
<del class="diff-old">@language
</del>
<ins class="diff-chg">@list
</ins>
</code>,
<del class="diff-old">term
rank
</del>
<ins class="diff-chg">set
</ins><i><ins class="diff-chg">
result
</ins></i><ins class="diff-chg">
to
</ins><a class="tref internalDFN" title="null" href="#dfn-null"><ins class="diff-chg">
null
</ins></a>.</li><li><ins class="diff-chg">
Otherwise,
if
</ins><i><ins class="diff-chg">
result
</ins></i><ins class="diff-chg">
is
a
</ins><a class="tref internalDFN" title="json-object" href="#dfn-json-object"><ins class="diff-chg">
JSON
object
</ins>
</a>
<ins class="diff-new">whose
only
key
</ins>
is
<code>
<del class="diff-old">1
</del>
<ins class="diff-chg">@id
</ins>
</code>,
<del class="diff-old">otherwise
0
.
</del>
<ins class="diff-chg">set
</ins><i><ins class="diff-chg">
result
</ins></i><ins class="diff-chg">
to
</ins><a class="tref internalDFN" title="null" href="#dfn-null"><ins class="diff-chg">
null
</ins></a>.
</li>
</ol>
</li>
<li>
Return
<del class="diff-old">term
rank
.
</del>
<i>
<ins class="diff-chg">result
</ins></i>.
</li>
</ol>
<p>
<ins class="diff-chg">If,
after
the
above
algorithm
is
run,
the
result
is
a
</ins><a class="tref internalDFN" title="json-object" href="#dfn-json-object"><ins class="diff-chg">
JSON
object
</ins></a><ins class="diff-chg">
that
contains
only
an
</ins><code><ins class="diff-chg">
@graph
</ins></code><ins class="diff-chg">
key,
set
the
result
to
the
value
of
</ins><code><ins class="diff-chg">
@graph
</ins></code><ins class="diff-chg">
's
value.
Otherwise,
if
the
result
is
</ins><a class="tref internalDFN" title="null" href="#dfn-null"><ins class="diff-chg">
null
</ins></a>,<ins class="diff-chg">
set
it
to
an
empty
</ins><a class="tref internalDFN" title="array" href="#dfn-array"><ins class="diff-chg">
array
</ins></a>.<ins class="diff-chg">
Finally,
if
the
result
is
not
an
</ins><a class="tref internalDFN" title="array" href="#dfn-array"><ins class="diff-chg">
array
</ins></a>,<ins class="diff-chg">
then
set
the
result
to
an
</ins><a class="tref internalDFN" title="array" href="#dfn-array"><ins class="diff-chg">
array
</ins></a><ins class="diff-chg">
containing
only
the
result.
</ins></p></section></section><section id="value-expansion">
<h3>
<span class="secno">
<del class="diff-old">4.5
</del>
<ins class="diff-chg">7.2
</ins>
</span>
Value
Expansion
</h3>
<p>
Some
values
in
JSON-LD
can
be
expressed
in
a
<a class="tref internalDFN" title="compacted-form" href="#dfn-compacted-form">
compact
<del class="diff-old">form.
</del>
<ins class="diff-chg">form
</ins></a>.
These
values
are
required
to
be
<a class="tref internalDFN" title="expansion" href="#dfn-expansion">
expanded
</a>
at
times
when
processing
JSON-LD
documents.
<del class="diff-old">The
algorithm
for
expanding
a
</del>
<ins class="diff-chg">A
</ins>
value
<del class="diff-old">takes
an
active
property
and
active
context
.
It
</del>
is
<del class="diff-old">implemented
as
follows:
</del>
<ins class="diff-chg">said
to
be
in
</ins><dfn title="expanded-form" id="dfn-expanded-form"><ins class="diff-chg">
expanded
form
</ins></dfn><ins class="diff-chg">
after
the
application
of
this
algorithm.
</ins>
</p>
<del class="diff-old">If
</del>
<section class="informative">
<h4 id="general-solution-4">
<ins class="diff-chg">General
Solution
</ins></h4><p>
<em>
<del class="diff-old">value
</del>
<ins class="diff-chg">This
section
</ins>
is
<del class="diff-old">null
,
the
value
</del>
<ins class="diff-chg">non-normative.
</ins>
</em>
<del class="diff-old">is
already
expanded.
</del>
</p>
<p>
If
<a class="tref internalDFN" title="active-property" href="#dfn-active-property">
active
property
</a>
<del class="diff-old">is
@graph
or
</del>
<ins class="diff-chg">has
a
</ins><a class="tref internalDFN" title="type-mapping" href="#dfn-type-mapping"><ins class="diff-chg">
type
mapping
</ins></a><ins class="diff-chg">
in
</ins>
the
<del class="diff-old">target
of
an
</del>
<a class="tref internalDFN" title="active-context" href="#dfn-active-context">
<ins class="diff-chg">active
context
</ins></a><ins class="diff-chg">
set
to
</ins>
<code>
@id
</code>
<del class="diff-old">coercion,
expand
the
value
into
an
</del>
<ins class="diff-chg">or
</ins><code><ins class="diff-chg">
@vocab
</ins></code>,<ins class="diff-chg">
a
</ins><a class="tref internalDFN" title="json-object" href="#dfn-json-object"><ins class="diff-chg">
JSON
</ins>
object
</a>
with
a
<del class="diff-old">key-value
pair
where
the
key
is
</del>
<ins class="diff-chg">single
member
</ins>
<code>
@id
</code>
<del class="diff-old">and
the
value
</del>
<ins class="diff-chg">whose
values
</ins>
is
the
<del class="diff-old">expanded
IRI
according
to
</del>
<ins class="diff-chg">result
of
using
</ins>
the
<a href="#iri-expansion">
<abbr title="Internationalized Resource Identifier">
IRI
</abbr>
Expansion
<ins class="diff-new">algorithm
</ins>
</a>
<del class="diff-old">rules.
Otherwise,
if
active
property
</del>
<ins class="diff-chg">on
</ins><i><ins class="diff-chg">
value
</ins></i>
is
<del class="diff-old">not
</del>
<ins class="diff-chg">returned.
</ins></p><p><ins class="diff-chg">
Otherwise,
the
result
will
be
</ins>
a
<del class="diff-old">keyword
,
then
expand
value
into
</del>
<a class="tref internalDFN" title="json-object" href="#dfn-json-object">
<ins class="diff-chg">JSON
object
</ins></a><ins class="diff-chg">
containing
</ins>
an
<del class="diff-old">object:
Set
the
first
key-value
pair
to
</del>
<code>
@value
</code>
<del class="diff-old">and
the
unexpanded
</del>
<ins class="diff-chg">member
whose
</ins>
value
<del class="diff-old">.
If
the
active
property
</del>
is
the
<del class="diff-old">target
of
typed
literal
coercion,
set
the
second
key-value
pair
to
</del>
<ins class="diff-chg">passed
</ins><i><ins class="diff-chg">
value
</ins></i>.<ins class="diff-chg">
Additionally,
an
</ins>
<code>
@type
</code>
<del class="diff-old">and
the
associated
coercion
datatype
expanded
according
to
the
IRI
Expansion
rules.
Otherwise,
</del>
<ins class="diff-chg">member
will
be
included
</ins>
if
<ins class="diff-new">there
is
a
</ins><a class="tref internalDFN" title="type-mapping" href="#dfn-type-mapping"><ins class="diff-new">
type
mapping
</ins></a><ins class="diff-new">
associated
with
</ins>
the
<a class="tref internalDFN" title="active-property" href="#dfn-active-property">
active
property
</a>
<del class="diff-old">is
the
target
of
language
tagging,
set
the
second
key-value
pair
to
</del>
<ins class="diff-chg">or
an
</ins>
<code>
@language
</code>
<del class="diff-old">and
</del>
<ins class="diff-chg">member
if
</ins><i>
value
<del class="diff-old">of
the
</del>
</i>
<ins class="diff-chg">is
a
</ins><a class="tref internalDFN" title="string" href="#dfn-string"><ins class="diff-chg">
string
</ins></a><ins class="diff-chg">
and
there
is
</ins><a class="tref internalDFN" title="language-mapping" href="#dfn-language-mapping">
language
<del class="diff-old">tagging
from
</del>
<ins class="diff-chg">mapping
</ins></a><ins class="diff-chg">
associated
with
</ins>
the
<a class="tref internalDFN" title="active-property" href="#dfn-active-property">
active
<del class="diff-old">context
</del>
<ins class="diff-chg">property
</ins>
</a>.
<del class="diff-old">Otherwise,
value
is
already
expanded.
4.6
Value
Compaction
Some
values,
such
as
IRIs
and
typed
literals
,
may
be
expressed
in
an
expanded
form
in
JSON-LD.
These
values
are
required
to
be
compacted
at
times
when
processing
JSON-LD
documents.
</del>
</p>
</section>
<section>
<h4 id="algorithm-4">
<ins class="diff-new">Algorithm
</ins></h4>
<p>
The
algorithm
<del class="diff-old">for
compacting
an
expanded
value
value
</del>
takes
<ins class="diff-new">three
required
inputs:
</ins>
an
<a class="tref internalDFN" title="active-context" href="#dfn-active-context">
<ins class="diff-chg">active
context
</ins></a>,<ins class="diff-chg">
an
</ins><a class="tref internalDFN" title="active-property" href="#dfn-active-property">
active
property
</a>,
and
<del class="diff-old">active
context
.
It
is
implemented
as
follows:
</del>
<ins class="diff-chg">a
</ins><i><ins class="diff-chg">
value
</ins></i><ins class="diff-chg">
to
expand.
</ins>
</p>
<ol class="algorithm">
<li>
If
<del class="diff-old">value
only
has
one
property
and
</del>
the
<a class="tref internalDFN" title="active-property" href="#dfn-active-property">
active
<del class="diff-old">context
</del>
<ins class="diff-chg">property
</ins>
</a>
has
<del class="diff-old">no
default
language,
then
the
compacted
value
is
the
value
of
@value
.
Otherwise,
if
</del>
<ins class="diff-chg">a
</ins><a class="tref internalDFN" title="type-mapping" href="#dfn-type-mapping"><ins class="diff-chg">
type
mapping
</ins></a><ins class="diff-chg">
in
</ins><a class="tref internalDFN" title="active-context" href="#dfn-active-context">
active
<del class="diff-old">property
</del>
<ins class="diff-chg">context
</ins>
</a>
<ins class="diff-new">that
</ins>
is
<code>
<del class="diff-old">@graph
</del>
<ins class="diff-chg">@id
</ins>
</code>,
<ins class="diff-new">return
a
new
</ins><a class="tref internalDFN" title="json-object" href="#dfn-json-object"><ins class="diff-new">
JSON
object
</ins></a><ins class="diff-new">
containing
a
single
key-value
pair
where
</ins>
the
<del class="diff-old">compacted
value
</del>
<ins class="diff-chg">key
</ins>
is
<del class="diff-old">the
value
associated
with
the
</del>
<code>
@id
</code>
<del class="diff-old">key,
processed
according
to
</del>
<ins class="diff-chg">and
</ins>
the
<ins class="diff-chg">value
is
the
result
of
using
the
</ins><a href="#iri-expansion">
<abbr title="Internationalized Resource Identifier">
IRI
</abbr>
<del class="diff-old">Compaction
</del>
<ins class="diff-chg">Expansion
algorithm
</ins></a>,<ins class="diff-chg">
passing
</ins><a class="tref internalDFN" title="active-context" href="#dfn-active-context"><ins class="diff-chg">
active
context
</ins></a>,<i><ins class="diff-chg">
value
</ins></i>,<ins class="diff-chg">
and
</ins><a class="tref internalDFN" title="true" href="#dfn-true"><ins class="diff-chg">
true
</ins>
</a>
<del class="diff-old">steps.
</del>
<ins class="diff-chg">for
</ins><i><ins class="diff-chg">
documentRelative
</ins></i>.
</li>
<li>
<del class="diff-old">Otherwise,
if
the
</del>
<ins class="diff-chg">If
</ins><a class="tref internalDFN" title="active-property" href="#dfn-active-property"><ins class="diff-chg">
active
property
</ins></a><ins class="diff-chg">
has
a
</ins><a class="tref internalDFN" title="type-mapping" href="#dfn-type-mapping"><ins class="diff-chg">
type
mapping
</ins></a><ins class="diff-chg">
in
</ins><a class="tref internalDFN" title="active-context" href="#dfn-active-context">
active
context
</a>
<del class="diff-old">contains
</del>
<ins class="diff-chg">that
is
</ins><code><ins class="diff-chg">
@vocab
</ins></code>,<ins class="diff-chg">
return
</ins>
a
<del class="diff-old">coercion
target
for
</del>
<ins class="diff-chg">new
</ins><a class="tref internalDFN" title="json-object" href="#dfn-json-object"><ins class="diff-chg">
JSON
object
</ins></a><ins class="diff-chg">
containing
a
single
key-value
pair
where
</ins>
the
key
<del class="diff-old">that
matches
the
expression
of
the
value,
compact
the
value
using
the
following
steps:
If
the
coercion
target
</del>
is
<del class="diff-old">an
</del>
<code>
@id
<del class="diff-old">,
</del>
</code>
<ins class="diff-chg">and
</ins>
the
<del class="diff-old">compacted
</del>
value
is
the
<del class="diff-old">value
associated
with
the
@id
key,
processed
according
to
</del>
<ins class="diff-chg">result
of
using
</ins>
the
<a href="#iri-expansion">
<abbr title="Internationalized Resource Identifier">
IRI
</abbr>
<del class="diff-old">Compaction
</del>
<ins class="diff-chg">Expansion
algorithm
</ins></a>,<ins class="diff-chg">
passing
</ins><a class="tref internalDFN" title="active-context" href="#dfn-active-context"><ins class="diff-chg">
active
context
</ins></a>,<i><ins class="diff-chg">
value
</ins></i>,<a class="tref internalDFN" title="true" href="#dfn-true"><ins class="diff-chg">
true
</ins>
</a>
<del class="diff-old">steps.
</del>
<ins class="diff-chg">for
</ins><i><ins class="diff-chg">
vocabRelative
</ins></i>,<ins class="diff-chg">
and
</ins><a class="tref internalDFN" title="true" href="#dfn-true"><ins class="diff-chg">
true
</ins></a><ins class="diff-chg">
for
</ins><i><ins class="diff-chg">
documentRelative
</ins></i>.
</li>
<li>
<del class="diff-old">If
the
coercion
target
</del>
<ins class="diff-chg">Otherwise,
initialize
</ins><i><ins class="diff-chg">
result
</ins></i><ins class="diff-chg">
to
a
</ins><a class="tref internalDFN" title="json-object" href="#dfn-json-object"><ins class="diff-chg">
JSON
object
</ins></a><ins class="diff-chg">
with
an
</ins><code><ins class="diff-chg">
@value
</ins></code><ins class="diff-chg">
member
whose
value
</ins>
is
<ins class="diff-new">set
to
</ins><i><ins class="diff-new">
value
</ins></i>.</li><li><ins class="diff-new">
If
</ins><a class="tref internalDFN" title="active-property" href="#dfn-active-property"><ins class="diff-new">
active
property
</ins></a><ins class="diff-new">
has
</ins>
a
<del class="diff-old">typed
literal
</del>
<a class="tref internalDFN" title="type-mapping" href="#dfn-type-mapping">
<ins class="diff-chg">type
mapping
</ins></a><ins class="diff-chg">
in
</ins><a class="tref internalDFN" title="active-context" href="#dfn-active-context"><ins class="diff-chg">
active
context
</ins>
</a>,
<del class="diff-old">the
compacted
</del>
<ins class="diff-chg">add
an
</ins><code><ins class="diff-chg">
@type
</ins></code><ins class="diff-chg">
member
to
</ins><i><ins class="diff-chg">
result
</ins></i><ins class="diff-chg">
and
set
its
</ins>
value
<del class="diff-old">is
</del>
<ins class="diff-chg">to
</ins>
the
value
associated
with
the
<del class="diff-old">@value
key.
</del>
<a class="tref internalDFN" title="type-mapping" href="#dfn-type-mapping">
<ins class="diff-chg">type
mapping
</ins></a>.
</li>
<li>
Otherwise,
if
<i>
value
<del class="diff-old">contains
</del>
</i>
<ins class="diff-chg">is
a
</ins><a class="tref internalDFN" title="string" href="#dfn-string"><ins class="diff-chg">
string
</ins></a>:<ol class="algorithm"><li><ins class="diff-chg">
If
a
</ins><a class="tref internalDFN" title="language-mapping" href="#dfn-language-mapping"><ins class="diff-chg">
language
mapping
</ins></a><ins class="diff-chg">
is
associated
with
</ins><a class="tref internalDFN" title="active-property" href="#dfn-active-property"><ins class="diff-chg">
active
property
</ins></a><ins class="diff-chg">
in
</ins><a class="tref internalDFN" title="active-context" href="#dfn-active-context"><ins class="diff-chg">
active
context
</ins></a>,<ins class="diff-chg">
add
</ins>
an
<code>
<del class="diff-old">@id
</del>
<ins class="diff-chg">@language
</ins>
</code>
<del class="diff-old">key,
the
compacted
value
is
</del>
<ins class="diff-chg">to
</ins><i><ins class="diff-chg">
result
</ins></i><ins class="diff-chg">
and
set
its
</ins>
value
<ins class="diff-chg">to
the
language
code
associated
</ins>
with
the
<del class="diff-old">value
of
@id
processed
according
to
</del>
<a class="tref internalDFN" title="language-mapping" href="#dfn-language-mapping">
<ins class="diff-chg">language
mapping
</ins></a><ins class="diff-chg">
;
unless
</ins>
the
<del class="diff-old">IRI
Compaction
</del>
<a class="tref internalDFN" title="language-mapping" href="#dfn-language-mapping">
<ins class="diff-chg">language
mapping
</ins>
</a>
<del class="diff-old">steps.
</del>
<ins class="diff-chg">is
set
to
</ins><a class="tref internalDFN" title="null" href="#dfn-null"><ins class="diff-chg">
null
</ins></a><ins class="diff-chg">
in
which
case
no
member
is
added.
</ins>
</li>
<li>
Otherwise,
if
the
<a class="tref internalDFN" title="active-context" href="#dfn-active-context">
active
context
</a>
<del class="diff-old">contains
</del>
<ins class="diff-chg">has
</ins>
a
<del class="diff-old">@language
,
which
matches
the
</del>
<a class="tref internalDFN" title="default-language" href="#dfn-default-language">
<ins class="diff-chg">default
language
</ins></a>,<ins class="diff-chg">
add
an
</ins>
<code>
@language
</code>
<del class="diff-old">of
</del>
<ins class="diff-chg">to
</ins><i><ins class="diff-chg">
result
</ins></i><ins class="diff-chg">
and
set
its
value
to
</ins>
the
<del class="diff-old">value,
</del>
<a class="tref internalDFN" title="default-language" href="#dfn-default-language">
<ins class="diff-chg">default
language
</ins></a>.</li></ol></li><li><ins class="diff-chg">
Return
</ins><i><ins class="diff-chg">
result
</ins></i>.</li></ol></section></section></section><section id="compaction-algorithms"><h2><span class="secno"><ins class="diff-chg">
8.
</ins></span><ins class="diff-chg">
Compaction
Algorithms
</ins></h2><section id="compaction-algorithm"><h3><span class="secno"><ins class="diff-chg">
8.1
</ins></span><ins class="diff-chg">
Compaction
Algorithm
</ins></h3><p><ins class="diff-chg">
This
algorithm
compacts
a
JSON-LD
document,
such
that
the
given
</ins><a class="tref internalDFN" title="context" href="#dfn-context"><ins class="diff-chg">
context
</ins></a><ins class="diff-chg">
is
applied.
This
must
result
in
shortening
any
applicable
</ins><a class="tref internalDFN" title="iri" href="#dfn-iri"><ins class="diff-chg">
IRIs
</ins></a><ins class="diff-chg">
to
</ins><a class="tref internalDFN" title="term" href="#dfn-term"><ins class="diff-chg">
terms
</ins></a>
or
<a class="tref internalDFN" title="compact-iri" href="#dfn-compact-iri">
<ins class="diff-new">compact
IRIs
</ins></a>,<ins class="diff-new">
any
applicable
</ins><a class="tref internalDFN" title="keyword" href="#dfn-keyword"><ins class="diff-new">
keywords
</ins></a><ins class="diff-new">
to
</ins><a class="tref internalDFN" title="keyword-alias" href="#dfn-keyword-alias"><ins class="diff-new">
keyword
aliases
</ins></a>,<ins class="diff-new">
and
any
applicable
</ins><a class="tref internalDFN" title="json-ld-value" href="#dfn-json-ld-value"><ins class="diff-new">
JSON-LD
values
</ins></a><ins class="diff-new">
expressed
in
</ins><a class="tref internalDFN" title="expanded-form" href="#dfn-expanded-form"><ins class="diff-new">
expanded
form
</ins></a><ins class="diff-new">
to
simple
values
such
as
</ins><a class="tref internalDFN" title="string" href="#dfn-string"><ins class="diff-new">
strings
</ins></a><ins class="diff-new">
or
</ins><a class="tref internalDFN" title="number" href="#dfn-number"><ins class="diff-new">
numbers
</ins></a>.</p><section class="informative"><h4 id="general-solution-5"><ins class="diff-new">
General
Solution
</ins></h4><p><em><ins class="diff-new">
This
section
is
non-normative.
</ins></em></p><p><ins class="diff-new">
Starting
with
its
root
</ins><i><ins class="diff-new">
element
</ins></i>,<ins class="diff-new">
we
can
process
</ins>
the
<del class="diff-old">value
has
only
</del>
<ins class="diff-chg">JSON-LD
document
recursively,
until
we
have
</ins>
a
<del class="diff-old">@value
key,
the
</del>
<ins class="diff-chg">fully
</ins><a class="tref internalDFN" title="compaction" href="#dfn-compaction">
compacted
<del class="diff-old">value
is
</del>
</a>
<i>
<ins class="diff-chg">result
</ins></i>.<ins class="diff-chg">
When
</ins><a class="tref internalDFN" title="compaction" href="#dfn-compaction"><ins class="diff-chg">
compacting
</ins></a><ins class="diff-chg">
an
</ins><i><ins class="diff-chg">
element
</ins></i>,<ins class="diff-chg">
we
can
treat
each
one
differently
according
to
its
type,
in
order
to
break
down
</ins>
the
<del class="diff-old">value
associated
with
</del>
<ins class="diff-chg">problem:
</ins></p><ol><li><ins class="diff-chg">
If
</ins>
the
<del class="diff-old">@value
key.
</del>
<i>
<ins class="diff-chg">element
</ins></i><ins class="diff-chg">
is
a
</ins><a class="tref internalDFN" title="scalar" href="#dfn-scalar"><ins class="diff-chg">
scalar
</ins></a>,<ins class="diff-chg">
it
is
already
in
</ins><a class="tref internalDFN" title="compacted-form" href="#dfn-compacted-form"><ins class="diff-chg">
compacted
form
</ins></a>,<ins class="diff-chg">
so
we
simply
return
it.
</ins>
</li>
<li>
<del class="diff-old">Otherwise,
if
</del>
<ins class="diff-chg">If
</ins>
the
<del class="diff-old">value
contains
</del>
<i>
<ins class="diff-chg">element
</ins></i><ins class="diff-chg">
is
an
</ins><a class="tref internalDFN" title="array" href="#dfn-array"><ins class="diff-chg">
array
</ins></a>,<ins class="diff-chg">
we
compact
each
of
its
items
recursively
and
return
them
in
</ins>
a
<del class="diff-old">@type
key,
the
compacted
value
</del>
<ins class="diff-chg">new
</ins><a class="tref internalDFN" title="array" href="#dfn-array"><ins class="diff-chg">
array
</ins></a>.</li><li><ins class="diff-chg">
Otherwise
</ins><i><ins class="diff-chg">
element
</ins></i>
is
<ins class="diff-chg">a
</ins><a class="tref internalDFN" title="json-object" href="#dfn-json-object"><ins class="diff-chg">
JSON
object
</ins></a>.<ins class="diff-chg">
The
</ins>
value
<del class="diff-old">with
</del>
<ins class="diff-chg">of
each
key
in
element
is
compacted
recursively.
Some
of
</ins>
the
<del class="diff-old">@type
value
processed
according
to
</del>
<ins class="diff-chg">keys
will
be
compacted,
using
</ins>
the
<a href="#iri-compaction">
<abbr title="Internationalized Resource Identifier">
IRI
</abbr>
Compaction
<ins class="diff-new">algorithm
</ins></a>,<ins class="diff-new">
to
</ins><a class="tref internalDFN" title="term" href="#dfn-term"><ins class="diff-new">
terms
</ins>
</a>
<del class="diff-old">steps.
Otherwise,
the
value
is
</del>
<ins class="diff-chg">or
</ins><a class="tref internalDFN" title="compact-iri" href="#dfn-compact-iri"><ins class="diff-chg">
compact
IRIs
</ins></a><ins class="diff-chg">
and
others
will
be
compacted
from
</ins><a class="tref internalDFN" title="keyword" href="#dfn-keyword"><ins class="diff-chg">
keywords
</ins></a><ins class="diff-chg">
to
</ins><a class="tref internalDFN" title="keyword-alias" href="#dfn-keyword-alias"><ins class="diff-chg">
keyword
aliases
</ins></a><ins class="diff-chg">
or
simply
left
unchanged
because
they
do
</ins>
not
<del class="diff-old">modified.
</del>
<ins class="diff-chg">have
definitions
in
the
</ins><a class="tref internalDFN" title="context" href="#dfn-context"><ins class="diff-chg">
context
</ins></a>.<ins class="diff-chg">
Values
will
be
converted
to
</ins><a class="tref internalDFN" title="compacted-form" href="#dfn-compacted-form"><ins class="diff-chg">
compacted
form
</ins></a><ins class="diff-chg">
via
the
</ins><a href="#value-compaction"><ins class="diff-chg">
Value
Compaction
algorithm
</ins></a>.<ins class="diff-chg">
Some
data
will
be
reshaped
based
on
</ins><a class="tref internalDFN" title="container-mapping" href="#dfn-container-mapping"><ins class="diff-chg">
container
mappings
</ins></a><ins class="diff-chg">
specified
in
the
context
such
as
</ins><code><ins class="diff-chg">
@index
</ins></code><ins class="diff-chg">
or
</ins><code><ins class="diff-chg">
@language
</ins></code><ins class="diff-chg">
maps.
</ins>
</li>
</ol>
<del class="diff-old">4.7
Expansion
</del>
<p>
<del class="diff-old">Expansion
</del>
<ins class="diff-chg">The
final
output
</ins>
is
<del class="diff-old">the
process
of
taking
</del>
a
<del class="diff-old">JSON-LD
document
and
applying
</del>
<a class="tref internalDFN" title="json-object" href="#dfn-json-object">
<ins class="diff-chg">JSON
object
</ins></a><ins class="diff-chg">
with
</ins>
a
<code>
<ins class="diff-new">@context
</ins></code><ins class="diff-new">
key,
if
a
</ins><a class="tref internalDFN" title="context" href="#dfn-context">
context
<del class="diff-old">such
that
all
IRI
,
datatypes,
and
literal
values
are
expanded
so
that
</del>
</a>
<ins class="diff-chg">was
given,
where
</ins>
the
<del class="diff-old">context
is
no
longer
necessary.
JSON-LD
document
expansion
</del>
<a class="tref internalDFN" title="json-object" href="#dfn-json-object">
<ins class="diff-chg">JSON
object
</ins></a>
is
<del class="diff-old">typically
used
as
</del>
<ins class="diff-chg">either
</ins><i><ins class="diff-chg">
result
</ins></i><ins class="diff-chg">
or
</ins>
a
<del class="diff-old">part
of
other
JSON-LD
API
methods.
For
example,
assume
the
following
JSON-LD
input
document:
{
   &quot;@context&quot;:
   {
      &quot;name&quot;: &quot;http://xmlns.com/foaf/0.1/name&quot;,
      &quot;homepage&quot;: {
        &quot;@id&quot;: &quot;http://xmlns.com/foaf/0.1/homepage&quot;,
        &quot;@type&quot;, &quot;@id&quot;
      }
   },
   &quot;name&quot;: &quot;Manu Sporny&quot;,
   &quot;homepage&quot;: &quot;http://manu.sporny.org/&quot;
}
Running
the
JSON-LD
Expansion
algorithm
against
</del>
<ins class="diff-chg">wrapper
for
it
where
</ins><i><ins class="diff-chg">
result
</ins></i><ins class="diff-chg">
appears
as
</ins>
the
<del class="diff-old">JSON-LD
input
document
provided
above
would
</del>
<ins class="diff-chg">value
of
an
(aliased)
</ins><code><ins class="diff-chg">
@graph
</ins></code><ins class="diff-chg">
key
because
</ins><i>
result
</i>
<ins class="diff-new">contained
two
or
more
items
</ins>
in
<del class="diff-old">the
following
output:
</del>
<ins class="diff-chg">an
</ins><a class="tref internalDFN" title="array" href="#dfn-array"><ins class="diff-chg">
array
</ins></a>.
</p>
<del class="diff-old">{
   &quot;http://xmlns.com/foaf/0.1/name&quot;: &quot;Manu Sporny&quot;,
   &quot;http://xmlns.com/foaf/0.1/homepage&quot;: {
      &quot;@id&quot;: &quot;http://manu.sporny.org/&quot;
   }
}
4.7.1
Expansion
</del>
</section>
<section>
<h4 id="algorithm-5">
Algorithm
</h4>
<p>
The
algorithm
takes
<del class="diff-old">three
</del>
<ins class="diff-chg">five
required
</ins>
input
variables:
an
<a class="tref internalDFN" title="active-context" href="#dfn-active-context">
active
context
</a>,
an
<a class="tref internalDFN" title="inverse-context" href="#dfn-inverse-context">
<ins class="diff-chg">inverse
context
</ins></a>,<ins class="diff-chg">
an
</ins><a class="tref internalDFN" title="active-property" href="#dfn-active-property">
active
property
</a>,
<del class="diff-old">and
</del>
an
<i>
element
</i>
to
be
<del class="diff-old">expanded.
</del>
<ins class="diff-chg">compacted,
and
a
flag
</ins><code class="idlMemberName"><a href="#widl-JsonLdOptions-compactArrays"><ins class="diff-chg">
compactArrays
</ins></a></code>.
To
begin,
the
<a class="tref internalDFN" title="active-context" href="#dfn-active-context">
active
context
</a>
is
set
to
the
result
of
<del class="diff-old">performing,
</del>
<ins class="diff-chg">performing
</ins><a href="#context-processing-algorithm">
Context
Processing
</a>
on
the
passed
<a class="tref internalDFN" title="context" href="#dfn-context">
context
<del class="diff-old">,
or
to
</del>
</a>,
the
<del class="diff-old">initial
</del>
<a class="tref internalDFN" title="inverse-context" href="#dfn-inverse-context">
<ins class="diff-chg">inverse
</ins>
context
</a>
<del class="diff-old">if
context
</del>
is
<del class="diff-old">null
</del>
<ins class="diff-chg">set
to
the
result
of
performing
the
</ins><a href="#inverse-context-creation"><ins class="diff-chg">
Inverse
Context
Creation
algorithm
</ins></a><ins class="diff-chg">
on
</ins><a class="tref internalDFN" title="active-context" href="#dfn-active-context"><ins class="diff-chg">
active
context
</ins>
</a>,
<ins class="diff-chg">the
</ins><a class="tref internalDFN" title="active-property" href="#dfn-active-property">
active
property
</a>
is
set
to
<a class="tref internalDFN" title="null" href="#dfn-null">
null
</a>,
<del class="diff-old">and
</del>
<i>
element
</i>
is
set
to
the
<ins class="diff-chg">result
of
performing
the
</ins><a href="#expansion-algorithm"><ins class="diff-chg">
Expansion
algorithm
</ins></a><ins class="diff-chg">
on
the
</ins><a class="tref internalDFN" title="json-ld-input" href="#dfn-json-ld-input">
JSON-LD
input
</a>,
<ins class="diff-new">and,
if
not
passed,
</ins><code class="idlMemberName"><a href="#widl-JsonLdOptions-compactArrays"><ins class="diff-new">
compactArrays
</ins></a></code><ins class="diff-new">
is
set
to
</ins><a class="tref internalDFN" title="true" href="#dfn-true"><ins class="diff-new">
true
</ins>
</a>.
</p>
<ol class="algorithm">
<li>
If
<i>
element
</i>
<ins class="diff-chg">is
a
</ins><a class="tref internalDFN" title="scalar" href="#dfn-scalar"><ins class="diff-chg">
scalar
</ins></a>,<ins class="diff-chg">
it
is
already
in
its
most
compact
form,
so
simply
return
</ins><i><ins class="diff-chg">
element
</ins></i>.</li><li><ins class="diff-chg">
If
</ins><i><ins class="diff-chg">
element
</ins></i>
is
an
<a class="tref internalDFN" title="array" href="#dfn-array">
array
<del class="diff-old">,
process
</del>
</a>:
<ol class="algorithm">
<li>
<ins class="diff-chg">Initialize
</ins><i><ins class="diff-chg">
result
</ins></i><ins class="diff-chg">
to
an
empty
</ins><a class="tref internalDFN" title="array" href="#dfn-array"><ins class="diff-chg">
array
</ins></a>.</li><li><ins class="diff-chg">
For
</ins>
each
<del class="diff-old">entry
</del>
<i>
<ins class="diff-chg">item
</ins></i>
in
<i>
element
<del class="diff-old">recursively
</del>
</i>:
<ol class="algorithm">
<li>
<ins class="diff-chg">Initialize
</ins><i><ins class="diff-chg">
compacted
item
</ins></i><ins class="diff-chg">
to
the
result
of
</ins>
using
this
<del class="diff-old">algorithm,
</del>
<ins class="diff-chg">algorithm
recursively,
</ins>
passing
<del class="diff-old">copies
of
the
</del>
<a class="tref internalDFN" title="active-context" href="#dfn-active-context">
active
context
<del class="diff-old">and
</del>
</a>,
<a class="tref internalDFN" title="inverse-context" href="#dfn-inverse-context">
<ins class="diff-chg">inverse
context
</ins></a>,<a class="tref internalDFN" title="active-property" href="#dfn-active-property">
active
property
<del class="diff-old">.
</del>
</a>,
<ins class="diff-chg">and
em&gt;item
for
</ins><i><ins class="diff-chg">
element
</ins></i>.</li><li><ins class="diff-chg">
If
</ins><i><ins class="diff-chg">
compacted
item
</ins></i><ins class="diff-chg">
is
not
</ins><a class="tref internalDFN" title="null" href="#dfn-null"><ins class="diff-chg">
null
</ins></a>,<ins class="diff-chg">
then
append
it
to
</ins><i><ins class="diff-chg">
result
</ins></i>.</li></ol></li><li>
If
<i>
<ins class="diff-new">result
</ins></i><ins class="diff-new">
contains
only
one
item
(it
</ins>
has
a
<ins class="diff-new">length
of
</ins>
<code>
<del class="diff-old">@container
</del>
<ins class="diff-chg">1
</ins></code><ins class="diff-chg">
),
</ins><a class="tref internalDFN" title="active-property" href="#dfn-active-property"><ins class="diff-chg">
active
property
</ins></a><ins class="diff-chg">
has
no
</ins><a class="tref internalDFN" title="container-mapping" href="#dfn-container-mapping"><ins class="diff-chg">
container
mapping
</ins></a><ins class="diff-chg">
in
</ins><a class="tref internalDFN" title="active-context" href="#dfn-active-context"><ins class="diff-chg">
active
context
</ins></a>,<ins class="diff-chg">
and
</ins><code class="idlMemberName"><a href="#widl-JsonLdOptions-compactArrays"><ins class="diff-chg">
compactArrays
</ins></a>
</code>
<ins class="diff-new">is
</ins><a class="tref internalDFN" title="true" href="#dfn-true"><ins class="diff-new">
true
</ins></a>,
set
<i>
<ins class="diff-new">result
</ins></i>
to
<del class="diff-old">@list
and
any
entry
in
</del>
<ins class="diff-chg">its
only
item.
</ins></li><li><ins class="diff-chg">
Return
</ins><i><ins class="diff-chg">
result
</ins></i>.</li></ol></li><li><ins class="diff-chg">
Otherwise
</ins><i>
element
</i>
is
<ins class="diff-new">a
</ins><a class="tref internalDFN" title="json-object" href="#dfn-json-object"><ins class="diff-new">
JSON
object
</ins></a>.</li><li><ins class="diff-new">
If
</ins><i><ins class="diff-new">
element
</ins></i><ins class="diff-new">
has
</ins>
an
<del class="diff-old">array
,
</del>
<code>
<ins class="diff-chg">@value
</ins></code>
or
<code>
<ins class="diff-new">@id
</ins></code><ins class="diff-new">
member
and
the
result
of
using
the
</ins><a href="#value-compaction"><ins class="diff-new">
Value
Compaction
algorithm
</ins></a>,<ins class="diff-new">
passing
</ins><a class="tref internalDFN" title="active-context" href="#dfn-active-context"><ins class="diff-new">
active
context
</ins></a>,<a class="tref internalDFN" title="inverse-context" href="#dfn-inverse-context"><ins class="diff-new">
inverse
context
</ins></a>,<a class="tref internalDFN" title="active-property" href="#dfn-active-property"><ins class="diff-new">
active
property
</ins></a>,and<i><ins class="diff-new">
element
</ins></i><ins class="diff-new">
as
</ins><i><ins class="diff-new">
value
</ins></i>
is
a
<a class="tref internalDFN" title="scalar" href="#dfn-scalar">
<ins class="diff-chg">scalar
</ins></a>,<ins class="diff-chg">
return
that
result.
</ins></li><li><ins class="diff-chg">
Initialize
</ins><i><ins class="diff-chg">
inside
reverse
</ins></i><ins class="diff-chg">
to
</ins><a class="tref internalDFN" title="true" href="#dfn-true"><ins class="diff-chg">
true
</ins></a><ins class="diff-chg">
if
</ins><a class="tref internalDFN" title="active-property" href="#dfn-active-property"><ins class="diff-chg">
active
property
</ins></a><ins class="diff-chg">
equals
</ins><code><ins class="diff-chg">
@reverse
</ins></code>,<ins class="diff-chg">
otherwise
to
</ins><a class="tref internalDFN" title="false" href="#dfn-false"><ins class="diff-chg">
false
</ins></a>.</li><li><ins class="diff-chg">
Initialize
</ins><i><ins class="diff-chg">
result
</ins></i><ins class="diff-chg">
to
an
empty
</ins><a class="tref internalDFN" title="json-object" href="#dfn-json-object">
JSON
object
<del class="diff-old">containing
a
</del>
</a>.
</li>
<li>
<ins class="diff-chg">For
each
key
</ins><i><ins class="diff-chg">
expanded
property
</ins></i><ins class="diff-chg">
and
value
</ins><i><ins class="diff-chg">
expanded
value
</ins></i><ins class="diff-chg">
in
</ins><i><ins class="diff-chg">
element
</ins></i>,<ins class="diff-chg">
ordered
lexicographically
by
</ins><i><ins class="diff-chg">
expanded
property
</ins></i>:<ol class="algorithm"><li><ins class="diff-chg">
If
</ins><i><ins class="diff-chg">
expanded
property
</ins></i><ins class="diff-chg">
is
</ins>
<code>
<del class="diff-old">@list
</del>
<ins class="diff-chg">@id
</ins>
</code>
<del class="diff-old">property,
throw
an
exception,
as
lists
of
lists
are
not
allowed.
</del>
<ins class="diff-chg">or
</ins><code><ins class="diff-chg">
@type
</ins></code>:<ol class="algorithm"><li>
If
<i>
<ins class="diff-new">expanded
value
</ins></i><ins class="diff-new">
is
a
</ins><a class="tref internalDFN" title="string" href="#dfn-string"><ins class="diff-new">
string
</ins></a>,<ins class="diff-new">
then
initialize
</ins><i><ins class="diff-new">
compacted
value
</ins></i><ins class="diff-new">
to
the
result
of
using
</ins>
the
<a href="#iri-compaction">
<abbr title="Internationalized Resource Identifier">
<ins class="diff-new">IRI
</ins></abbr><ins class="diff-new">
Compaction
algorithm
</ins></a>,<ins class="diff-new">
passing
</ins><a class="tref internalDFN" title="active-context" href="#dfn-active-context"><ins class="diff-new">
active
context
</ins></a>,<a class="tref internalDFN" title="inverse-context" href="#dfn-inverse-context"><ins class="diff-new">
inverse
context
</ins></a>,<i>
expanded
<del class="diff-old">entry
</del>
<ins class="diff-chg">value
</ins></i><ins class="diff-chg">
for
</ins><i><ins class="diff-chg">
iri
</ins></i>,<ins class="diff-chg">
and
</ins><a class="tref internalDFN" title="true" href="#dfn-true"><ins class="diff-chg">
true
</ins></a><ins class="diff-chg">
for
</ins><i><ins class="diff-chg">
vocabRelative
</ins></i><ins class="diff-chg">
if
</ins><i><ins class="diff-chg">
expanded
property
</ins></i>
is
<del class="diff-old">null,
drop
it.
If
it's
an
array,
merge
its
entries
with
element
's
entries.
</del>
<code>
<ins class="diff-chg">@type
</ins></code>,<a class="tref internalDFN" title="false" href="#dfn-false"><ins class="diff-chg">
false
</ins></a><ins class="diff-chg">
otherwise.
</ins>
</li>
<li>
Otherwise,
<del class="diff-old">if
element
is
an
object
</del>
<i>
<ins class="diff-chg">expanded
value
</ins></i><ins class="diff-chg">
must
be
a
</ins><code><ins class="diff-chg">
@type
</ins></code><a class="tref internalDFN" title="array" href="#dfn-array"><ins class="diff-chg">
array
</ins></a>:
<ol class="algorithm">
<li>
<ins class="diff-new">Initialize
</ins><i><ins class="diff-new">
compacted
value
</ins></i><ins class="diff-new">
to
an
empty
</ins><a class="tref internalDFN" title="array" href="#dfn-array"><ins class="diff-new">
array
</ins></a>.</li><li><ins class="diff-new">
For
each
item
</ins><i><ins class="diff-new">
expanded
type
</ins></i><ins class="diff-new">
in
</ins><i><ins class="diff-new">
expanded
value
</ins></i>,<ins class="diff-new">
append
the
result
of
of
using
the
</ins><a href="#iri-compaction"><abbr title="Internationalized Resource Identifier"><ins class="diff-new">
IRI
</ins></abbr><ins class="diff-new">
Compaction
algorithm
</ins></a>,<ins class="diff-new">
passing
</ins><a class="tref internalDFN" title="active-context" href="#dfn-active-context"><ins class="diff-new">
active
context
</ins></a>,<a class="tref internalDFN" title="inverse-context" href="#dfn-inverse-context"><ins class="diff-new">
inverse
context
</ins></a>,<i><ins class="diff-new">
expanded
type
</ins></i><ins class="diff-new">
for
</ins><i><ins class="diff-new">
iri
</ins></i>,<ins class="diff-new">
and
</ins><a class="tref internalDFN" title="true" href="#dfn-true"><ins class="diff-new">
true
</ins></a><ins class="diff-new">
for
</ins><i><ins class="diff-new">
vocabRelative
</ins></i>,<ins class="diff-new">
to
</ins><i><ins class="diff-new">
compacted
value
</ins></i>.</li><li>
If
<del class="diff-old">element
</del>
<i>
<ins class="diff-chg">compacted
value
</ins></i><ins class="diff-chg">
contains
only
one
item
(it
</ins>
has
a
<ins class="diff-new">length
of
</ins>
<code>
<del class="diff-old">@context
</del>
<ins class="diff-chg">1
</ins>
</code>
<del class="diff-old">property,
update
</del>
<ins class="diff-chg">),
then
set
</ins><i><ins class="diff-chg">
compacted
value
</ins></i><ins class="diff-chg">
to
its
only
item.
</ins></li></ol></li><li><ins class="diff-chg">
Initialize
</ins><i><ins class="diff-chg">
alias
</ins></i><ins class="diff-chg">
to
</ins>
the
<ins class="diff-chg">result
of
using
the
</ins><a href="#iri-compaction"><abbr title="Internationalized Resource Identifier"><ins class="diff-chg">
IRI
</ins></abbr><ins class="diff-chg">
Compaction
algorithm
</ins></a>,<ins class="diff-chg">
passing
</ins><a class="tref internalDFN" title="active-context" href="#dfn-active-context">
active
context
<del class="diff-old">according
</del>
</a>,
<a class="tref internalDFN" title="inverse-context" href="#dfn-inverse-context">
<ins class="diff-chg">inverse
context
</ins></a>,<ins class="diff-chg">
and
</ins><i><ins class="diff-chg">
expanded
property
</ins></i><ins class="diff-chg">
for
</ins><i><ins class="diff-chg">
iri
</ins></i>.</li><li><ins class="diff-chg">
Add
a
member
</ins><i><ins class="diff-chg">
alias
</ins></i>
to
<del class="diff-old">the
steps
outlined
in
Context
Processing
</del>
<i>
<ins class="diff-chg">result
</ins></i><ins class="diff-chg">
whose
value
is
set
to
</ins><i><ins class="diff-chg">
compacted
value
</ins></i>
and
<del class="diff-old">remove
</del>
<ins class="diff-chg">continue
to
</ins>
the
<ins class="diff-new">next
</ins><i><ins class="diff-new">
expanded
property
</ins></i>.</li></ol></li><li><ins class="diff-new">
If
</ins><i><ins class="diff-new">
expanded
property
</ins></i><ins class="diff-new">
is
</ins>
<code>
<del class="diff-old">@context
</del>
<ins class="diff-chg">@reverse
</ins></code>:<ol class="algorithm"><li><ins class="diff-chg">
Initialize
</ins><i><ins class="diff-chg">
compacted
value
</ins></i><ins class="diff-chg">
to
the
result
of
using
this
algorithm
recursively,
passing
</ins><a class="tref internalDFN" title="active-context" href="#dfn-active-context"><ins class="diff-chg">
active
context
</ins></a>,<a class="tref internalDFN" title="inverse-context" href="#dfn-inverse-context"><ins class="diff-chg">
inverse
context
</ins></a>,<code><ins class="diff-chg">
@reverse
</ins>
</code>
<del class="diff-old">property.
</del>
<ins class="diff-chg">for
</ins><a class="tref internalDFN" title="active-property" href="#dfn-active-property"><ins class="diff-chg">
active
property
</ins></a>,<ins class="diff-chg">
and
</ins><i><ins class="diff-chg">
expanded
value
</ins></i><ins class="diff-chg">
for
</ins><i><ins class="diff-chg">
element
</ins></i>.
</li>
<li>
<del class="diff-old">Then,
proceed
and
process
</del>
<ins class="diff-chg">For
</ins>
each
<i>
property
</i>
and
<i>
value
</i>
in
<del class="diff-old">element
as
follows:
</del>
<i>
<ins class="diff-chg">compacted
value
</ins></i>:
<ol class="algorithm">
<li>
<del class="diff-old">Remove
property
from
element
,
expand
property
according
to
</del>
<ins class="diff-chg">If
</ins>
the
<del class="diff-old">steps
outlined
</del>
<a class="tref internalDFN" title="term-definition" href="#dfn-term-definition">
<ins class="diff-chg">term
definition
</ins></a><ins class="diff-chg">
for
</ins><i><ins class="diff-chg">
property
</ins></i>
in
<del class="diff-old">IRI
Expansion
.
Set
</del>
the
<a class="tref internalDFN" title="active-context" href="#dfn-active-context">
active
<del class="diff-old">property
</del>
<ins class="diff-chg">context
</ins>
</a>
<del class="diff-old">to
the
original
un-expanded
</del>
<ins class="diff-chg">indicates
that
</ins><i>
property
<del class="diff-old">if
</del>
</i>
<ins class="diff-chg">is
a
</ins><a class="tref internalDFN" title="reverse-property" href="#dfn-reverse-property"><ins class="diff-chg">
reverse
</ins>
property
</a>
<ol class="algorithm">
<li>
<ins class="diff-chg">If
</ins><code class="idlMemberName"><a href="#widl-JsonLdOptions-compactArrays"><ins class="diff-chg">
compactArrays
</ins></a></code><ins class="diff-chg">
is
</ins><a class="tref internalDFN" title="false" href="#dfn-false"><ins class="diff-chg">
false
</ins></a><ins class="diff-chg">
and
</ins><i><ins class="diff-chg">
value
</ins></i>
is
not
<ins class="diff-new">an
</ins><a class="tref internalDFN" title="array" href="#dfn-array"><ins class="diff-new">
array
</ins></a>,<ins class="diff-new">
set
</ins><i><ins class="diff-new">
value
</ins></i><ins class="diff-new">
to
</ins>
a
<del class="diff-old">keyword
.
</del>
<ins class="diff-chg">new
</ins><a class="tref internalDFN" title="array" href="#dfn-array"><ins class="diff-chg">
array
</ins></a><ins class="diff-chg">
containing
only
</ins><i><ins class="diff-chg">
value
</ins></i>.
</li>
<li>
If
<i>
property
<del class="diff-old">does
</del>
</i>
<ins class="diff-chg">is
</ins>
not
<del class="diff-old">expand
to
</del>
a
<del class="diff-old">keyword
or
</del>
<ins class="diff-chg">member
of
</ins><i><ins class="diff-chg">
result
</ins></i>,<ins class="diff-chg">
add
one
and
set
its
value
to
</ins><i><ins class="diff-chg">
value
</ins></i>.</li><li><ins class="diff-chg">
Otherwise,
if
the
value
of
the
</ins><i><ins class="diff-chg">
property
</ins></i><ins class="diff-chg">
member
of
</ins><i><ins class="diff-chg">
result
</ins></i><ins class="diff-chg">
is
not
</ins>
an
<del class="diff-old">absolute
IRI
(i.e.,
</del>
<a class="tref internalDFN" title="array" href="#dfn-array">
<ins class="diff-chg">array
</ins></a>,<ins class="diff-chg">
set
</ins>
it
<del class="diff-old">doesn't
contain
</del>
<ins class="diff-chg">to
</ins>
a
<del class="diff-old">colon),
continue
with
</del>
<ins class="diff-chg">new
</ins><a class="tref internalDFN" title="array" href="#dfn-array"><ins class="diff-chg">
array
</ins></a><ins class="diff-chg">
containing
only
</ins>
the
<del class="diff-old">next
</del>
<ins class="diff-chg">value.
Then
append
</ins><i><ins class="diff-chg">
value
</ins></i><ins class="diff-chg">
to
its
value
if
</ins><i><ins class="diff-chg">
value
</ins></i><ins class="diff-chg">
is
not
an
</ins><a class="tref internalDFN" title="array" href="#dfn-array"><ins class="diff-chg">
array
</ins></a>,<ins class="diff-chg">
otherwise
append
each
of
its
items.
</ins></li><li><ins class="diff-chg">
Remove
the
</ins><i>
property
</i>
<ins class="diff-new">member
</ins>
from
<del class="diff-old">element
.
</del>
<i>
<ins class="diff-chg">compacted
value
</ins></i>.</li></ol></li></ol>
</li>
<li>
If
<i>
<ins class="diff-chg">compacted
</ins>
value
<del class="diff-old">is
null
and
property
</del>
</i>
<ins class="diff-chg">has
some
remaining
members,
i.e.,
it
</ins>
is
not
<ins class="diff-new">an
empty
</ins><a class="tref internalDFN" title="json-object" href="#dfn-json-object"><ins class="diff-new">
JSON
object
</ins></a>:<ol class="algorithm"><li><ins class="diff-new">
Initialize
</ins><i><ins class="diff-new">
alias
</ins></i><ins class="diff-new">
to
the
result
of
using
the
</ins><a href="#iri-compaction"><abbr title="Internationalized Resource Identifier"><ins class="diff-new">
IRI
</ins></abbr><ins class="diff-new">
Compaction
algorithm
</ins></a>,<ins class="diff-new">
passing
</ins><a class="tref internalDFN" title="active-context" href="#dfn-active-context"><ins class="diff-new">
active
context
</ins></a>,<a class="tref internalDFN" title="inverse-context" href="#dfn-inverse-context"><ins class="diff-new">
inverse
context
</ins></a>,<ins class="diff-new">
and
</ins>
<code>
<del class="diff-old">@value
,
</del>
<ins class="diff-chg">@reverse
</ins></code><ins class="diff-chg">
for
</ins><i><ins class="diff-chg">
iri
</ins></i>.</li><li><ins class="diff-chg">
Set
the
value
of
the
</ins><i><ins class="diff-chg">
alias
</ins></i><ins class="diff-chg">
member
of
</ins><i><ins class="diff-chg">
result
</ins></i><ins class="diff-chg">
to
</ins><i><ins class="diff-chg">
compacted
value
</ins></i><ins class="diff-chg">
and
</ins>
continue
with
the
next
<i>
<ins class="diff-new">expanded
</ins>
property
</i>
from
<i>
element
<del class="diff-old">.
</del>
</i>.
</li>
</ol>
</li>
</ol>
</li>
<li>
If
<del class="diff-old">the
</del>
<i>
<ins class="diff-chg">expanded
</ins>
property
</i>
is
<code>
<del class="diff-old">@id
</del>
<ins class="diff-chg">@index
</ins>
</code>
<ins class="diff-new">and
</ins><a class="tref internalDFN" title="active-property" href="#dfn-active-property"><ins class="diff-new">
active
property
</ins></a><ins class="diff-new">
has
a
</ins><a class="tref internalDFN" title="container-mapping" href="#dfn-container-mapping"><ins class="diff-new">
container
mapping
</ins></a><ins class="diff-new">
in
</ins><a class="tref internalDFN" title="active-context" href="#dfn-active-context"><ins class="diff-new">
active
context
</ins></a><ins class="diff-new">
that
is
</ins><code><ins class="diff-new">
@index
</ins></code>,<ins class="diff-new">
then
</ins>
the
<del class="diff-old">value
must
</del>
<ins class="diff-chg">compacted
result
will
</ins>
be
<del class="diff-old">a
string
.
Expand
</del>
<ins class="diff-chg">inside
of
an
</ins><code><ins class="diff-chg">
@index
</ins></code><ins class="diff-chg">
container,
drop
</ins>
the
<del class="diff-old">value
according
</del>
<code>
<ins class="diff-chg">@index
</ins></code><ins class="diff-chg">
property
by
continuing
</ins>
to
<del class="diff-old">IRI
Expansion
.
</del>
<ins class="diff-chg">the
next
</ins><i><ins class="diff-chg">
expanded
property
</ins></i>.
</li>
<li>
Otherwise,
if
<del class="diff-old">the
</del>
<i>
<ins class="diff-chg">expanded
</ins>
property
</i>
is
<code>
<del class="diff-old">@type
</del>
<ins class="diff-chg">@index
</ins></code>,<code><ins class="diff-chg">
@value
</ins></code>,<ins class="diff-chg">
or
</ins><code><ins class="diff-chg">
@language
</ins>
</code>:
<ol class="algorithm">
<li>
<del class="diff-old">If
value
is
a
string
,
expand
according
</del>
<ins class="diff-chg">Initialize
</ins><i><ins class="diff-chg">
alias
</ins></i>
to
<ins class="diff-chg">the
result
of
using
the
</ins><a href="#iri-compaction">
<abbr title="Internationalized Resource Identifier">
IRI
</abbr>
<del class="diff-old">Expansion
.
</del>
<ins class="diff-chg">Compaction
algorithm
</ins></a>,<ins class="diff-chg">
passing
</ins><a class="tref internalDFN" title="active-context" href="#dfn-active-context"><ins class="diff-chg">
active
context
</ins></a>,<a class="tref internalDFN" title="inverse-context" href="#dfn-inverse-context"><ins class="diff-chg">
inverse
context
</ins></a>,<ins class="diff-chg">
and
</ins><i><ins class="diff-chg">
expanded
property
</ins></i><ins class="diff-chg">
for
</ins><i><ins class="diff-chg">
iri
</ins></i>.
</li>
<li>
<del class="diff-old">Otherwise,
if
</del>
<ins class="diff-chg">Add
a
member
</ins><i><ins class="diff-chg">
alias
</ins></i><ins class="diff-chg">
to
</ins><i><ins class="diff-chg">
result
</ins></i><ins class="diff-chg">
whose
</ins>
value
is
<del class="diff-old">a
subject
reference
,
</del>
<ins class="diff-chg">set
to
</ins><i><ins class="diff-chg">
expanded
value
</ins></i><ins class="diff-chg">
and
continue
with
</ins>
the
<ins class="diff-new">next
</ins><i><ins class="diff-new">
expanded
property
</ins></i>.</li></ol></li><li><ins class="diff-new">
If
</ins><i>
expanded
value
</i>
is
<ins class="diff-new">an
empty
</ins><a class="tref internalDFN" title="array" href="#dfn-array"><ins class="diff-new">
array
</ins></a>:<ol class="algorithm"><li><ins class="diff-new">
Initialize
</ins><i><ins class="diff-new">
item
active
property
</ins></i><ins class="diff-new">
to
</ins>
the
result
of
<del class="diff-old">performing
</del>
<ins class="diff-chg">using
the
</ins><a href="#iri-compaction">
<abbr title="Internationalized Resource Identifier">
IRI
</abbr>
<del class="diff-old">Expansion
on
the
value
of
@id
.
Otherwise,
if
value
is
a
JSON
Object
</del>
<ins class="diff-chg">Compaction
algorithm
</ins>
</a>,
<del class="diff-old">it
must
be
empty
(used
</del>
<ins class="diff-chg">passing
</ins><a class="tref internalDFN" title="active-context" href="#dfn-active-context"><ins class="diff-chg">
active
context
</ins></a>,<a class="tref internalDFN" title="inverse-context" href="#dfn-inverse-context"><ins class="diff-chg">
inverse
context
</ins></a>,<i><ins class="diff-chg">
expanded
property
</ins></i>
for
<del class="diff-old">Framing
</del>
<i>
<ins class="diff-chg">iri
</ins></i>,<i><ins class="diff-chg">
expanded
value
</ins></i><ins class="diff-chg">
for
</ins><i><ins class="diff-chg">
value
</ins></i>,<a class="tref internalDFN" title="true" href="#dfn-true"><ins class="diff-chg">
true
</ins>
</a>
<del class="diff-old">).
</del>
<ins class="diff-chg">for
</ins><i><ins class="diff-chg">
vocabRelative
</ins></i>,<ins class="diff-chg">
and
</ins><i><ins class="diff-chg">
inside
reverse
</ins></i>.
</li>
<li>
<ins class="diff-new">If
</ins><i><ins class="diff-new">
result
</ins></i><ins class="diff-new">
does
not
have
the
key
that
equals
</ins><i><ins class="diff-new">
item
active
property
</ins></i>,<ins class="diff-new">
set
this
key's
value
in
</ins><i><ins class="diff-new">
result
</ins></i><ins class="diff-new">
to
an
empty
</ins><a class="tref internalDFN" title="array" href="#dfn-array"><ins class="diff-new">
array
</ins></a>.
Otherwise,
if
<ins class="diff-chg">the
key's
</ins>
value
is
<ins class="diff-new">not
</ins>
an
<a class="tref internalDFN" title="array" href="#dfn-array">
array
</a>,
<del class="diff-old">all
elements
must
be
either
a
string
or
subject
reference
.
Expand
value
for
each
of
its
entries
using
</del>
<ins class="diff-chg">then
set
it
to
one
containing
only
</ins>
the
<del class="diff-old">previous
three
steps.
</del>
<ins class="diff-chg">value.
</ins>
</li>
</ol>
</li>
<li>
<del class="diff-old">Otherwise,
if
the
property
is
@value
or
@language
the
</del>
<ins class="diff-chg">At
this
point,
</ins><i><ins class="diff-chg">
expanded
</ins>
value
</i>
must
<del class="diff-old">not
</del>
be
<del class="diff-old">a
JSON
object
or
</del>
an
<a class="tref internalDFN" title="array" href="#dfn-array">
array
</a>
<ins class="diff-new">due
to
the
</ins><a href="#expansion-algorithm"><ins class="diff-new">
Expansion
algorithm
</ins>
</a>.
<ins class="diff-chg">For
each
item
</ins><i><ins class="diff-chg">
expanded
item
</ins></i><ins class="diff-chg">
in
</ins><i><ins class="diff-chg">
expanded
value
</ins></i>:<ol class="algorithm">
<li>
<del class="diff-old">Otherwise,
if
the
</del>
<ins class="diff-chg">Initialize
</ins><i><ins class="diff-chg">
item
active
</ins>
property
<del class="diff-old">is
@list
or
@set
expand
value
recursively
using
this
algorithm,
passing
copies
</del>
</i>
<ins class="diff-chg">to
the
result
</ins>
of
<ins class="diff-new">using
</ins>
the
<a href="#iri-compaction">
<abbr title="Internationalized Resource Identifier">
<ins class="diff-chg">IRI
</ins></abbr><ins class="diff-chg">
Compaction
algorithm
</ins></a>,<ins class="diff-chg">
passing
</ins><a class="tref internalDFN" title="active-context" href="#dfn-active-context">
active
context
</a>,
<a class="tref internalDFN" title="inverse-context" href="#dfn-inverse-context">
<ins class="diff-new">inverse
context
</ins></a>,<i><ins class="diff-new">
expanded
property
</ins></i><ins class="diff-new">
for
</ins><i><ins class="diff-new">
iri
</ins></i>,<i><ins class="diff-new">
expanded
item
</ins></i><ins class="diff-new">
for
</ins><i><ins class="diff-new">
value
</ins></i>,<a class="tref internalDFN" title="true" href="#dfn-true"><ins class="diff-new">
true
</ins>
</a>
<ins class="diff-new">for
</ins><i><ins class="diff-new">
vocabRelative
</ins></i>,
and
<i>
<ins class="diff-chg">inside
reverse
</ins></i>.</li><li><ins class="diff-chg">
Initialize
</ins><i><ins class="diff-chg">
container
</ins></i><ins class="diff-chg">
to
</ins><a class="tref internalDFN" title="null" href="#dfn-null"><ins class="diff-chg">
null
</ins></a>.<ins class="diff-chg">
If
there
is
a
</ins><a class="tref internalDFN" title="container-mapping" href="#dfn-container-mapping"><ins class="diff-chg">
container
mapping
</ins></a><ins class="diff-chg">
for
</ins><i><ins class="diff-chg">
item
</ins>
active
property
<del class="diff-old">.
If
</del>
</i>
<ins class="diff-chg">in
</ins><a class="tref internalDFN" title="active-context" href="#dfn-active-context"><ins class="diff-chg">
active
context
</ins></a>,<ins class="diff-chg">
set
</ins><i><ins class="diff-chg">
container
</ins></i><ins class="diff-chg">
to
its
value.
</ins></li><li><ins class="diff-chg">
Initialize
</ins><i><ins class="diff-chg">
compacted
item
</ins></i><ins class="diff-chg">
to
</ins>
the
<ins class="diff-new">result
of
using
this
algorithm
recursively,
passing
</ins><a class="tref internalDFN" title="active-context" href="#dfn-active-context"><ins class="diff-new">
active
context
</ins></a>,<a class="tref internalDFN" title="inverse-context" href="#dfn-inverse-context"><ins class="diff-new">
inverse
context
</ins></a>,<i><ins class="diff-new">
item
active
property
</ins></i><ins class="diff-new">
for
</ins><a class="tref internalDFN" title="active-property" href="#dfn-active-property"><ins class="diff-new">
active
property
</ins></a>,<i>
expanded
<ins class="diff-chg">item
</ins></i><ins class="diff-chg">
for
</ins><i><ins class="diff-chg">
element
</ins></i><ins class="diff-chg">
if
it
does
not
contain
the
key
</ins><code><ins class="diff-chg">
@list
</ins></code>,<ins class="diff-chg">
otherwise
pass
the
key's
associated
</ins>
value
<ins class="diff-chg">for
</ins><i><ins class="diff-chg">
element
</ins></i>.</li><li><ins class="diff-chg">
If
</ins><i><ins class="diff-chg">
expanded
item
</ins></i><ins class="diff-chg">
is
a
</ins><a class="tref internalDFN" title="list-object" href="#dfn-list-object"><ins class="diff-chg">
list
object
</ins></a>:<ol class="algorithm"><li><ins class="diff-chg">
If
</ins><i><ins class="diff-chg">
compacted
item
</ins></i>
is
not
an
<a class="tref internalDFN" title="array" href="#dfn-array">
array
</a>,
<del class="diff-old">convert
</del>
<ins class="diff-chg">then
set
</ins>
it
to
an
<a class="tref internalDFN" title="array" href="#dfn-array">
array
<del class="diff-old">.
</del>
</a>
<ins class="diff-chg">containing
only
</ins><i><ins class="diff-chg">
compacted
item
</ins></i>.</li><li>
If
<del class="diff-old">property
</del>
<i>
<ins class="diff-chg">container
</ins></i>
is
<ins class="diff-new">not
</ins>
<code>
@list
<del class="diff-old">and
any
entry
in
value
is
</del>
</code>:
<ol class="algorithm">
<li>
<ins class="diff-chg">Convert
</ins><i><ins class="diff-chg">
compacted
item
</ins></i><ins class="diff-chg">
to
</ins>
a
<a class="tref internalDFN" title="list-object" href="#dfn-list-object">
<ins class="diff-chg">list
object
</ins></a><ins class="diff-chg">
by
setting
it
to
a
</ins><a class="tref internalDFN" title="json-object" href="#dfn-json-object">
JSON
object
</a>
containing
<del class="diff-old">an
</del>
<ins class="diff-chg">key-value
pair
where
the
key
is
the
result
of
the
</ins><a href="#iri-compaction"><abbr title="Internationalized Resource Identifier"><ins class="diff-chg">
IRI
</ins></abbr><ins class="diff-chg">
Compaction
algorithm
</ins></a>,<ins class="diff-chg">
passing
</ins><a class="tref internalDFN" title="active-context" href="#dfn-active-context"><ins class="diff-chg">
active
context
</ins></a>,<a class="tref internalDFN" title="inverse-context" href="#dfn-inverse-context"><ins class="diff-chg">
inverse
context
</ins></a>,
<code>
@list
</code>
<del class="diff-old">property,
throw
an
exception,
as
lists
of
lists
are
not
supported.
</del>
<ins class="diff-chg">for
</ins><i><ins class="diff-chg">
iri
</ins></i>,<ins class="diff-chg">
and
</ins><i><ins class="diff-chg">
compacted
item
</ins></i><ins class="diff-chg">
for
</ins><i><ins class="diff-chg">
value
</ins></i>.
</li>
<li>
<del class="diff-old">Otherwise,
expand
value
recursively
using
this
algorithm,
passing
copies
</del>
<ins class="diff-chg">If
</ins><i><ins class="diff-chg">
expanded
item
</ins></i><ins class="diff-chg">
contains
the
key
</ins><code><ins class="diff-chg">
@index
</ins></code>,<ins class="diff-chg">
then
add
a
key-value
pair
to
</ins><i><ins class="diff-chg">
compacted
item
</ins></i><ins class="diff-chg">
where
the
key
is
the
result
</ins>
of
the
<a href="#iri-compaction">
<abbr title="Internationalized Resource Identifier">
<ins class="diff-chg">IRI
</ins></abbr><ins class="diff-chg">
Compaction
algorithm
</ins></a>,<ins class="diff-chg">
passing
</ins><a class="tref internalDFN" title="active-context" href="#dfn-active-context">
active
context
</a>,
<a class="tref internalDFN" title="inverse-context" href="#dfn-inverse-context">
<ins class="diff-chg">inverse
context
</ins></a>,<code><ins class="diff-chg">
@index
</ins></code><ins class="diff-chg">
as
</ins><i><ins class="diff-chg">
iri
</ins></i>,
and
<del class="diff-old">active
property
.
</del>
<ins class="diff-chg">the
associated
with
the
</ins><code><ins class="diff-chg">
@index
</ins></code><ins class="diff-chg">
key
in
</ins><i><ins class="diff-chg">
expanded
item
</ins></i><ins class="diff-chg">
as
</ins><i><ins class="diff-chg">
value
</ins></i>.</li></ol>
</li>
<li>
<del class="diff-old">If
</del>
<ins class="diff-chg">Otherwise,
</ins><i><ins class="diff-chg">
item
active
</ins>
property
<del class="diff-old">is
</del>
</i>
<ins class="diff-chg">must
</ins>
not
<ins class="diff-new">be
</ins>
a
<del class="diff-old">keyword
and
</del>
<ins class="diff-chg">key
in
</ins><i><ins class="diff-chg">
result
</ins></i><ins class="diff-chg">
because
there
cannot
be
two
</ins><a class="tref internalDFN" title="list-object" href="#dfn-list-object"><ins class="diff-chg">
list
objects
</ins></a><ins class="diff-chg">
associated
with
an
</ins><a class="tref internalDFN" title="active-property" href="#dfn-active-property">
active
property
</a>
<ins class="diff-new">that
</ins>
has
a
<del class="diff-old">@container
</del>
<a class="tref internalDFN" title="container-mapping" href="#dfn-container-mapping">
<ins class="diff-chg">container
mapping
</ins></a><ins class="diff-chg">
;
a
</ins><code class="error"><a href="#idl-def-JsonLdErrorCode.compaction-to-list-of-lists"><ins class="diff-chg">
compaction
to
list
of
lists
</ins></a>
</code>
<ins class="diff-new">error
has
been
detected
and
processing
is
aborted.
</ins></li></ol></li><li><ins class="diff-new">
If
</ins><i><ins class="diff-new">
container
</ins></i><ins class="diff-new">
is
</ins>
<code>
<del class="diff-old">@list
</del>
<ins class="diff-chg">@language
</ins>
</code>
<del class="diff-old">and
the
expanded
value
</del>
<ins class="diff-chg">or
</ins><code><ins class="diff-chg">
@index
</ins></code>:<ol class="algorithm"><li><ins class="diff-chg">
If
</ins><i><ins class="diff-chg">
item
active
property
</ins></i>
is
<del class="diff-old">not
null
,
convert
value
</del>
<ins class="diff-chg">a
key
in
</ins><i><ins class="diff-chg">
result
</ins></i>,<ins class="diff-chg">
then
initialize
</ins><i><ins class="diff-chg">
map
object
</ins></i><ins class="diff-chg">
to
its
associated
value,
otherwise
initialize
it
</ins>
to
an
<ins class="diff-chg">empty
</ins><a class="tref internalDFN" title="json-object" href="#dfn-json-object"><ins class="diff-chg">
JSON
</ins>
object
<del class="diff-old">with
an
</del>
</a>.
</li>
<li>
<ins class="diff-chg">If
</ins><i><ins class="diff-chg">
container
</ins></i><ins class="diff-chg">
is
</ins>
<code>
<del class="diff-old">@list
</del>
<ins class="diff-chg">@language
</ins>
</code>
<del class="diff-old">property
whose
value
is
</del>
<ins class="diff-chg">and
</ins><i><ins class="diff-chg">
compacted
item
</ins></i><ins class="diff-chg">
contains
the
key
</ins><code><ins class="diff-chg">
@value
</ins></code>,<ins class="diff-chg">
then
</ins>
set
<i>
<ins class="diff-new">compacted
item
</ins></i>
to
<ins class="diff-chg">the
</ins>
value
<del class="diff-old">(unless
</del>
<ins class="diff-chg">associated
with
its
</ins><code><ins class="diff-chg">
@value
</ins></code><ins class="diff-chg">
key.
</ins></li><li><ins class="diff-chg">
Initialize
</ins><i><ins class="diff-chg">
map
key
</ins></i><ins class="diff-chg">
to
the
</ins>
value
<del class="diff-old">is
already
in
</del>
<ins class="diff-chg">associated
with
with
the
key
</ins>
that
<del class="diff-old">form).
</del>
<ins class="diff-chg">equals
</ins><i><ins class="diff-chg">
container
</ins></i><ins class="diff-chg">
in
</ins><i><ins class="diff-chg">
expanded
item
</ins></i>.
</li>
<li>
<del class="diff-old">Convert
</del>
<ins class="diff-chg">If
</ins><i><ins class="diff-chg">
map
key
</ins></i><ins class="diff-chg">
is
not
a
key
in
</ins><i><ins class="diff-chg">
map
object
</ins></i>,<ins class="diff-chg">
then
set
this
key's
</ins>
value
<ins class="diff-chg">in
</ins><i><ins class="diff-chg">
map
object
</ins></i>
to
<i>
<ins class="diff-new">compacted
item
</ins></i>.<ins class="diff-new">
Otherwise,
if
the
value
is
not
an
</ins>
<a class="tref internalDFN" title="array" href="#dfn-array">
array
<del class="diff-old">form
unless
</del>
</a>,
<ins class="diff-chg">then
set
it
to
one
containing
only
the
</ins>
value
<del class="diff-old">is
null
</del>
<ins class="diff-chg">and
then
append
</ins><i><ins class="diff-chg">
compacted
item
</ins></i><ins class="diff-chg">
to
it.
</ins></li></ol></li><li><ins class="diff-chg">
Otherwise,
</ins><ol class="algorithm"><li><ins class="diff-chg">
If
</ins><code class="idlMemberName"><a href="#widl-JsonLdOptions-compactArrays"><ins class="diff-chg">
compactArrays
</ins>
</a>
<del class="diff-old">or
property
</del>
</code>
<ins class="diff-chg">is
</ins><a class="tref internalDFN" title="false" href="#dfn-false"><ins class="diff-chg">
false
</ins></a>,<i><ins class="diff-chg">
container
</ins></i>
is
<code>
<del class="diff-old">@id
,
</del>
<ins class="diff-chg">@set
</ins></code><ins class="diff-chg">
or
</ins>
<code>
<del class="diff-old">@type
</del>
<ins class="diff-chg">@list
</ins>
</code>,
<ins class="diff-new">or
</ins><i><ins class="diff-new">
expanded
property
</ins></i><ins class="diff-new">
is
</ins>
<code>
<del class="diff-old">@value
,
</del>
<ins class="diff-chg">@list
</ins></code>
or
<code>
<del class="diff-old">@language
.
If
value
</del>
<ins class="diff-chg">@graph
</ins></code><ins class="diff-chg">
and
</ins><i><ins class="diff-chg">
compacted
item
</ins></i>
is
not
<del class="diff-old">null
,
either
merge
value
into
</del>
an
<del class="diff-old">existing
property
property
of
element
or
create
</del>
<a class="tref internalDFN" title="array" href="#dfn-array">
<ins class="diff-chg">array
</ins></a>,<ins class="diff-chg">
set
it
to
</ins>
a
new
<del class="diff-old">property
property
with
value
as
value.
</del>
<a class="tref internalDFN" title="array" href="#dfn-array">
<ins class="diff-chg">array
</ins></a><ins class="diff-chg">
containing
only
</ins><i><ins class="diff-chg">
compacted
item
</ins></i>.
</li>
<li>
If
<del class="diff-old">the
processed
element
has
an
@value
</del>
<i>
<ins class="diff-chg">item
active
</ins>
property
<del class="diff-old">element
must
</del>
</i>
<ins class="diff-chg">is
</ins>
not
<del class="diff-old">have
more
than
one
other
property,
which
can
either
be
@language
or
@type
with
</del>
a
<del class="diff-old">string
value.
</del>
<ins class="diff-chg">key
in
</ins><i><ins class="diff-chg">
result
</ins></i><ins class="diff-chg">
then
add
the
key-value
pair,
(
</ins><i><ins class="diff-chg">
item
active
property
</ins></i><ins class="diff-chg">
-
</ins><i><ins class="diff-chg">
compacted
item
</ins></i><ins class="diff-chg">
),
to
</ins><i><ins class="diff-chg">
result
</ins></i>.
</li>
<li>
<ins class="diff-new">Otherwise,
</ins>
if
the
value
<del class="diff-old">of
@value
equals
null
,
replace
element
</del>
<ins class="diff-chg">associated
</ins>
with
the
<del class="diff-old">value
of
@value
.
Otherwise,
if
element
has
an
@type
</del>
<ins class="diff-chg">key
that
equals
</ins><i><ins class="diff-chg">
item
active
</ins>
property
<del class="diff-old">and
its
value
</del>
</i>
<ins class="diff-chg">in
</ins><i><ins class="diff-chg">
result
</ins></i>
is
not
<del class="diff-old">in
the
form
of
</del>
an
<a class="tref internalDFN" title="array" href="#dfn-array">
array
</a>,
<del class="diff-old">convert
</del>
<ins class="diff-chg">set
</ins>
it
to
<del class="diff-old">an
</del>
<ins class="diff-chg">a
new
</ins>
<a class="tref internalDFN" title="array" href="#dfn-array">
array
<del class="diff-old">.
If
element
has
an
@set
or
@list
property,
it
must
be
the
</del>
</a>
<ins class="diff-chg">containing
</ins>
only
<del class="diff-old">property.
Set
element
</del>
<ins class="diff-chg">the
value.
Then
append
</ins><i><ins class="diff-chg">
compacted
item
</ins></i>
to
the
value
<del class="diff-old">of
@set
;
leave
@list
untouched.
</del>
<ins class="diff-chg">if
</ins><i><ins class="diff-chg">
compacted
item
</ins></i><ins class="diff-chg">
is
not
an
</ins><a class="tref internalDFN" title="array" href="#dfn-array"><ins class="diff-chg">
array
</ins></a>,<ins class="diff-chg">
otherwise,
concatenate
it.
</ins>
</li>
<del class="diff-old">If
element
has
just
a
@language
property,
set
element
to
null
.
</del>
</ol>
</li>
</ol>
</li>
</ol>
</li>
<li>
<del class="diff-old">Otherwise,
expand
element
according
to
the
Value
Expansion
rules,
passing
copies
of
the
active
context
and
active
property
.
</del>
<ins class="diff-chg">Return
</ins><i><ins class="diff-chg">
result
</ins></i>.
</li>
</ol>
<p>
If,
after
the
algorithm
outlined
above
is
run,
the
<del class="diff-old">resulting
element
</del>
<ins class="diff-chg">result
</ins><i><ins class="diff-chg">
result
</ins></i>
is
an
<a class="tref internalDFN" title="array" href="#dfn-array">
<ins class="diff-chg">array
</ins></a>,<ins class="diff-chg">
replace
it
with
a
new
</ins><a class="tref internalDFN" title="json-object" href="#dfn-json-object">
JSON
object
</a>
with
<del class="diff-old">just
</del>
a
<del class="diff-old">@graph
property,
element
</del>
<ins class="diff-chg">single
member
whose
key
</ins>
is
<del class="diff-old">set
to
</del>
the
<del class="diff-old">value
</del>
<ins class="diff-chg">result
</ins>
of
<ins class="diff-new">using
the
</ins><a href="#iri-compaction"><abbr title="Internationalized Resource Identifier"><ins class="diff-new">
IRI
</ins></abbr><ins class="diff-new">
Compaction
algorithm
</ins></a>,<ins class="diff-new">
passing
</ins><a class="tref internalDFN" title="active-context" href="#dfn-active-context"><ins class="diff-new">
active
context
</ins></a>,<a class="tref internalDFN" title="inverse-context" href="#dfn-inverse-context"><ins class="diff-new">
inverse
context
</ins></a>,<ins class="diff-new">
and
</ins>
<code>
@graph
</code>
<del class="diff-old">'s
value.
</del>
<ins class="diff-chg">as
</ins><i><ins class="diff-chg">
iri
</ins></i><ins class="diff-chg">
and
whose
value
is
the
</ins><a class="tref internalDFN" title="array" href="#dfn-array"><ins class="diff-chg">
array
</ins></a><i><ins class="diff-chg">
result
</ins></i>.
Finally,
if
<del class="diff-old">element
is
</del>
a
<del class="diff-old">JSON
object
,
it
is
wrapped
into
</del>
<i>
<ins class="diff-chg">context
</ins></i><ins class="diff-chg">
has
been
passed,
add
</ins>
an
<del class="diff-old">array
.
</del>
<code>
<ins class="diff-chg">@context
</ins></code><ins class="diff-chg">
member
to
</ins><i><ins class="diff-chg">
result
</ins></i><ins class="diff-chg">
and
set
its
value
to
the
passed
</ins><i><ins class="diff-chg">
context
</ins></i>.
</p>
</section>
</section>
<section id="inverse-context-creation">
<h3>
<span class="secno">
<del class="diff-old">4.8
</del>
<ins class="diff-chg">8.2
</ins>
</span>
<del class="diff-old">Compaction
</del>
<ins class="diff-chg">Inverse
Context
Creation
</ins>
</h3>
<p>
<del class="diff-old">Compaction
</del>
<ins class="diff-chg">When
there
</ins>
is
<ins class="diff-new">more
than
one
</ins><a class="tref internalDFN" title="term" href="#dfn-term"><ins class="diff-new">
term
</ins></a><ins class="diff-new">
that
could
be
chosen
to
compact
an
</ins><a class="tref internalDFN" title="iri" href="#dfn-iri"><abbr title="Internationalized Resource Identifier"><ins class="diff-new">
IRI
</ins></abbr></a>,<ins class="diff-new">
it
has
to
be
ensured
that
</ins>
the
<del class="diff-old">process
of
taking
a
JSON-LD
document
</del>
<a class="tref internalDFN" title="term" href="#dfn-term">
<ins class="diff-chg">term
</ins></a><ins class="diff-chg">
selection
is
both
deterministic
</ins>
and
<del class="diff-old">applying
a
context
such
that
</del>
<ins class="diff-chg">represents
</ins>
the
most
<del class="diff-old">compact
form
of
</del>
<ins class="diff-chg">context-appropriate
choice
whilst
taking
into
consideration
algorithmic
complexity.
</ins></p><p><ins class="diff-chg">
In
order
to
make
</ins><a class="tref internalDFN" title="term" href="#dfn-term"><ins class="diff-chg">
term
</ins></a><ins class="diff-chg">
selections,
</ins>
the
<del class="diff-old">document
</del>
<ins class="diff-chg">concept
of
an
</ins><a class="tref internalDFN" title="inverse-context" href="#dfn-inverse-context"><ins class="diff-chg">
inverse
context
</ins></a>
is
<del class="diff-old">generated.
JSON
</del>
<ins class="diff-chg">introduced.
An
</ins><dfn title="inverse-context" id="dfn-inverse-context"><ins class="diff-chg">
inverse
context
</ins></dfn>
is
<del class="diff-old">typically
expressed
in
</del>
<ins class="diff-chg">essentially
</ins>
a
<del class="diff-old">very
compact,
key-value
format.
That
is,
full
IRIs
are
rarely
used
as
keys.
At
times,
</del>
<ins class="diff-chg">reverse
lookup
table
that
maps
</ins><a class="tref internalDFN" title="container-mapping" href="#dfn-container-mapping"><ins class="diff-chg">
container
mappings
</ins></a>,<a class="tref internalDFN" title="type-mapping" href="#dfn-type-mapping"><ins class="diff-chg">
type
mappings
</ins></a>,<ins class="diff-chg">
and
</ins><a class="tref internalDFN" title="language-mapping" href="#dfn-language-mapping"><ins class="diff-chg">
language
mappings
</ins></a><ins class="diff-chg">
to
</ins>
a
<del class="diff-old">JSON-LD
document
may
</del>
<ins class="diff-chg">simple
</ins><a class="tref internalDFN" title="term" href="#dfn-term"><ins class="diff-chg">
term
</ins></a><ins class="diff-chg">
for
a
given
</ins><a class="tref internalDFN" title="active-context" href="#dfn-active-context"><ins class="diff-chg">
active
context
</ins></a>.<ins class="diff-chg">
A
</ins><a class="tref internalDFN" title="inverse-context" href="#dfn-inverse-context"><ins class="diff-chg">
inverse
context
</ins></a><ins class="diff-chg">
only
needs
to
</ins>
be
<del class="diff-old">received
that
</del>
<ins class="diff-chg">generated
for
an
</ins><a class="tref internalDFN" title="active-context" href="#dfn-active-context"><ins class="diff-chg">
active
context
</ins></a><ins class="diff-chg">
if
it
</ins>
is
<del class="diff-old">not
in
its
most
compact
form.
JSON-LD,
via
</del>
<ins class="diff-chg">being
used
for
</ins><a class="tref internalDFN" title="compaction" href="#dfn-compaction"><ins class="diff-chg">
compaction
</ins></a>.</p><p><ins class="diff-chg">
To
make
use
of
an
</ins><a class="tref internalDFN" title="inverse-context" href="#dfn-inverse-context"><ins class="diff-chg">
inverse
context
</ins></a>,<ins class="diff-chg">
a
list
of
preferred
</ins><a class="tref internalDFN" title="container-mapping" href="#dfn-container-mapping"><ins class="diff-chg">
container
mappings
</ins></a><ins class="diff-chg">
and
</ins>
the
<del class="diff-old">API,
provides
</del>
<a class="tref internalDFN" title="type-mapping" href="#dfn-type-mapping">
<ins class="diff-chg">type
mapping
</ins></a><ins class="diff-chg">
or
</ins><a class="tref internalDFN" title="language-mapping" href="#dfn-language-mapping"><ins class="diff-chg">
language
mapping
</ins></a><ins class="diff-chg">
are
gathered
for
</ins>
a
<del class="diff-old">way
</del>
<ins class="diff-chg">particular
value
associated
with
an
</ins><a class="tref internalDFN" title="iri" href="#dfn-iri"><abbr title="Internationalized Resource Identifier"><ins class="diff-chg">
IRI
</ins></abbr></a>.<ins class="diff-chg">
These
parameters
are
then
fed
</ins>
to
<del class="diff-old">compact
a
JSON-LD
document.
For
example,
assume
</del>
the
<del class="diff-old">following
JSON-LD
input
document:
</del>
<a href="#term-selection">
<ins class="diff-chg">Term
Selection
algorithm
</ins></a>,<ins class="diff-chg">
which
will
find
the
</ins><a class="tref internalDFN" title="term" href="#dfn-term"><ins class="diff-chg">
term
</ins></a><ins class="diff-chg">
that
most
appropriately
matches
the
value's
mappings.
</ins>
</p>
<del class="diff-old">{
  &quot;http://xmlns.com/foaf/0.1/name&quot;: &quot;Manu Sporny&quot;,
  &quot;http://xmlns.com/foaf/0.1/homepage&quot;: {
    &quot;@id&quot;: &quot;http://manu.sporny.org/&quot;
  }
}
</del>
<section class="informative">
<h4 id="general-solution-6">
<ins class="diff-chg">General
Solution
</ins></h4>
<p>
<del class="diff-old">Additionally,
assume
the
following
developer-supplied
JSON-LD
context:
{
  &quot;@context&quot;: {
    &quot;name&quot;: &quot;http://xmlns.com/foaf/0.1/name&quot;,
    &quot;homepage&quot;: {
      &quot;@id&quot;: &quot;http://xmlns.com/foaf/0.1/homepage&quot;,
      &quot;@type&quot;: &quot;@id&quot;
    }
  }
}
</del>
<em>
<ins class="diff-chg">This
section
is
non-normative.
</ins></em></p>
<p>
<del class="diff-old">Running
the
JSON-LD
Compaction
algorithm
</del>
<ins class="diff-chg">To
create
an
</ins><a class="tref internalDFN" title="inverse-context" href="#dfn-inverse-context"><ins class="diff-chg">
inverse
context
</ins></a><ins class="diff-chg">
for
a
</ins>
given
<a class="tref internalDFN" title="active-context" href="#dfn-active-context">
<ins class="diff-new">active
context
</ins></a>,<ins class="diff-new">
each
</ins><a class="tref internalDFN" title="term" href="#dfn-term"><ins class="diff-new">
term
</ins></a><ins class="diff-new">
in
</ins>
the
<a class="tref internalDFN" title="active-context" href="#dfn-active-context">
<ins class="diff-new">active
</ins>
context
<del class="diff-old">supplied
above
against
</del>
</a>
<ins class="diff-chg">is
visited,
ordered
by
length,
shortest
first
(ties
are
broken
by
choosing
</ins>
the
<del class="diff-old">JSON-LD
input
document
provided
above
</del>
<ins class="diff-chg">lexicographically
least
</ins><a class="tref internalDFN" title="term" href="#dfn-term"><ins class="diff-chg">
term
</ins></a><ins class="diff-chg">
).
For
each
</ins><a class="tref internalDFN" title="term" href="#dfn-term"><ins class="diff-chg">
term
</ins></a>,<ins class="diff-chg">
an
entry
is
added
to
the
</ins><a class="tref internalDFN" title="inverse-context" href="#dfn-inverse-context"><ins class="diff-chg">
inverse
context
</ins></a><ins class="diff-chg">
for
each
possible
combination
of
</ins><a class="tref internalDFN" title="container-mapping" href="#dfn-container-mapping"><ins class="diff-chg">
container
mapping
</ins></a><ins class="diff-chg">
and
</ins><a class="tref internalDFN" title="type-mapping" href="#dfn-type-mapping"><ins class="diff-chg">
type
mapping
</ins></a><ins class="diff-chg">
or
</ins><a class="tref internalDFN" title="language-mapping" href="#dfn-language-mapping"><ins class="diff-chg">
language
mapping
</ins></a><ins class="diff-chg">
that
</ins>
would
<del class="diff-old">result
in
</del>
<ins class="diff-chg">legally
match
</ins>
the
<del class="diff-old">following
output:
{
  &quot;@context&quot;: {
    &quot;name&quot;: &quot;http://xmlns.com/foaf/0.1/name&quot;,
    &quot;homepage&quot;: {
      &quot;@id&quot;: &quot;http://xmlns.com/foaf/0.1/homepage&quot;,
      &quot;@type&quot;: &quot;@id&quot;
    }
  },
  &quot;name&quot;: &quot;Manu Sporny&quot;,
  &quot;homepage&quot;: &quot;http://manu.sporny.org/&quot;
}
The
compaction
algorithm
also
enables
</del>
<a class="tref internalDFN" title="term" href="#dfn-term">
<ins class="diff-chg">term
</ins></a>.<ins class="diff-chg">
Illegal
matches
include
differences
between
a
value's
</ins><a class="tref internalDFN" title="type-mapping" href="#dfn-type-mapping"><ins class="diff-chg">
type
mapping
</ins></a><ins class="diff-chg">
or
</ins><a class="tref internalDFN" title="language-mapping" href="#dfn-language-mapping"><ins class="diff-chg">
language
mapping
</ins></a><ins class="diff-chg">
and
that
of
</ins>
the
<del class="diff-old">developer
to
map
any
expanded
format
into
</del>
<a class="tref internalDFN" title="term" href="#dfn-term">
<ins class="diff-chg">term
</ins></a>.<ins class="diff-chg">
If
a
</ins><a class="tref internalDFN" title="term" href="#dfn-term"><ins class="diff-chg">
term
</ins></a><ins class="diff-chg">
has
no
</ins><a class="tref internalDFN" title="container-mapping" href="#dfn-container-mapping"><ins class="diff-chg">
container
mapping
</ins></a>,<a class="tref internalDFN" title="type-mapping" href="#dfn-type-mapping"><ins class="diff-chg">
type
mapping
</ins></a>,<ins class="diff-chg">
or
</ins><a class="tref internalDFN" title="language-mapping" href="#dfn-language-mapping"><ins class="diff-chg">
language
mapping
</ins></a><ins class="diff-chg">
(or
some
combination
of
these),
then
it
will
have
</ins>
an
<del class="diff-old">application-specific
compacted
format.
While
</del>
<ins class="diff-chg">entry
in
</ins>
the
<a class="tref internalDFN" title="inverse-context" href="#dfn-inverse-context">
<ins class="diff-new">inverse
</ins>
context
<del class="diff-old">provided
above
mapped
</del>
</a>
<ins class="diff-chg">using
the
special
key
</ins>
<code>
<del class="diff-old">http://xmlns.com/foaf/0.1/name
</del>
<ins class="diff-chg">@none
</ins></code>.<ins class="diff-chg">
This
allows
the
</ins><a href="#term-selection"><ins class="diff-chg">
Term
Selection
algorithm
</ins></a>
to
<del class="diff-old">name
,
it
could
have
also
mapped
it
</del>
<ins class="diff-chg">fall
back
</ins>
to
<del class="diff-old">any
arbitrary
string
provided
by
the
developer.
</del>
<ins class="diff-chg">choosing
more
generic
</ins><a class="tref internalDFN" title="term" href="#dfn-term"><ins class="diff-chg">
terms
</ins></a><ins class="diff-chg">
when
a
more
specifically-matching
</ins><a class="tref internalDFN" title="term" href="#dfn-term"><ins class="diff-chg">
term
</ins></a><ins class="diff-chg">
is
not
available
for
a
particular
</ins><a class="tref internalDFN" title="iri" href="#dfn-iri">
<del class="diff-old">4.8.1
Compaction
</del>
<abbr title="Internationalized Resource Identifier">
<ins class="diff-chg">IRI
</ins></abbr></a><ins class="diff-chg">
and
value
combination.
</ins></p></section><section><h4 id="algorithm-6">
Algorithm
</h4>
<p>
The
algorithm
takes
<del class="diff-old">three
input
variables:
an
</del>
<ins class="diff-chg">one
required
input:
the
</ins><a class="tref internalDFN" title="active-context" href="#dfn-active-context">
active
context
<del class="diff-old">,
an
active
property
,
and
</del>
</a>
<ins class="diff-chg">that
the
</ins><a class="tref internalDFN" title="inverse-context" href="#dfn-inverse-context"><ins class="diff-chg">
inverse
context
</ins></a><ins class="diff-chg">
is
being
created
for.
</ins></p><ol class="algorithm"><li><ins class="diff-chg">
Initialize
</ins><i><ins class="diff-chg">
result
</ins></i><ins class="diff-chg">
to
</ins>
an
<del class="diff-old">element
</del>
<ins class="diff-chg">empty
</ins><a class="tref internalDFN" title="json-object" href="#dfn-json-object"><ins class="diff-chg">
JSON
object
</ins></a>.</li><li><ins class="diff-chg">
Initialize
</ins><i><ins class="diff-chg">
defaultLanguage
</ins></i>
to
<del class="diff-old">be
compacted.
To
begin,
</del>
<code>
<ins class="diff-chg">@none
</ins></code>.<ins class="diff-chg">
If
</ins>
the
<a class="tref internalDFN" title="active-context" href="#dfn-active-context">
active
context
</a>
<del class="diff-old">is
</del>
<ins class="diff-chg">has
a
</ins><a class="tref internalDFN" title="default-language" href="#dfn-default-language"><ins class="diff-chg">
default
language
</ins></a>,
set
<i>
<ins class="diff-new">defaultLanguage
</ins></i>
to
<del class="diff-old">the
result
of
performing
Context
Processing
</del>
<ins class="diff-chg">it.
</ins></li><li><ins class="diff-chg">
For
each
key
</ins><a class="tref internalDFN" title="term" href="#dfn-term"><ins class="diff-chg">
term
</ins>
</a>
<del class="diff-old">on
</del>
<ins class="diff-chg">and
value
</ins><a class="tref internalDFN" title="term-definition" href="#dfn-term-definition"><ins class="diff-chg">
term
definition
</ins></a><ins class="diff-chg">
in
</ins>
the
<del class="diff-old">passed
context
,
</del>
<a class="tref internalDFN" title="active-context" href="#dfn-active-context">
active
<del class="diff-old">property
</del>
<ins class="diff-chg">context
</ins></a>,<ins class="diff-chg">
ordered
by
shortest
</ins><a class="tref internalDFN" title="term" href="#dfn-term"><ins class="diff-chg">
term
</ins></a><ins class="diff-chg">
first
(breaking
ties
by
choosing
the
lexicographically
least
</ins><a class="tref internalDFN" title="term" href="#dfn-term"><ins class="diff-chg">
term
</ins></a><ins class="diff-chg">
):
</ins><ol class="algorithm"><li><ins class="diff-chg">
If
the
</ins><a class="tref internalDFN" title="term-definition" href="#dfn-term-definition"><ins class="diff-chg">
term
definition
</ins>
</a>
is
<del class="diff-old">set
to
</del>
<a class="tref internalDFN" title="null" href="#dfn-null">
null
</a>,
<del class="diff-old">and
element
</del>
<a class="tref internalDFN" title="term" href="#dfn-term">
<ins class="diff-chg">term
</ins></a><ins class="diff-chg">
cannot
be
selected
during
</ins><a class="tref internalDFN" title="compaction" href="#dfn-compaction"><ins class="diff-chg">
compaction
</ins></a>,<ins class="diff-chg">
so
continue
to
the
next
</ins><a class="tref internalDFN" title="term" href="#dfn-term"><ins class="diff-chg">
term
</ins></a>.</li><li><ins class="diff-chg">
Initialize
</ins><i><ins class="diff-chg">
container
</ins></i><ins class="diff-chg">
to
</ins><code><ins class="diff-chg">
@none
</ins></code>.<ins class="diff-chg">
If
there
</ins>
is
<ins class="diff-new">a
</ins><a class="tref internalDFN" title="container-mapping" href="#dfn-container-mapping"><ins class="diff-new">
container
mapping
</ins></a><ins class="diff-new">
in
</ins><a class="tref internalDFN" title="term-definition" href="#dfn-term-definition"><ins class="diff-new">
term
definition
</ins></a>,
set
<i>
<ins class="diff-new">container
</ins></i><ins class="diff-new">
to
its
associated
value.
</ins></li><li><ins class="diff-new">
Initialize
</ins><i><ins class="diff-new">
iri
</ins></i>
to
the
<del class="diff-old">result
</del>
<ins class="diff-chg">value
</ins>
of
<del class="diff-old">performing
</del>
the
<del class="diff-old">Expansion
Algorithm
</del>
<a class="tref internalDFN" title="iri-mapping" href="#dfn-iri-mapping">
<abbr title="Internationalized Resource Identifier">
<ins class="diff-chg">IRI
</ins></abbr><ins class="diff-chg">
mapping
</ins>
</a>
<del class="diff-old">on
</del>
<ins class="diff-chg">for
</ins>
the
<del class="diff-old">JSON-LD
input
</del>
<a class="tref internalDFN" title="term-definition" href="#dfn-term-definition">
<ins class="diff-chg">term
definition
</ins>
</a>.
<del class="diff-old">This
removes
any
existing
context
to
allow
the
given
active
context
to
be
cleanly
applied.
</del>
</li>
<li>
If
<del class="diff-old">element
</del>
<i>
<ins class="diff-chg">iri
</ins></i>
is
<del class="diff-old">an
array
,
process
each
entry
</del>
<ins class="diff-chg">not
a
key
</ins>
in
<del class="diff-old">element
recursively
using
this
algorithm,
passing
</del>
<i>
<ins class="diff-chg">result
</ins></i>,<ins class="diff-chg">
add
</ins>
a
<del class="diff-old">copy
of
</del>
<ins class="diff-chg">key-value
pair
where
</ins>
the
<del class="diff-old">active
context
</del>
<ins class="diff-chg">key
is
</ins><i><ins class="diff-chg">
iri
</ins></i>
and
the
<del class="diff-old">active
property
.
If
element
has
a
single
item,
the
compacted
</del>
value
is
<del class="diff-old">that
item;
otherwise
</del>
<ins class="diff-chg">an
empty
</ins><a class="tref internalDFN" title="json-object" href="#dfn-json-object"><ins class="diff-chg">
JSON
object
</ins></a><ins class="diff-chg">
to
</ins><i><ins class="diff-chg">
result
</ins></i>.</li><li><ins class="diff-chg">
Reference
</ins>
the
<del class="diff-old">compacted
</del>
value
<del class="diff-old">is
element
.
</del>
<ins class="diff-chg">associated
with
the
</ins><i><ins class="diff-chg">
iri
</ins></i><ins class="diff-chg">
member
in
</ins><i><ins class="diff-chg">
result
</ins></i><ins class="diff-chg">
using
the
variable
</ins><i><ins class="diff-chg">
container
map
</ins></i>.
</li>
<li>
<del class="diff-old">Otherwise,
if
element
is
an
object:
</del>
If
<del class="diff-old">element
</del>
<i>
<ins class="diff-chg">container
</ins></i>
has
<del class="diff-old">an
</del>
<ins class="diff-chg">no
</ins><i><ins class="diff-chg">
container
map
</ins></i><ins class="diff-chg">
member,
create
one
and
set
its
value
to
a
new
</ins><a class="tref internalDFN" title="json-object" href="#dfn-json-object"><ins class="diff-chg">
JSON
object
</ins></a><ins class="diff-chg">
with
two
members.
The
first
member
is
</ins>
<code>
<del class="diff-old">@value
</del>
<ins class="diff-chg">@language
</ins>
</code>
<del class="diff-old">property
or
element
</del>
<ins class="diff-chg">and
its
value
</ins>
is
a
<del class="diff-old">subject
reference
</del>
<ins class="diff-chg">new
empty
</ins><a class="tref internalDFN" title="json-object" href="#dfn-json-object"><ins class="diff-chg">
JSON
object
</ins>
</a>,
<del class="diff-old">return
</del>
the
<del class="diff-old">result
of
performing
Value
Compaction
on
element
using
active
property
</del>
<ins class="diff-chg">second
member
is
</ins><code><ins class="diff-chg">
@type
</ins></code><ins class="diff-chg">
and
its
value
is
a
new
empty
</ins><a class="tref internalDFN" title="json-object" href="#dfn-json-object"><ins class="diff-chg">
JSON
object
</ins>
</a>.
</li>
<li>
<del class="diff-old">Otherwise,
if
</del>
<ins class="diff-chg">Reference
</ins>
the
<del class="diff-old">active
property
</del>
<ins class="diff-chg">value
associated
with
the
</ins><i><ins class="diff-chg">
container
</ins></i><ins class="diff-chg">
member
in
</ins><i><ins class="diff-chg">
container
map
</ins></i><ins class="diff-chg">
using
the
variable
</ins><i><ins class="diff-chg">
typeOrLanguage
map
</ins></i>.</li><li><ins class="diff-chg">
If
the
</ins><a class="tref internalDFN" title="term-definition" href="#dfn-term-definition"><ins class="diff-chg">
term
definition
</ins>
</a>
<del class="diff-old">has
</del>
<ins class="diff-chg">indicates
that
the
</ins><a class="tref internalDFN" title="term" href="#dfn-term"><ins class="diff-chg">
term
</ins></a><ins class="diff-chg">
represents
</ins>
a
<a class="tref internalDFN" title="reverse-property" href="#dfn-reverse-property">
<ins class="diff-new">reverse
property
</ins></a>:<ol class="algorithm"><li><ins class="diff-new">
Reference
the
value
associated
with
the
</ins>
<code>
<del class="diff-old">@container
</del>
<ins class="diff-chg">@type
</ins>
</code>
<del class="diff-old">mapping
to
</del>
<ins class="diff-chg">member
in
</ins><i><ins class="diff-chg">
typeOrLanguage
map
</ins></i><ins class="diff-chg">
using
the
variable
</ins><i><ins class="diff-chg">
type
map
</ins></i>.</li><li><ins class="diff-chg">
If
</ins><i><ins class="diff-chg">
type
map
</ins></i><ins class="diff-chg">
does
not
have
a
</ins>
<code>
<del class="diff-old">@list
</del>
<ins class="diff-chg">@reverse
</ins>
</code>
<ins class="diff-new">member,
create
one
</ins>
and
<del class="diff-old">element
</del>
<ins class="diff-chg">set
its
value
to
the
</ins><a class="tref internalDFN" title="term" href="#dfn-term"><ins class="diff-chg">
term
</ins></a><ins class="diff-chg">
being
processed.
</ins></li></ol></li><li><ins class="diff-chg">
Otherwise,
if
</ins><a class="tref internalDFN" title="term-definition" href="#dfn-term-definition"><ins class="diff-chg">
term
definition
</ins></a>
has
a
<del class="diff-old">corresponding
</del>
<a class="tref internalDFN" title="type-mapping" href="#dfn-type-mapping">
<ins class="diff-chg">type
mapping
</ins></a>:<ol class="algorithm"><li><ins class="diff-chg">
Reference
the
value
associated
with
the
</ins>
<code>
<del class="diff-old">@list
</del>
<ins class="diff-chg">@type
</ins>
</code>
<del class="diff-old">property,
recursively
compact
that
property's
value
passing
</del>
<ins class="diff-chg">member
in
</ins><i><ins class="diff-chg">
typeOrLanguage
map
</ins></i><ins class="diff-chg">
using
the
variable
</ins><i><ins class="diff-chg">
type
map
</ins></i>.</li><li><ins class="diff-chg">
If
</ins><i><ins class="diff-chg">
type
map
</ins></i><ins class="diff-chg">
does
not
have
</ins>
a
<del class="diff-old">copy
of
</del>
<ins class="diff-chg">member
corresponding
to
</ins>
the
<del class="diff-old">active
context
</del>
<a class="tref internalDFN" title="type-mapping" href="#dfn-type-mapping">
<ins class="diff-chg">type
mapping
</ins>
</a>
<ins class="diff-new">in
</ins><a class="tref internalDFN" title="term-definition" href="#dfn-term-definition"><ins class="diff-new">
term
definition
</ins></a>,<ins class="diff-new">
create
one
</ins>
and
<ins class="diff-new">set
its
value
to
</ins>
the
<del class="diff-old">active
property
</del>
<a class="tref internalDFN" title="term" href="#dfn-term">
<ins class="diff-chg">term
</ins>
</a>
<del class="diff-old">ensuring
that
the
result
is
an
array
and
removing
</del>
<ins class="diff-chg">being
processed.
</ins></li></ol></li><li><ins class="diff-chg">
Otherwise,
if
</ins><a class="tref internalDFN" title="term-definition" href="#dfn-term-definition"><ins class="diff-chg">
term
definition
</ins></a><ins class="diff-chg">
has
a
</ins><a class="tref internalDFN" title="language-mapping" href="#dfn-language-mapping"><ins class="diff-chg">
language
mapping
</ins></a><ins class="diff-chg">
(might
be
</ins>
<a class="tref internalDFN" title="null" href="#dfn-null">
null
</a>
<del class="diff-old">values.
Return
either
</del>
<ins class="diff-chg">):
</ins><ol class="algorithm"><li><ins class="diff-chg">
Reference
</ins>
the
<del class="diff-old">result
as
an
array,
as
an
object
</del>
<ins class="diff-chg">value
associated
</ins>
with
<del class="diff-old">a
key
of
</del>
<ins class="diff-chg">the
</ins>
<code>
<del class="diff-old">@list
</del>
<ins class="diff-chg">@language
</ins>
</code>
<del class="diff-old">(or
appropriate
alias
from
active
context
</del>
<ins class="diff-chg">member
in
</ins><i><ins class="diff-chg">
typeOrLanguage
map
</ins></i><ins class="diff-chg">
using
the
variable
</ins><i><ins class="diff-chg">
language
map
</ins></i>.</li><li><ins class="diff-chg">
If
the
</ins><a class="tref internalDFN" title="language-mapping" href="#dfn-language-mapping"><ins class="diff-chg">
language
mapping
</ins>
</a>
<del class="diff-old">).
</del>
<ins class="diff-chg">equals
</ins><a class="tref internalDFN" title="null" href="#dfn-null"><ins class="diff-chg">
null
</ins></a>,<ins class="diff-chg">
set
</ins><i><ins class="diff-chg">
language
</ins></i><ins class="diff-chg">
to
</ins><code><ins class="diff-chg">
@null
</ins></code><ins class="diff-chg">
;
otherwise
set
it
to
the
language
code
in
</ins><a class="tref internalDFN" title="language-mapping" href="#dfn-language-mapping"><ins class="diff-chg">
language
mapping
</ins></a>.
</li>
<li>
<del class="diff-old">Otherwise,
construct
output
as
</del>
<ins class="diff-chg">If
</ins><i><ins class="diff-chg">
language
map
</ins></i><ins class="diff-chg">
does
not
have
</ins>
a
<del class="diff-old">new
JSON
object
</del>
<i>
<ins class="diff-chg">language
</ins></i><ins class="diff-chg">
member,
create
one
and
set
its
value
to
the
</ins><a class="tref internalDFN" title="term" href="#dfn-term"><ins class="diff-chg">
term
</ins>
</a>
<del class="diff-old">used
for
returning
</del>
<ins class="diff-chg">being
processed.
</ins></li></ol></li><li><ins class="diff-chg">
Otherwise:
</ins><ol class="algorithm"><li><ins class="diff-chg">
Reference
</ins>
the
<del class="diff-old">result
of
compacting
element
.
For
each
property
and
</del>
value
<ins class="diff-chg">associated
with
the
</ins><code><ins class="diff-chg">
@language
</ins></code><ins class="diff-chg">
member
</ins>
in
<del class="diff-old">element:
</del>
<i>
<ins class="diff-chg">typeOrLanguage
map
</ins></i><ins class="diff-chg">
using
the
variable
</ins><i><ins class="diff-chg">
language
map
</ins></i>.</li>
<li>
If
<del class="diff-old">property
is
</del>
<i>
<ins class="diff-chg">language
map
</ins></i><ins class="diff-chg">
does
not
have
a
</ins><i><ins class="diff-chg">
defaultLanguage
</ins></i><ins class="diff-chg">
member,
create
one
and
set
its
value
to
the
</ins><a class="tref internalDFN" title="term" href="#dfn-term"><ins class="diff-chg">
term
</ins></a><ins class="diff-chg">
being
processed.
</ins></li><li><ins class="diff-chg">
If
</ins><i><ins class="diff-chg">
language
map
</ins></i><ins class="diff-chg">
does
not
have
a
</ins>
<code>
<del class="diff-old">@id
</del>
<ins class="diff-chg">@none
</ins>
</code>
<del class="diff-old">or
</del>
<ins class="diff-chg">member,
create
one
and
set
its
value
to
the
</ins><a class="tref internalDFN" title="term" href="#dfn-term"><ins class="diff-chg">
term
</ins></a><ins class="diff-chg">
being
processed.
</ins></li><li><ins class="diff-chg">
Reference
the
value
associated
with
the
</ins>
<code>
@type
</code>
<ins class="diff-chg">member
in
</ins><i><ins class="diff-chg">
typeOrLanguage
map
</ins></i><ins class="diff-chg">
using
the
variable
</ins><i><ins class="diff-chg">
type
map
</ins></i>.</li>
<li>
<del class="diff-old">Set
active
property
</del>
<ins class="diff-chg">If
</ins><i><ins class="diff-chg">
type
map
</ins></i><ins class="diff-chg">
does
not
have
a
</ins><code><ins class="diff-chg">
@none
</ins></code><ins class="diff-chg">
member,
create
one
and
set
its
value
</ins>
to
the
<a class="tref internalDFN" title="term" href="#dfn-term">
<ins class="diff-new">term
</ins></a><ins class="diff-new">
being
processed.
</ins></li></ol></li></ol></li><li><ins class="diff-new">
Return
</ins><i>
result
<del class="diff-old">of
performing
</del>
</i>.
</li>
</ol>
</section>
</section>
<section id="iri-compaction">
<h3>
<span class="secno">
<ins class="diff-chg">8.3
</ins></span>
<abbr title="Internationalized Resource Identifier">
IRI
</abbr>
Compaction
</h3>
<p>
<ins class="diff-new">This
algorithm
compacts
an
</ins><a class="tref internalDFN" title="iri" href="#dfn-iri"><abbr title="Internationalized Resource Identifier"><ins class="diff-new">
IRI
</ins></abbr>
</a>
<del class="diff-old">on
property
.
If
value
is
</del>
<ins class="diff-chg">to
</ins>
a
<del class="diff-old">string
</del>
<a class="tref internalDFN" title="term" href="#dfn-term">
<ins class="diff-chg">term
</ins></a><ins class="diff-chg">
or
</ins><a class="tref internalDFN" title="compact-iri" href="#dfn-compact-iri"><ins class="diff-chg">
compact
</ins><abbr title="Internationalized Resource Identifier"><ins class="diff-chg">
IRI
</ins></abbr>
</a>,
<ins class="diff-new">or
a
</ins><a class="tref internalDFN" title="keyword" href="#dfn-keyword"><ins class="diff-new">
keyword
</ins></a><ins class="diff-new">
to
a
</ins><a class="tref internalDFN" title="keyword-alias" href="#dfn-keyword-alias"><ins class="diff-new">
keyword
alias
</ins></a>.<ins class="diff-new">
A
value
that
is
associated
with
</ins>
the
<del class="diff-old">compacted
</del>
<a class="tref internalDFN" title="iri" href="#dfn-iri">
<abbr title="Internationalized Resource Identifier">
<ins class="diff-chg">IRI
</ins></abbr></a><ins class="diff-chg">
may
be
passed
in
order
to
assist
in
selecting
the
most
context-appropriate
</ins><a class="tref internalDFN" title="term" href="#dfn-term"><ins class="diff-chg">
term
</ins></a>.</p><section class="informative"><h4 id="general-solution-7"><ins class="diff-chg">
General
Solution
</ins></h4><p>
<em>
<del class="diff-old">value
</del>
<ins class="diff-chg">This
section
is
non-normative.
</ins>
</em>
</p>
<p>
<ins class="diff-new">If
the
passed
</ins><a class="tref internalDFN" title="iri" href="#dfn-iri"><abbr title="Internationalized Resource Identifier"><ins class="diff-new">
IRI
</ins></abbr></a>
is
<a class="tref internalDFN" title="null" href="#dfn-null">
<ins class="diff-new">null
</ins></a>,<ins class="diff-new">
we
simply
return
</ins><a class="tref internalDFN" title="null" href="#dfn-null"><ins class="diff-new">
null
</ins></a>.<ins class="diff-new">
Otherwise,
we
first
try
to
find
a
</ins><a class="tref internalDFN" title="term" href="#dfn-term"><ins class="diff-new">
term
</ins></a><ins class="diff-new">
that
</ins>
the
<del class="diff-old">result
of
performing
</del>
<a class="tref internalDFN" title="iri" href="#dfn-iri">
<abbr title="Internationalized Resource Identifier">
IRI
</abbr>
<del class="diff-old">Compaction
</del>
</a>
<del class="diff-old">on
</del>
<ins class="diff-chg">or
</ins><a class="tref internalDFN" title="keyword" href="#dfn-keyword"><ins class="diff-chg">
keyword
</ins></a><ins class="diff-chg">
can
be
compacted
to
if
it
is
relative
to
</ins><a class="tref internalDFN" title="active-context" href="#dfn-active-context"><ins class="diff-chg">
active
context's
</ins></a><a class="tref internalDFN" title="vocabulary-mapping" href="#dfn-vocabulary-mapping"><ins class="diff-chg">
vocabulary
mapping
</ins></a>.<ins class="diff-chg">
In
order
to
select
the
most
appropriate
</ins><a class="tref internalDFN" title="term" href="#dfn-term"><ins class="diff-chg">
term
</ins></a>,<ins class="diff-chg">
we
may
have
to
collect
information
about
the
passed
</ins><i>
value
<del class="diff-old">.
Otherwise,
</del>
</i>.
<ins class="diff-chg">This
information
includes
whic
</ins><a class="tref internalDFN" title="container-mapping" href="#dfn-container-mapping"><ins class="diff-chg">
container
mappings
</ins></a><ins class="diff-chg">
would
be
preferred
for
expressing
the
</ins><i>
value
<del class="diff-old">must
</del>
</i>,
<ins class="diff-chg">and
what
its
</ins><a class="tref internalDFN" title="type-mapping" href="#dfn-type-mapping"><ins class="diff-chg">
type
mapping
</ins></a><ins class="diff-chg">
or
</ins><a class="tref internalDFN" title="language-mapping" href="#dfn-language-mapping"><ins class="diff-chg">
language
mapping
</ins></a><ins class="diff-chg">
is.
For
</ins><a class="tref internalDFN" title="list-object" href="#dfn-list-object"><ins class="diff-chg">
JSON-LD
lists
</ins></a>,<ins class="diff-chg">
the
</ins><a class="tref internalDFN" title="type-mapping" href="#dfn-type-mapping"><ins class="diff-chg">
type
mapping
</ins></a><ins class="diff-chg">
or
</ins><a class="tref internalDFN" title="language-mapping" href="#dfn-language-mapping"><ins class="diff-chg">
language
mapping
</ins></a><ins class="diff-chg">
will
</ins>
be
<ins class="diff-new">chosen
based
on
the
most
specific
values
that
work
for
all
items
in
the
list.
Once
this
information
is
gathered,
it
is
passed
to
the
</ins><a href="#term-selection"><ins class="diff-new">
Term
Selection
algorithm
</ins></a>,<ins class="diff-new">
which
will
return
the
most
appropriate
</ins><a class="tref internalDFN" title="term" href="#dfn-term"><ins class="diff-new">
term
</ins></a><ins class="diff-new">
to
use.
</ins></p><p><ins class="diff-new">
If
no
</ins><a class="tref internalDFN" title="term" href="#dfn-term"><ins class="diff-new">
term
</ins></a><ins class="diff-new">
was
found
that
could
be
used
to
compact
the
</ins><a class="tref internalDFN" title="iri" href="#dfn-iri"><abbr title="Internationalized Resource Identifier"><ins class="diff-new">
IRI
</ins></abbr></a>,<ins class="diff-new">
then
</ins>
an
<del class="diff-old">array
</del>
<ins class="diff-chg">attempt
is
made
to
find
a
</ins><a class="tref internalDFN" title="compact-iri" href="#dfn-compact-iri"><ins class="diff-chg">
compact
</ins><abbr title="Internationalized Resource Identifier"><ins class="diff-chg">
IRI
</ins></abbr></a><ins class="diff-chg">
to
use.
If
there
is
no
appropriate
</ins><a class="tref internalDFN" title="compact-iri" href="#dfn-compact-iri"><ins class="diff-chg">
compact
</ins><abbr title="Internationalized Resource Identifier"><ins class="diff-chg">
IRI
</ins></abbr></a>,<ins class="diff-chg">
then,
if
the
</ins><a class="tref internalDFN" title="iri" href="#dfn-iri"><abbr title="Internationalized Resource Identifier"><ins class="diff-chg">
IRI
</ins></abbr></a><ins class="diff-chg">
is
relative
to
</ins><a class="tref internalDFN" title="active-context" href="#dfn-active-context"><ins class="diff-chg">
active
context's
</ins></a><a class="tref internalDFN" title="vocabulary-mapping" href="#dfn-vocabulary-mapping"><ins class="diff-chg">
vocabulary
mapping
</ins></a>,<ins class="diff-chg">
then
it
is
used.
Otherwise,
it
is
transformed
to
a
</ins><a class="tref internalDFN" title="relative-iri" href="#dfn-relative-iri"><ins class="diff-chg">
relative
</ins><abbr title="Internationalized Resource Identifier"><ins class="diff-chg">
IRI
</ins></abbr></a><ins class="diff-chg">
using
the
document's
</ins><a class="tref internalDFN" title="base-iri" href="#dfn-base-iri"><ins class="diff-chg">
base
</ins><abbr title="Internationalized Resource Identifier"><ins class="diff-chg">
IRI
</ins></abbr>
</a>.
<del class="diff-old">Perform
</del>
<ins class="diff-chg">Finally,
if
the
</ins><a class="tref internalDFN" title="iri" href="#dfn-iri">
<abbr title="Internationalized Resource Identifier">
IRI
</abbr>
<del class="diff-old">Compaction
</del>
</a>
<ins class="diff-chg">or
</ins><a class="tref internalDFN" title="keyword" href="#dfn-keyword"><ins class="diff-chg">
keyword
</ins>
</a>
<ins class="diff-new">still
could
not
be
compacted,
it
is
returned
as
is.
</ins></p></section><section><h4 id="algorithm-7"><ins class="diff-new">
Algorithm
</ins></h4><p><ins class="diff-new">
This
algorithm
takes
three
required
inputs
and
three
optional
inputs.
The
required
inputs
an
</ins><a class="tref internalDFN" title="active-context" href="#dfn-active-context"><ins class="diff-new">
active
context
</ins></a>,<ins class="diff-new">
an
</ins><a class="tref internalDFN" title="inverse-context" href="#dfn-inverse-context"><ins class="diff-new">
inverse
context
</ins></a>,<ins class="diff-new">
and
the
</ins><i><ins class="diff-new">
iri
</ins></i><ins class="diff-new">
to
be
compacted.
The
optional
inputs
are
a
</ins><i><ins class="diff-new">
value
</ins></i><ins class="diff-new">
associated
with
the
</ins><i><ins class="diff-new">
iri
</ins></i>,<ins class="diff-new">
a
</ins><i><ins class="diff-new">
vocabRelative
</ins></i><ins class="diff-new">
flag
which
specifies
whether
the
passed
</ins><i><ins class="diff-new">
iri
</ins></i><ins class="diff-new">
should
be
compacted
using
the
</ins><a class="tref internalDFN" title="active-context" href="#dfn-active-context"><ins class="diff-new">
active
context's
</ins></a><a class="tref internalDFN" title="vocabulary-mapping" href="#dfn-vocabulary-mapping"><ins class="diff-new">
vocabulary
mapping
</ins></a>,<ins class="diff-new">
and
a
</ins><i><ins class="diff-new">
reverse
</ins></i><ins class="diff-new">
flag
which
specifies
whether
a
</ins><a class="tref internalDFN" title="reverse-property" href="#dfn-reverse-property"><ins class="diff-new">
reverse
property
</ins></a><ins class="diff-new">
is
being
compacted.
If
not
passed,
</ins><i><ins class="diff-new">
value
</ins></i><ins class="diff-new">
is
set
to
</ins><a class="tref internalDFN" title="null" href="#dfn-null"><ins class="diff-new">
null
</ins></a><ins class="diff-new">
and
</ins><i><ins class="diff-new">
vocabRelative
</ins></i><ins class="diff-new">
and
</ins><i><ins class="diff-new">
reverse
</ins></i><ins class="diff-new">
are
both
set
to
</ins><code><ins class="diff-new">
false
</ins></code>.</p><ol class="algorithm"><li><ins class="diff-new">
If
</ins><i><ins class="diff-new">
iri
</ins></i><ins class="diff-new">
is
</ins><a class="tref internalDFN" title="null" href="#dfn-null"><ins class="diff-new">
null
</ins></a>,<ins class="diff-new">
return
</ins><a class="tref internalDFN" title="null" href="#dfn-null"><ins class="diff-new">
null
</ins></a>.</li><li><ins class="diff-new">
If
</ins><i><ins class="diff-new">
vocabRelative
</ins></i><ins class="diff-new">
is
</ins><a class="tref internalDFN" title="true" href="#dfn-true"><ins class="diff-new">
true
</ins></a><ins class="diff-new">
and
</ins><i><ins class="diff-new">
iri
</ins></i><ins class="diff-new">
is
a
key
in
</ins><a class="tref internalDFN" title="inverse-context" href="#dfn-inverse-context"><ins class="diff-new">
inverse
context
</ins></a>:<ol class="algorithm"><li><ins class="diff-new">
Initialize
</ins><i><ins class="diff-new">
defaultLanguage
</ins></i><ins class="diff-new">
to
</ins><a class="tref internalDFN" title="active-context" href="#dfn-active-context"><ins class="diff-new">
active
context's
</ins></a><a class="tref internalDFN" title="default-language" href="#dfn-default-language"><ins class="diff-new">
default
language
</ins></a>,<ins class="diff-new">
if
it
has
one,
otherwise
to
</ins><code><ins class="diff-new">
@none
</ins></code>.</li><li><ins class="diff-new">
Initialize
</ins><i><ins class="diff-new">
containers
</ins></i><ins class="diff-new">
to
an
empty
</ins><a class="tref internalDFN" title="array" href="#dfn-array"><ins class="diff-new">
array
</ins></a>.<ins class="diff-new">
This
</ins><a class="tref internalDFN" title="array" href="#dfn-array"><ins class="diff-new">
array
</ins></a><ins class="diff-new">
will
be
used
to
keep
track
of
an
ordered
list
of
preferred
</ins><a class="tref internalDFN" title="container-mapping" href="#dfn-container-mapping"><ins class="diff-new">
container
mappings
</ins></a><ins class="diff-new">
for
a
</ins><a class="tref internalDFN" title="term" href="#dfn-term"><ins class="diff-new">
term
</ins></a>,<ins class="diff-new">
based
</ins>
on
<del class="diff-old">every
entry
</del>
<ins class="diff-chg">what
is
compatible
with
</ins><i><ins class="diff-chg">
value
</ins></i>.</li><li><ins class="diff-chg">
Initialize
</ins><i><ins class="diff-chg">
typeOrLanguage
</ins></i><ins class="diff-chg">
to
</ins><code><ins class="diff-chg">
@language
</ins></code>,<ins class="diff-chg">
and
</ins><i><ins class="diff-chg">
typeOrLanguageValue
</ins></i><ins class="diff-chg">
to
</ins><code><ins class="diff-chg">
@null
</ins></code>.<ins class="diff-chg">
These
two
variables
will
keep
track
</ins>
of
<ins class="diff-chg">the
preferred
</ins><a class="tref internalDFN" title="type-mapping" href="#dfn-type-mapping"><ins class="diff-chg">
type
mapping
</ins></a><ins class="diff-chg">
or
</ins><a class="tref internalDFN" title="language-mapping" href="#dfn-language-mapping"><ins class="diff-chg">
language
mapping
</ins></a><ins class="diff-chg">
for
a
</ins><a class="tref internalDFN" title="term" href="#dfn-term"><ins class="diff-chg">
term
</ins></a>,<ins class="diff-chg">
based
on
what
is
compatible
with
</ins><i>
value
<del class="diff-old">.
</del>
</i>.
</li>
<li>
If
<i>
value
</i>
<ins class="diff-chg">is
a
</ins><a class="tref internalDFN" title="json-object" href="#dfn-json-object"><ins class="diff-chg">
JSON
object
</ins></a><ins class="diff-chg">
that
</ins>
contains
<del class="diff-old">just
one
entry,
</del>
<ins class="diff-chg">the
key
</ins><code><ins class="diff-chg">
@index
</ins></code>,<ins class="diff-chg">
then
append
the
</ins>
value
<code>
<ins class="diff-chg">@index
</ins></code><ins class="diff-chg">
to
</ins><i><ins class="diff-chg">
containers
</ins></i>.</li><li><ins class="diff-chg">
If
</ins><i><ins class="diff-chg">
reverse
</ins></i><ins class="diff-chg">
is
</ins><a class="tref internalDFN" title="true" href="#dfn-true"><ins class="diff-chg">
true
</ins></a>,<ins class="diff-chg">
set
</ins><i><ins class="diff-chg">
typeOrLanguage
</ins></i><ins class="diff-chg">
to
</ins><code><ins class="diff-chg">
@type
</ins></code>,<i><ins class="diff-chg">
typeOrLanguageValue
</ins></i><ins class="diff-chg">
to
</ins><code><ins class="diff-chg">
@reverse
</ins></code>,<ins class="diff-chg">
and
append
</ins><code><ins class="diff-chg">
@set
</ins></code><ins class="diff-chg">
to
</ins><i><ins class="diff-chg">
containers
</ins></i>.</li><li><ins class="diff-chg">
Otherwise,
if
</ins><i><ins class="diff-chg">
value
</ins></i>
is
<ins class="diff-new">a
</ins><a class="tref internalDFN" title="list-object" href="#dfn-list-object"><ins class="diff-new">
list
object
</ins></a>,<ins class="diff-new">
then
</ins>
set
<i>
<ins class="diff-new">typeOrLanguage
</ins></i><ins class="diff-new">
and
</ins><i><ins class="diff-new">
typeOrLanguageValue
</ins></i>
to
<ins class="diff-new">the
most
specific
values
</ins>
that
<del class="diff-old">entry.
</del>
<ins class="diff-chg">work
for
all
items
in
the
list
as
follows:
</ins><ol class="algorithm"><li><ins class="diff-chg">
If
</ins><code><ins class="diff-chg">
@index
</ins></code><ins class="diff-chg">
is
a
not
key
in
</ins><i><ins class="diff-chg">
value
</ins></i>,<ins class="diff-chg">
then
append
</ins><code><ins class="diff-chg">
@list
</ins></code><ins class="diff-chg">
to
</ins><i><ins class="diff-chg">
containers
</ins></i>.
</li>
<li>
<del class="diff-old">Add
active
property
</del>
<ins class="diff-chg">Initialize
</ins><i><ins class="diff-chg">
list
</ins></i><ins class="diff-chg">
to
the
</ins><a class="tref internalDFN" title="array" href="#dfn-array"><ins class="diff-chg">
array
</ins>
</a>
<ins class="diff-new">associated
with
the
key
</ins><code><ins class="diff-new">
@list
</ins></code><ins class="diff-new">
in
</ins><i><ins class="diff-new">
value
</ins></i>.</li><li><ins class="diff-new">
Initialize
</ins><i><ins class="diff-new">
commonLanguage
</ins></i><ins class="diff-new">
to
</ins><a class="tref internalDFN" title="null" href="#dfn-null"><ins class="diff-new">
null
</ins></a>.<ins class="diff-new">
If
</ins><i><ins class="diff-new">
list
</ins></i><ins class="diff-new">
is
empty,
set
</ins><i><ins class="diff-new">
commonLanguage
</ins></i><ins class="diff-new">
to
</ins><i><ins class="diff-new">
defaultLanguage
</ins></i>.</li><li><ins class="diff-new">
For
each
</ins><i><ins class="diff-new">
item
</ins></i><ins class="diff-new">
in
</ins><i><ins class="diff-new">
list
</ins></i>:<ol class="algorithm"><li><ins class="diff-new">
Initialize
</ins><i><ins class="diff-new">
itemLanguage
</ins></i><ins class="diff-new">
to
</ins><code><ins class="diff-new">
@none
</ins></code>
and
<i>
<ins class="diff-new">itemType
</ins></i><ins class="diff-new">
to
</ins><code><ins class="diff-new">
@none
</ins></code>.</li><li><ins class="diff-new">
If
</ins><i><ins class="diff-new">
item
</ins></i><ins class="diff-new">
contains
</ins>
the
<del class="diff-old">expanded
</del>
<ins class="diff-chg">key
</ins><code><ins class="diff-chg">
@value
</ins></code>:<ol class="algorithm"><li><ins class="diff-chg">
If
</ins><i><ins class="diff-chg">
item
</ins></i><ins class="diff-chg">
contains
the
key
</ins><code><ins class="diff-chg">
@language
</ins></code>,<ins class="diff-chg">
then
set
</ins><i><ins class="diff-chg">
itemLanguage
</ins></i><ins class="diff-chg">
to
its
associated
value.
</ins></li><li><ins class="diff-chg">
Otherwise,
if
</ins><i><ins class="diff-chg">
item
</ins></i><ins class="diff-chg">
contains
the
key
</ins><code><ins class="diff-chg">
@type
</ins></code>,<ins class="diff-chg">
set
</ins><i><ins class="diff-chg">
itemType
</ins></i><ins class="diff-chg">
to
its
associated
value.
</ins></li><li><ins class="diff-chg">
Otherwise,
set
</ins><i><ins class="diff-chg">
itemLanguage
</ins></i><ins class="diff-chg">
to
</ins><code><ins class="diff-chg">
@null
</ins></code>.</li></ol></li><li><ins class="diff-chg">
Otherwise,
set
</ins><i><ins class="diff-chg">
itemType
</ins></i><ins class="diff-chg">
to
</ins><code><ins class="diff-chg">
@id
</ins></code>.</li><li><ins class="diff-chg">
If
</ins><i><ins class="diff-chg">
commonLanguage
</ins></i><ins class="diff-chg">
is
</ins><a class="tref internalDFN" title="null" href="#dfn-null"><ins class="diff-chg">
null
</ins></a>,<ins class="diff-chg">
set
it
to
</ins><i><ins class="diff-chg">
itemLanguage
</ins></i>.</li><li><ins class="diff-chg">
Otherwise,
if
</ins><i><ins class="diff-chg">
itemLanguage
</ins></i><ins class="diff-chg">
does
not
equal
</ins><i><ins class="diff-chg">
commonLanguage
</ins></i><ins class="diff-chg">
and
</ins><i><ins class="diff-chg">
item
</ins></i><ins class="diff-chg">
contains
the
key
</ins><code><ins class="diff-chg">
@value
</ins></code>,<ins class="diff-chg">
then
set
</ins><i><ins class="diff-chg">
commonLanguage
</ins></i><ins class="diff-chg">
to
</ins><code><ins class="diff-chg">
@none
</ins></code><ins class="diff-chg">
because
list
items
have
conflicting
languages.
</ins></li><li><ins class="diff-chg">
If
</ins><i><ins class="diff-chg">
commonType
</ins></i><ins class="diff-chg">
is
</ins><a class="tref internalDFN" title="null" href="#dfn-null"><ins class="diff-chg">
null
</ins></a>,<ins class="diff-chg">
set
it
to
</ins><i><ins class="diff-chg">
itemType
</ins></i>.</li><li><ins class="diff-chg">
Otherwise,
if
</ins><i><ins class="diff-chg">
itemType
</ins></i><ins class="diff-chg">
does
not
equal
</ins><i><ins class="diff-chg">
commonType
</ins></i>,<ins class="diff-chg">
then
set
</ins><i><ins class="diff-chg">
commonType
</ins></i><ins class="diff-chg">
to
</ins><code><ins class="diff-chg">
@none
</ins></code><ins class="diff-chg">
because
list
items
have
conflicting
types.
</ins></li><li><ins class="diff-chg">
If
</ins><i><ins class="diff-chg">
commonLanguage
</ins></i><ins class="diff-chg">
is
</ins><code><ins class="diff-chg">
@none
</ins></code><ins class="diff-chg">
and
</ins><i><ins class="diff-chg">
commonType
</ins></i><ins class="diff-chg">
is
</ins><code><ins class="diff-chg">
@none
</ins></code>,<ins class="diff-chg">
then
stop
processing
items
in
the
list
because
it
has
been
detected
that
there
is
no
common
language
or
type
amongst
the
items.
</ins></li></ol></li><li><ins class="diff-chg">
If
</ins><i><ins class="diff-chg">
commonLanguage
</ins></i><ins class="diff-chg">
is
</ins><a class="tref internalDFN" title="null" href="#dfn-null"><ins class="diff-chg">
null
</ins></a>,<ins class="diff-chg">
set
it
to
</ins><code><ins class="diff-chg">
@none
</ins></code>.</li><li><ins class="diff-chg">
If
</ins><i><ins class="diff-chg">
commonType
</ins></i><ins class="diff-chg">
is
</ins><a class="tref internalDFN" title="null" href="#dfn-null"><ins class="diff-chg">
null
</ins></a>,<ins class="diff-chg">
set
it
to
</ins><code><ins class="diff-chg">
@none
</ins></code>.</li><li><ins class="diff-chg">
If
</ins><i><ins class="diff-chg">
commonType
</ins></i><ins class="diff-chg">
is
not
</ins><code><ins class="diff-chg">
@none
</ins></code><ins class="diff-chg">
then
set
</ins><i><ins class="diff-chg">
typeOrLanguage
</ins></i><ins class="diff-chg">
to
</ins><code><ins class="diff-chg">
@type
</ins></code><ins class="diff-chg">
and
</ins><i><ins class="diff-chg">
typeOrLanguageValue
</ins></i><ins class="diff-chg">
to
</ins><i><ins class="diff-chg">
commonType
</ins></i>.</li><li><ins class="diff-chg">
Otherwise,
set
</ins><i><ins class="diff-chg">
typeOrLanguageValue
</ins></i><ins class="diff-chg">
to
</ins><i><ins class="diff-chg">
commonLanguage
</ins></i>.</li></ol></li><li><ins class="diff-chg">
Otherwise:
</ins><ol class="algorithm"><li><ins class="diff-chg">
If
</ins><i>
value
</i>
<ins class="diff-chg">is
a
</ins><a class="tref internalDFN" title="value-object" href="#dfn-value-object"><ins class="diff-chg">
value
object
</ins></a>:<ol class="algorithm"><li><ins class="diff-chg">
If
</ins><i><ins class="diff-chg">
value
</ins></i><ins class="diff-chg">
contains
the
key
</ins><code><ins class="diff-chg">
@language
</ins></code><ins class="diff-chg">
and
does
not
contain
the
key
</ins><code><ins class="diff-chg">
@index
</ins></code>,<ins class="diff-chg">
then
set
</ins><i><ins class="diff-chg">
typeOrLanguageValue
</ins></i>
to
<del class="diff-old">output
.
</del>
<ins class="diff-chg">its
associated
value
and
append
</ins><code><ins class="diff-chg">
@language
</ins></code><ins class="diff-chg">
to
</ins><i><ins class="diff-chg">
containers
</ins></i>.</li><li><ins class="diff-chg">
Otherwise,
if
</ins><i><ins class="diff-chg">
value
</ins></i><ins class="diff-chg">
contains
the
key
</ins><code><ins class="diff-chg">
@type
</ins></code>,<ins class="diff-chg">
then
set
</ins><i><ins class="diff-chg">
typeOrLanguageValue
</ins></i><ins class="diff-chg">
to
its
associated
value
and
set
</ins><i><ins class="diff-chg">
typeOrLanguage
</ins></i><ins class="diff-chg">
to
</ins><code><ins class="diff-chg">
@type
</ins></code>.
</li>
</ol>
</li>
<li>
Otherwise,
<ins class="diff-chg">set
</ins><i><ins class="diff-chg">
typeOrLanguage
</ins></i><ins class="diff-chg">
to
</ins><code><ins class="diff-chg">
@type
</ins></code><ins class="diff-chg">
and
set
</ins><i><ins class="diff-chg">
typeOrLanguageValue
</ins></i><ins class="diff-chg">
to
</ins><code><ins class="diff-chg">
@id
</ins></code>.</li><li><ins class="diff-chg">
Append
</ins><code><ins class="diff-chg">
@set
</ins></code><ins class="diff-chg">
to
</ins><i><ins class="diff-chg">
containers
</ins></i>.</li></ol></li><li><ins class="diff-chg">
Append
</ins><code><ins class="diff-chg">
@none
</ins></code><ins class="diff-chg">
to
</ins><i><ins class="diff-chg">
containers
</ins></i>.<ins class="diff-chg">
This
represents
the
non-existence
of
a
</ins><a class="tref internalDFN" title="container-mapping" href="#dfn-container-mapping"><ins class="diff-chg">
container
mapping
</ins></a>,<ins class="diff-chg">
and
it
will
be
the
last
</ins><a class="tref internalDFN" title="container-mapping" href="#dfn-container-mapping"><ins class="diff-chg">
container
mapping
</ins></a>
value
<del class="diff-old">must
</del>
<ins class="diff-chg">to
</ins>
be
<ins class="diff-new">checked
as
it
is
the
most
generic.
</ins></li><li><ins class="diff-new">
If
</ins><i><ins class="diff-new">
typeOrLanguageValue
</ins></i><ins class="diff-new">
is
</ins><a class="tref internalDFN" title="null" href="#dfn-null"><ins class="diff-new">
null
</ins></a>,<ins class="diff-new">
set
it
to
</ins><code><ins class="diff-new">
@null
</ins></code>.<ins class="diff-new">
This
is
the
key
under
which
</ins><a class="tref internalDFN" title="null" href="#dfn-null"><ins class="diff-new">
null
</ins></a><ins class="diff-new">
values
are
stored
in
the
</ins><a class="tref internalDFN" title="inverse-context" href="#dfn-inverse-context"><ins class="diff-new">
inverse
context
</ins></a><i><ins class="diff-new">
entry
</ins></i>.</li><li><ins class="diff-new">
Initialize
</ins><i><ins class="diff-new">
preferred
values
</ins></i><ins class="diff-new">
to
</ins>
an
<ins class="diff-new">empty
</ins>
<a class="tref internalDFN" title="array" href="#dfn-array">
array
</a>.
<ins class="diff-new">This
</ins><a class="tref internalDFN" title="array" href="#dfn-array"><ins class="diff-new">
array
</ins></a><ins class="diff-new">
will
indicate,
in
order,
the
preferred
values
for
a
</ins><a class="tref internalDFN" title="term" href="#dfn-term"><ins class="diff-new">
term's
</ins></a><a class="tref internalDFN" title="type-mapping" href="#dfn-type-mapping"><ins class="diff-new">
type
mapping
</ins></a><ins class="diff-new">
or
</ins><a class="tref internalDFN" title="language-mapping" href="#dfn-language-mapping"><ins class="diff-new">
language
mapping
</ins></a>.
</li>
<li>
If
<del class="diff-old">value
</del>
<i>
<ins class="diff-chg">typeOrLanguageValue
</ins></i>
is
<del class="diff-old">empty:
</del>
<code>
<ins class="diff-chg">@reverse
</ins></code>,<ins class="diff-chg">
append
</ins><code><ins class="diff-chg">
@reverse
</ins></code><ins class="diff-chg">
to
</ins><i><ins class="diff-chg">
preferred
values
</ins></i>.</li><li><ins class="diff-chg">
If
</ins><i><ins class="diff-chg">
typeOrLanguageValue
</ins></i><ins class="diff-chg">
is
</ins><code><ins class="diff-chg">
@id
</ins></code><ins class="diff-chg">
or
</ins><code><ins class="diff-chg">
@reverse
</ins></code><ins class="diff-chg">
and
</ins><i><ins class="diff-chg">
value
</ins></i><ins class="diff-chg">
has
an
</ins><code><ins class="diff-chg">
@id
</ins></code><ins class="diff-chg">
member:
</ins>
<ol class="algorithm">
<li>
<del class="diff-old">Set
active
property
to
</del>
<ins class="diff-chg">If
</ins>
the
result
of
<del class="diff-old">performing
</del>
<ins class="diff-chg">using
the
</ins>
<a href="#iri-compaction">
<abbr title="Internationalized Resource Identifier">
IRI
</abbr>
<del class="diff-old">Compaction
on
property
.
Create
an
entry
</del>
<ins class="diff-chg">compaction
algorithm
</ins></a>,<ins class="diff-chg">
passing
</ins><a class="tref internalDFN" title="active-context" href="#dfn-active-context"><ins class="diff-chg">
active
context
</ins></a>,<a class="tref internalDFN" title="inverse-context" href="#dfn-inverse-context"><ins class="diff-chg">
inverse
context
</ins></a>,<ins class="diff-chg">
the
value
associated
with
the
</ins><code><ins class="diff-chg">
@id
</ins></code><ins class="diff-chg">
key
</ins>
in
<del class="diff-old">output
</del>
<i>
<ins class="diff-chg">value
</ins></i>
for
<del class="diff-old">active
property
</del>
<i>
<ins class="diff-chg">iri
</ins></i>,<a class="tref internalDFN" title="true" href="#dfn-true"><ins class="diff-chg">
true
</ins>
</a>
<ins class="diff-new">for
</ins><i><ins class="diff-new">
vocabRelative
</ins></i>,
and
<a class="tref internalDFN" title="true" href="#dfn-true">
<ins class="diff-chg">true
</ins></a><ins class="diff-chg">
for
</ins><i><ins class="diff-chg">
documentRelative
</ins></i><ins class="diff-chg">
has
a
</ins><a class="tref internalDFN" title="term-definition" href="#dfn-term-definition"><ins class="diff-chg">
term
definition
</ins></a><ins class="diff-chg">
in
the
</ins><a class="tref internalDFN" title="active-context" href="#dfn-active-context"><ins class="diff-chg">
active
context
</ins></a><ins class="diff-chg">
with
an
</ins><a class="tref internalDFN" title="iri-mapping" href="#dfn-iri-mapping"><abbr title="Internationalized Resource Identifier"><ins class="diff-chg">
IRI
</ins></abbr><ins class="diff-chg">
mapping
</ins></a><ins class="diff-chg">
that
equals
the
</ins>
value
<del class="diff-old">.
</del>
<ins class="diff-chg">associated
with
the
</ins><code><ins class="diff-chg">
@id
</ins></code><ins class="diff-chg">
key
in
</ins><i><ins class="diff-chg">
value
</ins></i>,<ins class="diff-chg">
then
append
</ins><code><ins class="diff-chg">
@vocab
</ins></code>,<code><ins class="diff-chg">
@id
</ins></code>,<ins class="diff-chg">
and
</ins><code><ins class="diff-chg">
@none
</ins></code>,<ins class="diff-chg">
in
that
order,
to
</ins><i><ins class="diff-chg">
preferred
values
</ins></i>.</li><li><ins class="diff-chg">
Otherwise,
append
</ins><code><ins class="diff-chg">
@id
</ins></code>,<code><ins class="diff-chg">
@vocab
</ins></code>,<ins class="diff-chg">
and
</ins><code><ins class="diff-chg">
@none
</ins></code>,<ins class="diff-chg">
in
that
order,
to
</ins><i><ins class="diff-chg">
preferred
values
</ins></i>.
</li>
</ol>
</li>
<li>
<del class="diff-old">For
each
item
</del>
<ins class="diff-chg">Otherwise,
append
</ins><i><ins class="diff-chg">
typeOrLanguageValue
</ins></i><ins class="diff-chg">
and
</ins><code><ins class="diff-chg">
@none
</ins></code>,
in
<del class="diff-old">value
:
</del>
<ins class="diff-chg">that
order,
to
</ins><i><ins class="diff-chg">
preferred
values
</ins></i>.</li>
<li>
<del class="diff-old">Set
active
property
</del>
<ins class="diff-chg">Initialize
</ins><i><ins class="diff-chg">
term
</ins></i>
to
the
result
of
<del class="diff-old">performing
</del>
<ins class="diff-chg">the
</ins><a href="#term-selection"><ins class="diff-chg">
Term
Selection
algorithm
</ins></a>,<ins class="diff-chg">
passing
</ins><a class="tref internalDFN" title="inverse-context" href="#dfn-inverse-context"><ins class="diff-chg">
inverse
context
</ins></a>,<i><ins class="diff-chg">
iri
</ins></i>,<i><ins class="diff-chg">
containers
</ins></i>,<i><ins class="diff-chg">
typeOrLanguage
</ins></i>,<ins class="diff-chg">
and
</ins><i><ins class="diff-chg">
preferred
values
</ins></i>.</li><li><ins class="diff-chg">
If
</ins><i><ins class="diff-chg">
term
</ins></i><ins class="diff-chg">
is
not
</ins><a class="tref internalDFN" title="null" href="#dfn-null"><ins class="diff-chg">
null
</ins></a>,<ins class="diff-chg">
return
</ins><i><ins class="diff-chg">
term
</ins></i>.</li></ol></li><li><ins class="diff-chg">
At
this
point,
there
is
no
simple
</ins><a class="tref internalDFN" title="term" href="#dfn-term"><ins class="diff-chg">
term
</ins></a><ins class="diff-chg">
that
</ins><i><ins class="diff-chg">
iri
</ins></i><ins class="diff-chg">
can
be
compacted
to.
Instead,
try
to
create
a
</ins><a class="tref internalDFN" title="compact-iri" href="#dfn-compact-iri"><ins class="diff-chg">
compact
</ins><abbr title="Internationalized Resource Identifier"><ins class="diff-chg">
IRI
</ins></abbr>
</a>,
<ins class="diff-new">starting
by
initializing
</ins><i><ins class="diff-new">
compact
</ins>
<abbr title="Internationalized Resource Identifier">
IRI
</abbr>
<del class="diff-old">Compaction
</del>
</i>
<ins class="diff-chg">to
</ins><a class="tref internalDFN" title="null" href="#dfn-null"><ins class="diff-chg">
null
</ins></a>.<ins class="diff-chg">
This
variable
will
be
used
to
store
the
created
</ins><a class="tref internalDFN" title="compact-iri" href="#dfn-compact-iri"><ins class="diff-chg">
compact
</ins><abbr title="Internationalized Resource Identifier"><ins class="diff-chg">
IRI
</ins></abbr></a>,<ins class="diff-chg">
if
any.
</ins></li><li><ins class="diff-chg">
For
each
key
</ins><a class="tref internalDFN" title="term" href="#dfn-term"><ins class="diff-chg">
term
</ins>
</a>
<del class="diff-old">for
property
</del>
and
<del class="diff-old">item
using
</del>
<ins class="diff-chg">value
</ins><a class="tref internalDFN" title="term-definition" href="#dfn-term-definition"><ins class="diff-chg">
term
definition
</ins></a><ins class="diff-chg">
in
</ins>
the
<a class="tref internalDFN" title="active-context" href="#dfn-active-context">
active
context
</a>:
<ol class="algorithm">
<li>
<ins class="diff-new">If
the
</ins><a class="tref internalDFN" title="term" href="#dfn-term"><ins class="diff-new">
term
</ins></a><ins class="diff-new">
contains
a
colon
(
</ins><code>:</code><ins class="diff-new">
),
then
continue
to
the
next
</ins><a class="tref internalDFN" title="term" href="#dfn-term"><ins class="diff-new">
term
</ins></a><ins class="diff-new">
because
</ins><a class="tref internalDFN" title="term" href="#dfn-term"><ins class="diff-new">
terms
</ins></a><ins class="diff-new">
with
colons
can't
be
used
as
</ins><a class="tref internalDFN" title="prefix" href="#dfn-prefix"><ins class="diff-new">
prefixes
</ins>
</a>.
</li>
<li>
<del class="diff-old">Compact
item
by
recursively
performing
this
algorithm
passing
</del>
<ins class="diff-chg">If
the
</ins><a class="tref internalDFN" title="term-definition" href="#dfn-term-definition"><ins class="diff-chg">
term
definition
</ins></a><ins class="diff-chg">
is
</ins><a class="tref internalDFN" title="null" href="#dfn-null"><ins class="diff-chg">
null
</ins></a>,<ins class="diff-chg">
its
</ins><a class="tref internalDFN" title="iri-mapping" href="#dfn-iri-mapping"><abbr title="Internationalized Resource Identifier"><ins class="diff-chg">
IRI
</ins></abbr><ins class="diff-chg">
mapping
</ins></a><ins class="diff-chg">
equals
</ins><i><ins class="diff-chg">
iri
</ins></i>,<ins class="diff-chg">
or
its
</ins><a class="tref internalDFN" title="iri-mapping" href="#dfn-iri-mapping"><abbr title="Internationalized Resource Identifier"><ins class="diff-chg">
IRI
</ins></abbr><ins class="diff-chg">
mapping
</ins></a><ins class="diff-chg">
is
not
</ins>
a
<del class="diff-old">copy
</del>
<ins class="diff-chg">substring
at
the
beginning
</ins>
of
<i>
<ins class="diff-new">iri
</ins></i>,
the
<del class="diff-old">active
context
</del>
<a class="tref internalDFN" title="term" href="#dfn-term">
<ins class="diff-chg">term
</ins>
</a>
<ins class="diff-new">cannot
be
used
as
a
</ins><a class="tref internalDFN" title="prefix" href="#dfn-prefix"><ins class="diff-new">
prefix
</ins></a><ins class="diff-new">
because
it
is
not
a
partial
match
with
</ins><i><ins class="diff-new">
iri
</ins></i>.<ins class="diff-new">
Continue
with
the
next
</ins><a class="tref internalDFN" title="term" href="#dfn-term"><ins class="diff-new">
term
</ins></a>.</li><li><ins class="diff-new">
Initialize
</ins><i><ins class="diff-new">
candidate
</ins></i><ins class="diff-new">
by
concatenating
</ins><a class="tref internalDFN" title="term" href="#dfn-term"><ins class="diff-new">
term
</ins></a>,<ins class="diff-new">
a
colon
(
</ins><code>:</code><ins class="diff-new">
),
</ins>
and
the
<del class="diff-old">active
property
</del>
<ins class="diff-chg">substring
of
</ins><i><ins class="diff-chg">
iri
</ins></i><ins class="diff-chg">
that
follows
after
the
value
of
the
</ins><a class="tref internalDFN" title="term-definition" href="#dfn-term-definition"><ins class="diff-chg">
term
definition's
</ins></a><a class="tref internalDFN" title="iri-mapping" href="#dfn-iri-mapping"><abbr title="Internationalized Resource Identifier"><ins class="diff-chg">
IRI
</ins></abbr><ins class="diff-chg">
mapping
</ins>
</a>.
</li>
<li>
If
<del class="diff-old">an
entry
already
exists
</del>
<ins class="diff-chg">either
</ins><i><ins class="diff-chg">
compact
</ins><abbr title="Internationalized Resource Identifier"><ins class="diff-chg">
IRI
</ins></abbr></i><ins class="diff-chg">
is
</ins><a class="tref internalDFN" title="null" href="#dfn-null"><ins class="diff-chg">
null
</ins></a><ins class="diff-chg">
or
</ins><i><ins class="diff-chg">
candidate
</ins></i><ins class="diff-chg">
is
shorter
or
the
same
length
but
lexicographically
less
than
</ins><i><ins class="diff-chg">
compact
</ins><abbr title="Internationalized Resource Identifier"><ins class="diff-chg">
IRI
</ins></abbr></i><ins class="diff-chg">
and
</ins><i><ins class="diff-chg">
candidate
</ins></i><ins class="diff-chg">
does
not
have
a
</ins><a class="tref internalDFN" title="term-definition" href="#dfn-term-definition"><ins class="diff-chg">
term
definition
</ins></a>
in
<del class="diff-old">output
for
</del>
<a class="tref internalDFN" title="active-context" href="#dfn-active-context">
active
<del class="diff-old">property
,
convert
it
to
an
array
</del>
<ins class="diff-chg">context
</ins>
</a>
<ins class="diff-new">or
</ins>
if
<del class="diff-old">necessary,
and
append
</del>
the
<del class="diff-old">compacted
</del>
<a class="tref internalDFN" title="term-definition" href="#dfn-term-definition">
<ins class="diff-chg">term
definition
</ins></a><ins class="diff-chg">
has
an
</ins><a class="tref internalDFN" title="iri-mapping" href="#dfn-iri-mapping"><abbr title="Internationalized Resource Identifier"><ins class="diff-chg">
IRI
</ins></abbr><ins class="diff-chg">
mapping
</ins></a><ins class="diff-chg">
that
equals
</ins><i><ins class="diff-chg">
iri
</ins></i><ins class="diff-chg">
and
</ins><i>
value
<del class="diff-old">.
</del>
</i>
<ins class="diff-chg">is
</ins><a class="tref internalDFN" title="null" href="#dfn-null"><ins class="diff-chg">
null
</ins></a>,<ins class="diff-chg">
set
</ins><i><ins class="diff-chg">
compact
</ins><abbr title="Internationalized Resource Identifier"><ins class="diff-chg">
IRI
</ins></abbr></i><ins class="diff-chg">
to
</ins><i><ins class="diff-chg">
candidate
</ins></i>.</li></ol>
</li>
<li>
<del class="diff-old">Otherwise,
</del>
<ins class="diff-chg">If
</ins><i><ins class="diff-chg">
compact
</ins><abbr title="Internationalized Resource Identifier"><ins class="diff-chg">
IRI
</ins></abbr></i><ins class="diff-chg">
is
not
</ins><a class="tref internalDFN" title="null" href="#dfn-null"><ins class="diff-chg">
null
</ins></a>,<ins class="diff-chg">
return
</ins><i><ins class="diff-chg">
compact
</ins><abbr title="Internationalized Resource Identifier"><ins class="diff-chg">
IRI
</ins></abbr></i>.</li><li><ins class="diff-chg">
At
this
point,
there
is
no
</ins><a class="tref internalDFN" title="compact-iri" href="#dfn-compact-iri"><ins class="diff-chg">
compact
</ins><abbr title="Internationalized Resource Identifier"><ins class="diff-chg">
IRI
</ins></abbr></a><ins class="diff-chg">
that
</ins><i><ins class="diff-chg">
iri
</ins></i><ins class="diff-chg">
can
be
compacted
to,
so
</ins>
if
<i>
<ins class="diff-new">vocabRelative
</ins></i><ins class="diff-new">
is
</ins><a class="tref internalDFN" title="true" href="#dfn-true"><ins class="diff-new">
true
</ins></a><ins class="diff-new">
and
</ins><a class="tref internalDFN" title="active-context" href="#dfn-active-context"><ins class="diff-new">
active
context
</ins></a><ins class="diff-new">
has
a
</ins><a class="tref internalDFN" title="vocabulary-mapping" href="#dfn-vocabulary-mapping"><ins class="diff-new">
vocabulary
mapping
</ins></a>:<ol class="algorithm"><li><ins class="diff-new">
If
</ins><i><ins class="diff-new">
iri
</ins></i><ins class="diff-new">
begins
with
</ins>
the
<del class="diff-old">compacted
</del>
<a class="tref internalDFN" title="vocabulary-mapping" href="#dfn-vocabulary-mapping">
<ins class="diff-chg">vocabulary
mapping's
</ins></a>
value
<ins class="diff-chg">but
</ins>
is
<ins class="diff-new">longer,
then
initialize
</ins><i><ins class="diff-new">
suffix
</ins></i><ins class="diff-new">
to
the
substring
of
</ins><i><ins class="diff-new">
iri
</ins></i><ins class="diff-new">
that
does
</ins>
not
<ins class="diff-new">match.
If
</ins><i><ins class="diff-new">
suffix
</ins></i><ins class="diff-new">
does
not
have
a
</ins><a class="tref internalDFN" title="term-definition" href="#dfn-term-definition"><ins class="diff-new">
term
definition
</ins></a><ins class="diff-new">
in
</ins><a class="tref internalDFN" title="active-context" href="#dfn-active-context"><ins class="diff-new">
active
context
</ins></a>,<ins class="diff-new">
then
return
</ins><i><ins class="diff-new">
suffix
</ins></i>.</li></ol></li><li><ins class="diff-new">
If
</ins><i><ins class="diff-new">
vocabRelative
</ins></i><ins class="diff-new">
is
</ins><a class="tref internalDFN" title="false" href="#dfn-false"><ins class="diff-new">
false
</ins></a><ins class="diff-new">
then
transform
</ins><i><ins class="diff-new">
iri
</ins></i><ins class="diff-new">
to
a
</ins><a class="tref internalDFN" title="relative-iri" href="#dfn-relative-iri"><ins class="diff-new">
relative
</ins><abbr title="Internationalized Resource Identifier"><ins class="diff-new">
IRI
</ins></abbr></a><ins class="diff-new">
using
the
document's
base
</ins><a class="tref internalDFN" title="iri" href="#dfn-iri"><abbr title="Internationalized Resource Identifier"><ins class="diff-new">
IRI
</ins></abbr></a>.</li><li><ins class="diff-new">
Finally,
return
</ins><i><ins class="diff-new">
iri
</ins></i><ins class="diff-new">
as
is.
</ins></li></ol></section></section><section id="term-selection"><h3><span class="secno"><ins class="diff-new">
8.4
</ins></span><ins class="diff-new">
Term
Selection
</ins></h3><p><ins class="diff-new">
This
algorithm,
invoked
via
the
</ins><a href="#iri-compaction"><abbr title="Internationalized Resource Identifier"><ins class="diff-new">
IRI
</ins></abbr><ins class="diff-new">
Compaction
algorithm
</ins></a>,<ins class="diff-new">
makes
use
of
</ins>
an
<del class="diff-old">array
</del>
<a class="tref internalDFN" title="active-context" href="#dfn-active-context">
<ins class="diff-chg">active
context's
</ins></a><a class="tref internalDFN" title="inverse-context" href="#dfn-inverse-context"><ins class="diff-chg">
inverse
context
</ins></a><ins class="diff-chg">
to
find
the
</ins><a class="tref internalDFN" title="term" href="#dfn-term"><ins class="diff-chg">
term
</ins></a><ins class="diff-chg">
that
is
best
used
to
</ins><a class="tref internalDFN" title="compaction" href="#dfn-compaction"><ins class="diff-chg">
compact
</ins></a><ins class="diff-chg">
an
</ins><a class="tref internalDFN" title="iri" href="#dfn-iri"><abbr title="Internationalized Resource Identifier"><ins class="diff-chg">
IRI
</ins></abbr></a>.<ins class="diff-chg">
Other
information
about
a
value
associated
with
the
</ins><a class="tref internalDFN" title="iri" href="#dfn-iri"><abbr title="Internationalized Resource Identifier"><ins class="diff-chg">
IRI
</ins></abbr></a><ins class="diff-chg">
is
given,
including
which
</ins><a class="tref internalDFN" title="container-mapping" href="#dfn-container-mapping"><ins class="diff-chg">
container
mappings
</ins>
</a>
and
<del class="diff-old">active
property
</del>
<ins class="diff-chg">which
</ins><a class="tref internalDFN" title="type-mapping" href="#dfn-type-mapping"><ins class="diff-chg">
type
mapping
</ins></a><ins class="diff-chg">
or
</ins><a class="tref internalDFN" title="language-mapping" href="#dfn-language-mapping"><ins class="diff-chg">
language
mapping
</ins></a><ins class="diff-chg">
would
be
best
used
to
express
the
value.
</ins></p><section class="informative"><h4 id="general-solution-8"><ins class="diff-chg">
General
Solution
</ins></h4><p><em><ins class="diff-chg">
This
section
is
non-normative.
</ins></em></p><p><ins class="diff-chg">
The
</ins><a class="tref internalDFN" title="inverse-context" href="#dfn-inverse-context"><ins class="diff-chg">
inverse
context's
</ins></a><ins class="diff-chg">
entry
for
the
</ins><a class="tref internalDFN" title="iri" href="#dfn-iri"><abbr title="Internationalized Resource Identifier"><ins class="diff-chg">
IRI
</ins></abbr>
</a>
<ins class="diff-new">will
be
first
searched
according
to
the
preferred
</ins><a class="tref internalDFN" title="container-mapping" href="#dfn-container-mapping"><ins class="diff-new">
container
mappings
</ins></a>,<ins class="diff-new">
in
the
order
that
they
are
given.
Amongst
</ins><a class="tref internalDFN" title="term" href="#dfn-term"><ins class="diff-new">
terms
</ins></a><ins class="diff-new">
with
a
matching
</ins><a class="tref internalDFN" title="container-mapping" href="#dfn-container-mapping"><ins class="diff-new">
container
mapping
</ins></a>,<ins class="diff-new">
preference
will
be
given
to
those
with
a
matching
</ins><a class="tref internalDFN" title="type-mapping" href="#dfn-type-mapping"><ins class="diff-new">
type
mapping
</ins></a><ins class="diff-new">
or
</ins><a class="tref internalDFN" title="language-mapping" href="#dfn-language-mapping"><ins class="diff-new">
language
mapping
</ins></a>,<ins class="diff-new">
over
those
without
a
</ins><a class="tref internalDFN" title="type-mapping" href="#dfn-type-mapping"><ins class="diff-new">
type
mapping
</ins></a><ins class="diff-new">
or
</ins><a class="tref internalDFN" title="language-mapping" href="#dfn-language-mapping"><ins class="diff-new">
language
mapping
</ins></a>.<ins class="diff-new">
If
there
is
no
</ins><a class="tref internalDFN" title="term" href="#dfn-term"><ins class="diff-new">
term
</ins></a><ins class="diff-new">
with
a
matching
</ins><a class="tref internalDFN" title="container-mapping" href="#dfn-container-mapping"><ins class="diff-new">
container
mapping
</ins></a><ins class="diff-new">
then
the
</ins><a class="tref internalDFN" title="term" href="#dfn-term"><ins class="diff-new">
term
</ins></a><ins class="diff-new">
without
a
</ins><a class="tref internalDFN" title="container-mapping" href="#dfn-container-mapping"><ins class="diff-new">
container
mapping
</ins></a><ins class="diff-new">
that
matches
the
given
</ins><a class="tref internalDFN" title="type-mapping" href="#dfn-type-mapping"><ins class="diff-new">
type
mapping
</ins></a><ins class="diff-new">
or
</ins><a class="tref internalDFN" title="language-mapping" href="#dfn-language-mapping"><ins class="diff-new">
language
mapping
</ins></a><ins class="diff-new">
is
selected.
If
there
is
still
no
selected
</ins><a class="tref internalDFN" title="term" href="#dfn-term"><ins class="diff-new">
term
</ins></a>,<ins class="diff-new">
then
a
</ins><a class="tref internalDFN" title="term" href="#dfn-term"><ins class="diff-new">
term
</ins></a><ins class="diff-new">
with
no
</ins><a class="tref internalDFN" title="type-mapping" href="#dfn-type-mapping"><ins class="diff-new">
type
mapping
</ins></a><ins class="diff-new">
or
</ins><a class="tref internalDFN" title="language-mapping" href="#dfn-language-mapping"><ins class="diff-new">
language
mapping
</ins></a><ins class="diff-new">
will
be
selected
if
available.
No
</ins><a class="tref internalDFN" title="term" href="#dfn-term"><ins class="diff-new">
term
</ins></a><ins class="diff-new">
will
be
selected
that
</ins>
has
a
<del class="diff-old">@container
</del>
<ins class="diff-chg">conflicting
</ins><a class="tref internalDFN" title="type-mapping" href="#dfn-type-mapping"><ins class="diff-chg">
type
mapping
</ins></a><ins class="diff-chg">
or
</ins><a class="tref internalDFN" title="language-mapping" href="#dfn-language-mapping"><ins class="diff-chg">
language
</ins>
mapping
</a>.
<ins class="diff-new">Ties
between
</ins><a class="tref internalDFN" title="term" href="#dfn-term"><ins class="diff-new">
terms
</ins></a><ins class="diff-new">
that
have
the
same
mappings
are
resolved
by
first
choosing
the
shortest
terms,
and
then
by
choosing
the
lexicographically
least
term.
Note
that
these
ties
are
resolved
automatically
because
they
were
previously
resolved
when
the
</ins><a href="#inverse-context-creation"><ins class="diff-new">
Inverse
Context
Creation
algorithm
</ins></a><ins class="diff-new">
was
used
</ins>
to
<del class="diff-old">@set
,
</del>
create
<ins class="diff-new">the
</ins><a class="tref internalDFN" title="inverse-context" href="#dfn-inverse-context"><ins class="diff-new">
inverse
context
</ins></a>.</p></section><section><h4 id="algorithm-8"><ins class="diff-new">
Algorithm
</ins></h4><p><ins class="diff-new">
This
algorithm
has
five
required
inputs.
They
are:
</ins>
an
<del class="diff-old">entry
in
output
</del>
<a class="tref internalDFN" title="inverse-context" href="#dfn-inverse-context">
<ins class="diff-chg">inverse
context
</ins></a>,<ins class="diff-chg">
a
</ins><a class="tref internalDFN" title="keyword" href="#dfn-keyword"><ins class="diff-chg">
keyword
</ins></a><ins class="diff-chg">
or
</ins><a class="tref internalDFN" title="iri" href="#dfn-iri"><abbr title="Internationalized Resource Identifier"><ins class="diff-chg">
IRI
</ins></abbr></a><i><ins class="diff-chg">
iri
</ins></i>,<ins class="diff-chg">
an
</ins><a class="tref internalDFN" title="array" href="#dfn-array"><ins class="diff-chg">
array
</ins></a><i><ins class="diff-chg">
containers
</ins></i><ins class="diff-chg">
that
represents
an
ordered
list
of
preferred
</ins><a class="tref internalDFN" title="container-mapping" href="#dfn-container-mapping"><ins class="diff-chg">
container
mappings
</ins></a>,<ins class="diff-chg">
a
</ins><a class="tref internalDFN" title="string" href="#dfn-string"><ins class="diff-chg">
string
</ins></a><i><ins class="diff-chg">
typeOrLanguage
</ins></i><ins class="diff-chg">
that
indicates
whether
to
look
</ins>
for
<del class="diff-old">active
property
</del>
<ins class="diff-chg">a
</ins><a class="tref internalDFN" title="term" href="#dfn-term"><ins class="diff-chg">
term
</ins></a><ins class="diff-chg">
with
a
matching
</ins><a class="tref internalDFN" title="type-mapping" href="#dfn-type-mapping"><ins class="diff-chg">
type
mapping
</ins>
</a>
<ins class="diff-new">or
</ins><a class="tref internalDFN" title="language-mapping" href="#dfn-language-mapping"><ins class="diff-new">
language
mapping
</ins></a>,
and
<del class="diff-old">value
as
</del>
an
<a class="tref internalDFN" title="array" href="#dfn-array">
array
</a>
<ins class="diff-new">representing
an
ordered
list
of
</ins><i><ins class="diff-new">
preferred
values
</ins></i><ins class="diff-new">
for
the
</ins><a class="tref internalDFN" title="type-mapping" href="#dfn-type-mapping"><ins class="diff-new">
type
mapping
</ins></a><ins class="diff-new">
or
</ins><a class="tref internalDFN" title="language-mapping" href="#dfn-language-mapping"><ins class="diff-new">
language
mapping
</ins></a><ins class="diff-new">
to
look
for.
</ins></p><ol class="algorithm"><li><ins class="diff-new">
Initialize
</ins><i><ins class="diff-new">
container
map
</ins></i><ins class="diff-new">
to
the
value
associated
with
</ins><i><ins class="diff-new">
iri
</ins></i><ins class="diff-new">
in
the
</ins><a class="tref internalDFN" title="inverse-context" href="#dfn-inverse-context"><ins class="diff-new">
inverse
context
</ins>
</a>.
</li>
<li>
<del class="diff-old">Otherwise,
create
an
entry
</del>
<ins class="diff-chg">For
each
item
</ins><i><ins class="diff-chg">
container
</ins></i>
in
<del class="diff-old">output
for
active
property
</del>
<i>
<ins class="diff-chg">containers
</ins></i>:<ol class="algorithm"><li><ins class="diff-chg">
If
</ins><i><ins class="diff-chg">
container
</ins></i><ins class="diff-chg">
is
not
a
key
in
</ins><i><ins class="diff-chg">
container
map
</ins></i>,<ins class="diff-chg">
then
there
is
no
</ins><a class="tref internalDFN" title="term" href="#dfn-term"><ins class="diff-chg">
term
</ins>
</a>
<del class="diff-old">and
value
.
</del>
<ins class="diff-chg">with
a
matching
</ins><a class="tref internalDFN" title="container-mapping" href="#dfn-container-mapping"><ins class="diff-chg">
container
mapping
</ins></a><ins class="diff-chg">
for
it,
so
continue
to
the
next
</ins><i><ins class="diff-chg">
container
</ins></i>.
</li>
<li>
<ins class="diff-chg">Initialize
</ins><i><ins class="diff-chg">
typeOrLanguage
map
</ins></i><ins class="diff-chg">
to
the
value
associated
with
the
</ins><i><ins class="diff-chg">
container
</ins></i><ins class="diff-chg">
member
in
</ins><i><ins class="diff-chg">
container
map
</ins></i>.
</li>
<li>
<ins class="diff-chg">Initialize
</ins><i><ins class="diff-chg">
typeOrLanguageValue
map
</ins></i><ins class="diff-chg">
to
the
value
associated
with
</ins><i><ins class="diff-chg">
typeOrLanguage
</ins></i><ins class="diff-chg">
member
in
</ins><i><ins class="diff-chg">
typeOrLanguage
map
</ins></i>.
</li>
<li>
<ins class="diff-chg">For
each
</ins><i><ins class="diff-chg">
item
</ins></i><ins class="diff-chg">
in
</ins><i><ins class="diff-chg">
preferred
values
</ins></i>:<ol class="algorithm"><li><ins class="diff-chg">
If
</ins><i><ins class="diff-chg">
item
</ins></i><ins class="diff-chg">
is
not
a
key
in
</ins><i><ins class="diff-chg">
typeOrLanguageValue
map
</ins></i>,<ins class="diff-chg">
then
there
is
no
</ins><a class="tref internalDFN" title="term" href="#dfn-term"><ins class="diff-chg">
term
</ins></a><ins class="diff-chg">
with
a
matching
</ins><a class="tref internalDFN" title="type-mapping" href="#dfn-type-mapping"><ins class="diff-chg">
type
mapping
</ins></a><ins class="diff-chg">
or
</ins><a class="tref internalDFN" title="language-mapping" href="#dfn-language-mapping"><ins class="diff-chg">
language
mapping
</ins></a>,<ins class="diff-chg">
so
continue
to
the
next
</ins><i><ins class="diff-chg">
item
</ins></i>.
</li>
<li>
Otherwise,
<ins class="diff-new">a
matching
term
has
been
found,
</ins>
return
<del class="diff-old">element
as
</del>
the
<del class="diff-old">compacted
element
.
</del>
<ins class="diff-chg">value
associated
with
the
</ins><i><ins class="diff-chg">
item
</ins></i><ins class="diff-chg">
member
in
</ins><i><ins class="diff-chg">
typeOrLanguageValue
map
</ins></i>.</li></ol></li></ol></li><li><ins class="diff-chg">
No
matching
term
has
been
found.
Return
</ins><a class="tref internalDFN" title="null" href="#dfn-null"><ins class="diff-chg">
null
</ins></a>.</li></ol></section></section><section id="value-compaction"><h3>
<del class="diff-old">Issue
7
</del>
<span class="secno">
<ins class="diff-chg">8.5
</ins>
</span>
<del class="diff-old">Perhaps
this
should
also
call
</del>
Value
Compaction
</h3>
<p>
<a class="tref internalDFN" title="expansion" href="#dfn-expansion">
<ins class="diff-new">Expansion
</ins></a><ins class="diff-new">
transforms
all
values
into
</ins><a class="tref internalDFN" title="expanded-form" href="#dfn-expanded-form"><ins class="diff-new">
expanded
form
</ins>
</a>
<del class="diff-old">on
native
types
and
strings,
which
could
consolidate
potential
transformation
</del>
in
<del class="diff-old">one
place.
If,
after
</del>
<ins class="diff-chg">JSON-LD.
This
algorithm
performs
</ins>
the
<ins class="diff-new">opposite
operation,
transforming
a
value
into
</ins><dfn title="compacted-form" id="dfn-compacted-form"><ins class="diff-new">
compacted
form
</ins></dfn>.<ins class="diff-new">
This
</ins>
algorithm
<del class="diff-old">outlined
above
</del>
<ins class="diff-chg">compacts
a
value
according
to
the
</ins><a class="tref internalDFN" title="term-definition" href="#dfn-term-definition"><ins class="diff-chg">
term
definition
</ins></a><ins class="diff-chg">
in
the
given
</ins><a class="tref internalDFN" title="active-context" href="#dfn-active-context"><ins class="diff-chg">
active
context
</ins></a><ins class="diff-chg">
that
</ins>
is
<del class="diff-old">run,
</del>
<ins class="diff-chg">associated
with
</ins>
the
<del class="diff-old">resulting
</del>
<ins class="diff-chg">value's
associated
</ins><a class="tref internalDFN" title="active-property" href="#dfn-active-property"><ins class="diff-chg">
active
property
</ins></a>.</p><section class="informative"><h4 id="general-solution-9"><ins class="diff-chg">
General
Solution
</ins></h4><p>
<em>
<del class="diff-old">element
</del>
<ins class="diff-chg">This
section
is
non-normative.
</ins>
</em>
</p>
<p>
<ins class="diff-new">The
</ins><i><ins class="diff-new">
value
</ins></i><ins class="diff-new">
to
compact
has
either
an
</ins><code><ins class="diff-new">
@id
</ins></code><ins class="diff-new">
or
an
</ins><code><ins class="diff-new">
@value
</ins></code><ins class="diff-new">
member.
</ins></p><p><ins class="diff-new">
For
the
former
case,
if
the
</ins><a class="tref internalDFN" title="type-mapping" href="#dfn-type-mapping"><ins class="diff-new">
type
mapping
</ins></a><ins class="diff-new">
of
</ins><a class="tref internalDFN" title="active-property" href="#dfn-active-property"><ins class="diff-new">
active
property
</ins></a>
is
<ins class="diff-new">set
to
</ins><code><ins class="diff-new">
@id
</ins></code><ins class="diff-new">
or
</ins><code><ins class="diff-new">
@vocab
</ins></code><ins class="diff-new">
and
</ins><i><ins class="diff-new">
value
</ins></i><ins class="diff-new">
consists
of
only
of
</ins>
an
<del class="diff-old">array
,
put
element
</del>
<code>
<ins class="diff-chg">@id
</ins></code><ins class="diff-chg">
member
and,
if
if
the
</ins><a class="tref internalDFN" title="container-mapping" href="#dfn-container-mapping"><ins class="diff-chg">
container
mapping
</ins></a><ins class="diff-chg">
of
</ins><a class="tref internalDFN" title="active-property" href="#dfn-active-property"><ins class="diff-chg">
active
property
</ins></a><ins class="diff-chg">
is
set
to
</ins><code><ins class="diff-chg">
@index
</ins></code>,<ins class="diff-chg">
an
</ins><code><ins class="diff-chg">
@index
</ins></code><ins class="diff-chg">
member,
</ins><i><ins class="diff-chg">
value
</ins></i><ins class="diff-chg">
can
be
compacted
to
a
</ins><a class="tref internalDFN" title="string" href="#dfn-string"><ins class="diff-chg">
string
</ins></a><ins class="diff-chg">
by
returning
the
result
of
using
the
</ins><a href="#iri-compaction"><abbr title="Internationalized Resource Identifier"><ins class="diff-chg">
IRI
</ins></abbr><ins class="diff-chg">
Compaction
algorithm
</ins></a><ins class="diff-chg">
to
compact
the
value
associated
with
the
</ins><code><ins class="diff-chg">
@id
</ins></code><ins class="diff-chg">
member.
Otherwise,
</ins><i><ins class="diff-chg">
value
</ins></i><ins class="diff-chg">
cannot
be
compacted
and
is
returned
as
is.
</ins></p><p><ins class="diff-chg">
For
the
latter
case,
it
might
be
possible
to
compact
</ins><i><ins class="diff-chg">
value
</ins></i><ins class="diff-chg">
just
</ins>
into
the
<ins class="diff-new">value
associated
with
the
</ins>
<code>
<del class="diff-old">@graph
</del>
<ins class="diff-chg">@value
</ins>
</code>
<ins class="diff-new">member.
This
can
be
done
if
the
</ins><a class="tref internalDFN" title="active-property" href="#dfn-active-property"><ins class="diff-new">
active
</ins>
property
<del class="diff-old">of
</del>
</a>
<ins class="diff-chg">has
</ins>
a
<del class="diff-old">new
JSON
object
</del>
<ins class="diff-chg">matching
</ins><a class="tref internalDFN" title="type-mapping" href="#dfn-type-mapping"><ins class="diff-chg">
type
mapping
</ins></a><ins class="diff-chg">
or
</ins><a class="tref internalDFN" title="language-mapping" href="#dfn-language-mapping"><ins class="diff-chg">
language
mapping
</ins>
</a>
and
<del class="diff-old">then
</del>
<ins class="diff-chg">there
is
either
no
</ins><code><ins class="diff-chg">
@index
</ins></code><ins class="diff-chg">
member
or
the
</ins><a class="tref internalDFN" title="container-mapping" href="#dfn-container-mapping"><ins class="diff-chg">
container
mapping
</ins></a><ins class="diff-chg">
of
</ins><a class="tref internalDFN" title="active-property" href="#dfn-active-property"><ins class="diff-chg">
active
property
</ins></a><ins class="diff-chg">
is
</ins>
set
<del class="diff-old">element
</del>
to
<del class="diff-old">that
JSON
object
</del>
<code>
<ins class="diff-chg">@index
</ins></code>.<ins class="diff-chg">
It
can
also
be
done
if
</ins><code><ins class="diff-chg">
@value
</ins></code><ins class="diff-chg">
is
the
only
member
in
</ins><i><ins class="diff-chg">
value
</ins></i><ins class="diff-chg">
(apart
an
</ins><code><ins class="diff-chg">
@index
</ins></code><ins class="diff-chg">
member
in
case
the
</ins><a class="tref internalDFN" title="container-mapping" href="#dfn-container-mapping"><ins class="diff-chg">
container
mapping
</ins></a><ins class="diff-chg">
of
</ins><a class="tref internalDFN" title="active-property" href="#dfn-active-property"><ins class="diff-chg">
active
property
</ins></a><ins class="diff-chg">
is
set
to
</ins><code><ins class="diff-chg">
@index
</ins></code><ins class="diff-chg">
)
and
either
its
associated
value
is
not
a
</ins><a class="tref internalDFN" title="string" href="#dfn-string"><ins class="diff-chg">
string
</ins></a>,<ins class="diff-chg">
there
is
no
</ins><a class="tref internalDFN" title="default-language" href="#dfn-default-language"><ins class="diff-chg">
default
language
</ins></a>,<ins class="diff-chg">
or
there
is
an
explicit
</ins><a class="tref internalDFN" title="null" href="#dfn-null"><ins class="diff-chg">
null
</ins></a><a class="tref internalDFN" title="language-mapping" href="#dfn-language-mapping"><ins class="diff-chg">
language
mapping
</ins></a><ins class="diff-chg">
for
the
</ins><a class="tref internalDFN" title="active-property" href="#dfn-active-property"><ins class="diff-chg">
active
property
</ins>
</a>.
<del class="diff-old">Finally,
add
</del>
</p>
</section>
<section>
<h4 id="algorithm-9">
<ins class="diff-chg">Algorithm
</ins></h4><p><ins class="diff-chg">
This
algorithm
has
four
required
inputs:
an
</ins><a class="tref internalDFN" title="active-context" href="#dfn-active-context"><ins class="diff-chg">
active
context
</ins></a>,<ins class="diff-chg">
an
</ins><a class="tref internalDFN" title="inverse-context" href="#dfn-inverse-context"><ins class="diff-chg">
inverse
context
</ins></a>,<ins class="diff-chg">
an
</ins><a class="tref internalDFN" title="active-property" href="#dfn-active-property"><ins class="diff-chg">
active
property
</ins></a>,<ins class="diff-chg">
and
</ins>
a
<i>
<ins class="diff-new">value
</ins></i><ins class="diff-new">
to
be
compacted.
</ins></p><ol class="algorithm"><li><ins class="diff-new">
Initialize
</ins><i><ins class="diff-new">
number
members
</ins></i><ins class="diff-new">
to
the
number
of
members
</ins><i><ins class="diff-new">
value
</ins></i><ins class="diff-new">
contains.
</ins></li><li><ins class="diff-new">
If
</ins><i><ins class="diff-new">
value
</ins></i><ins class="diff-new">
has
an
</ins>
<code>
<del class="diff-old">@context
</del>
<ins class="diff-chg">@index
</ins>
</code>
<ins class="diff-new">member
and
the
</ins><a class="tref internalDFN" title="container-mapping" href="#dfn-container-mapping"><ins class="diff-new">
container
mapping
</ins></a><ins class="diff-new">
associated
to
</ins><a class="tref internalDFN" title="active-property" href="#dfn-active-property"><ins class="diff-new">
active
</ins>
property
</a>
<ins class="diff-new">is
set
</ins>
to
<del class="diff-old">element
</del>
<code>
<ins class="diff-chg">@index
</ins></code>,<ins class="diff-chg">
decrease
</ins><i><ins class="diff-chg">
number
members
</ins></i><ins class="diff-chg">
by
</ins><code><ins class="diff-chg">
1
</ins></code>.</li><li><ins class="diff-chg">
If
</ins><i><ins class="diff-chg">
number
members
</ins></i><ins class="diff-chg">
is
greater
than
</ins><code><ins class="diff-chg">
2
</ins></code>,<ins class="diff-chg">
return
</ins><i><ins class="diff-chg">
value
</ins></i><ins class="diff-chg">
as
it
cannot
be
compacted.
</ins></li><li><ins class="diff-chg">
If
</ins><i><ins class="diff-chg">
value
</ins></i><ins class="diff-chg">
has
an
</ins><code><ins class="diff-chg">
@id
</ins></code><ins class="diff-chg">
member:
</ins><ol class="algorithm"><li><ins class="diff-chg">
If
</ins><i><ins class="diff-chg">
number
members
</ins></i><ins class="diff-chg">
is
</ins><code><ins class="diff-chg">
1
</ins></code>
and
<ins class="diff-new">the
</ins><a class="tref internalDFN" title="type-mapping" href="#dfn-type-mapping"><ins class="diff-new">
type
mapping
</ins></a><ins class="diff-new">
of
</ins><a class="tref internalDFN" title="active-property" href="#dfn-active-property"><ins class="diff-new">
active
property
</ins></a><ins class="diff-new">
is
</ins>
set
<del class="diff-old">it
</del>
to
<code>
<ins class="diff-new">@id
</ins></code>,<ins class="diff-new">
return
</ins>
the
<del class="diff-old">initially
passed
context
.
</del>
<ins class="diff-chg">result
of
using
the
</ins><a href="#iri-compaction">
<del class="diff-old">4.9
RDF
Conversion
A
JSON-LD
document
may
be
converted
between
other
RDF-compatible
document
formats
</del>
<abbr title="Internationalized Resource Identifier">
<ins class="diff-chg">IRI
</ins></abbr><ins class="diff-chg">
compaction
algorithm
</ins></a>,<ins class="diff-chg">
passing
</ins><a class="tref internalDFN" title="active-context" href="#dfn-active-context"><ins class="diff-chg">
active
context
</ins></a>,<a class="tref internalDFN" title="inverse-context" href="#dfn-inverse-context"><ins class="diff-chg">
inverse
context
</ins></a>,<ins class="diff-chg">
and
the
value
of
the
</ins><code><ins class="diff-chg">
@id
</ins></code><ins class="diff-chg">
member
for
</ins><i><ins class="diff-chg">
iri
</ins></i>.</li><li><ins class="diff-chg">
Otherwise,
if
</ins><i><ins class="diff-chg">
number
members
</ins></i><ins class="diff-chg">
is
</ins><code><ins class="diff-chg">
1
</ins></code><ins class="diff-chg">
and
the
</ins><a class="tref internalDFN" title="type-mapping" href="#dfn-type-mapping"><ins class="diff-chg">
type
mapping
</ins></a><ins class="diff-chg">
of
</ins><a class="tref internalDFN" title="active-property" href="#dfn-active-property"><ins class="diff-chg">
active
property
</ins></a><ins class="diff-chg">
is
set
to
</ins><code><ins class="diff-chg">
@vocab
</ins></code>,<ins class="diff-chg">
return
the
result
of
</ins>
using
the
<del class="diff-old">algorithms
specified
in
this
section.
The
JSON-LD
Processing
Model
describes
processing
rules
</del>
<a href="#iri-compaction">
<abbr title="Internationalized Resource Identifier">
<ins class="diff-chg">IRI
</ins></abbr><ins class="diff-chg">
compaction
algorithm
</ins></a>,<ins class="diff-chg">
passing
</ins><a class="tref internalDFN" title="active-context" href="#dfn-active-context"><ins class="diff-chg">
active
context
</ins></a>,<a class="tref internalDFN" title="inverse-context" href="#dfn-inverse-context"><ins class="diff-chg">
inverse
context
</ins></a>,<ins class="diff-chg">
the
value
of
the
</ins><code><ins class="diff-chg">
@id
</ins></code><ins class="diff-chg">
member
</ins>
for
<del class="diff-old">extracting
RDF
from
a
JSON-LD
document,
</del>
<i>
<ins class="diff-chg">iri
</ins></i>,
and
<a class="tref internalDFN" title="true" href="#dfn-true">
<ins class="diff-new">true
</ins></a>
for
<del class="diff-old">transforming
</del>
<i>
<ins class="diff-chg">vocabRelative
</ins></i>.</li><li><ins class="diff-chg">
Otherwise,
return
</ins><i><ins class="diff-chg">
value
</ins></i><ins class="diff-chg">
as
is.
</ins></li></ol></li><li><ins class="diff-chg">
Otherwise,
if
</ins><i><ins class="diff-chg">
value
</ins></i><ins class="diff-chg">
has
</ins>
an
<del class="diff-old">array
of
</del>
<code>
<del class="diff-old">Quad
</del>
<ins class="diff-chg">@type
</ins>
</code>
<ins class="diff-chg">member
whose
value
matches
the
</ins><a class="tref internalDFN" title="type-mapping" href="#dfn-type-mapping"><ins class="diff-chg">
type
mapping
</ins>
</a>
<del class="diff-old">retrieved
by
processing
another
serialization
format
into
JSON-LD.
Note
that
many
uses
</del>
of
<del class="diff-old">JSON-LD
may
not
require
generation
</del>
<a class="tref internalDFN" title="active-property" href="#dfn-active-property">
<ins class="diff-chg">active
property
</ins></a>,<ins class="diff-chg">
return
the
value
associated
with
the
</ins><code><ins class="diff-chg">
@value
</ins></code><ins class="diff-chg">
member
</ins>
of
<del class="diff-old">RDF.
The
processing
algorithms
described
in
this
section
are
provided
in
order
to
demonstrate
how
one
might
implement
a
JSON-LD
to
RDF
processor.
Conformant
implementations
are
only
required
to
produce
</del>
<i>
<ins class="diff-chg">value
</ins></i>.</li><li><ins class="diff-chg">
Otherwise,
if
</ins><i><ins class="diff-chg">
value
</ins></i><ins class="diff-chg">
has
an
</ins><code><ins class="diff-chg">
@language
</ins></code><ins class="diff-chg">
member
whose
value
matches
</ins>
the
<del class="diff-old">same
type
and
number
</del>
<a class="tref internalDFN" title="language-mapping" href="#dfn-language-mapping">
<ins class="diff-chg">language
mapping
</ins></a>
of
<del class="diff-old">quads
during
</del>
<a class="tref internalDFN" title="active-property" href="#dfn-active-property">
<ins class="diff-chg">active
property
</ins></a>,<ins class="diff-chg">
return
</ins>
the
<del class="diff-old">output
process
</del>
<ins class="diff-chg">value
associated
with
the
</ins><code><ins class="diff-chg">
@value
</ins></code><ins class="diff-chg">
member
of
</ins><i><ins class="diff-chg">
value
</ins></i>.</li><li><ins class="diff-chg">
Otherwise,
if
</ins><i><ins class="diff-chg">
number
members
</ins></i><ins class="diff-chg">
equals
</ins><code><ins class="diff-chg">
1
</ins></code>
and
<del class="diff-old">are
</del>
<ins class="diff-chg">either
the
value
of
the
</ins><code><ins class="diff-chg">
@value
</ins></code><ins class="diff-chg">
member
is
</ins>
not
<del class="diff-old">required
</del>
<ins class="diff-chg">a
</ins><a class="tref internalDFN" title="string" href="#dfn-string"><ins class="diff-chg">
string
</ins></a>,<ins class="diff-chg">
or
the
</ins><a class="tref internalDFN" title="active-context" href="#dfn-active-context"><ins class="diff-chg">
active
context
</ins></a><ins class="diff-chg">
has
no
</ins><a class="tref internalDFN" title="default-language" href="#dfn-default-language"><ins class="diff-chg">
default
language
</ins></a>,<ins class="diff-chg">
or
the
</ins><a class="tref internalDFN" title="language-mapping" href="#dfn-language-mapping"><ins class="diff-chg">
language
mapping
</ins></a><ins class="diff-chg">
of
</ins><a class="tref internalDFN" title="active-property" href="#dfn-active-property"><ins class="diff-chg">
active
property
</ins></a><ins class="diff-chg">
is
set
</ins>
to
<del class="diff-old">implement
</del>
<a class="tref internalDFN" title="null" href="#dfn-null">
<ins class="diff-chg">null
</ins></a>,,<ins class="diff-chg">
return
</ins>
the
<del class="diff-old">algorithm
exactly
</del>
<ins class="diff-chg">value
associated
with
the
</ins><code><ins class="diff-chg">
@value
</ins></code><ins class="diff-chg">
member.
</ins></li><li><ins class="diff-chg">
Otherwise,
return
</ins><i><ins class="diff-chg">
value
</ins></i>
as
<del class="diff-old">described.
</del>
<ins class="diff-chg">is.
</ins></li></ol></section></section></section><section id="flattening-algorithms"><h2>
<span class="secno">
<del class="diff-old">4.9.1
</del>
<ins class="diff-chg">9.
</ins>
</span>
<del class="diff-old">Overview
</del>
<ins class="diff-chg">Flattening
Algorithms
</ins></h2><section id="flattening-algorithm"><h3><span class="secno"><ins class="diff-chg">
9.1
</ins></span><ins class="diff-chg">
Flattening
Algorithm
</ins></h3><p><ins class="diff-chg">
This
algorithm
flattens
a
JSON-LD
document
by
collecting
all
properties
of
a
</ins><a class="tref internalDFN" title="node" href="#dfn-node"><ins class="diff-chg">
node
</ins></a><ins class="diff-chg">
in
a
single
</ins><a class="tref internalDFN" title="json-object" href="#dfn-json-object"><ins class="diff-chg">
JSON
object
</ins></a><ins class="diff-chg">
and
labeling
all
</ins><a class="tref internalDFN" title="blank-node" href="#dfn-blank-node"><ins class="diff-chg">
blank
nodes
</ins></a><ins class="diff-chg">
with
</ins><a class="tref internalDFN" title="blank-node-identifier" href="#dfn-blank-node-identifier"><ins class="diff-chg">
blank
node
identifiers
</ins></a>.<ins class="diff-chg">
This
resulting
uniform
shape
of
the
document,
may
drastically
simplify
the
code
required
to
process
JSON-LD
data
in
certain
applications.
</ins></p><section class="informative"><h4 id="general-solution-10"><ins class="diff-chg">
General
Solution
</ins>
</h4>
<p>
<em>
This
section
is
non-normative.
</em>
</p>
<p>
<del class="diff-old">JSON-LD
</del>
<ins class="diff-chg">First,
the
document
</ins>
is
<del class="diff-old">intended
</del>
<ins class="diff-chg">expanded
using
the
</ins><a href="#expansion-algorithm"><ins class="diff-chg">
Expansion
algorithm
</ins></a>.<ins class="diff-chg">
This
removes
all
context
definitions
and
expands
all
</ins><a class="tref internalDFN" title="term" href="#dfn-term"><ins class="diff-chg">
terms
</ins></a><ins class="diff-chg">
and
</ins><a class="tref internalDFN" title="compact-iri" href="#dfn-compact-iri"><ins class="diff-chg">
compact
IRIs
</ins></a>
to
<del class="diff-old">have
an
easy
</del>
<a class="tref internalDFN" title="absolute-iri" href="#dfn-absolute-iri">
<ins class="diff-chg">absolute
IRIs
</ins></a>,<a class="tref internalDFN" title="blank-node-identifier" href="#dfn-blank-node-identifier"><ins class="diff-chg">
blank
node
identifiers
</ins></a>,<ins class="diff-chg">
or
</ins><a class="tref internalDFN" title="keyword" href="#dfn-keyword"><ins class="diff-chg">
keywords
</ins></a><ins class="diff-chg">
and
all
</ins><a class="tref internalDFN" title="json-ld-value" href="#dfn-json-ld-value"><ins class="diff-chg">
JSON-LD
values
</ins></a>
to
<del class="diff-old">parse
grammar
that
closely
models
existing
practice
in
</del>
<a class="tref internalDFN" title="expanded-form" href="#dfn-expanded-form">
<ins class="diff-chg">expanded
form
</ins></a>.<ins class="diff-chg">
In
the
next
step,
a
</ins><i><ins class="diff-chg">
node
map
</ins></i><ins class="diff-chg">
is
generated
</ins>
using
<ins class="diff-new">the
</ins><a href="#node-map-generation"><ins class="diff-new">
Node
Map
Generation
algorithm
</ins></a><ins class="diff-new">
which
collects
all
properties
of
a
</ins><a class="tref internalDFN" title="node" href="#dfn-node"><ins class="diff-new">
node
</ins></a><ins class="diff-new">
in
a
single
</ins><a class="tref internalDFN" title="json-object" href="#dfn-json-object">
JSON
<del class="diff-old">for
describing
</del>
object
<del class="diff-old">representations.
This
allows
</del>
</a>.
<ins class="diff-chg">Finally,
</ins>
the
<del class="diff-old">use
of
existing
libraries
for
parsing
JSON.
</del>
<i>
<ins class="diff-chg">node
map
</ins></i><ins class="diff-chg">
is
converted
to
a
JSON-LD
document
in
</ins><a class="tref externalDFN" title="flattened-document-form" href="../json-ld-syntax/#flattened-document-form"><ins class="diff-chg">
flattened
document
form
</ins></a>.<ins class="diff-chg">
If
a
</ins><a class="tref internalDFN" title="context" href="#dfn-context"><ins class="diff-chg">
context
</ins></a><ins class="diff-chg">
has
been
passed,
the
flattened
document
is
compacted
using
the
</ins><a href="#compaction-algorithm"><ins class="diff-chg">
Compaction
algorithm
</ins></a><ins class="diff-chg">
before
being
returned.
</ins>
</p>
</section>
<section>
<h4 id="algorithm-10">
<ins class="diff-new">Algorithm
</ins></h4>
<p>
<del class="diff-old">As
with
other
grammars
</del>
<ins class="diff-chg">The
algorithm
takes
two
input
variables,
an
</ins><i><ins class="diff-chg">
element
</ins></i><ins class="diff-chg">
to
flatten
and
an
optional
</ins><i><ins class="diff-chg">
context
</ins></i>
used
<del class="diff-old">for
describing
Linked
Data
,
</del>
<ins class="diff-chg">to
compact
the
flattened
document.
If
not
passed,
</ins><i><ins class="diff-chg">
context
</ins></i><ins class="diff-chg">
is
set
to
</ins><a class="tref internalDFN" title="null" href="#dfn-null"><ins class="diff-chg">
null
</ins></a>.</p><ol class="algorithm"><li><ins class="diff-chg">
Expand
</ins><i><ins class="diff-chg">
element
</ins></i><ins class="diff-chg">
according
the
</ins><a href="#expansion-algorithm"><ins class="diff-chg">
Expansion
algorithm
</ins></a>.</li><li><ins class="diff-chg">
Initialize
</ins><i><ins class="diff-chg">
node
map
</ins></i><ins class="diff-chg">
to
</ins>
a
<a class="tref internalDFN" title="json-object" href="#dfn-json-object">
<ins class="diff-new">JSON
object
</ins></a><ins class="diff-new">
consisting
of
a
single
member
whose
</ins>
key
<del class="diff-old">concept
</del>
is
<del class="diff-old">that
</del>
<code>
<ins class="diff-chg">@default
</ins></code><ins class="diff-chg">
and
whose
value
is
an
empty
</ins><a class="tref internalDFN" title="json-object" href="#dfn-json-object"><ins class="diff-chg">
JSON
object
</ins></a>.</li><li><ins class="diff-chg">
Perform
the
</ins><a href="#node-map-generation"><ins class="diff-chg">
Node
Map
Generation
algorithm
</ins></a>,<ins class="diff-chg">
passing
</ins><i><ins class="diff-chg">
element
</ins></i><ins class="diff-chg">
and
</ins><i><ins class="diff-chg">
node
map
</ins></i>.</li><li><ins class="diff-chg">
Initialize
</ins><i><ins class="diff-chg">
default
graph
</ins></i><ins class="diff-chg">
to
the
value
</ins>
of
<del class="diff-old">a
</del>
<ins class="diff-chg">the
</ins><code><ins class="diff-chg">
@default
</ins></code><ins class="diff-chg">
member
of
</ins><i>
node
<ins class="diff-new">map
</ins></i>,<ins class="diff-new">
which
is
a
</ins><a class="tref internalDFN" title="json-object" href="#dfn-json-object"><ins class="diff-new">
JSON
object
</ins>
</a>
<ins class="diff-new">representing
the
</ins><a class="tref internalDFN" title="default-graph" href="#dfn-default-graph"><ins class="diff-new">
default
graph
</ins></a>.</li><li><ins class="diff-new">
For
each
key-value
pair
</ins><i><ins class="diff-new">
graph
name
</ins></i><ins class="diff-new">
-
</ins><i><ins class="diff-new">
graph
</ins></i>
in
<i>
<ins class="diff-new">node
map
</ins></i><ins class="diff-new">
where
</ins><i><ins class="diff-new">
graph
name
</ins></i><ins class="diff-new">
is
not
</ins><code><ins class="diff-new">
@default
</ins></code>,<ins class="diff-new">
perform
the
following
steps:
</ins><ol class="algorithm"><li><ins class="diff-new">
If
</ins><i><ins class="diff-new">
default
graph
</ins></i><ins class="diff-new">
does
not
have
</ins>
a
<del class="diff-old">linked
data
</del>
<i>
graph
<del class="diff-old">.
Nodes
may
be
</del>
<ins class="diff-chg">name
</ins></i><ins class="diff-chg">
member,
create
one
and
initialize
its
value
to
a
</ins><a class="tref internalDFN" title="json-object" href="#dfn-json-object"><ins class="diff-chg">
JSON
object
</ins></a><ins class="diff-chg">
consisting
</ins>
of
<del class="diff-old">three
basic
types.
The
first
</del>
<ins class="diff-chg">an
</ins><code><ins class="diff-chg">
@id
</ins></code><ins class="diff-chg">
member
whose
value
</ins>
is
<ins class="diff-new">set
to
</ins><i><ins class="diff-new">
graph
name
</ins></i>.</li><li><ins class="diff-new">
Reference
</ins>
the
<ins class="diff-chg">value
associated
with
the
</ins><i><ins class="diff-chg">
graph
name
</ins></i><ins class="diff-chg">
member
in
</ins><i><ins class="diff-chg">
default
graph
</ins></i><ins class="diff-chg">
using
the
variable
</ins><i><ins class="diff-chg">
entry
</ins></i>.</li><li><ins class="diff-chg">
Add
an
</ins>
<code>
<del class="diff-old">IRI
</del>
<ins class="diff-chg">@graph
</ins>
</code>
<del class="diff-old">,
which
is
used
</del>
<ins class="diff-chg">member
</ins>
to
<del class="diff-old">refer
</del>
<i>
<ins class="diff-chg">entry
</ins></i><ins class="diff-chg">
and
set
it
</ins>
to
<ins class="diff-chg">an
empty
</ins><a class="tref internalDFN" title="array" href="#dfn-array"><ins class="diff-chg">
array
</ins></a>.</li><li><ins class="diff-chg">
For
each
</ins><i><ins class="diff-chg">
id
</ins></i><ins class="diff-chg">
-
</ins><i>
node
<del class="diff-old">s
</del>
</i>
<ins class="diff-chg">pair
</ins>
in
<del class="diff-old">other
linked
data
</del>
<i>
graph
<del class="diff-old">s.
The
second
is
</del>
</i>
<ins class="diff-chg">ordered
by
</ins><i><ins class="diff-chg">
id
</ins></i>,<ins class="diff-chg">
add
</ins><i><ins class="diff-chg">
node
</ins></i><ins class="diff-chg">
to
</ins>
the
<del class="diff-old">blank
</del>
<code>
<ins class="diff-chg">@graph
</ins></code><ins class="diff-chg">
member
of
</ins><i><ins class="diff-chg">
entry
</ins></i>.</li></ol></li><li><ins class="diff-chg">
Initialize
an
empty
</ins><a class="tref internalDFN" title="array" href="#dfn-array"><ins class="diff-chg">
array
</ins></a><i><ins class="diff-chg">
flattened
</ins></i>.</li><li><ins class="diff-chg">
For
each
</ins><i><ins class="diff-chg">
id
</ins></i><ins class="diff-chg">
-
</ins><i>
node
</i>
<ins class="diff-new">pair
in
</ins><i><ins class="diff-new">
default
graph
</ins></i><ins class="diff-new">
ordered
by
</ins><i><ins class="diff-new">
id
</ins></i>,<ins class="diff-new">
add
</ins><i><ins class="diff-new">
node
</ins></i><ins class="diff-new">
to
</ins><i><ins class="diff-new">
flattened
</ins></i>.</li><li><ins class="diff-new">
If
</ins><i><ins class="diff-new">
context
</ins></i><ins class="diff-new">
is
</ins><a class="tref internalDFN" title="null" href="#dfn-null"><ins class="diff-new">
null
</ins>
</a>,
<del class="diff-old">which
are
nodes
for
which
an
external
name
does
not
exist,
or
</del>
<ins class="diff-chg">return
</ins><i><ins class="diff-chg">
flattened
</ins></i>.</li><li><ins class="diff-chg">
Otherwise,
return
the
result
of
compacting
</ins><i><ins class="diff-chg">
flattened
</ins></i><ins class="diff-chg">
according
the
</ins><a href="#compaction-algorithm"><ins class="diff-chg">
Compaction
algorithm
</ins></a><ins class="diff-chg">
passing
</ins><i><ins class="diff-chg">
context
</ins></i><ins class="diff-chg">
ensuring
that
the
compaction
result
uses
the
</ins><code><ins class="diff-chg">
@graph
</ins></code><ins class="diff-chg">
keyword
(or
its
alias)
at
the
top-level,
even
if
the
context
</ins>
is
<del class="diff-old">not
known.
The
third
</del>
<ins class="diff-chg">empty
or
if
there
</ins>
is
<ins class="diff-new">only
one
element
to
put
in
the
</ins><code><ins class="diff-new">
@graph
</ins></code><a class="tref internalDFN" title="array" href="#dfn-array"><ins class="diff-new">
array
</ins></a>.<ins class="diff-new">
This
ensures
that
the
returned
document
has
</ins>
a
<del class="diff-old">Literal
,
which
express
values
such
as
strings,
dates
and
other
information
having
a
lexical
form,
possibly
including
an
explicit
language
or
datatype.
</del>
<ins class="diff-chg">deterministic
structure.
</ins></li></ol></section></section><section id="node-map-generation"><h3><span class="secno"><ins class="diff-chg">
9.2
</ins></span><ins class="diff-chg">
Node
Map
Generation
</ins></h3>
<p>
<del class="diff-old">Data
described
with
JSON-LD
may
be
considered
to
be
</del>
<ins class="diff-chg">This
algorithm
creates
</ins>
a
<del class="diff-old">graph
made
up
</del>
<a class="tref internalDFN" title="json-object" href="#dfn-json-object">
<ins class="diff-chg">JSON
object
</ins></a><i><ins class="diff-chg">
node
map
</ins></i><ins class="diff-chg">
holding
an
indexed
representation
</ins>
of
<del class="diff-old">subject
</del>
<ins class="diff-chg">the
</ins><a class="tref internalDFN" title="json-ld-graph" href="#dfn-json-ld-graph"><ins class="diff-chg">
graphs
</ins>
</a>
and
<del class="diff-old">object
</del>
<a class="tref internalDFN" title="node" href="#dfn-node">
<ins class="diff-chg">nodes
</ins>
</a>
<ins class="diff-new">represented
in
the
passed
expanded
document.
All
</ins>
<a class="tref internalDFN" title="node" href="#dfn-node">
nodes
</a>
<del class="diff-old">related
via
</del>
<ins class="diff-chg">that
are
not
uniquely
identified
by
an
</ins><abbr title="Internationalized Resource Identifier"><ins class="diff-chg">
IRI
</ins></abbr><ins class="diff-chg">
get
assigned
</ins>
a
<del class="diff-old">property
</del>
<ins class="diff-chg">(new)
</ins><a class="tref internalDFN" title="blank-node-identifier" href="#dfn-blank-node-identifier"><ins class="diff-chg">
blank
</ins>
node
<ins class="diff-new">identifier
</ins>
</a>.
<del class="diff-old">Specific
implementations
may
also
choose
to
operate
on
</del>
<ins class="diff-chg">The
resulting
</ins><i><ins class="diff-chg">
node
map
</ins></i><ins class="diff-chg">
will
have
a
member
for
every
graph
in
</ins>
the
document
<del class="diff-old">as
</del>
<ins class="diff-chg">whose
value
is
another
object
with
</ins>
a
<del class="diff-old">normal
JSON
description
of
objects
having
attributes.
Both
approaches
</del>
<ins class="diff-chg">member
for
every
</ins><a class="tref internalDFN" title="node" href="#dfn-node"><ins class="diff-chg">
node
</ins></a><ins class="diff-chg">
represented
in
the
document.
The
default
graph
is
stored
under
the
</ins><code><ins class="diff-chg">
@default
</ins></code><ins class="diff-chg">
member,
all
other
graphs
</ins>
are
<del class="diff-old">valid
ways
to
interact
with
JSON-LD
documents.
</del>
<ins class="diff-chg">stored
under
their
</ins><a class="tref internalDFN" title="graph-name" href="#dfn-graph-name"><ins class="diff-chg">
graph
name
</ins></a>.
</p>
<del class="diff-old">4.9.2
Parsing
Examples
</del>
<section class="informative">
<h4 id="general-solution-11">
<ins class="diff-chg">General
Solution
</ins>
</h4>
<p>
<em>
This
section
is
non-normative.
</em>
</p>
<p>
The
<del class="diff-old">following
examples
show
simple
transformations
of
</del>
<ins class="diff-chg">algorithm
recursively
runs
over
an
expanded
</ins>
JSON-LD
<del class="diff-old">documents
to
Turtle
[
TURTLE-TR
].
The
first
example
uses
a
simple
</del>
document
<del class="diff-old">containing
a
simple
FOAF
profile:
{
  &quot;@context&quot;: {&quot;foaf&quot;: &quot;http://xmlns.com/foaf/0.1/&quot;},
  &quot;@id&quot;: &quot;http://greggkellogg.net/foaf#me&quot;,
  &quot;@type&quot;: &quot;foaf:Person&quot;,
  &quot;foaf:name&quot;: &quot;Gregg Kellogg&quot;,
  &quot;foaf:knows&quot;: {
    &quot;@type&quot;: &quot;foaf:Person&quot;,
    &quot;foaf:name&quot;: &quot;Manu Sporny&quot;
  }
}
This
translates
fairly
directly
</del>
to
<ins class="diff-new">collect
all
</ins><a class="tref internalDFN" title="property" href="#dfn-property"><ins class="diff-new">
properties
</ins></a><ins class="diff-new">
of
</ins>
a
<del class="diff-old">similar
Turtle
document:
@prefix foaf: &lt;http://xmlns.com/foaf/0.1/&gt;.
&lt;http://greggkellogg.net/foaf#me&gt; a foaf:Person;
  foaf:name &quot;Gregg Kellogg&quot;;
foaf:knows
[
</del>
<a class="tref internalDFN" title="node" href="#dfn-node">
<ins class="diff-chg">node
</ins></a><ins class="diff-chg">
in
</ins>
a
<del class="diff-old">foaf:Person;
foaf:name
&quot;Manu
Sporny&quot;].
</del>
<ins class="diff-chg">single
</ins><a class="tref internalDFN" title="json-object" href="#dfn-json-object"><ins class="diff-chg">
JSON
object
</ins></a>.
The
<del class="diff-old">actual
parsing
steps
first
require
that
</del>
<ins class="diff-chg">algorithm
constructs
a
</ins><a class="tref internalDFN" title="json-object" href="#dfn-json-object"><ins class="diff-chg">
JSON
object
</ins></a><i><ins class="diff-chg">
node
map
</ins></i><ins class="diff-chg">
whose
keys
represent
the
</ins><a class="tref internalDFN" title="graph-name" href="#dfn-graph-name"><ins class="diff-chg">
graph
names
</ins></a><ins class="diff-chg">
used
in
</ins>
the
<del class="diff-old">JSON-LD
</del>
document
<del class="diff-old">be
expanded,
to
eliminate
</del>
<ins class="diff-chg">(the
</ins><a class="tref internalDFN" title="default-graph" href="#dfn-default-graph"><ins class="diff-chg">
default
graph
</ins></a><ins class="diff-chg">
is
stored
under
</ins>
the
<ins class="diff-new">key
</ins>
<code>
<del class="diff-old">@context
:
[{
  &quot;@id&quot;: &quot;http://greggkellogg.net/foaf#me&quot;,
  &quot;@type&quot;: [&quot;http://xmlns.com/foaf/0.1/Person&quot;],
  &quot;http://xmlns.com/foaf/0.1/name&quot;: [{&quot;@value&quot;: &quot;Gregg Kellogg&quot;}],
  &quot;http://xmlns.com/foaf/0.1/knows&quot;: [{
    &quot;@type&quot;: [&quot;http://xmlns.com/foaf/0.1/Person&quot;],
    &quot;http://xmlns.com/foaf/0.1/name&quot;: [{&quot;@value&quot;: &quot;Manu Sporny&quot;}]
  }]
}]
The
process
of
translating
this
to
RDF
then
operates
over
each
subject
definition
</del>
<ins class="diff-chg">@default
</ins></code><ins class="diff-chg">
)
and
whose
associated
values
are
</ins><a class="tref internalDFN" title="json-object" href="#dfn-json-object"><ins class="diff-chg">
JSON
objects
</ins>
</a>
<del class="diff-old">to
find
</del>
<ins class="diff-chg">which
index
the
</ins><a class="tref internalDFN" title="node" href="#dfn-node"><ins class="diff-chg">
nodes
</ins></a><ins class="diff-chg">
in
the
</ins><a class="tref internalDFN" title="json-ld-graph" href="#dfn-json-ld-graph"><ins class="diff-chg">
graph
</ins></a>.<ins class="diff-chg">
If
</ins>
a
<del class="diff-old">subject,
each
</del>
<a class="tref internalDFN" title="property" href="#dfn-property">
<del class="diff-old">property
</del>
<ins class="diff-chg">property's
</ins>
</a>
<del class="diff-old">to
find
an
RDF
predicate
,
and
each
</del>
value
<ins class="diff-new">is
a
</ins><a class="tref internalDFN" title="node-object" href="#dfn-node-object"><ins class="diff-new">
node
object
</ins></a>,<ins class="diff-new">
it
is
replace
by
a
</ins><a class="tref internalDFN" title="node-object" href="#dfn-node-object"><ins class="diff-new">
node
object
</ins></a><ins class="diff-new">
consisting
</ins>
of
<del class="diff-old">that
property
to
find
</del>
<ins class="diff-chg">only
</ins>
an
<code>
<ins class="diff-chg">@id
</ins></code><ins class="diff-chg">
member.
If
a
</ins><a class="tref internalDFN" title="node-object" href="#dfn-node-object"><ins class="diff-chg">
node
</ins>
object
<del class="diff-old">.
In
this
case,
each
property
</del>
</a>
has
<del class="diff-old">just
a
single
object:
</del>
<ins class="diff-chg">no
</ins>
<code>
<del class="diff-old">foaf:name
</del>
<ins class="diff-chg">@id
</ins>
</code>
<del class="diff-old">identifies
</del>
<ins class="diff-chg">member
or
it
is
identified
by
</ins>
a
<del class="diff-old">literal
</del>
<a class="tref internalDFN" title="blank-node-identifier" href="#dfn-blank-node-identifier">
<ins class="diff-chg">blank
node
identifier
</ins>
</a>,
<del class="diff-old">and
foaf:knows
identifies
</del>
a
<del class="diff-old">second
subject
definition
</del>
<ins class="diff-chg">new
</ins><a class="tref internalDFN" title="blank-node-identifier" href="#dfn-blank-node-identifier"><ins class="diff-chg">
blank
node
identifier
</ins>
</a>
<del class="diff-old">similar
to
Turtle's
blankNodePropertyList
.
After
expansion,
JSON-LD
numbers
,
booleans
,
typed-
and
language-tagged-
literals
,
and
IRIs
</del>
<ins class="diff-chg">is
generated.
This
relabeling
of
</ins><a class="tref internalDFN" title="blank-node-identifier" href="#dfn-blank-node-identifier"><ins class="diff-chg">
blank
node
identifiers
</ins>
</a>
<del class="diff-old">become
explicit,
and
can
</del>
<ins class="diff-chg">is
also
</ins>
be
<del class="diff-old">directly
transformed
into
their
RDF
representations.
[{
  &quot;@id&quot;: &quot;http://greggkellogg.net/foaf#me&quot;,
  &quot;@type&quot;: [&quot;http://xmlns.com/foaf/0.1/Person&quot;],
  &quot;http://xmlns.com/foaf/0.1/name&quot;: [{&quot;@value&quot;: &quot;Gregg Kellogg&quot;}],
  &quot;http://xmlns.com/foaf/0.1/currentProject&quot;: [{&quot;@id&quot;: &quot;http://json-ld.org/&quot;}],
  &quot;http://xmlns.com/foaf/0.1/birthday&quot;: [{
    &quot;@value&quot;: &quot;1957-02-27&quot;,
    &quot;@type&quot;: &quot;http://www.w3.org/2001/XMLSchema#date&quot;
  }],
  &quot;http://xmlns.com/foaf/0.1/knows&quot;: [{
    &quot;@type&quot;: [&quot;http://xmlns.com/foaf/0.1/Person&quot;],
    &quot;http://xmlns.com/foaf/0.1/name&quot;: [{&quot;@value&quot;: &quot;Manu Sporny&quot;}]
  }]
}]
Translates
to:
</del>
<ins class="diff-chg">done
for
</ins><a class="tref internalDFN" title="property" href="#dfn-property"><ins class="diff-chg">
properties
</ins></a><ins class="diff-chg">
and
values
of
</ins><code><ins class="diff-chg">
@type
</ins></code>.
</p>
<del class="diff-old">@prefix foaf: &lt;http://xmlns.com/foaf/0.1/&gt;.
@prefix xsd: &lt;http://www.w3.org/2001/XMLSchema#&gt;.
&lt;http://greggkellogg.net/foaf#me&gt; a foaf:Person;
  foaf:name &quot;Gregg Kellogg&quot;;
  foaf:currentProject &lt;http://json-ld.org/&gt;;
  foaf:birthday &quot;1957-02-27&quot;^^xsd:date;
foaf:knows
[
a
foaf:Person;
foaf:name
&quot;Manu
Sporny&quot;].
4.9.3
Convert
to
RDF
</del>
</section>
<section>
<h4 id="algorithm-11">
Algorithm
</h4>
<p>
The
algorithm
<del class="diff-old">below
is
designed
for
in-memory
implementations
with
random
access
</del>
<ins class="diff-chg">takes
as
input
an
expanded
JSON-LD
document
</ins><i><ins class="diff-chg">
element
</ins></i><ins class="diff-chg">
and
a
reference
</ins>
to
<ins class="diff-chg">a
</ins><a class="tref internalDFN" title="json-object" href="#dfn-json-object">
JSON
object
</a>
<del class="diff-old">elements.
A
conforming
JSON-LD
processor
implementing
RDF
conversion
must
implement
a
processing
algorithm
that
results
in
</del>
<i>
<ins class="diff-chg">node
map
</ins></i>.<ins class="diff-chg">
Furthermore
it
has
</ins>
the
<del class="diff-old">same
set
of
RDF
Quads
</del>
<ins class="diff-chg">optional
parameters
</ins><a class="tref internalDFN" title="active-graph" href="#dfn-active-graph"><ins class="diff-chg">
active
graph
</ins>
</a>
<del class="diff-old">that
the
following
algorithm
generates:
The
algorithm
takes
five
input
variables:
a
element
</del>
<ins class="diff-chg">(which
defaults
</ins>
to
<del class="diff-old">be
converted,
</del>
<code>
<ins class="diff-chg">@default
</ins></code><ins class="diff-chg">
),
</ins>
an
<a class="tref internalDFN" title="active-subject" href="#dfn-active-subject">
active
subject
</a>,
<a class="tref internalDFN" title="active-property" href="#dfn-active-property">
active
property
</a>,
and
<del class="diff-old">graph
name
.
To
begin,
the
</del>
<ins class="diff-chg">a
reference
to
a
</ins><a class="tref internalDFN" title="json-object" href="#dfn-json-object"><ins class="diff-chg">
JSON
object
</ins></a><i><ins class="diff-chg">
list
</ins></i>.<ins class="diff-chg">
If
not
passed,
</ins><a class="tref internalDFN" title="active-subject" href="#dfn-active-subject">
active
subject
</a>,
<a class="tref internalDFN" title="active-property" href="#dfn-active-property">
active
property
</a>,
and
<del class="diff-old">graph
name
</del>
<i>
<ins class="diff-chg">list
</ins></i>
are
set
to
<a class="tref internalDFN" title="null" href="#dfn-null">
null
</a>.
</p>
<ol class="algorithm">
<li>
<ins class="diff-new">If
</ins><i><ins class="diff-new">
element
</ins></i><ins class="diff-new">
is
an
array,
process
each
</ins><i><ins class="diff-new">
item
</ins></i><ins class="diff-new">
in
</ins><i><ins class="diff-new">
element
</ins></i><ins class="diff-new">
as
follows
and
then
return:
</ins><ol class="algorithm"><li><ins class="diff-new">
Run
this
algorithm
recursively
by
passing
</ins><i><ins class="diff-new">
item
</ins></i><ins class="diff-new">
for
</ins><i><ins class="diff-new">
element
</ins></i>,<i><ins class="diff-new">
node
map
</ins></i>,<a class="tref internalDFN" title="active-graph" href="#dfn-active-graph"><ins class="diff-new">
active
graph
</ins></a>,<a class="tref internalDFN" title="active-subject" href="#dfn-active-subject"><ins class="diff-new">
active
subject
</ins></a>,<a class="tref internalDFN" title="active-property" href="#dfn-active-property"><ins class="diff-new">
active
property
</ins>
</a>,
and
<i>
<ins class="diff-chg">list
</ins></i>.</li></ol></li><li><ins class="diff-chg">
Otherwise
</ins><i>
element
</i>
is
<del class="diff-old">set
to
</del>
<ins class="diff-chg">a
</ins><a class="tref internalDFN" title="json-object" href="#dfn-json-object"><ins class="diff-chg">
JSON
object
</ins></a>.<ins class="diff-chg">
Reference
</ins>
the
<del class="diff-old">result
</del>
<a class="tref internalDFN" title="json-object" href="#dfn-json-object">
<ins class="diff-chg">JSON
object
</ins></a><ins class="diff-chg">
which
is
the
value
</ins>
of
<del class="diff-old">performing
</del>
the
<del class="diff-old">Expansion
Algorithm
</del>
<a class="tref internalDFN" title="active-graph" href="#dfn-active-graph">
<ins class="diff-chg">active
graph
</ins>
</a>
<del class="diff-old">on
</del>
<ins class="diff-chg">member
of
</ins><i><ins class="diff-chg">
node
map
</ins></i><ins class="diff-chg">
using
</ins>
the
<del class="diff-old">JSON-LD
input
.
This
removes
any
existing
context
to
allow
</del>
<ins class="diff-chg">variable
</ins><i><ins class="diff-chg">
graph
</ins></i>.<ins class="diff-chg">
If
</ins>
the
<del class="diff-old">given
context
</del>
<a class="tref internalDFN" title="active-subject" href="#dfn-active-subject">
<ins class="diff-chg">active
subject
</ins></a><ins class="diff-chg">
is
</ins><a class="tref internalDFN" title="null" href="#dfn-null"><ins class="diff-chg">
null
</ins></a>,<ins class="diff-chg">
set
</ins><i><ins class="diff-chg">
node
</ins></i>
to
<del class="diff-old">be
cleanly
applied.
</del>
<a class="tref internalDFN" title="null" href="#dfn-null">
<ins class="diff-chg">null
</ins></a><ins class="diff-chg">
otherwise
reference
the
</ins><a class="tref internalDFN" title="active-subject" href="#dfn-active-subject"><ins class="diff-chg">
active
subject
</ins></a><ins class="diff-chg">
member
of
</ins><i><ins class="diff-chg">
graph
</ins></i><ins class="diff-chg">
using
the
variable
</ins><i><ins class="diff-chg">
node
</ins></i>.</li><li>
If
<i>
element
<del class="diff-old">is
a
JSON
object
,
</del>
</i>
<ins class="diff-chg">has
an
</ins><code><ins class="diff-chg">
@type
</ins></code><ins class="diff-chg">
member,
</ins>
perform
<ins class="diff-new">for
each
</ins><i><ins class="diff-new">
item
</ins></i>
the
following
steps:
<ol class="algorithm">
<li>
<del class="diff-old">Set
active
object
</del>
<ins class="diff-chg">If
</ins><i><ins class="diff-chg">
item
</ins></i><ins class="diff-chg">
is
a
</ins><a class="tref internalDFN" title="blank-node-identifier" href="#dfn-blank-node-identifier"><ins class="diff-chg">
blank
node
identifier
</ins></a>,<ins class="diff-chg">
replace
it
with
a
newly
</ins><a href="#generate-blank-node-identifier"><ins class="diff-chg">
generated
blank
node
identifier
</ins>
</a>
<del class="diff-old">to
null
.
</del>
<ins class="diff-chg">passing
</ins><i><ins class="diff-chg">
item
</ins></i><ins class="diff-chg">
for
</ins><i><ins class="diff-chg">
identifier
</ins></i>.
</li>
<li>
If
<del class="diff-old">element
</del>
<i>
<ins class="diff-chg">graph
</ins></i>
has
<ins class="diff-new">no
member
</ins><i><ins class="diff-new">
item
</ins></i>,<ins class="diff-new">
create
one
and
initialize
its
value
to
a
</ins><a class="tref internalDFN" title="json-object" href="#dfn-json-object"><ins class="diff-new">
JSON
object
</ins></a><ins class="diff-new">
consisting
of
</ins>
a
<ins class="diff-new">single
member
</ins>
<code>
<del class="diff-old">@value
</del>
<ins class="diff-chg">@id
</ins>
</code>
<del class="diff-old">property:
</del>
<ins class="diff-chg">whose
value
is
</ins><i><ins class="diff-chg">
item
</ins></i>.</li></ol></li>
<li>
If
<del class="diff-old">the
value
of
</del>
<i>
<ins class="diff-chg">element
</ins></i><ins class="diff-chg">
has
an
</ins>
<code>
@value
</code>
<ins class="diff-new">member,
perform
the
following
steps:
</ins><ol class="algorithm"><li><ins class="diff-new">
If
</ins><i><ins class="diff-new">
list
</ins></i>
is
<del class="diff-old">a
number
</del>
<a class="tref internalDFN" title="null" href="#dfn-null">
<ins class="diff-chg">null
</ins>
</a>,
<del class="diff-old">set
</del>
<ins class="diff-chg">merge
</ins><i><ins class="diff-chg">
element
</ins></i><ins class="diff-chg">
into
</ins>
the
<a class="tref internalDFN" title="active-property" href="#dfn-active-property">
active
<del class="diff-old">object
</del>
<ins class="diff-chg">property
</ins></a><ins class="diff-chg">
member
of
</ins><i><ins class="diff-chg">
node
</ins></i><ins class="diff-chg">
;
the
resulting
</ins><a class="tref internalDFN" title="array" href="#dfn-array"><ins class="diff-chg">
array
</ins>
</a>
<ins class="diff-new">must
not
contain
any
duplicate
values.
</ins></li><li><ins class="diff-new">
Otherwise,
append
</ins><i><ins class="diff-new">
element
</ins></i>
to
<ins class="diff-new">the
</ins><code><ins class="diff-new">
@list
</ins></code><ins class="diff-new">
member
of
</ins><i><ins class="diff-new">
list
</ins></i>.</li></ol></li><li><ins class="diff-new">
Otherwise,
if
</ins><i><ins class="diff-new">
element
</ins></i><ins class="diff-new">
has
an
</ins><code><ins class="diff-new">
@list
</ins></code><ins class="diff-new">
member,
perform
the
following
steps:
</ins><ol class="algorithm"><li><ins class="diff-new">
Initialize
</ins>
a
<del class="diff-old">typed
literal
</del>
<ins class="diff-chg">new
</ins><a class="tref internalDFN" title="json-object" href="#dfn-json-object"><ins class="diff-chg">
JSON
object
</ins>
</a>
<del class="diff-old">using
a
string
representation
</del>
<i>
<ins class="diff-chg">result
</ins></i><ins class="diff-chg">
consisting
</ins>
of
<del class="diff-old">the
</del>
<ins class="diff-chg">a
single
member
</ins><code><ins class="diff-chg">
@list
</ins></code><ins class="diff-chg">
whose
</ins>
value
<del class="diff-old">as
defined
in
the
section
Data
Round
Tripping
.
Set
datatype
</del>
<ins class="diff-chg">is
initialized
</ins>
to
<ins class="diff-new">an
empty
</ins><a class="tref internalDFN" title="array" href="#dfn-array"><ins class="diff-new">
array
</ins></a>.</li><li><ins class="diff-new">
Recursively
call
this
algorithm
passing
</ins>
the
value
of
<del class="diff-old">the
</del>
<i>
<ins class="diff-chg">element's
</ins></i>
<code>
<del class="diff-old">@type
</del>
<ins class="diff-chg">@list
</ins>
</code>
<ins class="diff-new">member
for
</ins><i><ins class="diff-new">
element
</ins></i>,<a class="tref internalDFN" title="active-graph" href="#dfn-active-graph"><ins class="diff-new">
active
graph
</ins></a>,<a class="tref internalDFN" title="active-subject" href="#dfn-active-subject"><ins class="diff-new">
active
subject
</ins></a>,<a class="tref internalDFN" title="active-property" href="#dfn-active-property"><ins class="diff-new">
active
</ins>
property
<del class="diff-old">if
it
exists,
otherwise
either
xsd:integer
or
xsd:double
,
depending
on
if
</del>
</a>,
<ins class="diff-chg">and
</ins><i><ins class="diff-chg">
result
</ins></i><ins class="diff-chg">
for
</ins><i><ins class="diff-chg">
list
</ins></i>.</li><li><ins class="diff-chg">
Append
</ins><i><ins class="diff-chg">
result
</ins></i><ins class="diff-chg">
to
the
</ins>
the
value
<del class="diff-old">contains
</del>
<ins class="diff-chg">of
the
</ins><a class="tref internalDFN" title="active-property" href="#dfn-active-property"><ins class="diff-chg">
active
property
</ins></a><ins class="diff-chg">
member
of
</ins><i><ins class="diff-chg">
node
</ins></i>.</li></ol></li><li><ins class="diff-chg">
Otherwise
</ins><i><ins class="diff-chg">
element
</ins></i><ins class="diff-chg">
is
</ins>
a
<del class="diff-old">fractional
and/or
</del>
<a class="tref internalDFN" title="node-object" href="#dfn-node-object">
<ins class="diff-chg">node
object
</ins></a>,<ins class="diff-chg">
perform
the
following
steps:
</ins><ol class="algorithm"><li><ins class="diff-chg">
If
</ins><i><ins class="diff-chg">
element
</ins></i><ins class="diff-chg">
has
</ins>
an
<del class="diff-old">exponential
component.
</del>
<code>
<ins class="diff-chg">@id
</ins></code><ins class="diff-chg">
member,
set
</ins><i><ins class="diff-chg">
id
</ins></i><ins class="diff-chg">
to
its
value
and
remove
the
member
from
</ins><i><ins class="diff-chg">
element
</ins></i>.<ins class="diff-chg">
If
</ins><i><ins class="diff-chg">
id
</ins></i><ins class="diff-chg">
is
a
</ins><a class="tref internalDFN" title="blank-node-identifier" href="#dfn-blank-node-identifier"><ins class="diff-chg">
blank
node
identifier
</ins></a>,<ins class="diff-chg">
replace
it
with
a
newly
</ins><a href="#generate-blank-node-identifier"><ins class="diff-chg">
generated
blank
node
identifier
</ins></a><ins class="diff-chg">
passing
</ins><i><ins class="diff-chg">
id
</ins></i><ins class="diff-chg">
for
</ins><i><ins class="diff-chg">
identifier
</ins></i>.
</li>
<li>
Otherwise,
<del class="diff-old">if
</del>
<ins class="diff-chg">set
</ins><i><ins class="diff-chg">
id
</ins></i><ins class="diff-chg">
to
</ins>
the
<ins class="diff-new">result
of
the
</ins><a href="#generate-blank-node-identifier"><ins class="diff-new">
Generate
Blank
Node
Identifier
algorithm
</ins></a><ins class="diff-new">
passing
</ins><a class="tref internalDFN" title="null" href="#dfn-null"><ins class="diff-new">
null
</ins></a><ins class="diff-new">
for
</ins><i><ins class="diff-new">
identifier
</ins></i>.</li><li><ins class="diff-new">
If
</ins><i><ins class="diff-new">
graph
</ins></i><ins class="diff-new">
does
not
contain
a
member
</ins><i><ins class="diff-new">
id
</ins></i>,<ins class="diff-new">
create
one
and
initialize
its
</ins>
value
<ins class="diff-new">to
a
</ins><a class="tref internalDFN" title="json-object" href="#dfn-json-object"><ins class="diff-new">
JSON
object
</ins></a><ins class="diff-new">
consisting
</ins>
of
<ins class="diff-new">a
single
member
</ins>
<code>
<del class="diff-old">@value
</del>
<ins class="diff-chg">@id
</ins>
</code>
<ins class="diff-new">whose
value
</ins>
is
<del class="diff-old">true
or
false
,
set
the
</del>
<i>
<ins class="diff-chg">id
</ins></i>.</li><li><ins class="diff-chg">
If
</ins><a class="tref internalDFN" title="active-property" href="#dfn-active-property">
active
<del class="diff-old">object
</del>
<ins class="diff-chg">property
</ins>
</a>
<del class="diff-old">to
</del>
<ins class="diff-chg">is
not
</ins><a class="tref internalDFN" title="null" href="#dfn-null"><ins class="diff-chg">
null
</ins></a>,<ins class="diff-chg">
perform
the
following
steps:
</ins><ol class="algorithm"><li><ins class="diff-chg">
Create
</ins>
a
<del class="diff-old">typed
literal
</del>
<ins class="diff-chg">new
</ins><a class="tref internalDFN" title="json-object" href="#dfn-json-object"><ins class="diff-chg">
JSON
object
</ins>
</a>
<del class="diff-old">created
from
</del>
<i>
<ins class="diff-chg">reference
</ins></i><ins class="diff-chg">
consisting
of
a
single
member
</ins><code><ins class="diff-chg">
@id
</ins></code><ins class="diff-chg">
whose
value
is
</ins><i><ins class="diff-chg">
id
</ins></i>.</li><li><ins class="diff-chg">
If
</ins><i><ins class="diff-chg">
list
</ins></i><ins class="diff-chg">
is
</ins><a class="tref internalDFN" title="null" href="#dfn-null"><ins class="diff-chg">
null
</ins></a>,<ins class="diff-chg">
merge
</ins><i><ins class="diff-chg">
element
</ins></i><ins class="diff-chg">
into
</ins>
the
<del class="diff-old">string
representation
</del>
<a class="tref internalDFN" title="active-property" href="#dfn-active-property">
<ins class="diff-chg">active
property
</ins></a><ins class="diff-chg">
member
</ins>
of
<i>
<ins class="diff-new">node
</ins></i><ins class="diff-new">
;
</ins>
the
<del class="diff-old">value.
Set
datatype
</del>
<ins class="diff-chg">resulting
</ins><a class="tref internalDFN" title="array" href="#dfn-array"><ins class="diff-chg">
array
</ins></a><ins class="diff-chg">
must
not
contain
any
duplicate
values.
</ins></li><li><ins class="diff-chg">
Otherwise,
append
</ins><i><ins class="diff-chg">
element
</ins></i>
to
the
<code>
<ins class="diff-new">@list
</ins></code><ins class="diff-new">
member
of
</ins><i><ins class="diff-new">
list
</ins></i>.</li></ol></li><li><ins class="diff-new">
Reference
the
</ins>
value
of
the
<i>
<ins class="diff-new">id
</ins></i><ins class="diff-new">
member
of
</ins><i><ins class="diff-new">
graph
</ins></i><ins class="diff-new">
using
the
variable
</ins><i><ins class="diff-new">
node
</ins></i>.</li><li><ins class="diff-new">
If
</ins><i><ins class="diff-new">
element
</ins></i><ins class="diff-new">
has
an
</ins>
<code>
@type
</code>
<del class="diff-old">property
if
it
exists,
otherwise
</del>
<ins class="diff-chg">member,
merge
each
of
its
values
into
the
</ins>
<code>
<del class="diff-old">xsd:boolean
.
</del>
<ins class="diff-chg">@type
</ins></code><ins class="diff-chg">
member
of
</ins><i><ins class="diff-chg">
node
</ins></i><ins class="diff-chg">
and
finally
remove
the
</ins><code><ins class="diff-chg">
@type
</ins></code><ins class="diff-chg">
member
from
</ins><i><ins class="diff-chg">
element
</ins></i><ins class="diff-chg">
;
the
resulting
</ins><a class="tref internalDFN" title="array" href="#dfn-array"><ins class="diff-chg">
array
</ins></a><ins class="diff-chg">
must
not
contain
any
duplicate
values.
</ins>
</li>
<li>
<del class="diff-old">Otherwise,
if
</del>
<ins class="diff-chg">If
</ins><i>
element
<del class="diff-old">contains
a
</del>
</i>
<ins class="diff-chg">has
an
</ins>
<code>
<del class="diff-old">@type
</del>
<ins class="diff-chg">@index
</ins>
</code>
<del class="diff-old">property,
</del>
<ins class="diff-chg">member,
</ins>
set
the
<del class="diff-old">active
object
</del>
<code>
<ins class="diff-chg">@index
</ins></code><ins class="diff-chg">
member
of
</ins><i><ins class="diff-chg">
node
</ins></i>
to
<ins class="diff-new">its
value.
If
</ins><a class="tref internalDFN" title="node" href="#dfn-node"><ins class="diff-new">
node
</ins></a><ins class="diff-new">
has
already
an
</ins><code><ins class="diff-new">
@index
</ins></code><ins class="diff-new">
member
with
</ins>
a
<del class="diff-old">typed
literal
.
</del>
<ins class="diff-chg">different
value,
a
</ins><code class="error"><a href="#idl-def-JsonLdErrorCode.conflicting-indexes"><ins class="diff-chg">
conflicting
indexes
</ins></a></code><ins class="diff-chg">
error
has
been
detected
and
processing
is
aborted.
Otherwise,
continue
by
removing
the
</ins><code><ins class="diff-chg">
@index
</ins></code><ins class="diff-chg">
member
from
</ins><i><ins class="diff-chg">
element
</ins></i>.
</li>
<li>
<del class="diff-old">Otherwise,
if
</del>
<ins class="diff-chg">If
</ins><i>
element
<del class="diff-old">contains
a
</del>
</i>
<ins class="diff-chg">has
an
</ins>
<code>
<del class="diff-old">@language
</del>
<ins class="diff-chg">@reverse
</ins>
</code>
<del class="diff-old">property,
set
the
active
</del>
<ins class="diff-chg">member:
</ins><ol class="algorithm"><li><ins class="diff-chg">
Create
a
</ins><a class="tref internalDFN" title="json-object" href="#dfn-json-object"><ins class="diff-chg">
JSON
</ins>
object
</a>
<del class="diff-old">to
</del>
<i>
<ins class="diff-chg">referenced
node
</ins></i><ins class="diff-chg">
with
</ins>
a
<del class="diff-old">language-tagged
literal
.
</del>
<ins class="diff-chg">single
member
</ins><code><ins class="diff-chg">
@id
</ins></code><ins class="diff-chg">
whose
value
is
</ins><i><ins class="diff-chg">
id
</ins></i>.
</li>
<li>
<del class="diff-old">Otherwise,
set
</del>
<ins class="diff-chg">Set
</ins><i><ins class="diff-chg">
reverse
map
</ins></i><ins class="diff-chg">
to
</ins>
the
<del class="diff-old">active
object
</del>
<ins class="diff-chg">value
of
the
</ins><code><ins class="diff-chg">
@reverse
</ins></code><ins class="diff-chg">
member
of
</ins><i><ins class="diff-chg">
element
</ins></i>.</li><li><ins class="diff-chg">
For
each
key-value
pair
</ins><i><ins class="diff-chg">
property
</ins></i><ins class="diff-chg">
-
</ins><i><ins class="diff-chg">
values
</ins></i><ins class="diff-chg">
in
</ins><i><ins class="diff-chg">
reverse
map
</ins></i>:<ol class="algorithm"><li><ins class="diff-chg">
For
each
</ins><i><ins class="diff-chg">
value
</ins></i><ins class="diff-chg">
of
</ins><i><ins class="diff-chg">
values
</ins></i>:<ol class="algorithm"><li><ins class="diff-chg">
If
</ins><i><ins class="diff-chg">
value
</ins></i><ins class="diff-chg">
has
a
</ins><i><ins class="diff-chg">
property
</ins></i><ins class="diff-chg">
member,
append
</ins><i><ins class="diff-chg">
referenced
node
</ins></i>
to
<ins class="diff-new">its
value;
otherwise
create
</ins>
a
<del class="diff-old">typed
literal
</del>
<i>
<ins class="diff-chg">property
</ins></i><ins class="diff-chg">
member
whose
value
is
an
</ins><a class="tref internalDFN" title="array" href="#dfn-array"><ins class="diff-chg">
array
</ins>
</a>
<del class="diff-old">using
</del>
<ins class="diff-chg">containing
</ins><i><ins class="diff-chg">
referenced
node
</ins></i>.</li><li><ins class="diff-chg">
Recursively
invoke
this
algorithm
passing
</ins><i><ins class="diff-chg">
value
</ins></i><ins class="diff-chg">
for
</ins><i><ins class="diff-chg">
element
</ins></i>,<i><ins class="diff-chg">
node
map
</ins></i>,<ins class="diff-chg">
and
</ins><a class="tref internalDFN" title="active-graph" href="#dfn-active-graph"><ins class="diff-chg">
active
graph
</ins></a>.</li></ol></li></ol></li><li><ins class="diff-chg">
Remove
the
</ins>
<code>
<del class="diff-old">xsd:string
</del>
<ins class="diff-chg">@reverse
</ins>
</code>
<del class="diff-old">as
the
datatype.
</del>
<ins class="diff-chg">member
from
</ins><i><ins class="diff-chg">
element
</ins></i>.
</li>
</ol>
</li>
<li>
If
<i>
element
</i>
has
<del class="diff-old">a
</del>
<ins class="diff-chg">an
</ins>
<code>
<del class="diff-old">@list
</del>
<ins class="diff-chg">@graph
</ins>
</code>
<del class="diff-old">property
the
value
must
be
an
array
.
Process
its
value
as
a
list
as
described
in
List
Conversion
using
</del>
<ins class="diff-chg">member,
recursively
invoke
this
algorithm
passing
</ins>
the
<del class="diff-old">return
</del>
value
<del class="diff-old">as
</del>
<ins class="diff-chg">of
</ins>
the
<code>
<ins class="diff-chg">@graph
</ins></code><ins class="diff-chg">
member
for
</ins><i><ins class="diff-chg">
element
</ins></i>,<i><ins class="diff-chg">
node
map
</ins></i>,<ins class="diff-chg">
and
</ins><i><ins class="diff-chg">
id
</ins></i><ins class="diff-chg">
for
</ins><a class="tref internalDFN" title="active-graph" href="#dfn-active-graph">
active
<del class="diff-old">object
</del>
<ins class="diff-chg">graph
</ins>
</a>
<ins class="diff-new">before
removing
the
</ins><code><ins class="diff-new">
@graph
</ins></code><ins class="diff-new">
member
from
</ins><i><ins class="diff-new">
element
</ins></i>.
</li>
<li>
<del class="diff-old">If
active
object
is
not
null
:
</del>
<ins class="diff-chg">Finally,
for
each
key-value
pair
</ins><i><ins class="diff-chg">
property
</ins></i><ins class="diff-chg">
-
</ins><i><ins class="diff-chg">
value
</ins></i><ins class="diff-chg">
in
</ins><i><ins class="diff-chg">
element
</ins></i><ins class="diff-chg">
ordered
by
</ins><i><ins class="diff-chg">
property
</ins></i><ins class="diff-chg">
perform
the
following
steps:
</ins>
<ol class="algorithm">
<li>
If
<del class="diff-old">neither
active
subject
nor
active
</del>
<i>
property
<del class="diff-old">are
null
</del>
</i>
<ins class="diff-chg">is
a
</ins><a class="tref internalDFN" title="blank-node-identifier" href="#dfn-blank-node-identifier"><ins class="diff-chg">
blank
node
identifier
</ins>
</a>,
<del class="diff-old">generate
</del>
<ins class="diff-chg">replace
it
with
</ins>
a
<del class="diff-old">Quad
</del>
<ins class="diff-chg">newly
</ins><a href="#generate-blank-node-identifier"><ins class="diff-chg">
generated
blank
node
identifier
</ins>
</a>
<del class="diff-old">representing
</del>
<ins class="diff-chg">passing
</ins><i><ins class="diff-chg">
property
</ins></i><ins class="diff-chg">
for
</ins><i><ins class="diff-chg">
identifier
</ins></i>.</li><li><ins class="diff-chg">
If
</ins><i><ins class="diff-chg">
node
</ins></i><ins class="diff-chg">
does
not
have
a
</ins><i><ins class="diff-chg">
property
</ins></i><ins class="diff-chg">
member,
create
one
and
initialize
its
value
to
an
empty
</ins><a class="tref internalDFN" title="array" href="#dfn-array"><ins class="diff-chg">
array
</ins></a>.</li><li><ins class="diff-chg">
Recursively
invoke
this
algorithm
passing
</ins><i><ins class="diff-chg">
value
</ins></i><ins class="diff-chg">
for
</ins><i><ins class="diff-chg">
element
</ins></i>,<i><ins class="diff-chg">
node
map
</ins></i>,<a class="tref internalDFN" title="active-graph" href="#dfn-active-graph">
active
<del class="diff-old">subject
</del>
<ins class="diff-chg">graph
</ins>
</a>,
<i>
<ins class="diff-chg">id
</ins></i><ins class="diff-chg">
for
</ins><a class="tref internalDFN" title="active-subject" href="#dfn-active-subject">
active
<del class="diff-old">property
</del>
<ins class="diff-chg">subject
</ins>
</a>,
<i>
<ins class="diff-chg">property
</ins></i><ins class="diff-chg">
for
</ins><a class="tref internalDFN" title="active-property" href="#dfn-active-property">
active
<del class="diff-old">object
</del>
<ins class="diff-chg">property
</ins>
</a>,
and
<del class="diff-old">graph
name
.
</del>
<i>
<ins class="diff-chg">list
</ins></i>.
</li>
<del class="diff-old">Return
active
object
.
</del>
</ol>
</li>
</ol>
</li>
<del class="diff-old">If
</del>
</ol>
</section>
</section>
<section id="generate-blank-node-identifier">
<h3>
<span class="secno">
<ins class="diff-chg">9.3
</ins></span><ins class="diff-chg">
Generate
Blank
Node
Identifier
</ins></h3><p><ins class="diff-chg">
This
algorithm
is
used
to
generate
new
</ins><a class="tref internalDFN" title="blank-node-identifier" href="#dfn-blank-node-identifier"><ins class="diff-chg">
blank
node
identifiers
</ins></a><ins class="diff-chg">
or
to
relabel
an
existing
</ins><a class="tref internalDFN" title="blank-node-identifier" href="#dfn-blank-node-identifier"><ins class="diff-chg">
blank
node
identifier
</ins></a><ins class="diff-chg">
to
avoid
collision
by
the
introduction
of
new
ones.
</ins></p><section class="informative"><h4 id="general-solution-12"><ins class="diff-chg">
General
Solution
</ins></h4><p>
<em>
<del class="diff-old">element
</del>
<ins class="diff-chg">This
section
is
non-normative.
</ins>
</em>
<del class="diff-old">has
</del>
</p>
<p>
<ins class="diff-chg">The
simplest
case
is
if
there
exists
already
</ins>
a
<del class="diff-old">@id
property,
</del>
<a class="tref internalDFN" title="blank-node-identifier" href="#dfn-blank-node-identifier">
<ins class="diff-chg">blank
node
identifier
</ins></a><ins class="diff-chg">
in
</ins>
the
<del class="diff-old">value
must
be
</del>
<i>
<ins class="diff-chg">identifier
map
</ins></i><ins class="diff-chg">
for
the
passed
</ins><i><ins class="diff-chg">
identifier
</ins></i>,<ins class="diff-chg">
in
which
case
it
is
simply
returned.
Otherwise,
</ins>
a
<ins class="diff-chg">new
</ins><a class="tref internalDFN" title="blank-node-identifier" href="#dfn-blank-node-identifier"><ins class="diff-chg">
blank
node
identifier
</ins></a><ins class="diff-chg">
is
generated
by
concatenating
the
</ins>
string
<code>
<ins class="diff-new">_:b
</ins></code><ins class="diff-new">
and
the
</ins><i><ins class="diff-new">
counter
</ins></i>.<ins class="diff-new">
If
the
passed
</ins><i><ins class="diff-new">
identifier
</ins></i><ins class="diff-new">
is
not
</ins><a class="tref internalDFN" title="null" href="#dfn-null"><ins class="diff-new">
null
</ins>
</a>,
<del class="diff-old">set
</del>
<ins class="diff-chg">an
entry
is
created
in
</ins>
the
<del class="diff-old">active
subject
</del>
<i>
<ins class="diff-chg">identifier
map
</ins></i><ins class="diff-chg">
associating
the
</ins><i><ins class="diff-chg">
identifier
</ins></i><ins class="diff-chg">
with
the
</ins><a class="tref internalDFN" title="blank-node-identifier" href="#dfn-blank-node-identifier"><ins class="diff-chg">
blank
node
identifier
</ins></a>.<ins class="diff-chg">
Finally,
the
</ins><i><ins class="diff-chg">
counter
</ins></i><ins class="diff-chg">
is
increased
by
one
and
the
new
</ins><a class="tref internalDFN" title="blank-node-identifier" href="#dfn-blank-node-identifier"><ins class="diff-chg">
blank
node
identifier
</ins>
</a>
<ins class="diff-new">is
returned.
</ins></p></section><section><h4 id="algorithm-12"><ins class="diff-new">
Algorithm
</ins></h4><p><ins class="diff-new">
The
algorithm
takes
a
single
input
variable
</ins><i><ins class="diff-new">
identifier
</ins></i><ins class="diff-new">
which
may
be
</ins><a class="tref internalDFN" title="null" href="#dfn-null"><ins class="diff-new">
null
</ins></a>.<ins class="diff-new">
Between
its
executions,
the
algorithm
needs
to
keep
an
</ins><i><ins class="diff-new">
identifier
map
</ins></i>
to
<ins class="diff-new">relabel
existing
</ins><a class="tref internalDFN" title="blank-node-identifier" href="#dfn-blank-node-identifier"><ins class="diff-new">
blank
node
identifiers
</ins></a><ins class="diff-new">
consistently
and
a
</ins><i><ins class="diff-new">
counter
</ins></i><ins class="diff-new">
to
generate
new
</ins><a class="tref internalDFN" title="blank-node-identifier" href="#dfn-blank-node-identifier"><ins class="diff-new">
blank
node
identifiers
</ins></a>.<ins class="diff-new">
The
</ins><i><ins class="diff-new">
counter
</ins></i><ins class="diff-new">
is
initialized
to
</ins><code><ins class="diff-new">
0
</ins></code><ins class="diff-new">
by
default.
</ins></p><ol class="algorithm"><li><ins class="diff-new">
If
</ins><i><ins class="diff-new">
identifier
</ins></i><ins class="diff-new">
is
not
</ins><a class="tref internalDFN" title="null" href="#dfn-null"><ins class="diff-new">
null
</ins></a><ins class="diff-new">
and
has
an
entry
in
</ins>
the
<del class="diff-old">previously
expanded
value
(either
</del>
<i>
<ins class="diff-chg">identifier
map
</ins></i>,<ins class="diff-chg">
return
the
mapped
identifier.
</ins></li><li><ins class="diff-chg">
Otherwise,
generate
</ins>
a
<ins class="diff-chg">new
</ins><a class="tref internalDFN" title="blank-node-identifier" href="#dfn-blank-node-identifier">
blank
node
<ins class="diff-new">identifier
</ins>
</a>
<del class="diff-old">or
</del>
<ins class="diff-chg">by
concatenating
the
string
</ins><code><ins class="diff-chg">
_:b
</ins></code><ins class="diff-chg">
and
</ins><i><ins class="diff-chg">
counter
</ins></i>.</li><li><ins class="diff-chg">
Increment
</ins><i><ins class="diff-chg">
counter
</ins></i><ins class="diff-chg">
by
</ins><code><ins class="diff-chg">
1
</ins></code>.</li><li><ins class="diff-chg">
If
</ins><i><ins class="diff-chg">
identifier
</ins></i><ins class="diff-chg">
is
not
</ins><a class="tref internalDFN" title="null" href="#dfn-null"><ins class="diff-chg">
null
</ins></a>,<ins class="diff-chg">
create
a
new
entry
for
</ins><i><ins class="diff-chg">
identifier
</ins></i><ins class="diff-chg">
in
</ins><i><ins class="diff-chg">
identifier
map
</ins></i><ins class="diff-chg">
and
set
its
value
to
the
new
</ins><a class="tref internalDFN" title="blank-node-identifier" href="#dfn-blank-node-identifier"><ins class="diff-chg">
blank
node
identifier
</ins></a>.</li><li><ins class="diff-chg">
Return
the
new
</ins><a class="tref internalDFN" title="blank-node-identifier" href="#dfn-blank-node-identifier"><ins class="diff-chg">
blank
node
identifier
</ins></a>.</li></ol></section></section></section><section id="rdf-conversion-algorithms"><h2><span class="secno"><ins class="diff-chg">
10.
</ins></span><ins class="diff-chg">
RDF
Conversion
Algorithms
</ins></h2><p><ins class="diff-chg">
This
section
describes
algorithms
to
transform
a
JSON-LD
document
to
</ins>
an
<a class="tref internalDFN" title="rdf-dataset" href="#dfn-rdf-dataset">
<ins class="diff-chg">RDF
dataset
</ins></a><ins class="diff-chg">
and
vice
versa.
The
algorithms
are
designed
for
in-memory
implementations
with
random
access
to
</ins><a class="tref internalDFN" title="json-object" href="#dfn-json-object"><ins class="diff-chg">
JSON
object
</ins></a><ins class="diff-chg">
elements.
</ins></p><p><ins class="diff-chg">
Throughout
this
section,
the
following
vocabulary
</ins><a class="tref internalDFN" title="prefix" href="#dfn-prefix"><ins class="diff-chg">
prefixes
</ins></a><ins class="diff-chg">
are
used
in
</ins><a class="tref internalDFN" title="compact-iri" href="#dfn-compact-iri"><ins class="diff-chg">
compact
IRIs
</ins></a>:</p><table rules="all"><thead><tr>
<th>
<ins class="diff-chg">Prefix
</ins></th><th>
<abbr title="Internationalized Resource Identifier">
IRI
</abbr>
</th>
</tr>
</thead>
<tbody>
<tr>
<td>
<ins class="diff-chg">rdf
</ins></td><td><ins class="diff-chg">
http://www.w3.org/1999/02/22-rdf-syntax-ns#
</ins></td></tr><tr><td><ins class="diff-chg">
rdfs
</ins></td><td><ins class="diff-chg">
http://www.w3.org/2000/01/rdf-schema#
</ins></td></tr><tr><td><ins class="diff-chg">
xsd
</ins></td><td><ins class="diff-chg">
http://www.w3.org/2001/XMLSchema#
</ins></td></tr></tbody></table><section id="convert-to-rdf-algorithm"><h3><span class="secno"><ins class="diff-chg">
10.1
</ins></span><ins class="diff-chg">
Convert
to
RDF
Algorithm
</ins></h3><p><ins class="diff-chg">
This
algorithms
converts
a
JSON-LD
document
to
an
</ins><a class="tref internalDFN" title="rdf-dataset" href="#dfn-rdf-dataset"><ins class="diff-chg">
RDF
dataset
</ins></a>.</p><div class="issue"><div class="issue-title"><a href="https://github.com/json-ld/json-ld.org/issues/217"><span><ins class="diff-chg">
Issue
217
</ins></span>
</a>
<del class="diff-old">).
Otherwise,
if
element
</del>
</div>
<p class="">
<ins class="diff-chg">RDF
</ins>
does
not
<del class="diff-old">have
</del>
<ins class="diff-chg">currently
allow
a
</ins><a class="tref internalDFN" title="blank-node-identifier" href="#dfn-blank-node-identifier"><ins class="diff-chg">
blank
node
identifier
</ins></a><ins class="diff-chg">
to
be
used
as
</ins>
a
<a class="tref internalDFN" title="graph-name" href="#dfn-graph-name">
<ins class="diff-new">graph
name
</ins></a>.</p></div><section class="informative"><h4 id="general-solution-13"><ins class="diff-new">
General
Solution
</ins></h4><p><em><ins class="diff-new">
This
section
is
non-normative.
</ins></em></p><p><ins class="diff-new">
The
JSON-LD
document
is
expanded
and
converted
to
a
</ins><i><ins class="diff-new">
node
map
</ins></i><ins class="diff-new">
using
the
</ins><a href="#node-map-generation"><ins class="diff-new">
Node
Map
Generation
algorithm
</ins></a>.<ins class="diff-new">
This
allows
each
graph
represented
within
the
document
to
be
extracted
and
flattened,
making
it
easier
to
process
each
</ins><a class="tref internalDFN" title="node-object" href="#dfn-node-object"><ins class="diff-new">
node
object
</ins></a>.<ins class="diff-new">
Each
graph
from
the
</ins><i><ins class="diff-new">
node
map
</ins></i><ins class="diff-new">
is
processed
to
extract
</ins><a class="tref internalDFN" title="rdf-triple" href="#dfn-rdf-triple"><ins class="diff-new">
RDF
triples
</ins></a>,<ins class="diff-new">
to
which
any
(non-default)
graph
name
is
applied
to
create
an
</ins><a class="tref internalDFN" title="rdf-dataset" href="#dfn-rdf-dataset"><ins class="diff-new">
RDF
dataset
</ins></a>.<ins class="diff-new">
Each
</ins><a class="tref internalDFN" title="node-object" href="#dfn-node-object"><ins class="diff-new">
node
object
</ins></a><ins class="diff-new">
in
the
</ins><i><ins class="diff-new">
node
map
</ins></i><ins class="diff-new">
has
an
</ins>
<code>
@id
</code>
<del class="diff-old">property,
set
</del>
<ins class="diff-chg">member
which
corresponds
to
</ins>
the
<del class="diff-old">active
</del>
<a class="tref internalDFN" title="rdf-subject" href="#dfn-rdf-subject">
<ins class="diff-chg">RDF
</ins>
subject
</a>,
<ins class="diff-new">the
other
members
represent
</ins><a class="tref internalDFN" title="rdf-predicate" href="#dfn-rdf-predicate"><ins class="diff-new">
RDF
predicates
</ins></a>.<ins class="diff-new">
Each
member
value
is
either
an
</ins><a class="tref internalDFN" title="iri" href="#dfn-iri"><abbr title="Internationalized Resource Identifier"><ins class="diff-new">
IRI
</ins></abbr>
</a>
<del class="diff-old">to
newly
generated
</del>
<ins class="diff-chg">or
</ins><a class="tref internalDFN" title="blank-node-identifier" href="#dfn-blank-node-identifier">
blank
node
<ins class="diff-new">identifier
</ins></a><ins class="diff-new">
or
can
be
transformed
to
an
</ins><a class="tref externalDFN" title="rdf-literal" href="http://www.w3.org/TR/rdf11-concepts/#dfn-literal"><ins class="diff-new">
RDF
literal
</ins></a><ins class="diff-new">
to
generate
an
</ins><a class="tref internalDFN" title="rdf-triple" href="#dfn-rdf-triple"><ins class="diff-new">
RDF
triple
</ins></a>.<a class="tref internalDFN" title="list" href="#dfn-list"><ins class="diff-new">
Lists
</ins></a><ins class="diff-new">
are
transformed
into
an
</ins><a class="tref externalDFN" title="rdf-collection" href="http://www.w3.org/TR/rdf-schema/#ch_collectionvocab"><ins class="diff-new">
RDF
Collection
</ins></a><ins class="diff-new">
using
the
</ins><a href="#list-to-rdf-conversion"><ins class="diff-new">
List
to
RDF
Conversion
algorithm.
</ins></a></p></section><section><h4 id="algorithm-13"><ins class="diff-new">
Algorithm
</ins></h4><p><ins class="diff-new">
The
algorithm
takes
a
JSON-LD
document
</ins><i><ins class="diff-new">
element
</ins></i><ins class="diff-new">
and
returns
an
</ins><a class="tref internalDFN" title="rdf-dataset" href="#dfn-rdf-dataset"><ins class="diff-new">
RDF
dataset
</ins></a>.</p><ol class="algorithm"><li><ins class="diff-new">
Expand
</ins><i><ins class="diff-new">
element
</ins></i><ins class="diff-new">
according
the
</ins><a href="#expansion-algorithm"><ins class="diff-new">
Expansion
algorithm
</ins></a>.</li><li><ins class="diff-new">
Generate
a
</ins><i><ins class="diff-new">
node
map
</ins></i><ins class="diff-new">
according
the
</ins><a href="#node-map-generation"><ins class="diff-new">
Node
Map
Generation
algorithm
</ins>
</a>.
</li>
<li>
<del class="diff-old">Process
</del>
<ins class="diff-chg">Initialize
an
empty
</ins><a class="tref internalDFN" title="rdf-dataset" href="#dfn-rdf-dataset"><ins class="diff-chg">
RDF
dataset
</ins></a><i><ins class="diff-chg">
dataset
</ins></i>.</li><li><ins class="diff-chg">
For
</ins>
each
<del class="diff-old">property
</del>
<i>
<ins class="diff-chg">graph
name
</ins></i>
and
<del class="diff-old">value
</del>
<i>
<ins class="diff-chg">graph
</ins></i>
in
<del class="diff-old">element
,
ordered
by
property
,
</del>
<i>
<ins class="diff-chg">node
map
</ins></i>:<ol class="algorithm"><li><ins class="diff-chg">
Initialize
</ins><i><ins class="diff-chg">
triples
</ins></i>
as
<del class="diff-old">follows:
</del>
<ins class="diff-chg">an
empty
</ins><a class="tref internalDFN" title="array" href="#dfn-array"><ins class="diff-chg">
array
</ins></a>.</li><li><ins class="diff-chg">
For
each
</ins><i><ins class="diff-chg">
subject
</ins></i><ins class="diff-chg">
and
</ins><i><ins class="diff-chg">
node
</ins></i><ins class="diff-chg">
in
</ins><i><ins class="diff-chg">
graph
</ins></i>:<ol class="algorithm"><li><ins class="diff-chg">
For
each
</ins><i><ins class="diff-chg">
property
</ins></i><ins class="diff-chg">
and
</ins><i><ins class="diff-chg">
values
</ins></i><ins class="diff-chg">
in
</ins><i><ins class="diff-chg">
node
</ins></i>:
<ol class="algorithm">
<li>
If
<i>
property
</i>
is
<code>
@type
</code>,
<del class="diff-old">set
the
active
property
</del>
<ins class="diff-chg">then
for
each
</ins><i><ins class="diff-chg">
type
</ins></i><ins class="diff-chg">
in
</ins><i><ins class="diff-chg">
values
</ins></i>,<ins class="diff-chg">
append
a
</ins><a class="tref internalDFN" title="triple" href="http://www.w3.org/TR/rdf11-concepts/#dfn-rdf-triple"><ins class="diff-chg">
triple
</ins>
</a>
<del class="diff-old">to
</del>
<ins class="diff-chg">composed
of
</ins><i><ins class="diff-chg">
subject
</ins></i>,
<code>
rdf:type
<del class="diff-old">.
Otherwise,
if
property
is
@graph
</del>
</code>,
<del class="diff-old">process
value
algorithm
recursively,
using
active
subject
as
graph
name
</del>
and
<del class="diff-old">null
values
for
active
subject
and
active
property
and
then
proceed
</del>
<i>
<ins class="diff-chg">type
</ins></i>
to
<del class="diff-old">next
property.
</del>
<i>
<ins class="diff-chg">triples
</ins></i>.
</li>
<li>
Otherwise,
if
<i>
property
</i>
is
a
<a class="tref internalDFN" title="keyword" href="#dfn-keyword">
keyword
<del class="diff-old">,
skip
this
step.
</del>
</a>
<ins class="diff-chg">continue
to
the
next
</ins><i><ins class="diff-chg">
property
</ins></i><ins class="diff-chg">
-
</ins><i><ins class="diff-chg">
values
</ins></i><ins class="diff-chg">
pair.
</ins>
</li>
<li>
Otherwise,
<del class="diff-old">set
active
</del>
<i>
property
<del class="diff-old">to
the
</del>
</i>
<ins class="diff-chg">is
an
</ins><a class="tref internalDFN" title="iri" href="#dfn-iri">
<abbr title="Internationalized Resource Identifier">
IRI
</abbr>
</a>
<ins class="diff-new">or
</ins><a class="tref internalDFN" title="blank-node-identifier" href="#dfn-blank-node-identifier"><ins class="diff-new">
blank
node
identifier
</ins></a>.<ins class="diff-new">
For
each
</ins><i><ins class="diff-new">
item
</ins></i><ins class="diff-new">
in
</ins><i><ins class="diff-new">
values
</ins></i>:<ol class="algorithm"><li><ins class="diff-new">
If
</ins><i><ins class="diff-new">
item
</ins></i><ins class="diff-new">
is
a
</ins><a class="tref internalDFN" title="list-object" href="#dfn-list-object"><ins class="diff-new">
list
object
</ins></a>,<ins class="diff-new">
initialize
</ins><i><ins class="diff-new">
list
triples
</ins></i><ins class="diff-new">
as
an
empty
</ins><a class="tref internalDFN" title="array" href="#dfn-array"><ins class="diff-new">
array
</ins></a><ins class="diff-new">
and
</ins><i><ins class="diff-new">
list
head
</ins></i><ins class="diff-new">
to
the
result
of
the
</ins><a href="#list-to-rdf-conversion"><ins class="diff-new">
List
Conversion
algorithm
</ins></a>,<ins class="diff-new">
passing
the
</ins>
value
<ins class="diff-new">associated
with
the
</ins><code><ins class="diff-new">
@list
</ins></code><ins class="diff-new">
key
from
</ins><i><ins class="diff-new">
item
</ins></i><ins class="diff-new">
and
</ins><i><ins class="diff-new">
list
triples
</ins></i>.<ins class="diff-new">
Append
first
a
</ins><a class="tref internalDFN" title="triple" href="http://www.w3.org/TR/rdf11-concepts/#dfn-rdf-triple"><ins class="diff-new">
triple
</ins></a><ins class="diff-new">
composed
</ins>
of
<i>
<ins class="diff-chg">subject
</ins></i>,<i>
property
<del class="diff-old">.
</del>
</i>,
<ins class="diff-chg">and
</ins><i><ins class="diff-chg">
list
head
</ins></i><ins class="diff-chg">
to
</ins><i><ins class="diff-chg">
triples
</ins></i><ins class="diff-chg">
and
finally
append
all
</ins><a class="tref internalDFN" title="triple" href="http://www.w3.org/TR/rdf11-concepts/#dfn-rdf-triple"><ins class="diff-chg">
triples
</ins></a><ins class="diff-chg">
from
</ins><i><ins class="diff-chg">
list
triples
</ins></i><ins class="diff-chg">
to
</ins><i><ins class="diff-chg">
triples
</ins></i>.
</li>
<li>
<del class="diff-old">Process
</del>
<ins class="diff-chg">Otherwise,
</ins><i><ins class="diff-chg">
item
</ins></i><ins class="diff-chg">
is
a
</ins><a class="tref internalDFN" title="value-object" href="#dfn-value-object">
value
<del class="diff-old">recursively
using
this
algorithm,
passing
copies
</del>
<ins class="diff-chg">object
</ins></a><ins class="diff-chg">
or
a
</ins><a class="tref internalDFN" title="node-object" href="#dfn-node-object"><ins class="diff-chg">
node
object
</ins></a>.<ins class="diff-chg">
Append
a
</ins><a class="tref internalDFN" title="triple" href="http://www.w3.org/TR/rdf11-concepts/#dfn-rdf-triple"><ins class="diff-chg">
triple
</ins></a><ins class="diff-chg">
composed
</ins>
of
<del class="diff-old">active
</del>
<i>
subject
<del class="diff-old">,
active
</del>
</i>,
<i>
property
</i>,
and
<del class="diff-old">graph
name
.
</del>
<ins class="diff-chg">the
result
of
using
the
</ins><a href="#object-to-rdf-conversion"><ins class="diff-chg">
Object
to
RDF
Conversion
algorithm
</ins></a><ins class="diff-chg">
passing
</ins><i><ins class="diff-chg">
item
</ins></i><ins class="diff-chg">
to
</ins><i><ins class="diff-chg">
triples
</ins></i>.
</li>
</ol>
</li>
<del class="diff-old">Set
active
object
to
active
subject
.
</del>
</ol>
</li>
</ol>
</li>
<li>
<del class="diff-old">Otherwise,
if
element
</del>
<ins class="diff-chg">If
</ins><i><ins class="diff-chg">
graph
name
</ins></i>
is
<del class="diff-old">an
array
,
process
each
value
in
</del>
<code>
<ins class="diff-chg">@default
</ins></code>,<ins class="diff-chg">
add
</ins><i><ins class="diff-chg">
triples
</ins></i><ins class="diff-chg">
to
</ins>
the
<del class="diff-old">array
</del>
<a class="tref internalDFN" title="default-graph" href="#dfn-default-graph">
<ins class="diff-chg">default
graph
</ins>
</a>
<del class="diff-old">as
follows,
process
element
recursively
using
this
algorithm,
using
copies
</del>
<ins class="diff-chg">in
</ins><i><ins class="diff-chg">
dataset
</ins></i>.</li><li><ins class="diff-chg">
Otherwise,
create
a
</ins><a class="tref internalDFN" title="named-graph" href="#dfn-named-graph"><ins class="diff-chg">
named
graph
</ins></a><ins class="diff-chg">
in
</ins><i><ins class="diff-chg">
dataset
</ins></i><ins class="diff-chg">
composed
</ins>
of
<del class="diff-old">active
subject
,
active
property
,
and
</del>
<i>
graph
name
<del class="diff-old">.
</del>
</i>
<ins class="diff-chg">and
add
</ins><i><ins class="diff-chg">
triples
</ins></i>.</li></ol>
</li>
<li>
<del class="diff-old">Otherwise,
if
element
is
</del>
<ins class="diff-chg">Return
</ins><i><ins class="diff-chg">
dataset
</ins></i>.</li></ol></section></section><section id="object-to-rdf-conversion"><h3><span class="secno"><ins class="diff-chg">
10.2
</ins></span><ins class="diff-chg">
Object
to
RDF
Conversion
</ins></h3><p><ins class="diff-chg">
This
algorithm
takes
</ins>
a
<del class="diff-old">string
,
then
the
active
property
</del>
<a class="tref internalDFN" title="node-object" href="#dfn-node-object">
<ins class="diff-chg">node
object
</ins>
</a>
<del class="diff-old">must
</del>
<ins class="diff-chg">or
</ins><a class="tref internalDFN" title="value-object" href="#dfn-value-object"><ins class="diff-chg">
value
object
</ins></a><ins class="diff-chg">
and
transforms
it
into
an
</ins><a class="tref externalDFN" title="rdf-resource" href="http://www.w3.org/TR/rdf11-concepts/#dfn-resource"><ins class="diff-chg">
RDF
resource
</ins></a><ins class="diff-chg">
to
</ins>
be
<del class="diff-old">rdf:type
so
set
</del>
<ins class="diff-chg">used
as
</ins>
the
<del class="diff-old">active
</del>
<a class="tref internalDFN" title="object" href="http://www.w3.org/TR/rdf11-concepts/#dfn-object">
object
</a>
<del class="diff-old">to
</del>
<ins class="diff-chg">of
</ins>
an
<a class="tref internalDFN" title="rdf-triple" href="#dfn-rdf-triple">
<ins class="diff-chg">RDF
triple
</ins></a>.</p><section class="informative"><h4 id="general-solution-14"><ins class="diff-chg">
General
Solution
</ins></h4>
<p>
<em>
<ins class="diff-chg">This
section
is
non-normative.
</ins></em></p><p><a class="tref internalDFN" title="value-object" href="#dfn-value-object"><ins class="diff-chg">
Value
objects
</ins></a><ins class="diff-chg">
are
transformed
to
</ins><a class="tref internalDFN" title="rdf-literal" href="http://www.w3.org/TR/rdf11-concepts/#dfn-literal"><ins class="diff-chg">
RDF
literals
</ins></a><ins class="diff-chg">
as
defined
in
the
section
</ins><a href="#data-round-tripping"><ins class="diff-chg">
Data
Round
Tripping
</ins></a><ins class="diff-chg">
whereas
</ins><a class="tref internalDFN" title="node-object" href="#dfn-node-object"><ins class="diff-chg">
node
objects
</ins></a><ins class="diff-chg">
are
transformed
to
</ins><a class="tref internalDFN" title="iri" href="#dfn-iri"><ins class="diff-chg">
IRIs
</ins></a><ins class="diff-chg">
or
</ins><a class="tref internalDFN" title="blank-node-identifier" href="#dfn-blank-node-identifier"><ins class="diff-chg">
blank
node
identifiers
</ins></a>.</p></section><section><h4 id="algorithm-14"><ins class="diff-chg">
Algorithm
</ins></h4><p><ins class="diff-chg">
The
algorithm
takes
as
its
sole
argument
</ins><i><ins class="diff-chg">
item
</ins></i><ins class="diff-chg">
which
must
be
either
a
</ins><a class="tref internalDFN" title="value-object" href="#dfn-value-object"><ins class="diff-chg">
value
object
</ins></a><ins class="diff-chg">
or
</ins><a class="tref internalDFN" title="node-object" href="#dfn-node-object"><ins class="diff-chg">
node
object
</ins></a>.</p><ol class="algorithm"><li><ins class="diff-chg">
If
</ins><i><ins class="diff-chg">
item
</ins></i><ins class="diff-chg">
is
a
</ins><a class="tref internalDFN" title="node-object" href="#dfn-node-object"><ins class="diff-chg">
node
object
</ins></a><ins class="diff-chg">
return
the
</ins><a class="tref internalDFN" title="iri" href="#dfn-iri">
<abbr title="Internationalized Resource Identifier">
IRI
</abbr>
</a>
<ins class="diff-new">or
</ins><a class="tref internalDFN" title="blank-node-identifier" href="#dfn-blank-node-identifier"><ins class="diff-new">
blank
node
identifier
</ins></a><ins class="diff-new">
associated
with
its
</ins><code><ins class="diff-new">
@id
</ins>
</code>
<ins class="diff-chg">member.
</ins></li><li><ins class="diff-chg">
Otherwise,
</ins><i><ins class="diff-chg">
item
</ins></i><ins class="diff-chg">
is
a
</ins><a class="tref internalDFN" title="value-object" href="#dfn-value-object"><ins class="diff-chg">
value
object
</ins>
</a>.
<ins class="diff-new">Initialize
</ins><i><ins class="diff-new">
value
</ins></i><ins class="diff-new">
to
the
value
associated
with
the
</ins><code><ins class="diff-new">
@value
</ins></code><ins class="diff-new">
member
in
</ins><i><ins class="diff-new">
item
</ins></i>.
</li>
<li>
<del class="diff-old">If
any
</del>
<ins class="diff-chg">Initialize
</ins><i><ins class="diff-chg">
datatype
</ins></i><ins class="diff-chg">
to
the
value
associated
with
the
</ins><code><ins class="diff-chg">
@type
</ins></code><ins class="diff-chg">
member
</ins>
of
<del class="diff-old">these
steps
created
an
active
object
</del>
<i>
<ins class="diff-chg">item
</ins></i><ins class="diff-chg">
or
</ins><code><ins class="diff-chg">
null
</ins></code><ins class="diff-chg">
if
</ins><i><ins class="diff-chg">
item
</ins></i><ins class="diff-chg">
does
not
have
such
a
member.
</ins></li><li><ins class="diff-chg">
If
</ins><i><ins class="diff-chg">
value
</ins></i><ins class="diff-chg">
is
</ins><a class="tref internalDFN" title="true" href="#dfn-true"><ins class="diff-chg">
true
</ins>
</a>
<del class="diff-old">and
neither
active
subject
</del>
<ins class="diff-chg">or
</ins><a class="tref internalDFN" title="false" href="#dfn-false"><ins class="diff-chg">
false
</ins></a>,<ins class="diff-chg">
set
</ins><i><ins class="diff-chg">
value
</ins></i><ins class="diff-chg">
to
its
</ins><a class="tref internalDFN" title="canonical-lexical-form" href="#dfn-canonical-lexical-form"><ins class="diff-chg">
canonical
lexical
form
</ins>
</a>
<del class="diff-old">nor
active
property
</del>
<ins class="diff-chg">as
defined
in
the
section
</ins><a href="#data-round-tripping"><ins class="diff-chg">
Data
Round
Tripping
</ins></a>.<ins class="diff-chg">
If
</ins><i><ins class="diff-chg">
datatype
</ins></i><ins class="diff-chg">
is
</ins><a class="tref internalDFN" title="null" href="#dfn-null"><ins class="diff-chg">
null
</ins></a>,<ins class="diff-chg">
set
it
to
</ins><code><ins class="diff-chg">
xsd:boolean
</ins></code>.</li><li><ins class="diff-chg">
Otherwise,
if
</ins><i><ins class="diff-chg">
value
</ins></i><ins class="diff-chg">
is
a
</ins><a class="tref internalDFN" title="number" href="#dfn-number"><ins class="diff-chg">
number
</ins></a>,<ins class="diff-chg">
then
set
</ins><i><ins class="diff-chg">
value
</ins></i><ins class="diff-chg">
to
its
</ins><a class="tref internalDFN" title="canonical-lexical-form" href="#dfn-canonical-lexical-form"><ins class="diff-chg">
canonical
lexical
form
</ins>
</a>
<del class="diff-old">are
</del>
<ins class="diff-chg">as
defined
in
the
section
</ins><a href="#data-round-tripping"><ins class="diff-chg">
Data
Round
Tripping
</ins></a>.<ins class="diff-chg">
If
</ins><i><ins class="diff-chg">
datatype
</ins></i><ins class="diff-chg">
is
</ins>
<a class="tref internalDFN" title="null" href="#dfn-null">
null
</a>,
<del class="diff-old">generate
</del>
<ins class="diff-chg">set
it
to
either
</ins><code><ins class="diff-chg">
xsd:integer
</ins></code><ins class="diff-chg">
or
</ins><code><ins class="diff-chg">
xsd:double
</ins></code>,<ins class="diff-chg">
depending
on
if
the
value
contains
</ins>
a
<ins class="diff-chg">fractional
and/or
an
exponential
component.
</ins></li><li><ins class="diff-chg">
Otherwise,
if
</ins><i><ins class="diff-chg">
datatype
</ins></i><ins class="diff-chg">
is
</ins><a class="tref internalDFN" title="null" href="#dfn-null"><ins class="diff-chg">
null
</ins></a>,<ins class="diff-chg">
set
it
to
</ins>
<code>
<del class="diff-old">Quad
</del>
<ins class="diff-chg">xsd:string
</ins>
</code>
<ins class="diff-chg">or
</ins><code><ins class="diff-chg">
rdf:langString
</ins></code>,<ins class="diff-chg">
depending
on
if
item
has
an
</ins><code><ins class="diff-chg">
@language
</ins></code><ins class="diff-chg">
member.
</ins></li><li><ins class="diff-chg">
Initialize
</ins><i><ins class="diff-chg">
literal
</ins></i><ins class="diff-chg">
as
an
</ins><a class="tref internalDFN" title="rdf-literal" href="http://www.w3.org/TR/rdf11-concepts/#dfn-literal"><ins class="diff-chg">
RDF
literal
</ins>
</a>
using
<del class="diff-old">active
subject
,
active
property
,
active
object
</del>
<i>
<ins class="diff-chg">value
</ins></i>
and
<del class="diff-old">graph
name
.
</del>
<i>
<ins class="diff-chg">datatype
</ins></i>.<ins class="diff-chg">
If
</ins><i><ins class="diff-chg">
item
</ins></i><ins class="diff-chg">
has
an
</ins><code><ins class="diff-chg">
@language
</ins></code><ins class="diff-chg">
member
and
</ins><i><ins class="diff-chg">
datatype
</ins></i><ins class="diff-chg">
is
</ins><code><ins class="diff-chg">
rdf:langString
</ins></code>,<ins class="diff-chg">
then
add
the
value
associated
with
the
</ins><code><ins class="diff-chg">
@language
</ins></code><ins class="diff-chg">
key
as
the
language
of
</ins><i><ins class="diff-chg">
literal
</ins></i>.
</li>
<li>
Return
<del class="diff-old">active
object
.
</del>
<i>
<ins class="diff-chg">literal
</ins></i>.
</li>
</ol>
</section>
</section>
<section id="list-to-rdf-conversion">
<h3>
<span class="secno">
<del class="diff-old">4.9.4
</del>
<ins class="diff-chg">10.3
</ins>
</span>
List
<ins class="diff-new">to
RDF
</ins>
Conversion
</h3>
<p>
List
Conversion
is
the
process
of
taking
<del class="diff-old">an
array
</del>
<ins class="diff-chg">a
</ins><a class="tref internalDFN" title="list-object" href="#dfn-list-object"><ins class="diff-chg">
list
object
</ins>
</a>
<del class="diff-old">of
values
</del>
and
<del class="diff-old">adding
them
to
a
newly
created
</del>
<ins class="diff-chg">transforming
it
into
an
</ins><a class="tref externalDFN" title="rdf-collection" href="http://www.w3.org/TR/rdf-schema/#ch_collectionvocab">
RDF
Collection
</a>
<del class="diff-old">(see
</del>
<ins class="diff-chg">as
defined
in
RDF
Semantics
</ins>
[
<cite>
<del class="diff-old">RDF-SCHEMA
</del>
<a class="bibref" href="#bib-RDF-MT">
<ins class="diff-chg">RDF-MT
</ins>
</a>
</cite>
<del class="diff-old">])
by
linking
</del>
<ins class="diff-chg">].
</ins></p><section class="informative"><h4 id="general-solution-15"><ins class="diff-chg">
General
Solution
</ins></h4><p><em><ins class="diff-chg">
This
section
is
non-normative.
</ins></em></p><p><ins class="diff-chg">
For
</ins>
each
element
of
the
<a class="tref internalDFN" title="list" href="#dfn-list">
list
<del class="diff-old">using
</del>
</a>
<ins class="diff-chg">a
new
</ins><a class="tref internalDFN" title="blank-node-identifier" href="#dfn-blank-node-identifier"><ins class="diff-chg">
blank
node
identifier
</ins></a><ins class="diff-chg">
is
allocated
which
is
used
to
generate
</ins>
<code>
rdf:first
</code>
and
<code>
<del class="diff-old">rdf:next
,
terminating
</del>
<ins class="diff-chg">rdf:rest
</ins></code><a class="tref internalDFN" title="rdf-triple" href="#dfn-rdf-triple"><ins class="diff-chg">
triples
</ins></a>.<ins class="diff-chg">
The
algorithm
returns
</ins>
the
list
<del class="diff-old">with
</del>
<ins class="diff-chg">head,
which
is
either
the
the
first
allocated
</ins><a class="tref internalDFN" title="blank-node-identifier" href="#dfn-blank-node-identifier"><ins class="diff-chg">
blank
node
identifier
</ins></a><ins class="diff-chg">
or
</ins>
<code>
rdf:nil
</code>
<del class="diff-old">using
</del>
<ins class="diff-chg">if
</ins>
the
<del class="diff-old">following
sequence:
</del>
<a class="tref internalDFN" title="list" href="#dfn-list">
<ins class="diff-chg">list
</ins></a><ins class="diff-chg">
is
empty.
</ins>
</p>
</section>
<section>
<h4 id="algorithm-15">
<ins class="diff-new">Algorithm
</ins></h4>
<p>
The
algorithm
<del class="diff-old">is
invoked
with
</del>
<ins class="diff-chg">takes
two
inputs:
</ins>
an
<a class="tref internalDFN" title="array" href="#dfn-array">
array
</a>
<del class="diff-old">array
,
the
active
property
</del>
<i>
<ins class="diff-chg">list
</ins></i>
and
<del class="diff-old">returns
a
value
to
be
used
as
</del>
an
<del class="diff-old">active
object
</del>
<ins class="diff-chg">empty
</ins><a class="tref internalDFN" title="array" href="#dfn-array"><ins class="diff-chg">
array
</ins>
</a>
<del class="diff-old">in
</del>
<i>
<ins class="diff-chg">list
triples
</ins></i><ins class="diff-chg">
used
for
returning
</ins>
the
<del class="diff-old">calling
location.
</del>
<ins class="diff-chg">generated
</ins><a class="tref internalDFN" title="rdf-triple" href="#dfn-rdf-triple"><ins class="diff-chg">
triples
</ins></a>.
</p>
<del class="diff-old">Note
This
algorithm
does
not
support
lists
containing
lists.
</del>
<ol class="algorithm">
<li>
If
<del class="diff-old">array
</del>
<i>
<ins class="diff-chg">list
</ins></i>
is
<del class="diff-old">empty
</del>
<ins class="diff-chg">empty,
</ins>
return
<code>
rdf:nil
</code>.
</li>
<li>
Otherwise,
<del class="diff-old">generate
a
Quad
using
using
the
active
subject
,
active
property
</del>
<ins class="diff-chg">create
an
</ins><a class="tref internalDFN" title="array" href="#dfn-array"><ins class="diff-chg">
array
</ins>
</a>
<del class="diff-old">and
</del>
<i>
<ins class="diff-chg">bnodes
</ins></i><ins class="diff-chg">
composed
of
</ins>
a
<a href="#generate-blank-node-identifier">
newly
generated
blank
node
<ins class="diff-new">identifier
</ins>
</a>
<del class="diff-old">identified
as
first
blank
node
</del>
<ins class="diff-chg">for
each
entry
in
</ins><i><ins class="diff-chg">
list
</ins></i>.</li><li><ins class="diff-chg">
Initialize
an
empty
</ins><a class="tref internalDFN" title="array" href="#dfn-array"><ins class="diff-chg">
array
</ins>
</a>
<del class="diff-old">.
</del>
<i>
<ins class="diff-chg">list
triples
</ins></i>.
</li>
<li>
For
each
<del class="diff-old">element
in
array
other
than
the
last
element:
</del>
<ins class="diff-chg">pair
of
</ins><i><ins class="diff-chg">
subject
</ins></i><ins class="diff-chg">
from
</ins><i><ins class="diff-chg">
bnodes
</ins></i><ins class="diff-chg">
and
</ins><i><ins class="diff-chg">
item
</ins></i><ins class="diff-chg">
from
</ins><i><ins class="diff-chg">
list
</ins></i>:
<ol class="algorithm">
<li>
<del class="diff-old">Create
</del>
<ins class="diff-chg">Append
</ins>
a
<del class="diff-old">processor
state
using
first
blank
node
as
the
active
</del>
<a class="tref internalDFN" title="triple" href="http://www.w3.org/TR/rdf11-concepts/#dfn-rdf-triple">
<ins class="diff-chg">triple
</ins></a><ins class="diff-chg">
composed
of
</ins><i>
subject
<del class="diff-old">,
and
</del>
</i>,
<code>
rdf:first
<del class="diff-old">as
the
active
property
.
Process
</del>
</code>,
<ins class="diff-chg">and
</ins>
the
<del class="diff-old">value
starting
at
Step
1
.
Proceed
</del>
<ins class="diff-chg">result
of
</ins>
using
<del class="diff-old">the
previous
processor
state
.
</del>
<ins class="diff-chg">th
</ins><a href="#object-to-rdf-conversion"><ins class="diff-chg">
Object
to
RDF
Conversion
algorithm
</ins></a><ins class="diff-chg">
passing
</ins><i><ins class="diff-chg">
item
</ins></i><ins class="diff-chg">
to
</ins><i><ins class="diff-chg">
list
triples
</ins></i>.
</li>
<li>
<del class="diff-old">Unless
this
is
</del>
<ins class="diff-chg">Set
</ins><i><ins class="diff-chg">
rest
</ins></i><ins class="diff-chg">
as
</ins>
the
<del class="diff-old">last
element
</del>
<ins class="diff-chg">next
entry
</ins>
in
<del class="diff-old">array
,
generate
a
new
blank
node
identified
as
rest
blank
node
,
otherwise
use
</del>
<i>
<ins class="diff-chg">bnodes
</ins></i>,<ins class="diff-chg">
or
if
that
does
not
exist,
</ins>
<code>
rdf:nil
</code>.
<del class="diff-old">Generate
</del>
<ins class="diff-chg">Append
</ins>
a
<del class="diff-old">new
Quad
</del>
<a class="tref internalDFN" title="triple" href="http://www.w3.org/TR/rdf11-concepts/#dfn-rdf-triple">
<ins class="diff-chg">triple
</ins>
</a>
<del class="diff-old">using
first
blank
node
,
</del>
<ins class="diff-chg">composed
of
</ins><i><ins class="diff-chg">
subject
</ins></i>,
<code>
rdf:rest
</code>,
and
<i>
rest
<del class="diff-old">blank
node
.
Set
first
blank
node
</del>
</i>
to
<del class="diff-old">rest
blank
node
.
</del>
<i>
<ins class="diff-chg">list
triples
</ins></i>.</li></ol>
</li>
<li>
Return
<ins class="diff-chg">the
</ins>
first
<a class="tref internalDFN" title="blank-node" href="#dfn-blank-node">
blank
node
<del class="diff-old">.
</del>
</a>
<ins class="diff-chg">from
</ins><i><ins class="diff-chg">
bnodes
</ins></i><ins class="diff-chg">
or
</ins><code><ins class="diff-chg">
rdf:nil
</ins></code><ins class="diff-chg">
if
</ins><i><ins class="diff-chg">
bnodes
</ins></i><ins class="diff-chg">
is
empty.
</ins>
</li>
</ol>
</section>
</section>
<section id="convert-from-rdf-algorithm">
<h3>
<span class="secno">
<del class="diff-old">4.9.5
</del>
<ins class="diff-chg">10.4
</ins>
</span>
Convert
from
RDF
Algorithm
</h3>
<p>
<ins class="diff-chg">This
algorithm
converts
an
</ins><a class="tref internalDFN" title="rdf-dataset" href="#dfn-rdf-dataset"><ins class="diff-chg">
RDF
dataset
</ins></a><ins class="diff-chg">
consisting
of
a
</ins><a class="tref internalDFN" title="default-graph" href="#dfn-default-graph"><ins class="diff-chg">
default
graph
</ins></a><ins class="diff-chg">
and
zero
or
more
</ins><a class="tref internalDFN" title="named-graph" href="#dfn-named-graph"><ins class="diff-chg">
named
graphs
</ins></a><ins class="diff-chg">
into
a
JSON-LD
document.
</ins></p>
<p>
In
some
cases,
data
exists
natively
in
<del class="diff-old">Triples
</del>
<ins class="diff-chg">the
form
of
triples
</ins>
or
<del class="diff-old">Quads
form;
</del>
<a class="tref internalDFN" title="triple" href="http://www.w3.org/TR/rdf11-concepts/#dfn-rdf-triple">
<ins class="diff-chg">triples
</ins></a><ins class="diff-chg">
;
</ins>
for
example,
if
the
data
was
originally
represented
in
an
<a class="tref internalDFN" title="rdf-dataset" href="#dfn-rdf-dataset">
RDF
<del class="diff-old">graph
or
triple/quad
store.
</del>
<ins class="diff-chg">dataset
</ins></a>.
This
algorithm
is
designed
to
simply
translate
an
array
of
<del class="diff-old">Quads
</del>
<a class="tref internalDFN" title="triple" href="http://www.w3.org/TR/rdf11-concepts/#dfn-rdf-triple">
<ins class="diff-chg">triples
</ins>
</a>
into
a
JSON-LD
document.
</p>
<div class="note">
<div class="note-title">
<span>
<ins class="diff-new">Note
</ins></span></div><p class=""><ins class="diff-new">
This
algorithm
does
not
support
lists
containing
lists.
</ins></p></div><section class="informative"><h4 id="general-solution-16"><ins class="diff-new">
General
Solution
</ins></h4>
<p>
<del class="diff-old">When
expanding
typed
literal
</del>
<em>
<ins class="diff-chg">This
section
is
non-normative.
</ins></em></p><p><ins class="diff-chg">
Iterate
through
each
graph
in
the
dataset,
converting
</ins><a class="tref internalDFN" title="rdf-collection" href="http://www.w3.org/TR/rdf-schema/#ch_collectionvocab"><ins class="diff-chg">
RDF
Collections
</ins>
</a>
<del class="diff-old">values
having
</del>
<ins class="diff-chg">into
</ins>
a
<del class="diff-old">datatype
of
xsd:string
,
the
@type
must
not
be
set
to
xsd:string
</del>
<a class="tref internalDFN" title="list" href="#dfn-list">
<ins class="diff-chg">list
</ins></a>
and
<del class="diff-old">the
resulting
value
must
have
only
</del>
<ins class="diff-chg">generating
</ins>
a
<del class="diff-old">@value
property.
</del>
<ins class="diff-chg">JSON-LD
document
in
expanded
form
for
all
</ins><a class="tref internalDFN" title="rdf-literal" href="http://www.w3.org/TR/rdf11-concepts/#dfn-literal"><ins class="diff-chg">
RDF
literals
</ins></a>,<a class="tref internalDFN" title="iri" href="#dfn-iri"><ins class="diff-chg">
IRIs
</ins></a><ins class="diff-chg">
and
</ins><a class="tref internalDFN" title="blank-node-identifier" href="#dfn-blank-node-identifier"><ins class="diff-chg">
blank
node
identifiers
</ins></a>.
</p>
</section>
<section>
<h4 id="algorithm-16">
<ins class="diff-new">Algorithm
</ins></h4>
<p>
The
<del class="diff-old">conversion
</del>
algorithm
takes
a
single
parameter
<del class="diff-old">input
</del>
<i>
<ins class="diff-chg">dataset
</ins></i>
in
the
form
of
an
array
of
<del class="diff-old">Quad
representations.
</del>
<ins class="diff-chg">an
</ins><a class="tref internalDFN" title="rdf-dataset" href="#dfn-rdf-dataset"><ins class="diff-chg">
RDF
dataset
</ins></a>.
</p>
<ol class="algorithm">
<del class="diff-old">Construct
defaultGraph
as
</del>
<li>
<ins class="diff-chg">Initialize
</ins><i><ins class="diff-chg">
default
graph
</ins></i><ins class="diff-chg">
to
</ins>
a
<ins class="diff-chg">new
</ins><a class="tref internalDFN" title="json-object" href="#dfn-json-object">
JSON
object
</a>
<del class="diff-old">containing
subjects
</del>
<ins class="diff-chg">consisting
of
two
members,
</ins><code><ins class="diff-chg">
nodeMap
</ins></code>
and
<code>
listMap
<del class="diff-old">,
each
</del>
</code>,
<ins class="diff-chg">whose
value
is
an
</ins>
an
empty
<a class="tref internalDFN" title="json-object" href="#dfn-json-object">
JSON
object
</a>.
</li>
<li>
<del class="diff-old">Construct
graphs
as
a
</del>
<ins class="diff-chg">Initialize
</ins><i><ins class="diff-chg">
graph
map
</ins></i><ins class="diff-chg">
to
an
empty
</ins><a class="tref internalDFN" title="json-object" href="#dfn-json-object">
JSON
object
</a>
<del class="diff-old">containing
defaultGraph
identified
by
an
empty
string
.
</del>
<ins class="diff-chg">consisting
of
a
single
member
</ins><code><ins class="diff-chg">
@default
</ins></code><ins class="diff-chg">
whose
value
is
set
to
reference
</ins><i><ins class="diff-chg">
default
graph
</ins></i>.</li><li><ins class="diff-chg">
Reference
the
</ins><code><ins class="diff-chg">
nodeMap
</ins></code><ins class="diff-chg">
member
of
</ins><i><ins class="diff-chg">
default
graph
</ins></i><ins class="diff-chg">
using
the
variable
</ins><i><ins class="diff-chg">
default
graph
nodes
</ins></i>.
</li>
<li>
For
each
<del class="diff-old">quad
</del>
<i>
<ins class="diff-chg">graph
</ins></i>
in
<del class="diff-old">input
:
</del>
<i>
<ins class="diff-chg">dataset
</ins></i>:
<ol class="algorithm">
<li>
<del class="diff-old">Set
</del>
<ins class="diff-chg">If
</ins><i>
graph
</i>
<ins class="diff-chg">is
the
</ins><a class="tref internalDFN" title="default-graph" href="#dfn-default-graph"><ins class="diff-chg">
default
graph
</ins></a>,<ins class="diff-chg">
set
</ins><i><ins class="diff-chg">
name
</ins></i><ins class="diff-chg">
to
</ins><code><ins class="diff-chg">
@default
</ins></code>,<ins class="diff-chg">
otherwise
</ins>
to
the
<del class="diff-old">entry
in
graphs
identified
by
</del>
<a class="tref internalDFN" title="graph-name" href="#dfn-graph-name">
<ins class="diff-chg">graph
</ins>
name
<del class="diff-old">,
initializing
it
</del>
</a>
<ins class="diff-chg">associated
with
</ins><i><ins class="diff-chg">
graph
</ins></i>.</li><li><ins class="diff-chg">
If
</ins><i><ins class="diff-chg">
graph
map
</ins></i><ins class="diff-chg">
has
no
</ins><i><ins class="diff-chg">
name
</ins></i><ins class="diff-chg">
member,
create
one
and
set
its
value
to
a
</ins>
to
a
new
<del class="diff-old">entry
using
the
mechanism
described
in
Step
1
</del>
<a class="tref internalDFN" title="json-object" href="#dfn-json-object">
<ins class="diff-chg">JSON
object
</ins></a><ins class="diff-chg">
consisting
of
two
members,
</ins><code><ins class="diff-chg">
nodeMap
</ins></code><ins class="diff-chg">
and
</ins><code><ins class="diff-chg">
listMap
</ins></code>,<ins class="diff-chg">
whose
value
is
an
an
empty
</ins><a class="tref internalDFN" title="json-object" href="#dfn-json-object"><ins class="diff-chg">
JSON
object
</ins>
</a>.
</li>
<li>
If
<del class="diff-old">property
</del>
<i>
<ins class="diff-chg">graph
</ins></i>
is
<del class="diff-old">rdf:first
,
use
</del>
<ins class="diff-chg">not
</ins>
the
<del class="diff-old">entry
in
graph.listMap
indexed
by
subject
,
initializing
it
</del>
<a class="tref internalDFN" title="default-graph" href="#dfn-default-graph">
<ins class="diff-chg">default
graph
</ins></a><ins class="diff-chg">
and
</ins><i><ins class="diff-chg">
default
graph
nodes
</ins></i><ins class="diff-chg">
does
not
have
a
</ins><i><ins class="diff-chg">
name
</ins></i><ins class="diff-chg">
member,
create
such
a
member
and
initialize
its
value
</ins>
to
a
new
<a class="tref internalDFN" title="json-object" href="#dfn-json-object">
JSON
object
</a>
<del class="diff-old">if
nesessary.
Represent
object
in
expanded
form,
as
described
</del>
<ins class="diff-chg">with
a
single
member
</ins><code><ins class="diff-chg">
@id
</ins></code><ins class="diff-chg">
whose
value
is
</ins><i><ins class="diff-chg">
name
</ins></i>.</li><li><ins class="diff-chg">
Reference
the
value
of
the
</ins><i><ins class="diff-chg">
name
</ins></i><ins class="diff-chg">
member
</ins>
in
<del class="diff-old">Value
Expansion
.
Add
</del>
<i>
<ins class="diff-chg">graph
map
</ins></i><ins class="diff-chg">
using
</ins>
the
<del class="diff-old">resulting
</del>
<ins class="diff-chg">variable
</ins><i><ins class="diff-chg">
graph
</ins>
object
<del class="diff-old">representation
to
</del>
</i>.
</li>
<li>
<ins class="diff-chg">Reference
</ins>
the
<del class="diff-old">entry
indexed
by
first
,
</del>
<ins class="diff-chg">value
of
the
</ins><code><ins class="diff-chg">
nodeMap
</ins></code><ins class="diff-chg">
member
in
</ins><i><ins class="diff-chg">
graph
object
</ins></i><ins class="diff-chg">
using
the
variable
</ins><i><ins class="diff-chg">
node
map
</ins></i>
and
<del class="diff-old">skip
to
</del>
the
<del class="diff-old">next
quad.
</del>
<ins class="diff-chg">value
of
the
</ins><code><ins class="diff-chg">
listMap
</ins></code><ins class="diff-chg">
member
using
the
variable
</ins><i><ins class="diff-chg">
list
map
</ins></i>.
</li>
<li>
<ins class="diff-new">For
each
</ins><a class="tref internalDFN" title="rdf-triple" href="#dfn-rdf-triple"><ins class="diff-new">
RDF
triple
</ins></a><ins class="diff-new">
in
</ins><i><ins class="diff-new">
graph
</ins></i><ins class="diff-new">
consisting
of
</ins><i><ins class="diff-new">
subject
</ins></i>,<i><ins class="diff-new">
predicate
</ins></i>,<ins class="diff-new">
and
</ins><i><ins class="diff-new">
object
</ins></i>:<ol class="algorithm"><li>
If
<del class="diff-old">property
is
</del>
<i>
<ins class="diff-chg">predicate
</ins></i><ins class="diff-chg">
equals
</ins>
<code>
<del class="diff-old">rdf:rest
:
</del>
<ins class="diff-chg">rdf:first
</ins></code>,
<ol class="algorithm">
<li>
If
<del class="diff-old">object
is
a
blank
node
,
use
the
entry
in
graph.listMap
indexed
by
</del>
<i>
<ins class="diff-chg">list
map
</ins></i><ins class="diff-chg">
has
no
</ins><i>
subject
<del class="diff-old">,
initializing
</del>
</i>
<ins class="diff-chg">member,
create
one
and
initialize
</ins>
it
to
<del class="diff-old">a
new
</del>
<ins class="diff-chg">an
empty
</ins><a class="tref internalDFN" title="json-object" href="#dfn-json-object">
JSON
object
<del class="diff-old">if
necessary.
Add
</del>
</a>.
</li>
<li>
<ins class="diff-chg">Initialize
</ins>
the
<del class="diff-old">nominalValue
</del>
<ins class="diff-chg">value
</ins>
of
<del class="diff-old">object
</del>
<ins class="diff-chg">the
</ins><code><ins class="diff-chg">
first
</ins></code><ins class="diff-chg">
member
of
the
</ins><i><ins class="diff-chg">
subject
</ins></i><ins class="diff-chg">
member
of
</ins><i><ins class="diff-chg">
list
map
</ins></i>
to
the
<del class="diff-old">entry
indexed
by
rest
.
</del>
<ins class="diff-chg">result
of
the
</ins><a href="#rdf-to-object-conversion"><ins class="diff-chg">
RDF
to
Object
Conversion
algorithm
</ins></a>,<ins class="diff-chg">
passing
</ins><i><ins class="diff-chg">
object
</ins></i>.
</li>
<li>
<del class="diff-old">Skip
to
</del>
<ins class="diff-chg">Continue
with
</ins>
the
next
<del class="diff-old">quad.
</del>
<a class="tref internalDFN" title="rdf-triple" href="#dfn-rdf-triple">
<ins class="diff-chg">RDF
triple
</ins></a>.
</li>
</ol>
</li>
<li>
If
<del class="diff-old">name
is
not
null
,
</del>
<i>
<ins class="diff-chg">predicate
</ins></i><ins class="diff-chg">
equals
</ins><code><ins class="diff-chg">
rdf:rest
</ins></code>:<ol class="algorithm"><li><ins class="diff-chg">
If
</ins><i><ins class="diff-chg">
list
map
</ins></i><ins class="diff-chg">
has
no
</ins><i><ins class="diff-chg">
subject
</ins></i><ins class="diff-chg">
member,
create
one
</ins>
and
<del class="diff-old">defaultGraph.subjects
does
not
contain
</del>
<ins class="diff-chg">initialize
it
to
</ins>
an
<del class="diff-old">entry
for
name
,
create
a
new
entry
for
name
from
a
new
</del>
<ins class="diff-chg">empty
</ins><a class="tref internalDFN" title="json-object" href="#dfn-json-object">
JSON
object
<del class="diff-old">with
key/value
pair
</del>
</a>.
</li>
<li>
<ins class="diff-chg">Initialize
the
value
</ins>
of
<ins class="diff-new">the
</ins>
<code>
<del class="diff-old">@id
</del>
<ins class="diff-chg">rest
</ins>
</code>
<del class="diff-old">and
a
string
representation
</del>
<ins class="diff-chg">member
</ins>
of
<del class="diff-old">name
.
</del>
<ins class="diff-chg">the
</ins><i><ins class="diff-chg">
subject
</ins></i><ins class="diff-chg">
member
of
</ins><i><ins class="diff-chg">
list
map
</ins></i><ins class="diff-chg">
to
</ins><a class="tref internalDFN" title="object" href="http://www.w3.org/TR/rdf11-concepts/#dfn-object"><ins class="diff-chg">
object
</ins></a>,<ins class="diff-chg">
which
is
either
an
</ins><a class="tref internalDFN" title="absolute-iri" href="#dfn-absolute-iri"><ins class="diff-chg">
absolute
</ins><abbr title="Internationalized Resource Identifier"><ins class="diff-chg">
IRI
</ins></abbr></a><ins class="diff-chg">
or
</ins><a class="tref internalDFN" title="blank-node-identifier" href="#dfn-blank-node-identifier"><ins class="diff-chg">
blank
node
identifier
</ins></a>.
</li>
<li>
<del class="diff-old">Set
value
as
</del>
<ins class="diff-chg">Continue
with
</ins>
the
<del class="diff-old">entry
from
graph.subjects
for
</del>
<ins class="diff-chg">next
</ins><a class="tref internalDFN" title="rdf-triple" href="#dfn-rdf-triple"><ins class="diff-chg">
RDF
triple
</ins></a>.</li></ol></li><li><ins class="diff-chg">
If
</ins><i><ins class="diff-chg">
node
map
</ins></i><ins class="diff-chg">
does
not
have
a
</ins><i>
subject
<del class="diff-old">,
initializing
it
</del>
</i>
<ins class="diff-chg">member,
create
one
and
initialize
its
value
</ins>
to
a
new
<a class="tref internalDFN" title="json-object" href="#dfn-json-object">
JSON
object
</a>
<del class="diff-old">with
key/value
pair
</del>
<ins class="diff-chg">consisting
</ins>
of
<ins class="diff-new">a
single
member
</ins>
<code>
@id
</code>
<del class="diff-old">and
a
string
representation
</del>
<ins class="diff-chg">whose
value
is
set
to
</ins><i><ins class="diff-chg">
subject
</ins></i>.</li><li><ins class="diff-chg">
Reference
the
value
</ins>
of
<ins class="diff-chg">the
</ins><i>
subject
<del class="diff-old">if
necessary.
</del>
</i>
<ins class="diff-chg">member
in
</ins><i><ins class="diff-chg">
node
map
</ins></i><ins class="diff-chg">
using
the
variable
</ins><i><ins class="diff-chg">
node
</ins></i>.
</li>
<li>
If
<del class="diff-old">property
is
</del>
<i>
<ins class="diff-chg">predicate
</ins></i><ins class="diff-chg">
equals
</ins>
<code>
rdf:type
</code>,
and
<del class="diff-old">the
notType
option
</del>
<i>
<ins class="diff-chg">object
</ins></i>
is
<del class="diff-old">present
and
not
true
:
Append
the
string
representation
of
</del>
<ins class="diff-chg">an
</ins><a class="tref internalDFN" title="iri" href="#dfn-iri"><abbr title="Internationalized Resource Identifier"><ins class="diff-chg">
IRI
</ins></abbr></a><ins class="diff-chg">
or
</ins><a class="tref internalDFN" title="blank-node-identifier" href="#dfn-blank-node-identifier"><ins class="diff-chg">
blank
node
identifier
</ins></a>,<ins class="diff-chg">
append
</ins><i>
object
</i>
to
the
<del class="diff-old">array
</del>
value
<del class="diff-old">for
</del>
<ins class="diff-chg">of
</ins>
the
<del class="diff-old">key
</del>
<code>
@type
<del class="diff-old">,
creating
</del>
</code>
<ins class="diff-chg">member
of
</ins><i><ins class="diff-chg">
node
</ins></i>.<ins class="diff-chg">
If
no
such
member
exists,
create
one
and
initialize
it
to
</ins>
an
<del class="diff-old">entry
in
value
if
necessary.
Otherwise,
if
object
</del>
<a class="tref internalDFN" title="array" href="#dfn-array">
<ins class="diff-chg">array
</ins></a><ins class="diff-chg">
whose
only
item
</ins>
is
<del class="diff-old">rdf:nil
:
Let
key
be
</del>
<i>
<ins class="diff-chg">object
</ins></i>.<ins class="diff-chg">
Finally,
continue
to
</ins>
the
<del class="diff-old">string
representation
of
property
.
</del>
<ins class="diff-chg">next
</ins><a class="tref internalDFN" title="rdf-triple" href="#dfn-rdf-triple"><ins class="diff-chg">
RDF
triple
</ins></a>.
</li>
<li>
<del class="diff-old">Append
</del>
<ins class="diff-chg">If
</ins><i><ins class="diff-chg">
node
</ins></i><ins class="diff-chg">
does
not
have
</ins>
an
<del class="diff-old">empty
@list
representation
to
the
array
</del>
<i>
<ins class="diff-chg">predicate
</ins></i><ins class="diff-chg">
member,
create
one
and
initialize
its
</ins>
value
<del class="diff-old">for
key
,
creating
</del>
<ins class="diff-chg">to
</ins>
an
<del class="diff-old">entry
in
value
if
necessary.
</del>
<ins class="diff-chg">empty
</ins><a class="tref internalDFN" title="array" href="#dfn-array"><ins class="diff-chg">
array
</ins></a>.
</li>
<li>
<del class="diff-old">Otherwise,
Let
key
be
</del>
<ins class="diff-chg">Set
</ins><i><ins class="diff-chg">
value
</ins></i><ins class="diff-chg">
to
</ins>
the
<del class="diff-old">string
representation
</del>
<ins class="diff-chg">result
</ins>
of
<del class="diff-old">property
and
let
object
representation
be
</del>
<ins class="diff-chg">using
the
</ins><a href="#rdf-to-object-conversion"><ins class="diff-chg">
RDF
to
Object
Conversion
algorithm
</ins></a>,<ins class="diff-chg">
passing
</ins><i>
object
<del class="diff-old">represented
in
expanded
form
as
described
in
Value
Expansion
.
</del>
</i>.
</li>
<li>
<ins class="diff-chg">Add
a
reference
to
</ins><i><ins class="diff-chg">
value
</ins></i><ins class="diff-chg">
to
the
to
the
</ins><a class="tref internalDFN" title="array" href="#dfn-array"><ins class="diff-chg">
array
</ins></a><ins class="diff-chg">
associated
with
the
</ins><i><ins class="diff-chg">
predicate
</ins></i><ins class="diff-chg">
member
of
</ins><i><ins class="diff-chg">
node
</ins></i>.
</li>
<li>
If
<i>
object
</i>
is
<ins class="diff-new">an
</ins><a class="tref internalDFN" title="iri" href="#dfn-iri"><abbr title="Internationalized Resource Identifier"><ins class="diff-new">
IRI
</ins></abbr></a><ins class="diff-new">
or
</ins>
a
<a class="tref internalDFN" title="blank-node-identifier" href="#dfn-blank-node-identifier">
blank
node
<del class="diff-old">,
use
the
entry
in
graph.listMap
indexed
by
object
,
initializing
</del>
<ins class="diff-chg">identifier
</ins></a>
it
<del class="diff-old">to
</del>
<ins class="diff-chg">might
represent
the
head
of
</ins>
a
<del class="diff-old">new
JSON
</del>
<ins class="diff-chg">RDF
list:
</ins><ol class="algorithm"><li><ins class="diff-chg">
If
</ins><i><ins class="diff-chg">
list
map
</ins></i><ins class="diff-chg">
has
no
</ins><i>
object
<del class="diff-old">if
nesessary.
Add
</del>
</i>
<ins class="diff-chg">member,
create
one
and
set
its
value
to
</ins>
an
<del class="diff-old">entry
for
head
with
</del>
<ins class="diff-chg">empty
</ins><a class="tref internalDFN" title="json-object" href="#dfn-json-object"><ins class="diff-chg">
JSON
</ins>
object
<del class="diff-old">representation
.
</del>
</a>.
</li>
<li>
<del class="diff-old">Append
</del>
<ins class="diff-chg">Set
the
</ins><code><ins class="diff-chg">
head
</ins></code><ins class="diff-chg">
member
of
the
</ins><i>
object
<del class="diff-old">representation
</del>
</i>
<ins class="diff-chg">member
of
</ins><i><ins class="diff-chg">
list
map
</ins></i>
to
<ins class="diff-new">a
reference
of
</ins><i><ins class="diff-new">
value
</ins></i>.<ins class="diff-new">
This
reference
may
be
required
later
to
replace
</ins>
the
<del class="diff-old">array
</del>
<i>
value
<del class="diff-old">for
key
,
creating
an
entry
</del>
</i>
in
<del class="diff-old">value
if
necessary.
</del>
<ins class="diff-chg">the
</ins><i><ins class="diff-chg">
predicate
</ins></i><ins class="diff-chg">
member
of
</ins><i><ins class="diff-chg">
node
</ins></i><ins class="diff-chg">
with
a
</ins><a class="tref internalDFN" title="list-object" href="#dfn-list-object"><ins class="diff-chg">
list
object
</ins></a>.</li></ol>
</li>
</ol>
</li>
</ol>
</li>
<li>
For
each
<i>
name
</i>
and
<i>
graph
<ins class="diff-chg">object
</ins></i>
in
<del class="diff-old">graphs
:
</del>
<i>
<ins class="diff-chg">graph
map
</ins></i>:
<ol class="algorithm">
<li>
<ins class="diff-new">Reference
the
value
of
the
</ins><code><ins class="diff-new">
listMap
</ins></code><ins class="diff-new">
member
in
</ins><i><ins class="diff-new">
graph
object
</ins></i><ins class="diff-new">
using
the
variable
</ins><i><ins class="diff-new">
list
map
</ins></i>.</li><li>
For
each
<ins class="diff-chg">key-value
pair
</ins><i>
subject
<del class="diff-old">and
</del>
</i>
<ins class="diff-chg">-
</ins><i>
entry
<del class="diff-old">in
</del>
</i>
<ins class="diff-chg">of
the
value
associated
to
the
</ins><code><ins class="diff-chg">
listMap
</ins></code><ins class="diff-chg">
member
of
</ins><i>
graph
<del class="diff-old">where
</del>
<ins class="diff-chg">object
</ins></i>:<ol class="algorithm"><li><ins class="diff-chg">
If
</ins><i>
entry
</i>
has
<del class="diff-old">both
</del>
<ins class="diff-chg">not
an
</ins><code>
head
</code>
and
<ins class="diff-chg">an
</ins><code>
first
<del class="diff-old">keys:
</del>
</code>
<ins class="diff-chg">member
it
does
not
represent
the
head
of
a
</ins><a class="tref internalDFN" title="list" href="#dfn-list"><ins class="diff-chg">
list
</ins></a>.<ins class="diff-chg">
Continue
with
the
next
key-value
pair.
</ins></li>
<li>
<del class="diff-old">Set
value
to
</del>
<ins class="diff-chg">Reference
</ins>
the
value
of
<ins class="diff-chg">the
</ins><code>
head
</code>
<ins class="diff-chg">member
</ins>
in
<i>
entry
<del class="diff-old">.
</del>
</i>
<ins class="diff-chg">using
the
variable
</ins><i><ins class="diff-chg">
value
</ins></i>.
</li>
<li>
Remove
the
<del class="diff-old">entry
for
</del>
<code>
@id
</code>
<del class="diff-old">in
</del>
<ins class="diff-chg">member
from
</ins><i>
value
<del class="diff-old">.
</del>
</i>.
</li>
<li>
Add
an
<del class="diff-old">entry
to
value
for
</del>
<code>
@list
</code>
<del class="diff-old">initialized
</del>
<ins class="diff-chg">member
</ins>
to
<del class="diff-old">a
new
</del>
<i>
<ins class="diff-chg">value
</ins></i><ins class="diff-chg">
and
initialize
it
to
an
</ins><a class="tref internalDFN" title="array" href="#dfn-array">
array
</a>
containing
the
value
of
<ins class="diff-chg">the
</ins><code>
first
<del class="diff-old">from
</del>
</code>
<ins class="diff-chg">member
of
</ins><i>
entry
<del class="diff-old">.
</del>
</i>.
</li>
<li>
While
<del class="diff-old">entry
has
a
key
for
</del>
<ins class="diff-chg">the
value
associated
with
the
</ins><code>
rest
<del class="diff-old">:
</del>
</code>
<ins class="diff-chg">member
of
</ins><i><ins class="diff-chg">
entry
</ins></i><ins class="diff-chg">
is
not
</ins><code><ins class="diff-chg">
rdf:nil
</ins></code>:
<ol class="algorithm">
<li>
Set
<i>
<ins class="diff-chg">rest
</ins></i><ins class="diff-chg">
to
the
value
of
the
</ins><code><ins class="diff-chg">
rest
</ins></code><ins class="diff-chg">
member
of
</ins><i>
entry
</i>.
</li>
<li>
<ins class="diff-chg">Set
</ins><i><ins class="diff-chg">
entry
</ins></i>
to
the
value
<ins class="diff-new">associated
with
the
</ins><i><ins class="diff-new">
rest
</ins></i><ins class="diff-new">
member
</ins>
of
<del class="diff-old">graph.listMap
for
entry.rest
.
</del>
<i>
<ins class="diff-chg">list
map
</ins></i>.
</li>
<li>
Add
the
value
<del class="diff-old">for
entry.first
</del>
<ins class="diff-chg">associated
with
the
</ins><code><ins class="diff-chg">
first
</ins></code><ins class="diff-chg">
member
of
</ins><i><ins class="diff-chg">
entry
</ins></i>
to
the
<del class="diff-old">list
array.
</del>
<code>
<ins class="diff-chg">@list
</ins></code><ins class="diff-chg">
member
of
</ins><i><ins class="diff-chg">
value
</ins></i>.
</li>
</ol>
</li>
</ol>
</li>
</ol>
</li>
<li>
<del class="diff-old">Create
array
as
</del>
<ins class="diff-chg">Initialize
</ins>
an
empty
<a class="tref internalDFN" title="array" href="#dfn-array">
array
<del class="diff-old">.
</del>
</a>
<i>
<ins class="diff-chg">result
</ins></i>.
</li>
<li>
For
each
<i>
subject
</i>
and
<del class="diff-old">entry
</del>
<i>
<ins class="diff-chg">node
</ins></i>
in
<del class="diff-old">defaultGraph.subjects
</del>
<i>
<ins class="diff-chg">default
graph
nodes
</ins></i>
ordered
by
<i>
subject
<del class="diff-old">:
</del>
</i>:
<ol class="algorithm">
<li>
<del class="diff-old">Add
entry
to
array
.
</del>
If
<del class="diff-old">graphs
</del>
<i>
<ins class="diff-chg">graph
map
</ins></i>
has
an
<del class="diff-old">entry
for
</del>
<i>
subject
<del class="diff-old">,
add
</del>
</i>
<ins class="diff-chg">member:
</ins><ol class="algorithm"><li><ins class="diff-chg">
Add
</ins>
a
<del class="diff-old">property
</del>
<code>
@graph
</code>
<del class="diff-old">in
entry
containing
</del>
<ins class="diff-chg">member
to
</ins><i><ins class="diff-chg">
node
</ins></i><ins class="diff-chg">
and
initialize
its
value
to
an
empty
</ins><a class="tref internalDFN" title="array" href="#dfn-array"><ins class="diff-chg">
array
</ins></a>.</li><li><ins class="diff-chg">
Reference
the
</ins><code><ins class="diff-chg">
nodeMap
</ins></code><ins class="diff-chg">
member
of
the
</ins><i><ins class="diff-chg">
subject
</ins></i><ins class="diff-chg">
member
of
</ins><i><ins class="diff-chg">
graph
map
</ins></i><ins class="diff-chg">
using
</ins>
the
<ins class="diff-new">variable
</ins><i><ins class="diff-new">
node
map
</ins></i>.</li><li><ins class="diff-new">
For
each
key-value
pair
</ins><i><ins class="diff-new">
s
</ins></i><ins class="diff-new">
-
</ins><i><ins class="diff-new">
n
</ins></i><ins class="diff-new">
in
</ins><i><ins class="diff-new">
node
map
</ins></i>
ordered
<del class="diff-old">entries
from
graphs[subject].subjects
.
</del>
<ins class="diff-chg">by
</ins><i><ins class="diff-chg">
s
</ins></i>,<ins class="diff-chg">
append
</ins><i><ins class="diff-chg">
n
</ins></i><ins class="diff-chg">
to
the
</ins><code><ins class="diff-chg">
@graph
</ins></code><ins class="diff-chg">
member
of
</ins><i><ins class="diff-chg">
node
</ins></i>.</li></ol></li><li><ins class="diff-chg">
Append
</ins><i><ins class="diff-chg">
node
</ins></i><ins class="diff-chg">
to
</ins><i><ins class="diff-chg">
result
</ins></i>.
</li>
</ol>
</li>
<li>
Return
<i>
<ins class="diff-new">result
</ins></i>.</li></ol></section></section><section id="rdf-to-object-conversion"><h3><span class="secno"><ins class="diff-new">
10.5
</ins></span><ins class="diff-new">
RDF
to
Object
Conversion
</ins></h3><p><ins class="diff-new">
This
algorithm
transforms
an
RDF
literal
to
a
JSON-LD
</ins><a class="tref internalDFN" title="value-object" href="#dfn-value-object"><ins class="diff-new">
value
object
</ins></a><ins class="diff-new">
and
a
RDF
blank
node
or
</ins><abbr title="Internationalized Resource Identifier"><ins class="diff-new">
IRI
</ins></abbr><ins class="diff-new">
to
an
JSON-LD
</ins><a class="tref internalDFN" title="node-object" href="#dfn-node-object"><ins class="diff-new">
node
object
</ins></a>.</p><section class="informative"><h4 id="general-solution-17"><ins class="diff-new">
General
Solution
</ins></h4><p>
<em>
<del class="diff-old">array
</del>
<ins class="diff-chg">This
section
is
non-normative.
</ins>
</em>
</p>
<p>
<a class="tref internalDFN" title="rdf-literal" href="http://www.w3.org/TR/rdf11-concepts/#dfn-literal">
<ins class="diff-new">RDF
literals
</ins></a><ins class="diff-new">
are
transformed
to
</ins><a class="tref internalDFN" title="value-object" href="#dfn-value-object"><ins class="diff-new">
value
objects
</ins></a><ins class="diff-new">
as
defined
in
the
section
</ins><a href="#data-round-tripping"><ins class="diff-new">
Data
Round
Tripping
</ins></a><ins class="diff-new">
whereas
</ins><a class="tref internalDFN" title="iri" href="#dfn-iri"><ins class="diff-new">
IRIs
</ins></a><ins class="diff-new">
and
</ins><a class="tref internalDFN" title="blank-node-identifier" href="#dfn-blank-node-identifier"><ins class="diff-new">
blank
node
identifiers
</ins></a><ins class="diff-new">
are
transformed
to
</ins><a class="tref internalDFN" title="node-object" href="#dfn-node-object"><ins class="diff-new">
node
objects
</ins></a>.</p></section><section><h4 id="algorithm-17"><ins class="diff-new">
Algorithm
</ins></h4><p><ins class="diff-new">
This
algorithm
takes
</ins>
as
<ins class="diff-new">single
input
variable
</ins><i><ins class="diff-new">
value
</ins></i><ins class="diff-new">
that
is
converted
to
a
</ins><a class="tref internalDFN" title="json-object" href="#dfn-json-object"><ins class="diff-new">
JSON
object
</ins></a>.</p><ol class="algorithm"><li><ins class="diff-new">
If
</ins><i><ins class="diff-new">
value
</ins></i><ins class="diff-new">
is
an
an
</ins><a class="tref internalDFN" title="iri" href="#dfn-iri"><abbr title="Internationalized Resource Identifier"><ins class="diff-new">
IRI
</ins></abbr></a><ins class="diff-new">
or
a
</ins><a class="tref internalDFN" title="blank-node-identifier" href="#dfn-blank-node-identifier"><ins class="diff-new">
blank
node
identifier
</ins></a>:<ol class="algorithm"><li><ins class="diff-new">
If
</ins><i><ins class="diff-new">
value
</ins></i><ins class="diff-new">
equals
</ins><code><ins class="diff-new">
rdf:nil
</ins></code><ins class="diff-new">
return
a
new
</ins><a class="tref internalDFN" title="json-object" href="#dfn-json-object"><ins class="diff-new">
JSON
object
</ins></a><ins class="diff-new">
consisting
of
a
single
member
</ins><code><ins class="diff-new">
@list
</ins></code><ins class="diff-new">
whose
value
is
set
to
an
empty
</ins><a class="tref internalDFN" title="array" href="#dfn-array"><ins class="diff-new">
array
</ins></a>.<ins class="diff-new">
This
is
behavior
is
required
by
</ins>
the
<a href="#convert-from-rdf-algorithm">
<ins class="diff-new">Convert
from
RDF
algorithm
</ins></a>.</li><li><ins class="diff-new">
Otherwise,
return
a
new
</ins><a class="tref internalDFN" title="json-object" href="#dfn-json-object"><ins class="diff-new">
JSON
object
</ins></a><ins class="diff-new">
consisting
of
a
single
member
</ins><code><ins class="diff-new">
@id
</ins></code><ins class="diff-new">
whose
value
is
set
to
</ins><i><ins class="diff-new">
value
</ins></i>.</li></ol></li><li><ins class="diff-new">
Otherwise
</ins><i><ins class="diff-new">
value
</ins></i><ins class="diff-new">
is
an
</ins><a class="tref externalDFN" title="rdf-literal" href="http://www.w3.org/TR/rdf11-concepts/#dfn-literal"><ins class="diff-new">
RDF
literal
</ins></a>:<ol class="algorithm"><li><ins class="diff-new">
Initialize
a
new
empty
</ins><a class="tref internalDFN" title="json-object" href="#dfn-json-object"><ins class="diff-new">
JSON
object
</ins></a>
result.
</li>
<li>
<ins class="diff-new">Initialize
</ins><i><ins class="diff-new">
converted
value
</ins></i><ins class="diff-new">
to
</ins><i><ins class="diff-new">
value
</ins></i>.</li><li><ins class="diff-new">
Initialize
</ins><i><ins class="diff-new">
type
</ins></i><ins class="diff-new">
to
</ins><a class="tref internalDFN" title="null" href="#dfn-null"><ins class="diff-new">
null
</ins></a></li><li><ins class="diff-new">
If
the
</ins><a class="tref externalDFN" title="datatype-iri" href="http://www.w3.org/TR/rdf11-concepts/#dfn-datatype-iri"><ins class="diff-new">
datatype
</ins><abbr title="Internationalized Resource Identifier"><ins class="diff-new">
IRI
</ins></abbr></a><ins class="diff-new">
of
</ins><i><ins class="diff-new">
value
</ins></i><ins class="diff-new">
equals
</ins><code><ins class="diff-new">
xsd:boolean
</ins></code>,<ins class="diff-new">
set
</ins><i><ins class="diff-new">
converted
value
</ins></i><ins class="diff-new">
to
</ins><a class="tref internalDFN" title="true" href="#dfn-true"><ins class="diff-new">
true
</ins></a><ins class="diff-new">
if
the
</ins><a class="tref externalDFN" title="lexical-form" href="http://www.w3.org/TR/rdf11-concepts/#dfn-lexical-form"><ins class="diff-new">
lexical
form
</ins></a><ins class="diff-new">
of
</ins><i><ins class="diff-new">
value
</ins></i><ins class="diff-new">
matches
</ins><code><ins class="diff-new">
true
</ins></code>,<ins class="diff-new">
or
</ins><code><ins class="diff-new">
false
</ins></code><ins class="diff-new">
if
it
matches
</ins><code><ins class="diff-new">
false
</ins></code>.</li><li><ins class="diff-new">
Otherwise,
if
the
</ins><a class="tref externalDFN" title="datatype-iri" href="http://www.w3.org/TR/rdf11-concepts/#dfn-datatype-iri"><ins class="diff-new">
datatype
</ins><abbr title="Internationalized Resource Identifier"><ins class="diff-new">
IRI
</ins></abbr></a><ins class="diff-new">
of
</ins><i><ins class="diff-new">
value
</ins></i><ins class="diff-new">
equals
</ins><code><ins class="diff-new">
xsd:integer
</ins></code><ins class="diff-new">
or
</ins><code><ins class="diff-new">
xsd:double
</ins></code>,<ins class="diff-new">
try
to
convert
the
literal
to
a
</ins><a class="tref internalDFN" title="number" href="#dfn-number"><ins class="diff-new">
JSON
number
</ins></a>.<ins class="diff-new">
If
the
conversion
is
successful,
store
the
result
in
</ins><i><ins class="diff-new">
converted
value
</ins></i>.</li><li><ins class="diff-new">
Otherwise,
if
</ins><i><ins class="diff-new">
value
</ins></i><ins class="diff-new">
is
a
</ins><a class="tref externalDFN" title="language-tagged-string" href="http://www.w3.org/TR/rdf11-concepts/#dfn-language-tagged-string"><ins class="diff-new">
language-tagged
string
</ins></a><ins class="diff-new">
add
a
member
</ins><code><ins class="diff-new">
@language
</ins></code><ins class="diff-new">
to
</ins><i><ins class="diff-new">
result
</ins></i><ins class="diff-new">
and
set
its
value
to
the
</ins><a class="tref externalDFN" title="language-tag" href="http://www.w3.org/TR/rdf11-concepts/#dfn-language-tag"><ins class="diff-new">
language
tag
</ins></a><ins class="diff-new">
of
</ins><i><ins class="diff-new">
value
</ins></i>.</li><li><ins class="diff-new">
Otherwise,
set
</ins><i><ins class="diff-new">
type
</ins></i><ins class="diff-new">
to
the
</ins><a class="tref externalDFN" title="datatype-iri" href="http://www.w3.org/TR/rdf11-concepts/#dfn-datatype-iri"><ins class="diff-new">
datatype
</ins><abbr title="Internationalized Resource Identifier"><ins class="diff-new">
IRI
</ins></abbr></a><ins class="diff-new">
of
</ins><i><ins class="diff-new">
value
</ins></i>,<ins class="diff-new">
unless
it
equals
</ins><code><ins class="diff-new">
xsd:string
</ins></code><ins class="diff-new">
which
is
ignored.
</ins></li><li><ins class="diff-new">
Add
a
member
</ins><code><ins class="diff-new">
@value
</ins></code><ins class="diff-new">
to
</ins><i><ins class="diff-new">
result
</ins></i><ins class="diff-new">
whose
value
is
set
to
</ins><i><ins class="diff-new">
converted
value
</ins></i>.</li><li><ins class="diff-new">
If
</ins><i><ins class="diff-new">
type
</ins></i><ins class="diff-new">
is
not
</ins><a class="tref internalDFN" title="null" href="#dfn-null"><ins class="diff-new">
null
</ins></a>,<ins class="diff-new">
add
a
member
</ins><code><ins class="diff-new">
@type
</ins></code><ins class="diff-new">
to
</ins><i><ins class="diff-new">
result
</ins></i><ins class="diff-new">
whose
value
is
set
to
</ins><i><ins class="diff-new">
type
</ins></i>.</li><li><ins class="diff-new">
Return
</ins><i><ins class="diff-new">
result
</ins></i>.</li>
</ol>
</li>
</ol>
</section>
</section>
<section id="data-round-tripping">
<h3>
<span class="secno">
<del class="diff-old">5.
</del>
<ins class="diff-chg">10.6
</ins>
</span>
Data
Round
Tripping
</h3>
<p>
When
<del class="diff-old">coercing
</del>
<a href="#rdf-conversion">
<ins class="diff-chg">converting
JSON-LD
to
RDF
</ins></a><ins class="diff-chg">
JSON-native
types
such
as
</ins><em>
numbers
</em>
<ins class="diff-new">and
</ins><em><ins class="diff-new">
booleans
</ins></em><ins class="diff-new">
are
automatically
coerced
</ins>
to
<code>
xsd:integer
<del class="diff-old">or
</del>
</code>,
<code>
xsd:double
<del class="diff-old">as
it,
e.g.,
happens
during
RDF
Conversion
,
implementers
must
</del>
</code>,
<ins class="diff-chg">or
</ins><code><ins class="diff-chg">
xsd:boolean
</ins></code>.<ins class="diff-chg">
Implementers
</ins><em class="rfc2119" title="MUST"><ins class="diff-chg">
MUST
</ins>
</em>
ensure
that
the
result
is
<del class="diff-old">a
</del>
<ins class="diff-chg">in
</ins><a class="tref internalDFN" title="canonical-lexical-form" href="#dfn-canonical-lexical-form">
canonical
lexical
form
<del class="diff-old">in
the
form
of
a
string
</del>
</a>.
A
<dfn title="canonical-lexical-form" id="dfn-canonical-lexical-form">
canonical
lexical
form
</dfn>
is
a
set
of
literals
from
among
the
valid
set
of
literals
for
a
datatype
such
that
there
is
a
one-to-one
mapping
between
the
<a class="tref internalDFN" title="canonical-lexical-form" href="#dfn-canonical-lexical-form">
canonical
lexical
form
</a>
and
a
value
in
the
value
space
as
defined
in
[
<cite>
<a class="bibref" href="#bib-XMLSCHEMA11-2">
XMLSCHEMA11-2
</a>
</cite>
<del class="diff-old">]].
</del>
<ins class="diff-chg">].
</ins>
In
other
words,
every
value
<del class="diff-old">must
</del>
<em class="rfc2119" title="MUST">
<ins class="diff-chg">MUST
</ins>
</em>
be
converted
to
a
deterministic
<a class="tref internalDFN" title="string" href="#dfn-string">
string
</a>
representation.
</p>
<p>
The
canonical
lexical
form
of
an
<em>
integer
</em>,
i.e.,
a
number
without
fractions
or
a
number
coerced
to
<code>
xsd:integer
<del class="diff-old">,
</del>
</code>,
is
a
finite-length
sequence
of
decimal
digits
(
<code>
0-9
</code>
)
with
an
optional
leading
minus
sign;
leading
<del class="diff-old">zeroes
</del>
<ins class="diff-chg">zeros
</ins>
are
prohibited.
To
convert
the
number
in
JavaScript,
implementers
can
use
the
following
snippet
of
code:
</p>
<div class="example">
<div class="example-title">
<span>
Example
<del class="diff-old">23
</del>
<ins class="diff-chg">12
</ins></span>:<ins class="diff-chg">
Sample
integer
serialization
implementation
in
JavaScript
</ins>
</div>
<pre class="example">
(value).toFixed(0).toString()
</pre>
</div>
<p>
The
canonical
lexical
form
of
a
<em>
double
</em>,
i.e.,
a
number
with
fractions
or
a
number
coerced
to
<code>
xsd:double
<del class="diff-old">,
</del>
</code>,
consists
of
a
mantissa
followed
by
the
character
&quot;E&quot;,
followed
by
an
exponent.
The
mantissa
<del class="diff-old">must
</del>
<em class="rfc2119" title="MUST">
<ins class="diff-chg">MUST
</ins>
</em>
be
a
decimal
number.
The
exponent
<del class="diff-old">must
</del>
<em class="rfc2119" title="MUST">
<ins class="diff-chg">MUST
</ins>
</em>
be
an
integer.
Leading
<del class="diff-old">zeroes
</del>
<ins class="diff-chg">zeros
</ins>
and
a
preceding
plus
sign
(
<code>
+
</code>
)
are
prohibited
in
the
exponent.
If
the
exponent
is
zero,
it
must
be
indicated
by
<code>
E0
</code>.
For
the
mantissa,
the
preceding
optional
plus
sign
is
prohibited
and
the
decimal
point
is
required.
Leading
and
trailing
<del class="diff-old">zeroes
</del>
<ins class="diff-chg">zeros
</ins>
are
prohibited
subject
to
the
following:
number
representations
must
be
normalized
such
that
there
is
a
single
digit
which
is
non-zero
to
the
left
of
the
decimal
point
and
at
least
a
single
digit
to
the
right
of
the
decimal
point
unless
the
value
being
represented
is
zero.
The
canonical
representation
for
zero
is
<code>
0.0E0
</code>.
<code>
<ins class="diff-new">xsd:double
</ins></code><ins class="diff-new">
's
value
space
is
defined
by
the
IEEE
double-precision
64-bit
floating
point
type
[
</ins><cite><a class="bibref" href="#bib-IEEE-754-1985"><ins class="diff-new">
IEEE-754-1985
</ins></a></cite><ins class="diff-new">
];
in
JSON-LD
the
mantissa
is
rounded
to
15
digits
after
the
decimal
point.
</ins></p><p>
To
convert
the
number
in
JavaScript,
implementers
can
use
the
following
snippet
of
code:
</p>
<div class="example">
<div class="example-title">
<span>
Example
<del class="diff-old">24
</del>
<ins class="diff-chg">13
</ins></span>:<ins class="diff-chg">
Sample
floating
point
number
serialization
implementation
in
JavaScript
</ins>
</div>
<pre class="example">
<del class="diff-old">(value).toExponential().replace(/e\+?/,'E')
</del>
<ins class="diff-chg">(value).toExponential(15).replace(/(\d)0*e\+?/,'$1E')
</ins>
</pre>
</div>
<del class="diff-old">xsd:double
's
value
space
is
defined
by
the
IEEE
double-precision
64-bit
floating
point
type
[
IEEE-754-1985
].
</del>
<div class="note">
<div class="note-title">
<span>
Note
</span>
</div>
<p class="">
When
data
such
as
decimals
need
to
be
normalized,
JSON-LD
authors
should
not
use
values
that
are
going
to
undergo
automatic
conversion.
This
is
due
to
the
lossy
nature
of
<code>
xsd:double
</code>
values.
Authors
should
instead
use
the
expanded
object
form
to
set
the
canonical
lexical
form
directly.
</p>
</div>
<del class="diff-old">Note
</del>
<p>
<ins class="diff-chg">The
canonical
lexical
form
of
the
</ins><em><ins class="diff-chg">
boolean
</ins></em><ins class="diff-chg">
values
</ins><a class="tref internalDFN" title="true" href="#dfn-true"><ins class="diff-chg">
true
</ins></a><ins class="diff-chg">
and
</ins><a class="tref internalDFN" title="false" href="#dfn-false"><ins class="diff-chg">
false
</ins></a><ins class="diff-chg">
are
the
strings
</ins><code><ins class="diff-chg">
true
</ins></code><ins class="diff-chg">
and
</ins><code><ins class="diff-chg">
false
</ins></code>.</p><p>
When
JSON-native
<del class="diff-old">datatypes,
like
</del>
<a class="tref internalDFN" title="number" href="#dfn-number">
number
</a>
s,
are
type
coerced,
lossless
data
round-tripping
can
not
be
<del class="diff-old">guaranted.
Consider
the
following
code
example:
var myObj1 = {
               &quot;@context&quot;: {
                 &quot;number&quot;: {
                   &quot;@id&quot;: &quot;http://example.com/vocab#number&quot;,
                   
                 }
               },
               &quot;number&quot; : 
             };
// Convert the JSON-LD document to RDF; this converts 42 to a string
var jsonldText = jsonld.toRDF(myObj1, myRdfTripleCollector);
// Convert the RDF triples back to a JavaScript object
var
myObj2
=
jsonld.fromRDF(myRdfTripleCollector.getTriples());
At
this
point,
myObj1
and
myObj2
will
have
different
values
for
the
&quot;number&quot;
property.
myObj1
will
have
the
number
</del>
<ins class="diff-chg">guaranteed
as
rounding
errors
might
occur.
Additionally,
only
literals
typed
as
</ins>
<code>
<del class="diff-old">42
</del>
<ins class="diff-chg">xsd:integer
</ins>
</code>,
<del class="diff-old">while
</del>
<code>
<del class="diff-old">myObj2
have
an
object
consisting
of
@value
set
to
the
string
&quot;42&quot;
</del>
<ins class="diff-chg">xsd:double
</ins></code>,
and
<code>
<del class="diff-old">@type
</del>
<ins class="diff-chg">xsd:boolean
</ins>
</code>
<del class="diff-old">set
</del>
<ins class="diff-chg">are
automatically
converted
back
</ins>
to
<del class="diff-old">the
expanded
value
of
xsd:nonNegativeInteger
.
</del>
<ins class="diff-chg">their
JSON-native
counterparts
in
when
</ins><a href="#rdf-conversion"><ins class="diff-chg">
converting
from
RDF
</ins></a>.
</p>
<del class="diff-old">Note
</del>
<p>
Some
JSON
serializers,
such
as
PHP's
native
implementation
in
some
versions,
backslash-escape
the
forward
slash
character.
For
example,
the
value
<code>
http://example.com/
</code>
would
be
serialized
as
<code>
http:\/\/example.com\/
</code>.
This
is
problematic
as
other
JSON
parsers
might
not
understand
those
escaping
characters.
There
is
no
need
to
backslash-escape
forward
slashes
in
JSON-LD.
To
aid
interoperability
between
JSON-LD
processors,
a
JSON-LD
serializer
<del class="diff-old">must
not
</del>
<em class="rfc2119" title="MUST NOT">
<ins class="diff-chg">MUST
NOT
</ins>
</em>
backslash-escape
forward
slashes.
</p>
</section>
</section>
<section id="the-application-programming-interface">
<h2>
<span class="secno">
<ins class="diff-new">11.
</ins></span><ins class="diff-new">
The
Application
Programming
Interface
</ins></h2><p><ins class="diff-new">
This
API
provides
a
clean
mechanism
that
enables
developers
to
convert
JSON-LD
data
into
a
a
variety
of
output
formats
that
are
often
easier
to
work
with.
A
conformant
JSON-LD
Processor
</ins><em class="rfc2119" title="MUST"><ins class="diff-new">
MUST
</ins></em><ins class="diff-new">
implement
the
entirety
of
the
following
API.
</ins></p><section id="jsonldprocessor"><h3><span class="secno"><ins class="diff-new">
11.1
</ins></span><ins class="diff-new">
JsonLdProcessor
</ins></h3><p><ins class="diff-new">
The
JSON-LD
Processor
interface
is
the
high-level
programming
structure
that
developers
use
to
access
the
JSON-LD
transformation
methods.
</ins></p><p><ins class="diff-new">
It
is
important
to
highlight
that
conformant
</ins><a class="tref internalDFN" title="json-ld-processor" href="#dfn-json-ld-processor"><ins class="diff-new">
JSON-LD
processors
</ins></a><em class="rfc2119" title="MUST NOT"><ins class="diff-new">
MUST
NOT
</ins></em><ins class="diff-new">
modify
the
input
parameters.
</ins></p>    <pre class="idl"><span class="idlInterface" id="idl-def-JsonLdProcessor">[<span class="extAttr">Constructor</span>]<ins class="diff-new">
interface <span class="idlInterfaceID">JsonLdProcessor</span> {
</ins><span class="idlMethod">    <span class="idlMethType"><a>void</a></span> <span class="idlMethName"><a href="#widl-JsonLdProcessor-expand-void-object-object---DOMString-input-JsonLdCallback-callback-JsonLdOptions-options">expand</a></span> (<span class="idlParam"><span class="idlParamType">(<a>object</a> or <a>object[]</a> or <a>DOMString</a>)</span> <span class="idlParamName">input</span></span>, <span class="idlParam"><span class="idlParamType"><a href="#idl-def-JsonLdCallback" class="idlType"><code>JsonLdCallback</code></a></span> <span class="idlParamName">callback</span></span>, <span class="idlParam">optional <span class="idlParamType"><a href="#idl-def-JsonLdOptions" class="idlType"><code>JsonLdOptions</code></a>?</span> <span class="idlParamName">options</span></span>);</span><span class="idlMethod">    <span class="idlMethType"><a>void</a></span> <span class="idlMethName"><a href="#widl-JsonLdProcessor-compact-void-object-object---DOMString-input-object-DOMString-context-JsonLdCallback-callback-JsonLdOptions-options">compact</a></span> (<span class="idlParam"><span class="idlParamType">(<a>object</a> or <a>object[]</a> or <a>DOMString</a>)</span> <span class="idlParamName">input</span></span>, <span class="idlParam"><span class="idlParamType">(<a>object</a> or <a>DOMString</a>)</span> <span class="idlParamName">context</span></span>, <span class="idlParam"><span class="idlParamType"><a href="#idl-def-JsonLdCallback" class="idlType"><code>JsonLdCallback</code></a></span> <span class="idlParamName">callback</span></span>, <span class="idlParam">optional <span class="idlParamType"><a href="#idl-def-JsonLdOptions" class="idlType"><code>JsonLdOptions</code></a>?</span> <span class="idlParamName">options</span></span>);</span><span class="idlMethod">    <span class="idlMethType"><a>void</a></span> <span class="idlMethName"><a href="#widl-JsonLdProcessor-flatten-void-object-object---DOMString-input-object-DOMString-context-JsonLdCallback-callback-JsonLdOptions-options">flatten</a></span> (<span class="idlParam"><span class="idlParamType">(<a>object</a> or <a>object[]</a> or <a>DOMString</a>)</span> <span class="idlParamName">input</span></span>, <span class="idlParam"><span class="idlParamType">(<a>object</a> or <a>DOMString</a>)?</span> <span class="idlParamName">context</span></span>, <span class="idlParam"><span class="idlParamType"><a href="#idl-def-JsonLdCallback" class="idlType"><code>JsonLdCallback</code></a></span> <span class="idlParamName">callback</span></span>, <span class="idlParam">optional <span class="idlParamType"><a href="#idl-def-JsonLdOptions" class="idlType"><code>JsonLdOptions</code></a>?</span> <span class="idlParamName">options</span></span>);</span><ins class="diff-new">
};
</ins></span></pre><section><h4 id="methods"><ins class="diff-new">
Methods
</ins></h4><dl class="methods"><dt id="widl-JsonLdProcessor-compact-void-object-object---DOMString-input-object-DOMString-context-JsonLdCallback-callback-JsonLdOptions-options"><code><ins class="diff-new">
compact
</ins></code></dt><dd><a href="#compaction"><ins class="diff-new">
Compacts
</ins></a><ins class="diff-new">
the
given
</ins><code><ins class="diff-new">
input
</ins></code><ins class="diff-new">
using
the
</ins><code><ins class="diff-new">
context
</ins></code><ins class="diff-new">
according
to
the
steps
in
the
</ins><a href="#compaction-algorithm"><ins class="diff-new">
Compaction
algorithm
</ins></a>.<table class="parameters"><tr><th><ins class="diff-new">
Parameter
</ins></th><th><ins class="diff-new">
Type
</ins></th><th><ins class="diff-new">
Nullable
</ins></th><th><ins class="diff-new">
Optional
</ins></th><th><ins class="diff-new">
Description
</ins></th></tr><tr><td class="prmName"><ins class="diff-new">
input
</ins></td><td class="prmType"><code><ins class="diff-new">
(
</ins><a><ins class="diff-new">
object
</ins></a><ins class="diff-new">
or
</ins><a><ins class="diff-new">
object[]
</ins></a><ins class="diff-new">
or
</ins><a><ins class="diff-new">
DOMString
</ins></a><ins class="diff-new">
)
</ins></code></td><td class="prmNullFalse"><ins class="diff-new">
✘
</ins></td><td class="prmOptFalse"><ins class="diff-new">
✘
</ins></td><td class="prmDesc"><ins class="diff-new">
The
JSON-LD
object
or
array
of
JSON-LD
objects
to
perform
the
compaction
upon
or
an
</ins><a class="tref internalDFN" title="iri" href="#dfn-iri"><abbr title="Internationalized Resource Identifier"><ins class="diff-new">
IRI
</ins></abbr></a><ins class="diff-new">
referencing
the
JSON-LD
document
to
compact.
</ins></td></tr><tr><td class="prmName"><ins class="diff-new">
context
</ins></td><td class="prmType"><code><ins class="diff-new">
(
</ins><a><ins class="diff-new">
object
</ins></a><ins class="diff-new">
or
</ins><a><ins class="diff-new">
DOMString
</ins></a><ins class="diff-new">
)
</ins></code></td><td class="prmNullFalse"><ins class="diff-new">
✘
</ins></td><td class="prmOptFalse"><ins class="diff-new">
✘
</ins></td><td class="prmDesc"><ins class="diff-new">
The
context
to
use
when
compacting
the
</ins><code><ins class="diff-new">
input
</ins></code><ins class="diff-new">
;
either
in
the
form
of
a
</ins><a class="tref internalDFN" title="json-object" href="#dfn-json-object"><ins class="diff-new">
JSON
object
</ins></a><ins class="diff-new">
or
as
</ins><a class="tref internalDFN" title="iri" href="#dfn-iri"><abbr title="Internationalized Resource Identifier"><ins class="diff-new">
IRI
</ins></abbr></a>.</td></tr><tr><td class="prmName"><ins class="diff-new">
callback
</ins></td><td class="prmType"><code><a href="#idl-def-JsonLdCallback" class="idlType"><code><ins class="diff-new">
JsonLdCallback
</ins></code></a></code></td><td class="prmNullFalse"><ins class="diff-new">
✘
</ins></td><td class="prmOptFalse"><ins class="diff-new">
✘
</ins></td><td class="prmDesc"><ins class="diff-new">
A
callback
that
is
called
when
processing
completed
successfully
on
the
given
</ins><code><ins class="diff-new">
input
</ins></code>,<ins class="diff-new">
or
a
fatal
error
prevented
processing
from
completing.
</ins></td></tr><tr><td class="prmName"><ins class="diff-new">
options
</ins></td><td class="prmType"><code><a href="#idl-def-JsonLdOptions" class="idlType"><code><ins class="diff-new">
JsonLdOptions
</ins></code></a></code></td><td class="prmNullTrue"><ins class="diff-new">
✔
</ins></td><td class="prmOptTrue"><ins class="diff-new">
✔
</ins></td><td class="prmDesc"><ins class="diff-new">
A
set
of
options
to
configure
the
algorithms.
This
allows,
e.g.,
to
set
the
input
document's
base
</ins><a class="tref internalDFN" title="iri" href="#dfn-iri"><abbr title="Internationalized Resource Identifier"><ins class="diff-new">
IRI
</ins></abbr></a>.</td></tr></table><div><em><ins class="diff-new">
Return
type:
</ins></em><code><a><ins class="diff-new">
void
</ins></a></code>
</div>
</dd>
<dt id="widl-JsonLdProcessor-expand-void-object-object---DOMString-input-JsonLdCallback-callback-JsonLdOptions-options">
<code>
<ins class="diff-new">expand
</ins></code></dt><dd><a href="#expansion"><ins class="diff-new">
Expands
</ins></a><ins class="diff-new">
the
given
</ins><code><ins class="diff-new">
input
</ins></code><ins class="diff-new">
according
to
the
steps
in
the
</ins><a href="#expansion-algorithm"><ins class="diff-new">
Expansion
algorithm
</ins></a>.<table class="parameters"><tr><th><ins class="diff-new">
Parameter
</ins></th><th><ins class="diff-new">
Type
</ins></th><th><ins class="diff-new">
Nullable
</ins></th><th><ins class="diff-new">
Optional
</ins></th><th><ins class="diff-new">
Description
</ins></th></tr><tr><td class="prmName"><ins class="diff-new">
input
</ins></td><td class="prmType"><code><ins class="diff-new">
(
</ins><a><ins class="diff-new">
object
</ins></a><ins class="diff-new">
or
</ins><a><ins class="diff-new">
object[]
</ins></a><ins class="diff-new">
or
</ins><a><ins class="diff-new">
DOMString
</ins></a><ins class="diff-new">
)
</ins></code></td><td class="prmNullFalse"><ins class="diff-new">
✘
</ins></td><td class="prmOptFalse"><ins class="diff-new">
✘
</ins></td><td class="prmDesc"><ins class="diff-new">
The
JSON-LD
object
or
array
of
JSON-LD
objects
to
perform
the
expansion
upon
or
an
</ins><a class="tref internalDFN" title="iri" href="#dfn-iri"><abbr title="Internationalized Resource Identifier"><ins class="diff-new">
IRI
</ins></abbr></a><ins class="diff-new">
referencing
the
JSON-LD
document
to
expand.
</ins></td></tr><tr><td class="prmName"><ins class="diff-new">
callback
</ins></td><td class="prmType"><code><a href="#idl-def-JsonLdCallback" class="idlType"><code><ins class="diff-new">
JsonLdCallback
</ins></code></a></code></td><td class="prmNullFalse"><ins class="diff-new">
✘
</ins></td><td class="prmOptFalse"><ins class="diff-new">
✘
</ins></td><td class="prmDesc"><ins class="diff-new">
A
callback
that
is
called
when
processing
completed
successfully
on
the
given
</ins><code><ins class="diff-new">
input
</ins></code>,<ins class="diff-new">
or
a
fatal
error
prevented
processing
from
completing.
</ins></td></tr><tr><td class="prmName"><ins class="diff-new">
options
</ins></td><td class="prmType"><code><a href="#idl-def-JsonLdOptions" class="idlType"><code><ins class="diff-new">
JsonLdOptions
</ins></code></a></code></td><td class="prmNullTrue"><ins class="diff-new">
✔
</ins></td><td class="prmOptTrue"><ins class="diff-new">
✔
</ins></td><td class="prmDesc"><ins class="diff-new">
A
set
of
options
to
configure
the
used
algorithms
such.
This
allows,
e.g.,
to
set
the
input
document's
base
</ins><a class="tref internalDFN" title="iri" href="#dfn-iri"><abbr title="Internationalized Resource Identifier"><ins class="diff-new">
IRI
</ins></abbr></a>.</td></tr></table><div><em><ins class="diff-new">
Return
type:
</ins></em><code><a><ins class="diff-new">
void
</ins></a></code>
</div>
</dd>
<dt id="widl-JsonLdProcessor-flatten-void-object-object---DOMString-input-object-DOMString-context-JsonLdCallback-callback-JsonLdOptions-options">
<code>
<ins class="diff-chg">flatten
</ins></code></dt><dd><a href="#flattening"><ins class="diff-chg">
Flattens
</ins></a><ins class="diff-chg">
the
given
</ins><code><ins class="diff-chg">
input
</ins></code><ins class="diff-chg">
and
</ins><a href="#compaction"><ins class="diff-chg">
compacts
</ins></a><ins class="diff-chg">
it
using
the
passed
</ins><code><ins class="diff-chg">
context
</ins></code><ins class="diff-chg">
according
to
the
steps
in
the
</ins><a href="#flattening-algorithm"><ins class="diff-chg">
Flattening
algorithm
</ins></a>.<table class="parameters"><tr><th><ins class="diff-chg">
Parameter
</ins></th><th><ins class="diff-chg">
Type
</ins></th><th><ins class="diff-chg">
Nullable
</ins></th><th><ins class="diff-chg">
Optional
</ins></th><th><ins class="diff-chg">
Description
</ins></th></tr><tr><td class="prmName"><ins class="diff-chg">
input
</ins></td><td class="prmType"><code><ins class="diff-chg">
(
</ins><a><ins class="diff-chg">
object
</ins></a><ins class="diff-chg">
or
</ins><a><ins class="diff-chg">
object[]
</ins></a><ins class="diff-chg">
or
</ins><a><ins class="diff-chg">
DOMString
</ins></a><ins class="diff-chg">
)
</ins></code></td><td class="prmNullFalse"><ins class="diff-chg">
✘
</ins></td><td class="prmOptFalse"><ins class="diff-chg">
✘
</ins></td><td class="prmDesc"><ins class="diff-chg">
The
JSON-LD
object
or
array
of
JSON-LD
objects
or
an
</ins><a class="tref internalDFN" title="iri" href="#dfn-iri"><abbr title="Internationalized Resource Identifier"><ins class="diff-chg">
IRI
</ins></abbr></a><ins class="diff-chg">
referencing
the
JSON-LD
document
to
flatten.
</ins></td></tr><tr><td class="prmName"><ins class="diff-chg">
context
</ins></td><td class="prmType"><code><ins class="diff-chg">
(
</ins><a><ins class="diff-chg">
object
</ins></a><ins class="diff-chg">
or
</ins><a><ins class="diff-chg">
DOMString
</ins></a><ins class="diff-chg">
)
</ins></code></td><td class="prmNullTrue"><ins class="diff-chg">
✔
</ins></td><td class="prmOptFalse"><ins class="diff-chg">
✘
</ins></td><td class="prmDesc"><ins class="diff-chg">
The
context
to
use
when
compacting
the
flattened
</ins><code><ins class="diff-chg">
input
</ins></code><ins class="diff-chg">
;
either
in
the
form
of
a
</ins><a class="tref internalDFN" title="json-object" href="#dfn-json-object"><ins class="diff-chg">
JSON
object
</ins></a><ins class="diff-chg">
or
as
</ins><a class="tref internalDFN" title="iri" href="#dfn-iri"><abbr title="Internationalized Resource Identifier"><ins class="diff-chg">
IRI
</ins></abbr></a>.<ins class="diff-chg">
If
</ins><a class="tref internalDFN" title="null" href="#dfn-null"><ins class="diff-chg">
null
</ins></a><ins class="diff-chg">
is
passed,
the
result
will
not
be
compacted
but
kept
in
expanded
form.
</ins></td></tr><tr><td class="prmName"><ins class="diff-chg">
callback
</ins></td><td class="prmType"><code><a href="#idl-def-JsonLdCallback" class="idlType"><code><ins class="diff-chg">
JsonLdCallback
</ins></code></a></code></td><td class="prmNullFalse"><ins class="diff-chg">
✘
</ins></td><td class="prmOptFalse"><ins class="diff-chg">
✘
</ins></td><td class="prmDesc"><ins class="diff-chg">
A
callback
that
is
called
when
processing
completed
successfully
on
the
given
</ins><code><ins class="diff-chg">
input
</ins></code>,<ins class="diff-chg">
or
a
fatal
error
prevented
processing
from
completing.
</ins></td></tr><tr><td class="prmName"><ins class="diff-chg">
options
</ins></td><td class="prmType"><code><a href="#idl-def-JsonLdOptions" class="idlType"><code><ins class="diff-chg">
JsonLdOptions
</ins></code></a></code></td><td class="prmNullTrue"><ins class="diff-chg">
✔
</ins></td><td class="prmOptTrue"><ins class="diff-chg">
✔
</ins></td><td class="prmDesc"><ins class="diff-chg">
A
set
of
options
to
configure
the
used
algorithms
such.
This
allows,
e.g.,
to
set
the
input
document's
base
</ins><a class="tref internalDFN" title="iri" href="#dfn-iri"><abbr title="Internationalized Resource Identifier"><ins class="diff-chg">
IRI
</ins></abbr></a>.</td></tr></table><div><em><ins class="diff-chg">
Return
type:
</ins></em><code><a><ins class="diff-chg">
void
</ins></a></code></div></dd></dl></section></section><section id="callbacks"><h3>
<span class="secno">
<del class="diff-old">A.
</del>
<ins class="diff-chg">11.2
</ins>
</span>
<del class="diff-old">Initial
Context
</del>
<ins class="diff-chg">Callbacks
</ins></h3><p><ins class="diff-chg">
JSON-LD
processors
utilize
callbacks
in
order
to
exchange
information
in
an
asynchronous
manner
with
applications.
This
section
details
the
parameters
of
those
callbacks.
</ins></p><section><h4 id="jsonldcallback"><ins class="diff-chg">
JsonLdCallback
</ins></h4><p><ins class="diff-chg">
The
</ins><a href="#idl-def-JsonLdCallback" class="idlType"><code><ins class="diff-chg">
JsonLdCallback
</ins></code></a><ins class="diff-chg">
is
called
when
an
API
method
of
</ins><a href="#idl-def-JsonLdProcessor" class="idlType"><code><ins class="diff-chg">
JsonLdProcessor
</ins></code></a><ins class="diff-chg">
has
been
completed,
either
successfully
or
by
a
fatal
error.
</ins></p><pre class="idl"><span class="idlCallback" id="idl-def-JsonLdCallback"><ins class="diff-chg">
callback
</ins><span class="idlCallbackID"><ins class="diff-chg">
JsonLdCallback
</ins></span><ins class="diff-chg">
=
</ins><span class="idlCallbackType"><a><ins class="diff-chg">
void
</ins></a></span><ins class="diff-chg">
(
</ins><span class="idlParam"><span class="idlParamType"><a href="#idl-def-JsonLdError" class="idlType"><code><ins class="diff-chg">
JsonLdError
</ins></code></a></span><span class="idlParamName"><ins class="diff-chg">
error
</ins></span></span>,<span class="idlParam"><span class="idlParamType"><a><ins class="diff-chg">
object
or
object
</ins></a><ins class="diff-chg">
[]
</ins></span><span class="idlParamName"><ins class="diff-chg">
document
</ins></span></span><ins class="diff-chg">
);
</ins></span></pre><section><h5 id="callback-jsonldcallback-parameters"><ins class="diff-chg">
Callback
</ins><a class="idlType" href="#idl-def-JsonLdCallback"><code><ins class="diff-chg">
JsonLdCallback
</ins></code></a><ins class="diff-chg">
Parameters
</ins></h5><dl class="callback-members"><dt id="widl-JsonLdCallback-error"><code><ins class="diff-chg">
error
</ins></code><ins class="diff-chg">
of
type
</ins><span class="idlMemberType"><a href="#idl-def-JsonLdError" class="idlType"><code><ins class="diff-chg">
JsonLdError
</ins></code></a></span></dt><dd><ins class="diff-chg">
If
the
value
is
</ins><a class="tref internalDFN" title="null" href="#dfn-null"><ins class="diff-chg">
null
</ins></a>,<ins class="diff-chg">
then
no
issue
was
detected
during
processing.
Otherwise,
a
processing
error
was
detected
and
the
details
are
contained
within
the
</ins><em><ins class="diff-chg">
error
</ins></em><ins class="diff-chg">
object.
</ins></dd><dt id="widl-JsonLdCallback-document"><code><ins class="diff-chg">
document
</ins></code><ins class="diff-chg">
of
type
array
of
</ins><span class="idlMemberType"><a><ins class="diff-chg">
object
or
object
</ins></a></span></dt><dd><ins class="diff-chg">
The
processed
JSON-LD
document.
</ins></dd></dl></section></section><section><h4 id="loadcontextcallback"><ins class="diff-chg">
LoadContextCallback
</ins></h4><p><ins class="diff-chg">
The
</ins><a href="#idl-def-LoadContextCallback" class="idlType"><code><ins class="diff-chg">
LoadContextCallback
</ins></code></a><ins class="diff-chg">
defines
the
callback
that
custom
context
loaders
have
to
implement
to
be
used
to
retrieve
remote
contexts.
</ins></p><pre class="idl"><span class="idlCallback" id="idl-def-LoadContextCallback"><ins class="diff-chg">
callback
</ins><span class="idlCallbackID"><ins class="diff-chg">
LoadContextCallback
</ins></span><ins class="diff-chg">
=
</ins><span class="idlCallbackType"><a><ins class="diff-chg">
void
</ins></a></span><ins class="diff-chg">
(
</ins><span class="idlParam"><span class="idlParamType"><a><ins class="diff-chg">
DOMString
</ins></a></span><span class="idlParamName"><ins class="diff-chg">
url
</ins></span></span>,<span class="idlParam"><span class="idlParamType"><a href="#idl-def-ContextLoadedCallback" class="idlType"><code><ins class="diff-chg">
ContextLoadedCallback
</ins></code></a></span><span class="idlParamName"><ins class="diff-chg">
callback
</ins></span></span><ins class="diff-chg">
);
</ins></span></pre><section><h5 id="callback-loadcontextcallback-parameters"><ins class="diff-chg">
Callback
</ins><a class="idlType" href="#idl-def-LoadContextCallback"><code><ins class="diff-chg">
LoadContextCallback
</ins></code></a><ins class="diff-chg">
Parameters
</ins></h5><dl class="callback-members"><dt id="widl-LoadContextCallback-url"><code><ins class="diff-chg">
url
</ins></code><ins class="diff-chg">
of
type
</ins><span class="idlMemberType"><a><ins class="diff-chg">
DOMString
</ins></a></span></dt><dd><ins class="diff-chg">
The
URL
of
the
remote
context
to
load.
</ins></dd><dt id="widl-LoadContextCallback-callback"><code><ins class="diff-chg">
callback
</ins></code><ins class="diff-chg">
of
type
</ins><span class="idlMemberType"><a href="#idl-def-ContextLoadedCallback" class="idlType"><code><ins class="diff-chg">
ContextLoadedCallback
</ins></code></a></span></dt><dd><ins class="diff-chg">
The
callback
that
is
called
when
the
remote
context
has
been
successfully
loaded
or
an
error
preventing
its
loading
has
been
detected.
</ins></dd></dl></section></section><section><h4 id="contextloadedcallback"><ins class="diff-chg">
ContextLoadedCallback
</ins></h4><p><ins class="diff-chg">
The
</ins><a href="#idl-def-ContextLoadedCallback" class="idlType"><code><ins class="diff-chg">
ContextLoadedCallback
</ins></code></a><ins class="diff-chg">
is
called
in
response
to
a
call
of
the
</ins><a href="#idl-def-LoadContextCallback" class="idlType"><code><ins class="diff-chg">
LoadContextCallback
</ins></code></a>.</p><pre class="idl"><span class="idlCallback" id="idl-def-ContextLoadedCallback"><ins class="diff-chg">
callback
</ins><span class="idlCallbackID"><ins class="diff-chg">
ContextLoadedCallback
</ins></span><ins class="diff-chg">
=
</ins><span class="idlCallbackType"><a><ins class="diff-chg">
void
</ins></a></span><ins class="diff-chg">
(
</ins><span class="idlParam"><span class="idlParamType"><a href="#idl-def-JsonLdError" class="idlType"><code><ins class="diff-chg">
JsonLdError
</ins></code></a></span><span class="idlParamName"><ins class="diff-chg">
error
</ins></span></span>,<span class="idlParam"><span class="idlParamType"><a><ins class="diff-chg">
DOMString
</ins></a></span><span class="idlParamName"><ins class="diff-chg">
url
</ins></span></span>,<span class="idlParam"><span class="idlParamType"><a><ins class="diff-chg">
DOMString
</ins></a></span><span class="idlParamName"><ins class="diff-chg">
context
</ins></span></span><ins class="diff-chg">
);
</ins></span></pre><section><h5 id="callback-contextloadedcallback-parameters"><ins class="diff-chg">
Callback
</ins><a class="idlType" href="#idl-def-ContextLoadedCallback"><code><ins class="diff-chg">
ContextLoadedCallback
</ins></code></a><ins class="diff-chg">
Parameters
</ins></h5><dl class="callback-members"><dt id="widl-ContextLoadedCallback-error"><code><ins class="diff-chg">
error
</ins></code><ins class="diff-chg">
of
type
</ins><span class="idlMemberType"><a href="#idl-def-JsonLdError" class="idlType"><code><ins class="diff-chg">
JsonLdError
</ins></code></a></span></dt><dd><ins class="diff-chg">
If
the
value
is
</ins><a class="tref internalDFN" title="null" href="#dfn-null"><ins class="diff-chg">
null
</ins></a>,<ins class="diff-chg">
then
no
issue
was
detected
during
processing.
Otherwise,
a
processing
issue
was
detected
and
the
details
are
contained
within
the
</ins><em><ins class="diff-chg">
error
</ins></em><ins class="diff-chg">
object.
All
errors
</ins><em class="rfc2119" title="MUST"><ins class="diff-chg">
MUST
</ins></em><ins class="diff-chg">
have
a
</ins><a href="#idl-def-JsonLdErrorCode" class="idlType"><code><ins class="diff-chg">
JsonLdErrorCode
</ins></code></a><ins class="diff-chg">
of
</ins><code class="error"><a href="#idl-def-JsonLdErrorCode.loading-remote-context-failed"><ins class="diff-chg">
loading
remote
context
failed
</ins></a></code>.</dd><dt id="widl-ContextLoadedCallback-url"><code><ins class="diff-chg">
url
</ins></code><ins class="diff-chg">
of
type
</ins><span class="idlMemberType"><a><ins class="diff-chg">
DOMString
</ins></a></span></dt><dd><ins class="diff-chg">
The
final
URL
of
the
loaded
JSON-LD
context.
This
is
important
to
handle
HTTP
redirects
properly.
</ins></dd><dt id="widl-ContextLoadedCallback-context"><code><ins class="diff-chg">
context
</ins></code><ins class="diff-chg">
of
type
</ins><span class="idlMemberType"><a><ins class="diff-chg">
DOMString
</ins></a></span></dt><dd><ins class="diff-chg">
The
raw
content
of
the
retrieved
JSON-LD
context.
</ins></dd></dl></section></section></section><section id="data-structures"><h3><span class="secno"><ins class="diff-chg">
11.3
</ins></span><ins class="diff-chg">
Data
Structures
</ins></h3><p><ins class="diff-chg">
This
section
describes
datatype
definitions
used
within
the
JSON-LD
API.
</ins></p><section><h4 id="jsonldoptions"><ins class="diff-chg">
JsonLdOptions
</ins></h4><p><ins class="diff-chg">
The
</ins><a href="#idl-def-JsonLdOptions" class="idlType"><code><ins class="diff-chg">
JsonLdOptions
</ins></code></a><ins class="diff-chg">
type
is
used
to
pass
various
options
to
the
</ins><a href="#idl-def-JsonLdProcessor" class="idlType"><code><ins class="diff-chg">
JsonLdProcessor
</ins></code></a><ins class="diff-chg">
methods.
</ins></p>      <pre class="idl"><span class="idlDictionary" id="idl-def-JsonLdOptions">dictionary <span class="idlDictionaryID">JsonLdOptions</span> {<span class="idlMember">    <span class="idlMemberType"><a>DOMString</a></span>           <span class="idlMemberName"><a href="#widl-JsonLdOptions-base">base</a></span>;</span><span class="idlMember">    <span class="idlMemberType"><a>boolean</a></span>             <span class="idlMemberName"><a href="#widl-JsonLdOptions-compactArrays">compactArrays</a></span> = <span class="idlMemberValue">true</span>;</span><span class="idlMember">    <span class="idlMemberType"><a href="#idl-def-LoadContextCallback" class="idlType"><code>LoadContextCallback</code></a></span> <span class="idlMemberName"><a href="#widl-JsonLdOptions-loadContext">loadContext</a></span>;</span><span class="idlMember">    <span class="idlMemberType"><a>object or DOMString</a></span> <span class="idlMemberName"><a href="#widl-JsonLdOptions-expandContext">expandContext</a></span> = <span class="idlMemberValue">null</span>;</span><span class="idlMember">    <span class="idlMemberType"><a>DOMString</a></span>           <span class="idlMemberName"><a href="#widl-JsonLdOptions-processingMode">processingMode</a></span> = <span class="idlMemberValue">&quot;json-ld-1.0&quot;</span>;</span><ins class="diff-chg">
};
</ins></span></pre><section><h5 id="dictionary-jsonldoptions-members"><ins class="diff-chg">
Dictionary
</ins><a class="idlType" href="#idl-def-JsonLdOptions"><code><ins class="diff-chg">
JsonLdOptions
</ins></code></a><ins class="diff-chg">
Members
</ins></h5><dl class="dictionary-members"><dt id="widl-JsonLdOptions-base"><code><ins class="diff-chg">
base
</ins></code><ins class="diff-chg">
of
type
</ins><span class="idlMemberType"><a><ins class="diff-chg">
DOMString
</ins></a></span></dt><dd><ins class="diff-chg">
The
Base
</ins><abbr title="Internationalized Resource Identifier"><ins class="diff-chg">
IRI
</ins></abbr><ins class="diff-chg">
to
use
when
expanding
or
compacting
the
document.
This
overrides
the
value
of
</ins><em><ins class="diff-chg">
input
</ins></em><ins class="diff-chg">
if
it
is
a
</ins><a><abbr title="Internationalized Resource Identifier"><ins class="diff-chg">
IRI
</ins></abbr></a>.<ins class="diff-chg">
If
not
specified
and
</ins><em><ins class="diff-chg">
input
</ins></em><ins class="diff-chg">
is
not
an
</ins><a><abbr title="Internationalized Resource Identifier"><ins class="diff-chg">
IRI
</ins></abbr></a>,<ins class="diff-chg">
the
base
</ins><abbr title="Internationalized Resource Identifier"><ins class="diff-chg">
IRI
</ins></abbr><ins class="diff-chg">
defaults
to
the
current
document
</ins><abbr title="Internationalized Resource Identifier"><ins class="diff-chg">
IRI
</ins></abbr><ins class="diff-chg">
if
in
a
browser
context,
or
the
empty
string
if
there
is
no
document
context.
</ins>
<div class="issue">
<div class="issue-title">
<a href="https://github.com/json-ld/json-ld.org/issues/223">
<span>
Issue
<del class="diff-old">8
</del>
<ins class="diff-chg">223
</ins>
</span>
</a>:
<ins class="diff-new">Feature
at
risk
</ins>
</div>
<del class="diff-old">It
</del>
<p class="atrisk">
<ins class="diff-chg">The
default
value
of
this
option
implies
that
all
IRIs
that
cannot
be
compacted
otherwise
are
transformed
to
relative
IRIs
during
compaction.
To
avoid
that
data
</ins>
is
<del class="diff-old">still
</del>
being
<del class="diff-old">discussed
</del>
<ins class="diff-chg">lost,
developers
thus
have
to
store
the
base
</ins><abbr title="Internationalized Resource Identifier"><ins class="diff-chg">
IRI
</ins></abbr><ins class="diff-chg">
along
with
the
compacted
document.
This
might
be
problematic
in
practice
and
thus
the
default
behavior
might
be
changed
in
future.
Furthermore,
the
relationship
of
this
option
to
the
</ins><code><ins class="diff-chg">
@base
</ins></code><ins class="diff-chg">
keyword
(which
is
at
risk)
should
be
further
investigated.
</ins></p></div></dd><dt id="widl-JsonLdOptions-compactArrays"><code><ins class="diff-chg">
compactArrays
</ins></code><ins class="diff-chg">
of
type
</ins><span class="idlMemberType"><a><ins class="diff-chg">
boolean
</ins>
</a>
<del class="diff-old">whether
</del>
</span>,
<ins class="diff-chg">defaulting
to
</ins><code><ins class="diff-chg">
true
</ins></code></dt><dd><ins class="diff-chg">
If
set
to
</ins><code><ins class="diff-chg">
true
</ins></code>,<ins class="diff-chg">
the
</ins>
JSON-LD
<del class="diff-old">has
</del>
<ins class="diff-chg">processor
replaces
arrays
with
just
one
element
with
that
element
during
compaction.
If
set
to
</ins><code><ins class="diff-chg">
false
</ins></code>,<ins class="diff-chg">
all
arrays
will
remain
arrays
even
if
they
have
just
one
element.
</ins></dd><dt id="widl-JsonLdOptions-expandContext"><code><ins class="diff-chg">
expandContext
</ins></code><ins class="diff-chg">
of
type
</ins><span class="idlMemberType"><a><ins class="diff-chg">
object
or
DOMString
</ins></a></span>,<ins class="diff-chg">
defaulting
to
</ins><code><ins class="diff-chg">
null
</ins></code></dt><dd><ins class="diff-chg">
A
context
that
is
used
to
initialize
</ins>
the
<del class="diff-old">notion
</del>
<ins class="diff-chg">active
context
when
expanding
a
document.
</ins></dd><dt id="widl-JsonLdOptions-loadContext"><code><ins class="diff-chg">
loadContext
</ins></code>
of
<del class="diff-old">an
initial
</del>
<ins class="diff-chg">type
</ins><span class="idlMemberType"><a href="#idl-def-LoadContextCallback" class="idlType"><code><ins class="diff-chg">
LoadContextCallback
</ins></code></a></span></dt><dd><ins class="diff-chg">
The
callback
of
the
</ins>
context
<del class="diff-old">or
not.
</del>
<ins class="diff-chg">loader
to
be
used
to
retrieve
remote
contexts.
</ins>
If
<del class="diff-old">JSON-LD
has
an
initial
context,
</del>
<ins class="diff-chg">specified,
</ins>
it
<del class="diff-old">must
</del>
<em class="rfc2119" title="MUST">
<ins class="diff-chg">MUST
</ins>
</em>
be
<del class="diff-old">specified
external
</del>
<ins class="diff-chg">used
</ins>
to
<ins class="diff-new">retrieve
remote
contexts;
otherwise,
if
not
specified,
the
processor's
built-in
context
loader
</ins><em class="rfc2119" title="MUST"><ins class="diff-new">
MUST
</ins></em><ins class="diff-new">
be
used.
</ins></dd><dt id="widl-JsonLdOptions-processingMode"><code><ins class="diff-new">
processingMode
</ins></code><ins class="diff-new">
of
type
</ins><span class="idlMemberType"><a><ins class="diff-new">
DOMString
</ins></a></span>,<ins class="diff-new">
defaulting
to
</ins><code><ins class="diff-new">
&quot;json-ld-1.0&quot;
</ins></code></dt><dd><ins class="diff-new">
If
set
to
</ins><code><ins class="diff-new">
json-ld-1.0
</ins></code>,
the
JSON-LD
<del class="diff-old">Syntax
</del>
<ins class="diff-chg">Processor
</ins><em class="rfc2119" title="MUST"><ins class="diff-chg">
MUST
</ins></em><ins class="diff-chg">
produce
exactly
the
same
results
as
the
algorithms
defined
in
this
specification.
If
set
to
another
value,
the
JSON-LD
Processor
is
allowed
to
extend
or
modify
the
algorithms
defined
in
this
</ins>
specification
<del class="diff-old">at
</del>
<ins class="diff-chg">to
enable
application-specific
optimizations.
The
definition
of
such
optimizations
is
beyond
the
scope
of
this
specification
and
thus
not
defined.
Consequently,
different
implementations
</ins><em class="rfc2119" title="MAY"><ins class="diff-chg">
MAY
</ins></em><ins class="diff-chg">
implement
different
optimizations.
Developers
</ins><em class="rfc2119" title="MUST NOT"><ins class="diff-chg">
MUST
NOT
</ins></em><ins class="diff-chg">
define
modes
beginning
with
</ins><code><ins class="diff-chg">
json-ld
</ins></code><ins class="diff-chg">
as
they
are
reserved
for
future
versions
of
this
specification.
</ins></dd></dl></section></section><section><h4 id="jsonlderror"><ins class="diff-chg">
JsonLdError
</ins></h4><p><ins class="diff-chg">
The
</ins><a href="#idl-def-JsonLdError" class="idlType"><code><ins class="diff-chg">
JsonLdError
</ins></code></a><ins class="diff-chg">
type
is
used
to
report
processing
errors
to
</ins>
a
<del class="diff-old">well-known
location.
</del>
<a href="#idl-def-JsonLdCallback" class="idlType">
<code>
<ins class="diff-chg">JsonLdCallback
</ins></code></a>.
</p>
      <pre class="idl"><span class="idlDictionary" id="idl-def-JsonLdError">dictionary <span class="idlDictionaryID">JsonLdError</span> {
<span class="idlMember">    <span class="idlMemberType"><a href="#idl-def-JsonLdErrorCode" class="idlType"><code>JsonLdErrorCode</code></a></span> <span class="idlMemberName"><a href="#widl-JsonLdError-code">code</a></span>;</span>
<span class="idlMember">    <span class="idlMemberType"><a>DOMString</a>?</span>      <span class="idlMemberName"><a href="#widl-JsonLdError-message">message</a></span>;</span>
<ins class="diff-new">};
</ins></span>
</pre>
<section>
<h5 id="dictionary-jsonlderror-members">
<ins class="diff-chg">Dictionary
</ins><a class="idlType" href="#idl-def-JsonLdError"><code><ins class="diff-chg">
JsonLdError
</ins></code></a><ins class="diff-chg">
Members
</ins></h5><dl class="dictionary-members"><dt id="widl-JsonLdError-code"><code><ins class="diff-chg">
code
</ins></code><ins class="diff-chg">
of
type
</ins><span class="idlMemberType"><a href="#idl-def-JsonLdErrorCode" class="idlType"><code><ins class="diff-chg">
JsonLdErrorCode
</ins></code></a></span></dt><dd><ins class="diff-chg">
a
string
representing
the
particular
error
type,
as
described
in
the
various
algorithms
in
this
document.
</ins></dd><dt id="widl-JsonLdError-message"><code><ins class="diff-chg">
message
</ins></code><ins class="diff-chg">
of
type
</ins><span class="idlMemberType"><a><ins class="diff-chg">
DOMString
</ins></a></span>,<ins class="diff-chg">
nullable
</ins></dt><dd><ins class="diff-chg">
an
optional
error
message
containing
additional
debugging
information.
The
specific
contents
of
error
messages
are
outside
the
scope
of
this
specification.
</ins></dd></dl></section></section><section><h4 id="jsonlderrorcode"><ins class="diff-chg">
JsonLdErrorCode
</ins></h4><p><ins class="diff-chg">
The
</ins><a href="#idl-def-JsonLdErrorCode" class="idlType"><code><ins class="diff-chg">
JsonLdErrorCode
</ins></code></a><ins class="diff-chg">
represents
the
collection
of
valid
JSON-LD
error
codes.
</ins></p>      <pre class="idl"><span class="idlEnum" id="idl-def-JsonLdErrorCode">enum <span class="idlEnumID">JsonLdErrorCode</span> {<ins class="diff-chg">
    &quot;<a href="#idl-def-JsonLdErrorCode.invalid-syntax" class="idlEnumItem">invalid syntax</a>&quot;,
    &quot;<a href="#idl-def-JsonLdErrorCode.list-of-lists-detected" class="idlEnumItem">list of lists detected</a>&quot;,
    &quot;<a href="#idl-def-JsonLdErrorCode.invalid--index-value" class="idlEnumItem">invalid @index value</a>&quot;,
    &quot;<a href="#idl-def-JsonLdErrorCode.conflicting-indexes" class="idlEnumItem">conflicting indexes</a>&quot;,
    &quot;<a href="#idl-def-JsonLdErrorCode.invalid--id-value" class="idlEnumItem">invalid @id value</a>&quot;,
    &quot;<a href="#idl-def-JsonLdErrorCode.invalid-local-context" class="idlEnumItem">invalid local context</a>&quot;,
    &quot;<a href="#idl-def-JsonLdErrorCode.loading-remote-context-failed" class="idlEnumItem">loading remote context failed</a>&quot;,
    &quot;<a href="#idl-def-JsonLdErrorCode.invalid-remote-context" class="idlEnumItem">invalid remote context</a>&quot;,
    &quot;<a href="#idl-def-JsonLdErrorCode.recursive-context-inclusion" class="idlEnumItem">recursive context inclusion</a>&quot;,
    &quot;<a href="#idl-def-JsonLdErrorCode.invalid-base-IRI" class="idlEnumItem">invalid base IRI</a>&quot;,
    &quot;<a href="#idl-def-JsonLdErrorCode.invalid-vocab-mapping" class="idlEnumItem">invalid vocab mapping</a>&quot;,
    &quot;<a href="#idl-def-JsonLdErrorCode.invalid-default-language" class="idlEnumItem">invalid default language</a>&quot;,
    &quot;<a href="#idl-def-JsonLdErrorCode.keyword-redefinition" class="idlEnumItem">keyword redefinition</a>&quot;,
    &quot;<a href="#idl-def-JsonLdErrorCode.invalid-term-definition" class="idlEnumItem">invalid term definition</a>&quot;,
    &quot;<a href="#idl-def-JsonLdErrorCode.invalid-reverse-property" class="idlEnumItem">invalid reverse property</a>&quot;,
    &quot;<a href="#idl-def-JsonLdErrorCode.invalid-IRI-mapping" class="idlEnumItem">invalid IRI mapping</a>&quot;,
    &quot;<a href="#idl-def-JsonLdErrorCode.cyclic-IRI-mapping" class="idlEnumItem">cyclic IRI mapping</a>&quot;,
    &quot;<a href="#idl-def-JsonLdErrorCode.invalid-keyword-alias" class="idlEnumItem">invalid keyword alias</a>&quot;,
    &quot;<a href="#idl-def-JsonLdErrorCode.invalid-type-mapping" class="idlEnumItem">invalid type mapping</a>&quot;,
    &quot;<a href="#idl-def-JsonLdErrorCode.invalid-language-mapping" class="idlEnumItem">invalid language mapping</a>&quot;,
    &quot;<a href="#idl-def-JsonLdErrorCode.colliding-keywords" class="idlEnumItem">colliding keywords</a>&quot;,
    &quot;<a href="#idl-def-JsonLdErrorCode.invalid-container-mapping" class="idlEnumItem">invalid container mapping</a>&quot;,
    &quot;<a href="#idl-def-JsonLdErrorCode.invalid-type-value" class="idlEnumItem">invalid type value</a>&quot;,
    &quot;<a href="#idl-def-JsonLdErrorCode.invalid-value-object" class="idlEnumItem">invalid value object</a>&quot;,
    &quot;<a href="#idl-def-JsonLdErrorCode.invalid-value-object-value" class="idlEnumItem">invalid value object value</a>&quot;,
    &quot;<a href="#idl-def-JsonLdErrorCode.invalid-language-tagged-string" class="idlEnumItem">invalid language-tagged string</a>&quot;,
    &quot;<a href="#idl-def-JsonLdErrorCode.invalid-language-tagged-value" class="idlEnumItem">invalid language-tagged value</a>&quot;,
    &quot;<a href="#idl-def-JsonLdErrorCode.invalid-typed-value" class="idlEnumItem">invalid typed value</a>&quot;,
    &quot;<a href="#idl-def-JsonLdErrorCode.invalid-language-map-value" class="idlEnumItem">invalid language map value</a>&quot;,
    &quot;<a href="#idl-def-JsonLdErrorCode.compaction-to-list-of-lists" class="idlEnumItem">compaction to list of lists</a>&quot;,
    &quot;<a href="#idl-def-JsonLdErrorCode.invalid-reverse-property-map" class="idlEnumItem">invalid reverse property map</a>&quot;,
    &quot;<a href="#idl-def-JsonLdErrorCode.invalid--reverse-value" class="idlEnumItem">invalid @reverse value</a>&quot;,
    &quot;<a href="#idl-def-JsonLdErrorCode.invalid-reverse-property-value" class="idlEnumItem">invalid reverse property value</a>&quot;
};
</ins></span></pre><table class="simple"><tr><th colspan="2"><ins class="diff-chg">
Enumeration
description
</ins></th></tr><tr><td><code id="idl-def-JsonLdErrorCode.invalid-syntax"><ins class="diff-chg">
invalid
syntax
</ins></code></td><td><ins class="diff-chg">
The
document
could
not
be
parsed
as
JSON.
</ins></td></tr><tr><td><code id="idl-def-JsonLdErrorCode.list-of-lists-detected"><ins class="diff-chg">
list
of
lists
detected
</ins></code></td><td><ins class="diff-chg">
A
list
of
lists
was
detected.
List
of
lists
are
not
supported
in
this
version
of
JSON-LD
due
to
the
algorithmic
complexity
associated
with
conversion
to
RDF.
</ins></td></tr><tr><td><code id="idl-def-JsonLdErrorCode.invalid--index-value"><ins class="diff-chg">
invalid
@index
value
</ins></code></td><td><ins class="diff-chg">
An
</ins><code><ins class="diff-chg">
@index
</ins></code><ins class="diff-chg">
member
was
encountered
whose
value
was
not
a
</ins><a class="tref internalDFN" title="string" href="#dfn-string"><ins class="diff-chg">
string
</ins></a>.</td></tr><tr><td><code id="idl-def-JsonLdErrorCode.conflicting-indexes"><ins class="diff-chg">
conflicting
indexes
</ins></code></td><td><ins class="diff-chg">
Multiple
conflicting
indexes
have
been
found
for
the
same
node.
</ins></td></tr><tr><td><code id="idl-def-JsonLdErrorCode.invalid--id-value"><ins class="diff-chg">
invalid
@id
value
</ins></code></td><td><ins class="diff-chg">
An
</ins><code><ins class="diff-chg">
@id
</ins></code><ins class="diff-chg">
member
was
encountered
whose
value
was
not
a
</ins><a class="tref internalDFN" title="string" href="#dfn-string"><ins class="diff-chg">
string
</ins></a>.</td></tr><tr><td><code id="idl-def-JsonLdErrorCode.invalid-local-context"><ins class="diff-chg">
invalid
local
context
</ins></code></td><td><ins class="diff-chg">
In
invalid
</ins><a class="tref internalDFN" title="local-context" href="#dfn-local-context"><ins class="diff-chg">
local
context
</ins></a><ins class="diff-chg">
was
detected.
</ins></td></tr><tr><td><code id="idl-def-JsonLdErrorCode.loading-remote-context-failed"><ins class="diff-chg">
loading
remote
context
failed
</ins></code></td><td><ins class="diff-chg">
There
was
a
problem
encountered
loading
a
remote
context.
</ins></td></tr><tr><td><code id="idl-def-JsonLdErrorCode.invalid-remote-context"><ins class="diff-chg">
invalid
remote
context
</ins></code></td><td><ins class="diff-chg">
No
valid
context
document
has
been
found
for
a
referenced,
remote
context.
</ins></td></tr><tr><td><code id="idl-def-JsonLdErrorCode.recursive-context-inclusion"><ins class="diff-chg">
recursive
context
inclusion
</ins></code></td><td><ins class="diff-chg">
A
cycle
in
remote
context
inclusions
has
been
detected.
</ins></td></tr><tr><td><code id="idl-def-JsonLdErrorCode.invalid-base-IRI"><ins class="diff-chg">
invalid
base
IRI
</ins></code></td><td><ins class="diff-chg">
An
invalid
</ins><a class="tref internalDFN" title="base-iri" href="#dfn-base-iri"><ins class="diff-chg">
base
</ins><abbr title="Internationalized Resource Identifier"><ins class="diff-chg">
IRI
</ins></abbr></a><ins class="diff-chg">
has
been
detected,
i.e.,
it
is
neither
an
</ins><a class="tref internalDFN" title="absolute-iri" href="#dfn-absolute-iri"><ins class="diff-chg">
absolute
</ins><abbr title="Internationalized Resource Identifier"><ins class="diff-chg">
IRI
</ins></abbr></a><ins class="diff-chg">
nor
</ins><a class="tref internalDFN" title="null" href="#dfn-null"><ins class="diff-chg">
null
</ins></a>.</td></tr><tr><td><code id="idl-def-JsonLdErrorCode.invalid-vocab-mapping"><ins class="diff-chg">
invalid
vocab
mapping
</ins></code></td><td><ins class="diff-chg">
An
invalid
</ins><a class="tref internalDFN" title="vocabulary-mapping" href="#dfn-vocabulary-mapping"><ins class="diff-chg">
vocabulary
mapping
</ins></a><ins class="diff-chg">
has
been
detected,
i.e.,
it
is
neither
an
</ins><a class="tref internalDFN" title="absolute-iri" href="#dfn-absolute-iri"><ins class="diff-chg">
absolute
</ins><abbr title="Internationalized Resource Identifier"><ins class="diff-chg">
IRI
</ins></abbr></a><ins class="diff-chg">
nor
</ins><a class="tref internalDFN" title="null" href="#dfn-null"><ins class="diff-chg">
null
</ins></a>.</td></tr><tr><td><code id="idl-def-JsonLdErrorCode.invalid-default-language"><ins class="diff-chg">
invalid
default
language
</ins></code></td><td><ins class="diff-chg">
The
value
of
the
</ins><a class="tref internalDFN" title="default-language" href="#dfn-default-language"><ins class="diff-chg">
default
language
</ins></a><ins class="diff-chg">
is
not
a
</ins><a class="tref internalDFN" title="string" href="#dfn-string"><ins class="diff-chg">
string
</ins></a><ins class="diff-chg">
or
</ins><a class="tref internalDFN" title="null" href="#dfn-null"><ins class="diff-chg">
null
</ins></a><ins class="diff-chg">
and
thus
invalid.
</ins></td></tr><tr><td><code id="idl-def-JsonLdErrorCode.keyword-redefinition"><ins class="diff-chg">
keyword
redefinition
</ins></code></td><td><ins class="diff-chg">
A
</ins><a class="tref internalDFN" title="keyword" href="#dfn-keyword"><ins class="diff-chg">
keyword
</ins></a><ins class="diff-chg">
redefinition
has
been
detected.
</ins></td></tr><tr><td><code id="idl-def-JsonLdErrorCode.invalid-term-definition"><ins class="diff-chg">
invalid
term
definition
</ins></code></td><td><ins class="diff-chg">
An
invalid
</ins><a class="tref internalDFN" title="term-definition" href="#dfn-term-definition"><ins class="diff-chg">
term
definition
</ins></a><ins class="diff-chg">
has
been
detected.
</ins></td></tr><tr><td><code id="idl-def-JsonLdErrorCode.invalid-reverse-property"><ins class="diff-chg">
invalid
reverse
property
</ins></code></td><td><ins class="diff-chg">
An
invalid
reverse
property
definition
has
been
detected.
</ins></td></tr><tr><td><code id="idl-def-JsonLdErrorCode.invalid-IRI-mapping"><ins class="diff-chg">
invalid
IRI
mapping
</ins></code></td><td><ins class="diff-chg">
A
</ins><a class="tref internalDFN" title="local-context" href="#dfn-local-context"><ins class="diff-chg">
local
context
</ins></a><ins class="diff-chg">
contains
a
</ins><a class="tref internalDFN" title="term" href="#dfn-term"><ins class="diff-chg">
term
</ins></a><ins class="diff-chg">
that
has
an
invalid
or
missing
</ins><a class="tref internalDFN" title="iri-mapping" href="#dfn-iri-mapping"><abbr title="Internationalized Resource Identifier"><ins class="diff-chg">
IRI
</ins></abbr><ins class="diff-chg">
mapping
</ins></a>.</td></tr><tr><td><code id="idl-def-JsonLdErrorCode.cyclic-IRI-mapping"><ins class="diff-chg">
cyclic
IRI
mapping
</ins></code></td><td><ins class="diff-chg">
A
cycle
in
</ins><a class="tref internalDFN" title="iri-mapping" href="#dfn-iri-mapping"><abbr title="Internationalized Resource Identifier"><ins class="diff-chg">
IRI
</ins></abbr><ins class="diff-chg">
mappings
</ins></a><ins class="diff-chg">
has
been
detected.
</ins></td></tr><tr><td><code id="idl-def-JsonLdErrorCode.invalid-keyword-alias"><ins class="diff-chg">
invalid
keyword
alias
</ins></code></td><td><ins class="diff-chg">
An
invalid
</ins><a class="tref internalDFN" title="keyword" href="#dfn-keyword"><ins class="diff-chg">
keyword
</ins></a><ins class="diff-chg">
alias
definition
has
been
encountered.
</ins></td></tr><tr><td><code id="idl-def-JsonLdErrorCode.invalid-type-mapping"><ins class="diff-chg">
invalid
type
mapping
</ins></code></td><td><ins class="diff-chg">
An
</ins><code><ins class="diff-chg">
@type
</ins></code><ins class="diff-chg">
member
in
a
</ins><a class="tref internalDFN" title="term-definition" href="#dfn-term-definition"><ins class="diff-chg">
term
definition
</ins></a><ins class="diff-chg">
was
encountered
whose
value
could
not
be
expanded
to
an
</ins><a class="tref internalDFN" title="absolute-iri" href="#dfn-absolute-iri"><ins class="diff-chg">
absolute
</ins><abbr title="Internationalized Resource Identifier"><ins class="diff-chg">
IRI
</ins></abbr></a>.</td></tr><tr><td><code id="idl-def-JsonLdErrorCode.invalid-language-mapping"><ins class="diff-chg">
invalid
language
mapping
</ins></code></td><td><ins class="diff-chg">
An
</ins><code><ins class="diff-chg">
@language
</ins></code><ins class="diff-chg">
member
in
a
</ins><a class="tref internalDFN" title="term-definition" href="#dfn-term-definition"><ins class="diff-chg">
term
definition
</ins></a><ins class="diff-chg">
was
encountered
whose
value
was
neither
a
</ins><a class="tref internalDFN" title="string" href="#dfn-string"><ins class="diff-chg">
string
</ins></a><ins class="diff-chg">
nor
</ins><a class="tref internalDFN" title="null" href="#dfn-null"><ins class="diff-chg">
null
</ins></a><ins class="diff-chg">
and
thus
invalid.
</ins></td></tr><tr><td><code id="idl-def-JsonLdErrorCode.colliding-keywords"><ins class="diff-chg">
colliding
keywords
</ins></code></td><td><ins class="diff-chg">
Two
properties
which
expand
to
the
same
keyword
have
been
detected.
This
might
occur
if
a
</ins><a class="tref internalDFN" title="keyword" href="#dfn-keyword"><ins class="diff-chg">
keyword
</ins></a><ins class="diff-chg">
and
an
an
alias
thereof
are
used
at
the
same
time.
</ins></td></tr><tr><td><code id="idl-def-JsonLdErrorCode.invalid-container-mapping"><ins class="diff-chg">
invalid
container
mapping
</ins></code></td><td><ins class="diff-chg">
An
</ins><code><ins class="diff-chg">
@container
</ins></code><ins class="diff-chg">
member
was
encountered
whose
value
was
not
one
of
the
following
</ins><a class="tref internalDFN" title="string" href="#dfn-string"><ins class="diff-chg">
strings
</ins></a>:<code><ins class="diff-chg">
@list
</ins></code>,<code><ins class="diff-chg">
@set
</ins></code>,<ins class="diff-chg">
or
</ins><code><ins class="diff-chg">
@index
</ins></code>.</td></tr><tr><td><code id="idl-def-JsonLdErrorCode.invalid-type-value"><ins class="diff-chg">
invalid
type
value
</ins></code></td><td><ins class="diff-chg">
An
invalid
value
for
an
</ins><code><ins class="diff-chg">
@type
</ins></code><ins class="diff-chg">
member
has
been
detected,
i.e.,
the
value
was
neither
a
</ins><a class="tref internalDFN" title="string" href="#dfn-string"><ins class="diff-chg">
string
</ins></a><ins class="diff-chg">
nor
an
</ins><a class="tref internalDFN" title="array" href="#dfn-array"><ins class="diff-chg">
array
</ins></a><ins class="diff-chg">
of
</ins><a class="tref internalDFN" title="string" href="#dfn-string"><ins class="diff-chg">
strings
</ins></a>.</td></tr><tr><td><code id="idl-def-JsonLdErrorCode.invalid-value-object"><ins class="diff-chg">
invalid
value
object
</ins></code></td><td><ins class="diff-chg">
A
</ins><a class="tref internalDFN" title="value-object" href="#dfn-value-object"><ins class="diff-chg">
value
object
</ins></a><ins class="diff-chg">
with
disallowed
members
has
been
detected.
</ins></td></tr><tr><td><code id="idl-def-JsonLdErrorCode.invalid-value-object-value"><ins class="diff-chg">
invalid
value
object
value
</ins></code></td><td><ins class="diff-chg">
An
invalid
value
for
the
</ins><code><ins class="diff-chg">
@value
</ins></code><ins class="diff-chg">
member
of
a
</ins><a class="tref internalDFN" title="value-object" href="#dfn-value-object"><ins class="diff-chg">
value
object
</ins></a><ins class="diff-chg">
has
been
detected,
i.e.,
it
is
neither
a
</ins><a class="tref internalDFN" title="scalar" href="#dfn-scalar"><ins class="diff-chg">
scalar
</ins></a><ins class="diff-chg">
nor
</ins><a class="tref internalDFN" title="null" href="#dfn-null"><ins class="diff-chg">
null
</ins></a>.</td></tr><tr><td><code id="idl-def-JsonLdErrorCode.invalid-language-tagged-string"><ins class="diff-chg">
invalid
language-tagged
string
</ins></code></td><td><ins class="diff-chg">
A
</ins><a class="tref internalDFN" title="language-tagged-string" href="http://www.w3.org/TR/rdf11-concepts/#dfn-language-tagged-string"><ins class="diff-chg">
language-tagged
string
</ins></a><ins class="diff-chg">
with
an
invalid
language
value
was
detected.
</ins></td></tr><tr><td><code id="idl-def-JsonLdErrorCode.invalid-language-tagged-value"><ins class="diff-chg">
invalid
language-tagged
value
</ins></code></td><td><ins class="diff-chg">
A
</ins><a class="tref internalDFN" title="number" href="#dfn-number"><ins class="diff-chg">
number
</ins></a>,<a class="tref internalDFN" title="true" href="#dfn-true"><ins class="diff-chg">
true
</ins></a>,<ins class="diff-chg">
or
</ins><a class="tref internalDFN" title="false" href="#dfn-false"><ins class="diff-chg">
false
</ins></a><ins class="diff-chg">
with
an
associated
language
tag
was
detected.
</ins></td></tr><tr><td><code id="idl-def-JsonLdErrorCode.invalid-typed-value"><ins class="diff-chg">
invalid
typed
value
</ins></code></td><td><ins class="diff-chg">
A
</ins><a class="tref internalDFN" title="typed-value" href="#dfn-typed-value"><ins class="diff-chg">
typed
value
</ins></a><ins class="diff-chg">
with
an
invalid
type
was
detected.
</ins></td></tr><tr><td><code id="idl-def-JsonLdErrorCode.invalid-language-map-value"><ins class="diff-chg">
invalid
language
map
value
</ins></code></td><td><ins class="diff-chg">
An
invalid
value
in
a
</ins><a class="tref externalDFN" title="language-map" href="../json-ld-syntax/#dfn-language-map"><ins class="diff-chg">
language
map
</ins></a><ins class="diff-chg">
has
been
detected.
It
has
to
be
a
</ins><a class="tref internalDFN" title="string" href="#dfn-string"><ins class="diff-chg">
string
</ins></a><ins class="diff-chg">
or
an
</ins><a class="tref internalDFN" title="array" href="#dfn-array"><ins class="diff-chg">
array
</ins></a><ins class="diff-chg">
of
</ins><a class="tref internalDFN" title="string" href="#dfn-string"><ins class="diff-chg">
strings
</ins></a>.</td></tr><tr><td><code id="idl-def-JsonLdErrorCode.compaction-to-list-of-lists"><ins class="diff-chg">
compaction
to
list
of
lists
</ins></code></td><td><ins class="diff-chg">
The
compacted
document
contains
a
list
of
lists
as
multiple
lists
have
been
compacted
to
the
same
term.
</ins></td></tr><tr><td><code id="idl-def-JsonLdErrorCode.invalid-reverse-property-map"><ins class="diff-chg">
invalid
reverse
property
map
</ins></code></td><td><ins class="diff-chg">
An
invalid
reverse
property
map
has
been
detected.
No
</ins><a class="tref internalDFN" title="keyword" href="#dfn-keyword"><ins class="diff-chg">
keywords
</ins></a><ins class="diff-chg">
apart
from
</ins><code><ins class="diff-chg">
@context
</ins></code><ins class="diff-chg">
are
allowed
in
reverse
property
maps.
</ins></td></tr><tr><td><code id="idl-def-JsonLdErrorCode.invalid--reverse-value"><ins class="diff-chg">
invalid
@reverse
value
</ins></code></td><td><ins class="diff-chg">
An
invalid
value
for
an
</ins><code><ins class="diff-chg">
@reverse
</ins></code><ins class="diff-chg">
member
has
been
detected,
i.e.,
the
value
was
not
a
</ins><a class="tref internalDFN" title="json-object" href="#dfn-json-object"><ins class="diff-chg">
JSON
object
</ins></a>.</td></tr><tr><td><code id="idl-def-JsonLdErrorCode.invalid-reverse-property-value"><ins class="diff-chg">
invalid
reverse
property
value
</ins></code></td><td><ins class="diff-chg">
An
invalid
value
for
a
reverse
property
has
been
detected.
The
value
of
an
inverse
property
must
be
a
</ins><a class="tref internalDFN" title="node-object" href="#dfn-node-object"><ins class="diff-chg">
node
object
</ins></a>.</td></tr></table></section></section></section><section class="appendix informative" id="acknowledgements">
<h2>
<span class="secno">
<del class="diff-old">B.
</del>
<ins class="diff-chg">A.
</ins>
</span>
Acknowledgements
</h2>
<p>
<em>
<ins class="diff-new">This
section
is
non-normative.
</ins></em></p><p><ins class="diff-new">
A
large
amount
of
thanks
goes
out
to
the
JSON-LD
Community
Group
participants
who
worked
through
many
of
the
technical
issues
on
the
mailing
list
and
the
weekly
telecons
-
of
special
mention
are
Niklas
Lindström,
François
Daoust,
Lin
Clark,
and
Zdenko
'Denny'
Vrandečić.
</ins>
The
editors
would
like
to
thank
Mark
Birbeck,
who
provided
a
great
deal
of
the
initial
push
behind
the
JSON-LD
work
via
his
work
on
<del class="diff-old">RDFj,
</del>
<ins class="diff-chg">RDFj.
The
work
of
</ins>
Dave
Lehn
and
Mike
Johnson
<del class="diff-old">who
reviewed,
provided
feedback,
</del>
<ins class="diff-chg">are
appreciated
for
reviewing,
</ins>
and
<del class="diff-old">performed
</del>
<ins class="diff-chg">performing
</ins>
several
implementations
of
the
<del class="diff-old">specification,
and
</del>
<ins class="diff-chg">specification.
</ins>
Ian
<del class="diff-old">Davis,
who
created
</del>
<ins class="diff-chg">Davis
is
thanked
for
his
work
on
</ins>
RDF/JSON.
Thanks
also
to
Nathan
Rixham,
Bradley
P.
Allen,
Kingsley
Idehen,
Glenn
McDonald,
Alexandre
Passant,
Danny
Ayers,
Ted
Thibodeau
Jr.,
Olivier
Grisel,
Josh
Mandel,
Eric
Prud'hommeaux,
David
Wood,
Guus
Schreiber,
Pat
Hayes,
Sandro
Hawke,
and
Richard
Cyganiak
<del class="diff-old">for
</del>
<ins class="diff-chg">or
</ins>
their
input
on
the
specification.
</p>
</section>
<section id="references" class="appendix" typeof="bibo:Chapter" resource="#references" rel="bibo:chapter">
<h2>
<span class="secno">
<del class="diff-old">C.
</del>
<ins class="diff-chg">B.
</ins>
</span>
References
</h2>
<section id="normative-references" typeof="bibo:Chapter" resource="#normative-references" rel="bibo:chapter">
<h3>
<span class="secno">
<del class="diff-old">C.1
</del>
<ins class="diff-chg">B.1
</ins>
</span>
Normative
references
</h3>
<del class="diff-old">[BCP47]
A.
Phillips;
M.
Davis.
Tags
for
Identifying
Languages
September
2009.
IETF
Best
Current
Practice.
URL:
http://tools.ietf.org/html/bcp47
</del>
<dl class="bibliography" about="">
<dt id="bib-IEEE-754-1985">
[IEEE-754-1985]
</dt>
<dd rel="dcterms:requires">
IEEE.
<cite>
IEEE
Standard
for
Binary
Floating-Point
Arithmetic.
</cite>
<del class="diff-old">See
</del>
<ins class="diff-chg">URL:
</ins>
<a href="http://standards.ieee.org/reading/ieee/std_public/description/busarch/754-1985_desc.html">
http://standards.ieee.org/reading/ieee/std_public/description/busarch/754-1985_desc.html
</a>
</dd>
<dt id="bib-JSON-LD">
[JSON-LD]
</dt>
<del class="diff-old">The
JSON-LD
Syntax
</del>
<dd rel="dcterms:requires">
Manu
Sporny,
Gregg
Kellogg,
Markus
<del class="diff-old">Lanthaler
</del>
<ins class="diff-chg">Lanthaler,
</ins>
Editors.
<del class="diff-old">World
Wide
Web
Consortium
</del>
<cite>
<a href="http://json-ld.org/spec/latest/json-ld-syntax/">
<ins class="diff-chg">JSON-LD
1.0
</ins></a>.</cite><ins class="diff-chg">
W3C
Editor's
Draft
</ins>
(work
in
progress).
<del class="diff-old">22
May
2012.
Editor's
Draft.
This
edition
of
the
JSON-LD
Syntax
specification
is
http://json-ld.org/spec/ED/json-ld-syntax/20120522/.
The
</del>
<ins class="diff-chg">URL:
</ins>
<a href="http://json-ld.org/spec/latest/json-ld-syntax/">
<del class="diff-old">latest
edition
of
the
JSON-LD
Syntax
is
available
at
</del>
http://json-ld.org/spec/latest/json-ld-syntax/
<del class="diff-old">[JSON-POINTER]
JSON
Pointer
P.
Bryan,
Ed.
IETF
Draft.
URL:
http://tools.ietf.org/html/draft-ietf-appsawg-json-pointer-02
</del>
</a>
</dd>
<del class="diff-old">[RDF-CONCEPTS]
</del>
<dt id="bib-RDF-MT">
<ins class="diff-chg">[RDF-MT]
</ins>
</dt>
<dd rel="dcterms:requires">
<ins class="diff-chg">Patrick
Hayes.
</ins><a href="http://www.w3.org/TR/2004/REC-rdf-mt-20040210">
<cite>
RDF
<del class="diff-old">1.1
Concepts
and
Abstract
Syntax
</del>
<ins class="diff-chg">Semantics
</ins>
</cite>
<del class="diff-old">Richard
Cyganiak,
David
Wood,
Editors.
World
Wide
Web
Consortium
(work
in
progress).
30
May
2012.
Editor's
Draft.
This
edition
of
the
JSON-LD
Syntax
specification
is
http://www.w3.org/TR/2011/WD-rdf11-concepts-20110830/.
The
latest
edition
of
the
JSON-LD
Syntax
</del>
</a>.
<ins class="diff-chg">10
February
2004.
W3C
Recommendation.
URL:
</ins><a href="http://www.w3.org/TR/2004/REC-rdf-mt-20040210"><ins class="diff-chg">
http://www.w3.org/TR/2004/REC-rdf-mt-20040210
</ins>
</a>
<del class="diff-old">is
available
at
http://www.w3.org/TR/rdf11-concepts/
</del>
</dd>
<del class="diff-old">[RDF-SCHEMA]
</del>
<dt id="bib-RFC2119">
<ins class="diff-chg">[RFC2119]
</ins>
</dt>
<del class="diff-old">Dan
Brickley;
Ramanathan
V.
Guha.
</del>
<dd rel="dcterms:requires">
<ins class="diff-chg">S.
Bradner.
</ins><a href="http://www.ietf.org/rfc/rfc2119.txt">
<cite>
<del class="diff-old">RDF
Vocabulary
Description
Language
1.0:
RDF
Schema.
</del>
<ins class="diff-chg">Key
words
for
use
in
RFCs
to
Indicate
Requirement
Levels.
</ins>
</cite>
</a>
<del class="diff-old">10
February
2004.
W3C
Recommendation.
</del>
<ins class="diff-chg">March
1997.
Internet
RFC
2119.
</ins>
URL:
<del class="diff-old">http://www.w3.org/TR/2004/REC-rdf-schema-20040210
</del>
<a href="http://www.ietf.org/rfc/rfc2119.txt">
<ins class="diff-chg">http://www.ietf.org/rfc/rfc2119.txt
</ins>
</a>
</dd>
<dt id="bib-RFC3986">
[RFC3986]
</dt>
<dd rel="dcterms:requires">
T.
Berners-Lee;
R.
Fielding;
L.
Masinter.
<a href="http://www.ietf.org/rfc/rfc3986.txt">
<cite>
Uniform
Resource
Identifier
(URI):
Generic
<del class="diff-old">Syntax.
</del>
<ins class="diff-chg">Syntax
</ins>
</cite>
</a>.
January
2005.
<del class="diff-old">Internet
</del>
RFC
3986.
URL:
<a href="http://www.ietf.org/rfc/rfc3986.txt">
http://www.ietf.org/rfc/rfc3986.txt
</a>
</dd>
<dt id="bib-RFC3987">
[RFC3987]
</dt>
<dd rel="dcterms:requires">
M.
Dürst;
M.
Suignard.
<a href="http://www.ietf.org/rfc/rfc3987.txt">
<cite>
Internationalized
Resource
Identifiers
<del class="diff-old">(IRIs).
</del>
<ins class="diff-chg">(IRIs)
</ins>
</cite>
</a>.
January
2005.
<del class="diff-old">Internet
</del>
RFC
3987.
URL:
<a href="http://www.ietf.org/rfc/rfc3987.txt">
http://www.ietf.org/rfc/rfc3987.txt
</a>
</dd>
<dt id="bib-RFC4627">
[RFC4627]
</dt>
<dd rel="dcterms:requires">
D.
Crockford.
<a href="http://www.ietf.org/rfc/rfc4627.txt">
<cite>
The
application/json
Media
Type
for
JavaScript
Object
Notation
(JSON)
</cite>
</a>.
July
2006.
<del class="diff-old">Internet
</del>
RFC
4627.
URL:
<a href="http://www.ietf.org/rfc/rfc4627.txt">
http://www.ietf.org/rfc/rfc4627.txt
</a>
</dd>
<dt id="bib-WEBIDL">
[WEBIDL]
</dt>
<dd rel="dcterms:requires">
<ins class="diff-chg">Cameron
McCormack,
Editor.
</ins>
<cite>
<a href="http://www.w3.org/TR/2012/CR-WebIDL-20120419/">
Web
<del class="diff-old">IDL
</del>
<ins class="diff-chg">IDL.
</ins>
</a>
</cite>
<del class="diff-old">Cameron
McCormack,
Editor.
World
Wide
Web
Consortium.
</del>
19
April
2012.
<ins class="diff-new">W3C
</ins>
Candidate
<del class="diff-old">Recommendataion.
This
edition
of
Web
IDL
is
http://www.w3.org/TR/2012/CR-WebIDL-20120419/.
</del>
<ins class="diff-chg">Recommendation
(work
in
progress).
URL:
</ins><a href="http://www.w3.org/TR/2012/CR-WebIDL-20120419/"><ins class="diff-chg">
http://www.w3.org/TR/2012/CR-WebIDL-20120419/
</ins></a>.
The
latest
edition
<del class="diff-old">of
Web
IDL
</del>
is
available
at
<del class="diff-old">http://dev.w3.org/2006/webapi/WebIDL/
</del>
<a href="http://www.w3.org/TR/WebIDL/">
<ins class="diff-chg">http://www.w3.org/TR/WebIDL/
</ins></a>
</dd>
<dt id="bib-XMLSCHEMA11-2">
[XMLSCHEMA11-2]
</dt>
<dd rel="dcterms:requires">
Henry
S.
<del class="diff-old">Thompson;
</del>
<ins class="diff-chg">Thompson
</ins>
et
al.
<a href="http://www.w3.org/TR/2012/REC-xmlschema11-2-20120405/">
<cite>
W3C
XML
Schema
Definition
Language
(XSD)
1.1
Part
2:
<del class="diff-old">Datatypes.
</del>
<ins class="diff-chg">Datatypes
</ins>
</cite>
</a>.
5
April
2012.
W3C
<del class="diff-old">Recommendation
</del>
<ins class="diff-chg">Recommendation.
</ins>
URL:
<a href="http://www.w3.org/TR/2012/REC-xmlschema11-2-20120405/">
http://www.w3.org/TR/2012/REC-xmlschema11-2-20120405/
</a>
</dd>
</dl>
</section>
<section id="informative-references" typeof="bibo:Chapter" resource="#informative-references" rel="bibo:chapter">
<h3>
<span class="secno">
<del class="diff-old">C.2
</del>
<ins class="diff-chg">B.2
</ins>
</span>
Informative
references
</h3>
<dl class="bibliography" about="">
<dt id="bib-BCP47">
<ins class="diff-chg">[BCP47]
</ins></dt><dd rel="dcterms:references"><ins class="diff-chg">
A.
Phillips;
M.
Davis.
</ins><a href="http://tools.ietf.org/html/bcp47"><cite><ins class="diff-chg">
Tags
for
Identifying
Languages
</ins></cite></a>.<ins class="diff-chg">
September
2009.
IETF
Best
Current
Practice.
URL:
</ins><a href="http://tools.ietf.org/html/bcp47"><ins class="diff-chg">
http://tools.ietf.org/html/bcp47
</ins></a></dd>
<dt id="bib-ECMA-262">
[ECMA-262]
</dt>
<dd rel="dcterms:references">
<a href="http://www.ecma-international.org/publications/standards/Ecma-262.htm">
<cite>
ECMAScript
Language
Specification.
</cite>
</a>
<del class="diff-old">December
1999.
</del>
<ins class="diff-chg">June
2011.
</ins>
URL:
<a href="http://www.ecma-international.org/publications/standards/Ecma-262.htm">
http://www.ecma-international.org/publications/standards/Ecma-262.htm
</a>
</dd>
<del class="diff-old">[TURTLE-TR]
</del>
<dt id="bib-JSON-LD-TESTS">
<ins class="diff-chg">[JSON-LD-TESTS]
</ins>
</dt>
<del class="diff-old">Eric
Prud'hommeaux,
Gavin
Carothers.
</del>
<dd rel="dcterms:references">
<cite>
<del class="diff-old">Turtle:
Terse
</del>
<a href="http://dvcs.w3.org/hg/json-ld/raw-file/default/test-suite/">
<ins class="diff-chg">JSON-LD
Test
Suite
</ins></a></cite><ins class="diff-chg">
(work
in
progress).
</ins></dd><dt id="bib-RDF11-CONCEPTS"><ins class="diff-chg">
[RDF11-CONCEPTS]
</ins></dt><dd rel="dcterms:references"><ins class="diff-chg">
Richard
Cyganiak,
David
Wood,
Editors.
</ins><cite><a href="http://www.w3.org/TR/2013/WD-rdf11-concepts-20130115/">
RDF
<del class="diff-old">Triple
Language.
</del>
<ins class="diff-chg">1.1
Concepts
and
Abstract
Syntax.
</ins>
</a>
</cite>
<del class="diff-old">09
August
2011.
</del>
<ins class="diff-chg">15
January
2013.
</ins>
W3C
Working
<del class="diff-old">Draft.
</del>
<ins class="diff-chg">Draft
(work
in
progress).
</ins>
URL:
<del class="diff-old">http://www.w3.org/TR/2011/WD-turtle-20110809/
</del>
<a href="http://www.w3.org/TR/2013/WD-rdf11-concepts-20130115/">
<ins class="diff-chg">http://www.w3.org/TR/2013/WD-rdf11-concepts-20130115/
</ins></a>.<ins class="diff-chg">
The
latest
edition
is
available
at
</ins><a href="http://www.w3.org/TR/rdf11-concepts/"><ins class="diff-chg">
http://www.w3.org/TR/rdf11-concepts/
</ins>
</a>
</dd>
<del class="diff-old">[UNICODE]
</del>
<dt id="bib-TURTLE">
<ins class="diff-chg">[TURTLE]
</ins>
</dt>
<del class="diff-old">The
Unicode
Consortium.
</del>
<dd rel="dcterms:references">
<ins class="diff-chg">Eric
Prud'hommeaux,
Gavin
Carothers,
Editors.
</ins>
<cite>
<del class="diff-old">The
Unicode
Standard.
</del>
<a href="http://www.w3.org/TR/2013/CR-turtle-20130219/">
<ins class="diff-new">Turtle:
Terse
RDF
Triple
Language.
</ins>
</a>
<del class="diff-old">2003.
Defined
by:
The
Unicode
Standard,
Version
4.0
(Boston,
MA,
Addison-Wesley,
ISBN
0-321-18578-1),
as
updated
from
time
to
time
by
the
publication
of
new
versions
</del>
</cite>
<ins class="diff-chg">19
February
2013.
W3C
Candidate
Recommendation
(work
in
progress).
</ins>
URL:
<del class="diff-old">http://www.unicode.org/unicode/standard/versions/enumeratedversions.html
</del>
<a href="http://www.w3.org/TR/2013/CR-turtle-20130219/">
<ins class="diff-chg">http://www.w3.org/TR/2013/CR-turtle-20130219/
</ins></a>.<ins class="diff-chg">
The
latest
edition
is
available
at
</ins><a href="http://www.w3.org/TR/turtle/"><ins class="diff-chg">
http://www.w3.org/TR/turtle/
</ins>
</a>
</dd>
</dl>
</section>
</section>
</body>
</html>
